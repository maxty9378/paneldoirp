# ðŸ”§ Ð ÑƒÑ‡Ð½Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° HTTPS

Ð¡ÐµÑ€Ð²ÐµÑ€ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸. Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ **Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ**:

## ðŸ“ ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ

### 1. ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÐµÑÑŒ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ

```bash
ssh -i src/ssh/ssh-key-doirp-01 root@51.250.94.103
```

### 2. Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ ÑÑ‚Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¿Ð¾ Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒ:

```bash
# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
apt-get update

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Nginx
apt-get install -y nginx

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Certbot
apt-get install -y certbot python3-certbot-nginx

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸ Ð´Ð»Ñ SSL
mkdir -p /etc/nginx/ssl

# Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ ÑÐ°Ð¼Ð¾Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ°Ð½Ð½Ð¾Ð³Ð¾ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð°
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/nginx/ssl/doirp.key \
  -out /etc/nginx/ssl/doirp.crt \
  -subj "/C=RU/ST=Moscow/L=Moscow/O=SNS/CN=51.250.94.103"

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Nginx
cat > /etc/nginx/sites-available/doirp << 'EOF'
# HTTP - Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚ Ð½Ð° HTTPS
server {
    listen 80;
    server_name 51.250.94.103;
    return 301 https://$server_name$request_uri;
}

# HTTPS
server {
    listen 443 ssl http2;
    server_name 51.250.94.103;

    # SSL ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ñ‹
    ssl_certificate /etc/nginx/ssl/doirp.crt;
    ssl_certificate_key /etc/nginx/ssl/doirp.key;

    # SSL Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    root /var/www/html;
    index index.html;

    # Ð›Ð¾Ð³Ð¸
    access_log /var/log/nginx/doirp_access.log;
    error_log /var/log/nginx/doirp_error.log;

    # ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
    location / {
        try_files $uri $uri/ /index.html;
    }

    # ÐšÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Gzip
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;
}
EOF

# ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
ln -sf /etc/nginx/sites-available/doirp /etc/nginx/sites-enabled/
rm -f /etc/nginx/sites-enabled/default

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
nginx -t

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Nginx
systemctl restart nginx
systemctl enable nginx

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° firewall
ufw allow 80/tcp
ufw allow 443/tcp
ufw allow 22/tcp
ufw --force enable

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
systemctl status nginx
```

### 3. Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ

```bash
# Ð¡ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ð°
npm run build

# ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð¾Ð²
scp -i src/ssh/ssh-key-doirp-01 -r dist/* root@51.250.94.103:/var/www/html/

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿Ñ€Ð°Ð²
ssh -i src/ssh/ssh-key-doirp-01 root@51.250.94.103 "chown -R www-data:www-data /var/www/html && chmod -R 755 /var/www/html"

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Nginx
ssh -i src/ssh/ssh-key-doirp-01 root@51.250.94.103 "systemctl restart nginx"
```

## âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾!

ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´:
- ðŸŒ Ð¡Ð°Ð¹Ñ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½: **https://51.250.94.103**
- ðŸ“± ÐšÐ°Ð¼ÐµÑ€Ð° QR-ÑÐºÐ°Ð½ÐµÑ€ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚!
- ðŸ”’ HTTPS Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½

## âš ï¸ Ð’Ð°Ð¶Ð½Ð¾

Ð‘Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð¿Ð¾ÐºÐ°Ð¶ÐµÑ‚ Ð¿Ñ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ Ð¾ ÑÐ°Ð¼Ð¾Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ°Ð½Ð½Ð¾Ð¼ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ðµ. Ð­Ñ‚Ð¾ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾! ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ:
- **"Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾"** â†’ **"ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ð½Ð° ÑÐ°Ð¹Ñ‚"**

