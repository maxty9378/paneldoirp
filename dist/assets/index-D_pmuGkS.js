function u7(e,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in e)){const i=Object.getOwnPropertyDescriptor(a,n);i&&Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Os=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function iv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function f7(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}),r}var l6={exports:{}},Ah={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h7=Symbol.for("react.transitional.element"),m7=Symbol.for("react.fragment");function o6(e,t,r){var a=null;if(r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),"key"in t){r={};for(var n in t)n!=="key"&&(r[n]=t[n])}else r=t;return t=r.ref,{$$typeof:h7,type:e,key:a,ref:t!==void 0?t:null,props:r}}Ah.Fragment=m7;Ah.jsx=o6;Ah.jsxs=o6;l6.exports=Ah;var s=l6.exports,c6={exports:{}},dt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv=Symbol.for("react.transitional.element"),g7=Symbol.for("react.portal"),p7=Symbol.for("react.fragment"),v7=Symbol.for("react.strict_mode"),b7=Symbol.for("react.profiler"),y7=Symbol.for("react.consumer"),w7=Symbol.for("react.context"),E7=Symbol.for("react.forward_ref"),_7=Symbol.for("react.suspense"),j7=Symbol.for("react.memo"),d6=Symbol.for("react.lazy"),Zy=Symbol.iterator;function N7(e){return e===null||typeof e!="object"?null:(e=Zy&&e[Zy]||e["@@iterator"],typeof e=="function"?e:null)}var x6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u6=Object.assign,f6={};function a0(e,t,r){this.props=e,this.context=t,this.refs=f6,this.updater=r||x6}a0.prototype.isReactComponent={};a0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};a0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function h6(){}h6.prototype=a0.prototype;function ov(e,t,r){this.props=e,this.context=t,this.refs=f6,this.updater=r||x6}var cv=ov.prototype=new h6;cv.constructor=ov;u6(cv,a0.prototype);cv.isPureReactComponent=!0;var e2=Array.isArray,rr={H:null,A:null,T:null,S:null},m6=Object.prototype.hasOwnProperty;function dv(e,t,r,a,n,i){return r=i.ref,{$$typeof:lv,type:e,key:t,ref:r!==void 0?r:null,props:i}}function C7(e,t){return dv(e.type,t,void 0,void 0,void 0,e.props)}function xv(e){return typeof e=="object"&&e!==null&&e.$$typeof===lv}function A7(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var t2=/\/+/g;function Nm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?A7(""+e.key):t.toString(36)}function r2(){}function k7(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(r2,r2):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function Go(e,t,r,a,n){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"bigint":case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case lv:case g7:l=!0;break;case d6:return l=e._init,Go(l(e._payload),t,r,a,n)}}if(l)return n=n(e),l=a===""?"."+Nm(e,0):a,e2(n)?(r="",l!=null&&(r=l.replace(t2,"$&/")+"/"),Go(n,t,r,"",function(d){return d})):n!=null&&(xv(n)&&(n=C7(n,r+(n.key==null||e&&e.key===n.key?"":(""+n.key).replace(t2,"$&/")+"/")+l)),t.push(n)),1;l=0;var o=a===""?".":a+":";if(e2(e))for(var c=0;c<e.length;c++)a=e[c],i=o+Nm(a,c),l+=Go(a,t,r,i,n);else if(c=N7(e),typeof c=="function")for(e=c.call(e),c=0;!(a=e.next()).done;)a=a.value,i=o+Nm(a,c++),l+=Go(a,t,r,i,n);else if(i==="object"){if(typeof e.then=="function")return Go(k7(e),t,r,a,n);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return l}function lu(e,t,r){if(e==null)return e;var a=[],n=0;return Go(e,a,"","",function(i){return t.call(r,i,n++)}),a}function D7(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var s2=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function S7(){}dt.Children={map:lu,forEach:function(e,t,r){lu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return lu(e,function(){t++}),t},toArray:function(e){return lu(e,function(t){return t})||[]},only:function(e){if(!xv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};dt.Component=a0;dt.Fragment=p7;dt.Profiler=b7;dt.PureComponent=ov;dt.StrictMode=v7;dt.Suspense=_7;dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=rr;dt.act=function(){throw Error("act(...) is not supported in production builds of React.")};dt.cache=function(e){return function(){return e.apply(null,arguments)}};dt.cloneElement=function(e,t,r){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var a=u6({},e.props),n=e.key,i=void 0;if(t!=null)for(l in t.ref!==void 0&&(i=void 0),t.key!==void 0&&(n=""+t.key),t)!m6.call(t,l)||l==="key"||l==="__self"||l==="__source"||l==="ref"&&t.ref===void 0||(a[l]=t[l]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];a.children=o}return dv(e.type,n,void 0,void 0,i,a)};dt.createContext=function(e){return e={$$typeof:w7,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:y7,_context:e},e};dt.createElement=function(e,t,r){var a,n={},i=null;if(t!=null)for(a in t.key!==void 0&&(i=""+t.key),t)m6.call(t,a)&&a!=="key"&&a!=="__self"&&a!=="__source"&&(n[a]=t[a]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}if(e&&e.defaultProps)for(a in l=e.defaultProps,l)n[a]===void 0&&(n[a]=l[a]);return dv(e,i,void 0,void 0,null,n)};dt.createRef=function(){return{current:null}};dt.forwardRef=function(e){return{$$typeof:E7,render:e}};dt.isValidElement=xv;dt.lazy=function(e){return{$$typeof:d6,_payload:{_status:-1,_result:e},_init:D7}};dt.memo=function(e,t){return{$$typeof:j7,type:e,compare:t===void 0?null:t}};dt.startTransition=function(e){var t=rr.T,r={};rr.T=r;try{var a=e(),n=rr.S;n!==null&&n(r,a),typeof a=="object"&&a!==null&&typeof a.then=="function"&&a.then(S7,s2)}catch(i){s2(i)}finally{rr.T=t}};dt.unstable_useCacheRefresh=function(){return rr.H.useCacheRefresh()};dt.use=function(e){return rr.H.use(e)};dt.useActionState=function(e,t,r){return rr.H.useActionState(e,t,r)};dt.useCallback=function(e,t){return rr.H.useCallback(e,t)};dt.useContext=function(e){return rr.H.useContext(e)};dt.useDebugValue=function(){};dt.useDeferredValue=function(e,t){return rr.H.useDeferredValue(e,t)};dt.useEffect=function(e,t){return rr.H.useEffect(e,t)};dt.useId=function(){return rr.H.useId()};dt.useImperativeHandle=function(e,t,r){return rr.H.useImperativeHandle(e,t,r)};dt.useInsertionEffect=function(e,t){return rr.H.useInsertionEffect(e,t)};dt.useLayoutEffect=function(e,t){return rr.H.useLayoutEffect(e,t)};dt.useMemo=function(e,t){return rr.H.useMemo(e,t)};dt.useOptimistic=function(e,t){return rr.H.useOptimistic(e,t)};dt.useReducer=function(e,t,r){return rr.H.useReducer(e,t,r)};dt.useRef=function(e){return rr.H.useRef(e)};dt.useState=function(e){return rr.H.useState(e)};dt.useSyncExternalStore=function(e,t,r){return rr.H.useSyncExternalStore(e,t,r)};dt.useTransition=function(){return rr.H.useTransition()};dt.version="19.0.0";c6.exports=dt;var E=c6.exports;const wt=iv(E),B7=u7({__proto__:null,default:wt},[E]);var g6={exports:{}},kh={},p6={exports:{}},v6={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,N){var T=F.length;F.push(N);e:for(;0<T;){var S=T-1>>>1,z=F[S];if(0<n(z,N))F[S]=N,F[T]=z,T=S;else break e}}function r(F){return F.length===0?null:F[0]}function a(F){if(F.length===0)return null;var N=F[0],T=F.pop();if(T!==N){F[0]=T;e:for(var S=0,z=F.length,W=z>>>1;S<W;){var k=2*(S+1)-1,q=F[k],A=k+1,I=F[A];if(0>n(q,T))A<z&&0>n(I,q)?(F[S]=I,F[A]=T,S=A):(F[S]=q,F[k]=T,S=k);else if(A<z&&0>n(I,T))F[S]=I,F[A]=T,S=A;else break e}}return N}function n(F,N){var T=F.sortIndex-N.sortIndex;return T!==0?T:F.id-N.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],d=[],x=1,u=null,f=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function m(F){for(var N=r(d);N!==null;){if(N.callback===null)a(d);else if(N.startTime<=F)a(d),N.sortIndex=N.expirationTime,t(c,N);else break;N=r(d)}}function b(F){if(g=!1,m(F),!p)if(r(c)!==null)p=!0,U();else{var N=r(d);N!==null&&P(b,N.startTime-F)}}var _=!1,C=-1,j=5,D=-1;function R(){return!(e.unstable_now()-D<j)}function M(){if(_){var F=e.unstable_now();D=F;var N=!0;try{e:{p=!1,g&&(g=!1,v(C),C=-1),h=!0;var T=f;try{t:{for(m(F),u=r(c);u!==null&&!(u.expirationTime>F&&R());){var S=u.callback;if(typeof S=="function"){u.callback=null,f=u.priorityLevel;var z=S(u.expirationTime<=F);if(F=e.unstable_now(),typeof z=="function"){u.callback=z,m(F),N=!0;break t}u===r(c)&&a(c),m(F)}else a(c);u=r(c)}if(u!==null)N=!0;else{var W=r(d);W!==null&&P(b,W.startTime-F),N=!1}}break e}finally{u=null,f=T,h=!1}N=void 0}}finally{N?O():_=!1}}}var O;if(typeof w=="function")O=function(){w(M)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,L=B.port2;B.port1.onmessage=M,O=function(){L.postMessage(null)}}else O=function(){y(M,0)};function U(){_||(_=!0,O())}function P(F,N){C=y(function(){F(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,U())},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(F){switch(f){case 1:case 2:case 3:var N=3;break;default:N=f}var T=f;f=N;try{return F()}finally{f=T}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,N){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var T=f;f=F;try{return N()}finally{f=T}},e.unstable_scheduleCallback=function(F,N,T){var S=e.unstable_now();switch(typeof T=="object"&&T!==null?(T=T.delay,T=typeof T=="number"&&0<T?S+T:S):T=S,F){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=T+z,F={id:x++,callback:N,priorityLevel:F,startTime:T,expirationTime:z,sortIndex:-1},T>S?(F.sortIndex=T,t(d,F),r(c)===null&&F===r(d)&&(g?(v(C),C=-1):g=!0,P(b,T-S))):(F.sortIndex=z,t(c,F),p||h||(p=!0,U())),F},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(F){var N=f;return function(){var T=f;f=N;try{return F.apply(this,arguments)}finally{f=T}}}})(v6);p6.exports=v6;var F7=p6.exports,b6={exports:{}},Ls={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T7=E;function y6(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function yi(){}var Bs={d:{f:yi,r:function(){throw Error(y6(522))},D:yi,C:yi,L:yi,m:yi,X:yi,S:yi,M:yi},p:0,findDOMNode:null},M7=Symbol.for("react.portal");function R7(e,t,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M7,key:a==null?null:""+a,children:e,containerInfo:t,implementation:r}}var Z0=T7.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Dh(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}Ls.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Bs;Ls.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(y6(299));return R7(e,t,null,r)};Ls.flushSync=function(e){var t=Z0.T,r=Bs.p;try{if(Z0.T=null,Bs.p=2,e)return e()}finally{Z0.T=t,Bs.p=r,Bs.d.f()}};Ls.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,Bs.d.C(e,t))};Ls.prefetchDNS=function(e){typeof e=="string"&&Bs.d.D(e)};Ls.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var r=t.as,a=Dh(r,t.crossOrigin),n=typeof t.integrity=="string"?t.integrity:void 0,i=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;r==="style"?Bs.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:a,integrity:n,fetchPriority:i}):r==="script"&&Bs.d.X(e,{crossOrigin:a,integrity:n,fetchPriority:i,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};Ls.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var r=Dh(t.as,t.crossOrigin);Bs.d.M(e,{crossOrigin:r,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&Bs.d.M(e)};Ls.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var r=t.as,a=Dh(r,t.crossOrigin);Bs.d.L(e,r,{crossOrigin:a,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};Ls.preloadModule=function(e,t){if(typeof e=="string")if(t){var r=Dh(t.as,t.crossOrigin);Bs.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:r,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else Bs.d.m(e)};Ls.requestFormReset=function(e){Bs.d.r(e)};Ls.unstable_batchedUpdates=function(e,t){return e(t)};Ls.useFormState=function(e,t,r){return Z0.H.useFormState(e,t,r)};Ls.useFormStatus=function(){return Z0.H.useHostTransitionStatus()};Ls.version="19.0.0";function w6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(w6)}catch(e){console.error(e)}}w6(),b6.exports=Ls;var Ml=b6.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ur=F7,E6=E,O7=Ml;function Se(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function _6(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}var P7=Symbol.for("react.element"),ou=Symbol.for("react.transitional.element"),q0=Symbol.for("react.portal"),ec=Symbol.for("react.fragment"),j6=Symbol.for("react.strict_mode"),op=Symbol.for("react.profiler"),L7=Symbol.for("react.provider"),N6=Symbol.for("react.consumer"),Kn=Symbol.for("react.context"),uv=Symbol.for("react.forward_ref"),cp=Symbol.for("react.suspense"),dp=Symbol.for("react.suspense_list"),fv=Symbol.for("react.memo"),ki=Symbol.for("react.lazy"),C6=Symbol.for("react.offscreen"),I7=Symbol.for("react.memo_cache_sentinel"),a2=Symbol.iterator;function A0(e){return e===null||typeof e!="object"?null:(e=a2&&e[a2]||e["@@iterator"],typeof e=="function"?e:null)}var U7=Symbol.for("react.client.reference");function xp(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===U7?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ec:return"Fragment";case q0:return"Portal";case op:return"Profiler";case j6:return"StrictMode";case cp:return"Suspense";case dp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Kn:return(e.displayName||"Context")+".Provider";case N6:return(e._context.displayName||"Context")+".Consumer";case uv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case fv:return t=e.displayName||null,t!==null?t:xp(e.type)||"Memo";case ki:t=e._payload,e=e._init;try{return xp(e(t))}catch{}}return null}var ot=E6.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Gt=Object.assign,Cm,n2;function V0(e){if(Cm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Cm=t&&t[1]||"",n2=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cm+e+n2}var Am=!1;function km(e,t){if(!e||Am)return"";Am=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var u=function(){throw Error()};if(Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(h){var f=h}Reflect.construct(e,[],u)}else{try{u.call()}catch(h){f=h}e.call(u.prototype)}}else{try{throw Error()}catch(h){f=h}(u=e())&&typeof u.catch=="function"&&u.catch(function(){})}}catch(h){if(h&&f&&typeof h.stack=="string")return[h.stack,f.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=a.DetermineComponentFrameRoot(),l=i[0],o=i[1];if(l&&o){var c=l.split(`
`),d=o.split(`
`);for(n=a=0;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;for(;n<d.length&&!d[n].includes("DetermineComponentFrameRoot");)n++;if(a===c.length||n===d.length)for(a=c.length-1,n=d.length-1;1<=a&&0<=n&&c[a]!==d[n];)n--;for(;1<=a&&0<=n;a--,n--)if(c[a]!==d[n]){if(a!==1||n!==1)do if(a--,n--,0>n||c[a]!==d[n]){var x=`
`+c[a].replace(" at new "," at ");return e.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",e.displayName)),x}while(1<=a&&0<=n);break}}}finally{Am=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?V0(r):""}function $7(e){switch(e.tag){case 26:case 27:case 5:return V0(e.type);case 16:return V0("Lazy");case 13:return V0("Suspense");case 19:return V0("SuspenseList");case 0:case 15:return e=km(e.type,!1),e;case 11:return e=km(e.type.render,!1),e;case 1:return e=km(e.type,!0),e;default:return""}}function i2(e){try{var t="";do t+=$7(e),e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function n0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function A6(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function l2(e){if(n0(e)!==e)throw Error(Se(188))}function z7(e){var t=e.alternate;if(!t){if(t=n0(e),t===null)throw Error(Se(188));return t!==e?null:e}for(var r=e,a=t;;){var n=r.return;if(n===null)break;var i=n.alternate;if(i===null){if(a=n.return,a!==null){r=a;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===r)return l2(n),e;if(i===a)return l2(n),t;i=i.sibling}throw Error(Se(188))}if(r.return!==a.return)r=n,a=i;else{for(var l=!1,o=n.child;o;){if(o===r){l=!0,r=n,a=i;break}if(o===a){l=!0,a=n,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,a=n;break}if(o===a){l=!0,a=i,r=n;break}o=o.sibling}if(!l)throw Error(Se(189))}}if(r.alternate!==a)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?e:t}function k6(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=k6(e),t!==null)return t;e=e.sibling}return null}var H0=Array.isArray,Vt=O7.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ul={pending:!1,data:null,method:null,action:null},up=[],tc=-1;function Tn(e){return{current:e}}function Jr(e){0>tc||(e.current=up[tc],up[tc]=null,tc--)}function Xt(e,t){tc++,up[tc]=e.current,e.current=t}var wn=Tn(null),Pd=Tn(null),zi=Tn(null),pf=Tn(null);function vf(e,t){switch(Xt(zi,t),Xt(Pd,e),Xt(wn,null),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?ow(t):0;break;default:if(e=e===8?t.parentNode:t,t=e.tagName,e=e.namespaceURI)e=ow(e),t=U9(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Jr(wn),Xt(wn,t)}function Tc(){Jr(wn),Jr(Pd),Jr(zi)}function fp(e){e.memoizedState!==null&&Xt(pf,e);var t=wn.current,r=U9(t,e.type);t!==r&&(Xt(Pd,e),Xt(wn,r))}function bf(e){Pd.current===e&&(Jr(wn),Jr(Pd)),pf.current===e&&(Jr(pf),Yd._currentValue=Ul)}var hp=Object.prototype.hasOwnProperty,hv=Ur.unstable_scheduleCallback,Dm=Ur.unstable_cancelCallback,q7=Ur.unstable_shouldYield,V7=Ur.unstable_requestPaint,En=Ur.unstable_now,H7=Ur.unstable_getCurrentPriorityLevel,D6=Ur.unstable_ImmediatePriority,S6=Ur.unstable_UserBlockingPriority,yf=Ur.unstable_NormalPriority,W7=Ur.unstable_LowPriority,B6=Ur.unstable_IdlePriority,G7=Ur.log,Y7=Ur.unstable_setDisableYieldValue,Dx=null,na=null;function X7(e){if(na&&typeof na.onCommitFiberRoot=="function")try{na.onCommitFiberRoot(Dx,e,void 0,(e.current.flags&128)===128)}catch{}}function Oi(e){if(typeof G7=="function"&&Y7(e),na&&typeof na.setStrictMode=="function")try{na.setStrictMode(Dx,e)}catch{}}var ia=Math.clz32?Math.clz32:J7,K7=Math.log,Q7=Math.LN2;function J7(e){return e>>>=0,e===0?32:31-(K7(e)/Q7|0)|0}var cu=128,du=4194304;function Cl(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Sh(e,t){var r=e.pendingLanes;if(r===0)return 0;var a=0,n=e.suspendedLanes,i=e.pingedLanes,l=e.warmLanes;e=e.finishedLanes!==0;var o=r&134217727;return o!==0?(r=o&~n,r!==0?a=Cl(r):(i&=o,i!==0?a=Cl(i):e||(l=o&~l,l!==0&&(a=Cl(l))))):(o=r&~n,o!==0?a=Cl(o):i!==0?a=Cl(i):e||(l=r&~l,l!==0&&(a=Cl(l)))),a===0?0:t!==0&&t!==a&&!(t&n)&&(n=a&-a,l=t&-t,n>=l||n===32&&(l&4194176)!==0)?t:a}function Sx(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Z7(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F6(){var e=cu;return cu<<=1,!(cu&4194176)&&(cu=128),e}function T6(){var e=du;return du<<=1,!(du&62914560)&&(du=4194304),e}function Sm(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Bx(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ek(e,t,r,a,n,i){var l=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var o=e.entanglements,c=e.expirationTimes,d=e.hiddenUpdates;for(r=l&~r;0<r;){var x=31-ia(r),u=1<<x;o[x]=0,c[x]=-1;var f=d[x];if(f!==null)for(d[x]=null,x=0;x<f.length;x++){var h=f[x];h!==null&&(h.lane&=-536870913)}r&=~u}a!==0&&M6(e,a,0),i!==0&&n===0&&e.tag!==0&&(e.suspendedLanes|=i&~(l&~t))}function M6(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-ia(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|r&4194218}function R6(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-ia(r),n=1<<a;n&t|e[a]&t&&(e[a]|=t),r&=~n}}function O6(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function P6(){var e=Vt.p;return e!==0?e:(e=window.event,e===void 0?32:K9(e.type))}function tk(e,t){var r=Vt.p;try{return Vt.p=e,t()}finally{Vt.p=r}}var cl=Math.random().toString(36).slice(2),vs="__reactFiber$"+cl,Gs="__reactProps$"+cl,i0="__reactContainer$"+cl,mp="__reactEvents$"+cl,rk="__reactListeners$"+cl,sk="__reactHandles$"+cl,o2="__reactResources$"+cl,Ld="__reactMarker$"+cl;function mv(e){delete e[vs],delete e[Gs],delete e[mp],delete e[rk],delete e[sk]}function Rl(e){var t=e[vs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[i0]||r[vs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=dw(e);e!==null;){if(r=e[vs])return r;e=dw(e)}return t}e=r,r=e.parentNode}return null}function l0(e){if(e=e[vs]||e[i0]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function W0(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(Se(33))}function vc(e){var t=e[o2];return t||(t=e[o2]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Yr(e){e[Ld]=!0}var L6=new Set,I6={};function yo(e,t){Mc(e,t),Mc(e+"Capture",t)}function Mc(e,t){for(I6[e]=t,e=0;e<t.length;e++)L6.add(t[e])}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ak=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),c2={},d2={};function nk(e){return hp.call(d2,e)?!0:hp.call(c2,e)?!1:ak.test(e)?d2[e]=!0:(c2[e]=!0,!1)}function Zu(e,t,r){if(nk(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function xu(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function In(e,t,r,a){if(a===null)e.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+a)}}function ja(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function U6(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ik(e){var t=U6(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(l){a=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(l){a=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wf(e){e._valueTracker||(e._valueTracker=ik(e))}function $6(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=U6(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function Ef(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var lk=/[\n"\\]/g;function ka(e){return e.replace(lk,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function gp(e,t,r,a,n,i,l,o){e.name="",l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"?e.type=l:e.removeAttribute("type"),t!=null?l==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+ja(t)):e.value!==""+ja(t)&&(e.value=""+ja(t)):l!=="submit"&&l!=="reset"||e.removeAttribute("value"),t!=null?pp(e,l,ja(t)):r!=null?pp(e,l,ja(r)):a!=null&&e.removeAttribute("value"),n==null&&i!=null&&(e.defaultChecked=!!i),n!=null&&(e.checked=n&&typeof n!="function"&&typeof n!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.name=""+ja(o):e.removeAttribute("name")}function z6(e,t,r,a,n,i,l,o){if(i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"&&(e.type=i),t!=null||r!=null){if(!(i!=="submit"&&i!=="reset"||t!=null))return;r=r!=null?""+ja(r):"",t=t!=null?""+ja(t):r,o||t===e.value||(e.value=t),e.defaultValue=t}a=a??n,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=o?e.checked:!!a,e.defaultChecked=!!a,l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"&&(e.name=l)}function pp(e,t,r){t==="number"&&Ef(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function bc(e,t,r,a){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&a&&(e[r].defaultSelected=!0)}else{for(r=""+ja(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,a&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function q6(e,t,r){if(t!=null&&(t=""+ja(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+ja(r):""}function V6(e,t,r,a){if(t==null){if(a!=null){if(r!=null)throw Error(Se(92));if(H0(a)){if(1<a.length)throw Error(Se(93));a=a[0]}r=a}r==null&&(r=""),t=r}r=ja(t),e.defaultValue=r,a=e.textContent,a===r&&a!==""&&a!==null&&(e.value=a)}function Rc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ok=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function x2(e,t,r){var a=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,r):typeof r!="number"||r===0||ok.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function H6(e,t,r){if(t!=null&&typeof t!="object")throw Error(Se(62));if(e=e.style,r!=null){for(var a in r)!r.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var n in t)a=t[n],t.hasOwnProperty(n)&&r[n]!==a&&x2(e,n,a)}else for(var i in t)t.hasOwnProperty(i)&&x2(e,i,t[i])}function gv(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ck=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dk=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ef(e){return dk.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var vp=null;function pv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rc=null,yc=null;function u2(e){var t=l0(e);if(t&&(e=t.stateNode)){var r=e[Gs]||null;e:switch(e=t.stateNode,t.type){case"input":if(gp(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+ka(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var n=a[Gs]||null;if(!n)throw Error(Se(90));gp(a,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<r.length;t++)a=r[t],a.form===e.form&&$6(a)}break e;case"textarea":q6(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&bc(e,!!r.multiple,t,!1)}}}var Bm=!1;function W6(e,t,r){if(Bm)return e(t,r);Bm=!0;try{var a=e(t);return a}finally{if(Bm=!1,(rc!==null||yc!==null)&&(Uh(),rc&&(t=rc,e=yc,yc=rc=null,u2(t),e)))for(t=0;t<e.length;t++)u2(e[t])}}function Id(e,t){var r=e.stateNode;if(r===null)return null;var a=r[Gs]||null;if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Se(231,t,typeof r));return r}var bp=!1;if(ii)try{var k0={};Object.defineProperty(k0,"passive",{get:function(){bp=!0}}),window.addEventListener("test",k0,k0),window.removeEventListener("test",k0,k0)}catch{bp=!1}var Pi=null,vv=null,tf=null;function G6(){if(tf)return tf;var e,t=vv,r=t.length,a,n="value"in Pi?Pi.value:Pi.textContent,i=n.length;for(e=0;e<r&&t[e]===n[e];e++);var l=r-e;for(a=1;a<=l&&t[r-a]===n[i-a];a++);return tf=n.slice(e,1<a?1-a:void 0)}function rf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function uu(){return!0}function f2(){return!1}function Xs(e){function t(r,a,n,i,l){this._reactName=r,this._targetInst=n,this.type=a,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?uu:f2,this.isPropagationStopped=f2,this}return Gt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=uu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=uu)},persist:function(){},isPersistent:uu}),t}var wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bh=Xs(wo),Fx=Gt({},wo,{view:0,detail:0}),xk=Xs(Fx),Fm,Tm,D0,Fh=Gt({},Fx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==D0&&(D0&&e.type==="mousemove"?(Fm=e.screenX-D0.screenX,Tm=e.screenY-D0.screenY):Tm=Fm=0,D0=e),Fm)},movementY:function(e){return"movementY"in e?e.movementY:Tm}}),h2=Xs(Fh),uk=Gt({},Fh,{dataTransfer:0}),fk=Xs(uk),hk=Gt({},Fx,{relatedTarget:0}),Mm=Xs(hk),mk=Gt({},wo,{animationName:0,elapsedTime:0,pseudoElement:0}),gk=Xs(mk),pk=Gt({},wo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vk=Xs(pk),bk=Gt({},wo,{data:0}),m2=Xs(bk),yk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ek={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _k(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ek[e])?!!t[e]:!1}function bv(){return _k}var jk=Gt({},Fx,{key:function(e){if(e.key){var t=yk[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=rf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?wk[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bv,charCode:function(e){return e.type==="keypress"?rf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?rf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nk=Xs(jk),Ck=Gt({},Fh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),g2=Xs(Ck),Ak=Gt({},Fx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bv}),kk=Xs(Ak),Dk=Gt({},wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sk=Xs(Dk),Bk=Gt({},Fh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fk=Xs(Bk),Tk=Gt({},wo,{newState:0,oldState:0}),Mk=Xs(Tk),Rk=[9,13,27,32],yv=ii&&"CompositionEvent"in window,ed=null;ii&&"documentMode"in document&&(ed=document.documentMode);var Ok=ii&&"TextEvent"in window&&!ed,Y6=ii&&(!yv||ed&&8<ed&&11>=ed),p2=" ",v2=!1;function X6(e,t){switch(e){case"keyup":return Rk.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function K6(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sc=!1;function Pk(e,t){switch(e){case"compositionend":return K6(t);case"keypress":return t.which!==32?null:(v2=!0,p2);case"textInput":return e=t.data,e===p2&&v2?null:e;default:return null}}function Lk(e,t){if(sc)return e==="compositionend"||!yv&&X6(e,t)?(e=G6(),tf=vv=Pi=null,sc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Y6&&t.locale!=="ko"?null:t.data;default:return null}}var Ik={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function b2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ik[e.type]:t==="textarea"}function Q6(e,t,r,a){rc?yc?yc.push(a):yc=[a]:rc=a,t=Lf(t,"onChange"),0<t.length&&(r=new Bh("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var td=null,Ud=null;function Uk(e){P9(e,0)}function Th(e){var t=W0(e);if($6(t))return e}function y2(e,t){if(e==="change")return t}var J6=!1;if(ii){var Rm;if(ii){var Om="oninput"in document;if(!Om){var w2=document.createElement("div");w2.setAttribute("oninput","return;"),Om=typeof w2.oninput=="function"}Rm=Om}else Rm=!1;J6=Rm&&(!document.documentMode||9<document.documentMode)}function E2(){td&&(td.detachEvent("onpropertychange",Z6),Ud=td=null)}function Z6(e){if(e.propertyName==="value"&&Th(Ud)){var t=[];Q6(t,Ud,e,pv(e)),W6(Uk,t)}}function $k(e,t,r){e==="focusin"?(E2(),td=t,Ud=r,td.attachEvent("onpropertychange",Z6)):e==="focusout"&&E2()}function zk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Th(Ud)}function qk(e,t){if(e==="click")return Th(t)}function Vk(e,t){if(e==="input"||e==="change")return Th(t)}function Hk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var oa=typeof Object.is=="function"?Object.is:Hk;function $d(e,t){if(oa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var n=r[a];if(!hp.call(t,n)||!oa(e[n],t[n]))return!1}return!0}function _2(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function j2(e,t){var r=_2(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_2(r)}}function eE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?eE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function tE(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Ef(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ef(e.document)}return t}function wv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Wk(e,t){var r=tE(t);t=e.focusedElem;var a=e.selectionRange;if(r!==t&&t&&t.ownerDocument&&eE(t.ownerDocument.documentElement,t)){if(a!==null&&wv(t)){if(e=a.start,r=a.end,r===void 0&&(r=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(r,t.value.length);else if(r=(e=t.ownerDocument||document)&&e.defaultView||window,r.getSelection){r=r.getSelection();var n=t.textContent.length,i=Math.min(a.start,n);a=a.end===void 0?i:Math.min(a.end,n),!r.extend&&i>a&&(n=a,a=i,i=n),n=j2(t,i);var l=j2(t,a);n&&l&&(r.rangeCount!==1||r.anchorNode!==n.node||r.anchorOffset!==n.offset||r.focusNode!==l.node||r.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),r.removeAllRanges(),i>a?(r.addRange(e),r.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),r.addRange(e)))}}for(e=[],r=t;r=r.parentNode;)r.nodeType===1&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)r=e[t],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Gk=ii&&"documentMode"in document&&11>=document.documentMode,ac=null,yp=null,rd=null,wp=!1;function N2(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;wp||ac==null||ac!==Ef(a)||(a=ac,"selectionStart"in a&&wv(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),rd&&$d(rd,a)||(rd=a,a=Lf(yp,"onSelect"),0<a.length&&(t=new Bh("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=ac)))}function bl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var nc={animationend:bl("Animation","AnimationEnd"),animationiteration:bl("Animation","AnimationIteration"),animationstart:bl("Animation","AnimationStart"),transitionrun:bl("Transition","TransitionRun"),transitionstart:bl("Transition","TransitionStart"),transitioncancel:bl("Transition","TransitionCancel"),transitionend:bl("Transition","TransitionEnd")},Pm={},rE={};ii&&(rE=document.createElement("div").style,"AnimationEvent"in window||(delete nc.animationend.animation,delete nc.animationiteration.animation,delete nc.animationstart.animation),"TransitionEvent"in window||delete nc.transitionend.transition);function Eo(e){if(Pm[e])return Pm[e];if(!nc[e])return e;var t=nc[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in rE)return Pm[e]=t[r];return e}var sE=Eo("animationend"),aE=Eo("animationiteration"),nE=Eo("animationstart"),Yk=Eo("transitionrun"),Xk=Eo("transitionstart"),Kk=Eo("transitioncancel"),iE=Eo("transitionend"),lE=new Map,C2="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function ln(e,t){lE.set(e,t),yo(t,[e])}var wa=[],ic=0,Ev=0;function Mh(){for(var e=ic,t=Ev=ic=0;t<e;){var r=wa[t];wa[t++]=null;var a=wa[t];wa[t++]=null;var n=wa[t];wa[t++]=null;var i=wa[t];if(wa[t++]=null,a!==null&&n!==null){var l=a.pending;l===null?n.next=n:(n.next=l.next,l.next=n),a.pending=n}i!==0&&oE(r,n,i)}}function Rh(e,t,r,a){wa[ic++]=e,wa[ic++]=t,wa[ic++]=r,wa[ic++]=a,Ev|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function _v(e,t,r,a){return Rh(e,t,r,a),_f(e)}function Ki(e,t){return Rh(e,null,null,t),_f(e)}function oE(e,t,r){e.lanes|=r;var a=e.alternate;a!==null&&(a.lanes|=r);for(var n=!1,i=e.return;i!==null;)i.childLanes|=r,a=i.alternate,a!==null&&(a.childLanes|=r),i.tag===22&&(e=i.stateNode,e===null||e._visibility&1||(n=!0)),e=i,i=i.return;n&&t!==null&&e.tag===3&&(i=e.stateNode,n=31-ia(r),i=i.hiddenUpdates,e=i[n],e===null?i[n]=[t]:e.push(t),t.lane=r|536870912)}function _f(e){if(50<hd)throw hd=0,qp=null,Error(Se(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var lc={},A2=new WeakMap;function Da(e,t){if(typeof e=="object"&&e!==null){var r=A2.get(e);return r!==void 0?r:(t={value:e,source:t,stack:i2(t)},A2.set(e,t),t)}return{value:e,source:t,stack:i2(t)}}var oc=[],cc=0,jf=null,Nf=0,Na=[],Ca=0,$l=null,Qn=1,Jn="";function Al(e,t){oc[cc++]=Nf,oc[cc++]=jf,jf=e,Nf=t}function cE(e,t,r){Na[Ca++]=Qn,Na[Ca++]=Jn,Na[Ca++]=$l,$l=e;var a=Qn;e=Jn;var n=32-ia(a)-1;a&=~(1<<n),r+=1;var i=32-ia(t)+n;if(30<i){var l=n-n%5;i=(a&(1<<l)-1).toString(32),a>>=l,n-=l,Qn=1<<32-ia(t)+n|r<<n|a,Jn=i+e}else Qn=1<<i|r<<n|a,Jn=e}function jv(e){e.return!==null&&(Al(e,1),cE(e,1,0))}function Nv(e){for(;e===jf;)jf=oc[--cc],oc[cc]=null,Nf=oc[--cc],oc[cc]=null;for(;e===$l;)$l=Na[--Ca],Na[Ca]=null,Jn=Na[--Ca],Na[Ca]=null,Qn=Na[--Ca],Na[Ca]=null}var Ss=null,ls=null,At=!1,Ya=null,gn=!1,Ep=Error(Se(519));function to(e){var t=Error(Se(418,""));throw zd(Da(t,e)),Ep}function k2(e){var t=e.stateNode,r=e.type,a=e.memoizedProps;switch(t[vs]=e,t[Gs]=a,r){case"dialog":bt("cancel",t),bt("close",t);break;case"iframe":case"object":case"embed":bt("load",t);break;case"video":case"audio":for(r=0;r<Hd.length;r++)bt(Hd[r],t);break;case"source":bt("error",t);break;case"img":case"image":case"link":bt("error",t),bt("load",t);break;case"details":bt("toggle",t);break;case"input":bt("invalid",t),z6(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),wf(t);break;case"select":bt("invalid",t);break;case"textarea":bt("invalid",t),V6(t,a.value,a.defaultValue,a.children),wf(t)}r=a.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||a.suppressHydrationWarning===!0||I9(t.textContent,r)?(a.popover!=null&&(bt("beforetoggle",t),bt("toggle",t)),a.onScroll!=null&&bt("scroll",t),a.onScrollEnd!=null&&bt("scrollend",t),a.onClick!=null&&(t.onclick=zh),t=!0):t=!1,t||to(e)}function D2(e){for(Ss=e.return;Ss;)switch(Ss.tag){case 3:case 27:gn=!0;return;case 5:case 13:gn=!1;return;default:Ss=Ss.return}}function S0(e){if(e!==Ss)return!1;if(!At)return D2(e),At=!0,!1;var t=!1,r;if((r=e.tag!==3&&e.tag!==27)&&((r=e.tag===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Kp(e.type,e.memoizedProps)),r=!r),r&&(t=!0),t&&ls&&to(e),D2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(r=e.data,r==="/$"){if(t===0){ls=Za(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++;e=e.nextSibling}ls=null}}else ls=Ss?Za(e.stateNode.nextSibling):null;return!0}function Tx(){ls=Ss=null,At=!1}function zd(e){Ya===null?Ya=[e]:Ya.push(e)}var sd=Error(Se(460)),dE=Error(Se(474)),_p={then:function(){}};function S2(e){return e=e.status,e==="fulfilled"||e==="rejected"}function fu(){}function xE(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(fu,fu),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===sd?Error(Se(483)):e;default:if(typeof t.status=="string")t.then(fu,fu);else{if(e=Ut,e!==null&&100<e.shellSuspendCounter)throw Error(Se(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var n=t;n.status="fulfilled",n.value=a}},function(a){if(t.status==="pending"){var n=t;n.status="rejected",n.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===sd?Error(Se(483)):e}throw ad=t,sd}}var ad=null;function B2(){if(ad===null)throw Error(Se(459));var e=ad;return ad=null,e}var wc=null,qd=0;function hu(e){var t=qd;return qd+=1,wc===null&&(wc=[]),xE(wc,e,t)}function B0(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function mu(e,t){throw t.$$typeof===P7?Error(Se(525)):(e=Object.prototype.toString.call(t),Error(Se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function F2(e){var t=e._init;return t(e._payload)}function uE(e){function t(v,w){if(e){var m=v.deletions;m===null?(v.deletions=[w],v.flags|=16):m.push(w)}}function r(v,w){if(!e)return null;for(;w!==null;)t(v,w),w=w.sibling;return null}function a(v){for(var w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function n(v,w){return v=Hi(v,w),v.index=0,v.sibling=null,v}function i(v,w,m){return v.index=m,e?(m=v.alternate,m!==null?(m=m.index,m<w?(v.flags|=33554434,w):m):(v.flags|=33554434,w)):(v.flags|=1048576,w)}function l(v){return e&&v.alternate===null&&(v.flags|=33554434),v}function o(v,w,m,b){return w===null||w.tag!==6?(w=Xm(m,v.mode,b),w.return=v,w):(w=n(w,m),w.return=v,w)}function c(v,w,m,b){var _=m.type;return _===ec?x(v,w,m.props.children,b,m.key):w!==null&&(w.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ki&&F2(_)===w.type)?(w=n(w,m.props),B0(w,m),w.return=v,w):(w=of(m.type,m.key,m.props,null,v.mode,b),B0(w,m),w.return=v,w)}function d(v,w,m,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==m.containerInfo||w.stateNode.implementation!==m.implementation?(w=Km(m,v.mode,b),w.return=v,w):(w=n(w,m.children||[]),w.return=v,w)}function x(v,w,m,b,_){return w===null||w.tag!==7?(w=ql(m,v.mode,b,_),w.return=v,w):(w=n(w,m),w.return=v,w)}function u(v,w,m){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return w=Xm(""+w,v.mode,m),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ou:return m=of(w.type,w.key,w.props,null,v.mode,m),B0(m,w),m.return=v,m;case q0:return w=Km(w,v.mode,m),w.return=v,w;case ki:var b=w._init;return w=b(w._payload),u(v,w,m)}if(H0(w)||A0(w))return w=ql(w,v.mode,m,null),w.return=v,w;if(typeof w.then=="function")return u(v,hu(w),m);if(w.$$typeof===Kn)return u(v,gu(v,w),m);mu(v,w)}return null}function f(v,w,m,b){var _=w!==null?w.key:null;if(typeof m=="string"&&m!==""||typeof m=="number"||typeof m=="bigint")return _!==null?null:o(v,w,""+m,b);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ou:return m.key===_?c(v,w,m,b):null;case q0:return m.key===_?d(v,w,m,b):null;case ki:return _=m._init,m=_(m._payload),f(v,w,m,b)}if(H0(m)||A0(m))return _!==null?null:x(v,w,m,b,null);if(typeof m.then=="function")return f(v,w,hu(m),b);if(m.$$typeof===Kn)return f(v,w,gu(v,m),b);mu(v,m)}return null}function h(v,w,m,b,_){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return v=v.get(m)||null,o(w,v,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ou:return v=v.get(b.key===null?m:b.key)||null,c(w,v,b,_);case q0:return v=v.get(b.key===null?m:b.key)||null,d(w,v,b,_);case ki:var C=b._init;return b=C(b._payload),h(v,w,m,b,_)}if(H0(b)||A0(b))return v=v.get(m)||null,x(w,v,b,_,null);if(typeof b.then=="function")return h(v,w,m,hu(b),_);if(b.$$typeof===Kn)return h(v,w,m,gu(w,b),_);mu(w,b)}return null}function p(v,w,m,b){for(var _=null,C=null,j=w,D=w=0,R=null;j!==null&&D<m.length;D++){j.index>D?(R=j,j=null):R=j.sibling;var M=f(v,j,m[D],b);if(M===null){j===null&&(j=R);break}e&&j&&M.alternate===null&&t(v,j),w=i(M,w,D),C===null?_=M:C.sibling=M,C=M,j=R}if(D===m.length)return r(v,j),At&&Al(v,D),_;if(j===null){for(;D<m.length;D++)j=u(v,m[D],b),j!==null&&(w=i(j,w,D),C===null?_=j:C.sibling=j,C=j);return At&&Al(v,D),_}for(j=a(j);D<m.length;D++)R=h(j,v,D,m[D],b),R!==null&&(e&&R.alternate!==null&&j.delete(R.key===null?D:R.key),w=i(R,w,D),C===null?_=R:C.sibling=R,C=R);return e&&j.forEach(function(O){return t(v,O)}),At&&Al(v,D),_}function g(v,w,m,b){if(m==null)throw Error(Se(151));for(var _=null,C=null,j=w,D=w=0,R=null,M=m.next();j!==null&&!M.done;D++,M=m.next()){j.index>D?(R=j,j=null):R=j.sibling;var O=f(v,j,M.value,b);if(O===null){j===null&&(j=R);break}e&&j&&O.alternate===null&&t(v,j),w=i(O,w,D),C===null?_=O:C.sibling=O,C=O,j=R}if(M.done)return r(v,j),At&&Al(v,D),_;if(j===null){for(;!M.done;D++,M=m.next())M=u(v,M.value,b),M!==null&&(w=i(M,w,D),C===null?_=M:C.sibling=M,C=M);return At&&Al(v,D),_}for(j=a(j);!M.done;D++,M=m.next())M=h(j,v,D,M.value,b),M!==null&&(e&&M.alternate!==null&&j.delete(M.key===null?D:M.key),w=i(M,w,D),C===null?_=M:C.sibling=M,C=M);return e&&j.forEach(function(B){return t(v,B)}),At&&Al(v,D),_}function y(v,w,m,b){if(typeof m=="object"&&m!==null&&m.type===ec&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case ou:e:{for(var _=m.key;w!==null;){if(w.key===_){if(_=m.type,_===ec){if(w.tag===7){r(v,w.sibling),b=n(w,m.props.children),b.return=v,v=b;break e}}else if(w.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ki&&F2(_)===w.type){r(v,w.sibling),b=n(w,m.props),B0(b,m),b.return=v,v=b;break e}r(v,w);break}else t(v,w);w=w.sibling}m.type===ec?(b=ql(m.props.children,v.mode,b,m.key),b.return=v,v=b):(b=of(m.type,m.key,m.props,null,v.mode,b),B0(b,m),b.return=v,v=b)}return l(v);case q0:e:{for(_=m.key;w!==null;){if(w.key===_)if(w.tag===4&&w.stateNode.containerInfo===m.containerInfo&&w.stateNode.implementation===m.implementation){r(v,w.sibling),b=n(w,m.children||[]),b.return=v,v=b;break e}else{r(v,w);break}else t(v,w);w=w.sibling}b=Km(m,v.mode,b),b.return=v,v=b}return l(v);case ki:return _=m._init,m=_(m._payload),y(v,w,m,b)}if(H0(m))return p(v,w,m,b);if(A0(m)){if(_=A0(m),typeof _!="function")throw Error(Se(150));return m=_.call(m),g(v,w,m,b)}if(typeof m.then=="function")return y(v,w,hu(m),b);if(m.$$typeof===Kn)return y(v,w,gu(v,m),b);mu(v,m)}return typeof m=="string"&&m!==""||typeof m=="number"||typeof m=="bigint"?(m=""+m,w!==null&&w.tag===6?(r(v,w.sibling),b=n(w,m),b.return=v,v=b):(r(v,w),b=Xm(m,v.mode,b),b.return=v,v=b),l(v)):r(v,w)}return function(v,w,m,b){try{qd=0;var _=y(v,w,m,b);return wc=null,_}catch(j){if(j===sd)throw j;var C=Sa(29,j,null,v.mode);return C.lanes=b,C.return=v,C}finally{}}}var ro=uE(!0),fE=uE(!1),Oc=Tn(null),Cf=Tn(0);function T2(e,t){e=ci,Xt(Cf,e),Xt(Oc,t),ci=e|t.baseLanes}function jp(){Xt(Cf,ci),Xt(Oc,Oc.current)}function Cv(){ci=Cf.current,Jr(Oc),Jr(Cf)}var Ra=Tn(null),_n=null;function Bi(e){var t=e.alternate;Xt(Pr,Pr.current&1),Xt(Ra,e),_n===null&&(t===null||Oc.current!==null||t.memoizedState!==null)&&(_n=e)}function hE(e){if(e.tag===22){if(Xt(Pr,Pr.current),Xt(Ra,e),_n===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(_n=e)}}else Fi()}function Fi(){Xt(Pr,Pr.current),Xt(Ra,Ra.current)}function Zn(e){Jr(Ra),_n===e&&(_n=null),Jr(Pr)}var Pr=Tn(0);function Af(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qk=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},Jk=Ur.unstable_scheduleCallback,Zk=Ur.unstable_NormalPriority,Rr={$$typeof:Kn,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Av(){return{controller:new Qk,data:new Map,refCount:0}}function Mx(e){e.refCount--,e.refCount===0&&Jk(Zk,function(){e.controller.abort()})}var nd=null,Np=0,Pc=0,Ec=null;function eD(e,t){if(nd===null){var r=nd=[];Np=0,Pc=Kv(),Ec={status:"pending",value:void 0,then:function(a){r.push(a)}}}return Np++,t.then(M2,M2),t}function M2(){if(--Np===0&&nd!==null){Ec!==null&&(Ec.status="fulfilled");var e=nd;nd=null,Pc=0,Ec=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function tD(e,t){var r=[],a={status:"pending",value:null,reason:null,then:function(n){r.push(n)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var n=0;n<r.length;n++)(0,r[n])(t)},function(n){for(a.status="rejected",a.reason=n,n=0;n<r.length;n++)(0,r[n])(void 0)}),a}var R2=ot.S;ot.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&eD(e,t),R2!==null&&R2(e,t)};var zl=Tn(null);function kv(){var e=zl.current;return e!==null?e:Ut.pooledCache}function sf(e,t){t===null?Xt(zl,zl.current):Xt(zl,t.pool)}function mE(){var e=kv();return e===null?null:{parent:Rr._currentValue,pool:e}}var Qi=0,ut=null,Mt=null,Br=null,kf=!1,_c=!1,so=!1,Df=0,Vd=0,jc=null,rD=0;function yr(){throw Error(Se(321))}function Dv(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!oa(e[r],t[r]))return!1;return!0}function Sv(e,t,r,a,n,i){return Qi=i,ut=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ot.H=e===null||e.memoizedState===null?_o:dl,so=!1,i=r(a,n),so=!1,_c&&(i=pE(t,r,a,n)),gE(e),i}function gE(e){ot.H=An;var t=Mt!==null&&Mt.next!==null;if(Qi=0,Br=Mt=ut=null,kf=!1,Vd=0,jc=null,t)throw Error(Se(300));e===null||Kr||(e=e.dependencies,e!==null&&Ff(e)&&(Kr=!0))}function pE(e,t,r,a){ut=e;var n=0;do{if(_c&&(jc=null),Vd=0,_c=!1,25<=n)throw Error(Se(301));if(n+=1,Br=Mt=null,e.updateQueue!=null){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,i.memoCache!=null&&(i.memoCache.index=0)}ot.H=jo,i=t(r,a)}while(_c);return i}function sD(){var e=ot.H,t=e.useState()[0];return t=typeof t.then=="function"?Rx(t):t,e=e.useState()[0],(Mt!==null?Mt.memoizedState:null)!==e&&(ut.flags|=1024),t}function Bv(){var e=Df!==0;return Df=0,e}function Fv(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Tv(e){if(kf){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}kf=!1}Qi=0,Br=Mt=ut=null,_c=!1,Vd=Df=0,jc=null}function $s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Br===null?ut.memoizedState=Br=e:Br=Br.next=e,Br}function Fr(){if(Mt===null){var e=ut.alternate;e=e!==null?e.memoizedState:null}else e=Mt.next;var t=Br===null?ut.memoizedState:Br.next;if(t!==null)Br=t,Mt=e;else{if(e===null)throw ut.alternate===null?Error(Se(467)):Error(Se(310));Mt=e,e={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},Br===null?ut.memoizedState=Br=e:Br=Br.next=e}return Br}var Oh;Oh=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Rx(e){var t=Vd;return Vd+=1,jc===null&&(jc=[]),e=xE(jc,e,t),t=ut,(Br===null?t.memoizedState:Br.next)===null&&(t=t.alternate,ot.H=t===null||t.memoizedState===null?_o:dl),e}function Ph(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Rx(e);if(e.$$typeof===Kn)return bs(e)}throw Error(Se(438,String(e)))}function Mv(e){var t=null,r=ut.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var a=ut.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(n){return n.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=Oh(),ut.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),a=0;a<e;a++)r[a]=I7;return t.index++,r}function li(e,t){return typeof t=="function"?t(e):t}function af(e){var t=Fr();return Rv(t,Mt,e)}function Rv(e,t,r){var a=e.queue;if(a===null)throw Error(Se(311));a.lastRenderedReducer=r;var n=e.baseQueue,i=a.pending;if(i!==null){if(n!==null){var l=n.next;n.next=i.next,i.next=l}t.baseQueue=n=i,a.pending=null}if(i=e.baseState,n===null)e.memoizedState=i;else{t=n.next;var o=l=null,c=null,d=t,x=!1;do{var u=d.lane&-536870913;if(u!==d.lane?(_t&u)===u:(Qi&u)===u){var f=d.revertLane;if(f===0)c!==null&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),u===Pc&&(x=!0);else if((Qi&f)===f){d=d.next,f===Pc&&(x=!0);continue}else u={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},c===null?(o=c=u,l=i):c=c.next=u,ut.lanes|=f,Zi|=f;u=d.action,so&&r(i,u),i=d.hasEagerState?d.eagerState:r(i,u)}else f={lane:u,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},c===null?(o=c=f,l=i):c=c.next=f,ut.lanes|=u,Zi|=u;d=d.next}while(d!==null&&d!==t);if(c===null?l=i:c.next=o,!oa(i,e.memoizedState)&&(Kr=!0,x&&(r=Ec,r!==null)))throw r;e.memoizedState=i,e.baseState=l,e.baseQueue=c,a.lastRenderedState=i}return n===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function Lm(e){var t=Fr(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var a=r.dispatch,n=r.pending,i=t.memoizedState;if(n!==null){r.pending=null;var l=n=n.next;do i=e(i,l.action),l=l.next;while(l!==n);oa(i,t.memoizedState)||(Kr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,a]}function vE(e,t,r){var a=ut,n=Fr(),i=At;if(i){if(r===void 0)throw Error(Se(407));r=r()}else r=t();var l=!oa((Mt||n).memoizedState,r);if(l&&(n.memoizedState=r,Kr=!0),n=n.queue,Ov(wE.bind(null,a,n,e),[e]),n.getSnapshot!==t||l||Br!==null&&Br.memoizedState.tag&1){if(a.flags|=2048,Lc(9,yE.bind(null,a,n,r,t),{destroy:void 0},null),Ut===null)throw Error(Se(349));i||Qi&60||bE(a,t,r)}return r}function bE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ut.updateQueue,t===null?(t=Oh(),ut.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function yE(e,t,r,a){t.value=r,t.getSnapshot=a,EE(t)&&_E(e)}function wE(e,t,r){return r(function(){EE(t)&&_E(e)})}function EE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!oa(e,r)}catch{return!0}}function _E(e){var t=Ki(e,2);t!==null&&Ts(t,e,2)}function Cp(e){var t=$s();if(typeof e=="function"){var r=e;if(e=r(),so){Oi(!0);try{r()}finally{Oi(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:e},t}function jE(e,t,r,a){return e.baseState=r,Rv(e,Mt,typeof a=="function"?a:li)}function aD(e,t,r,a,n){if(Ih(e))throw Error(Se(485));if(e=t.action,e!==null){var i={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(l){i.listeners.push(l)}};ot.T!==null?r(!0):i.isTransition=!1,a(i),r=t.pending,r===null?(i.next=t.pending=i,NE(t,i)):(i.next=r.next,t.pending=r.next=i)}}function NE(e,t){var r=t.action,a=t.payload,n=e.state;if(t.isTransition){var i=ot.T,l={};ot.T=l;try{var o=r(n,a),c=ot.S;c!==null&&c(l,o),O2(e,t,o)}catch(d){Ap(e,t,d)}finally{ot.T=i}}else try{i=r(n,a),O2(e,t,i)}catch(d){Ap(e,t,d)}}function O2(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(a){P2(e,t,a)},function(a){return Ap(e,t,a)}):P2(e,t,r)}function P2(e,t,r){t.status="fulfilled",t.value=r,CE(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,NE(e,r)))}function Ap(e,t,r){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=r,CE(t),t=t.next;while(t!==a)}e.action=null}function CE(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function AE(e,t){return t}function kE(e,t){if(At){var r=Ut.formState;if(r!==null){e:{var a=ut;if(At){if(ls){t:{for(var n=ls,i=gn;n.nodeType!==8;){if(!i){n=null;break t}if(n=Za(n.nextSibling),n===null){n=null;break t}}i=n.data,n=i==="F!"||i==="F"?n:null}if(n){ls=Za(n.nextSibling),a=n.data==="F!";break e}}to(a)}a=!1}a&&(t=r[0])}}return r=$s(),r.memoizedState=r.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:AE,lastRenderedState:t},r.queue=a,r=HE.bind(null,ut,a),a.dispatch=r,a=Cp(!1),i=Uv.bind(null,ut,!1,a.queue),a=$s(),n={state:t,dispatch:null,action:e,pending:null},a.queue=n,r=aD.bind(null,ut,n,i,r),n.dispatch=r,a.memoizedState=e,[t,r,!1]}function DE(e){var t=Fr();return SE(t,Mt,e)}function SE(e,t,r){t=Rv(e,t,AE)[0],e=af(li)[0],t=typeof t=="object"&&t!==null&&typeof t.then=="function"?Rx(t):t;var a=Fr(),n=a.queue,i=n.dispatch;return r!==a.memoizedState&&(ut.flags|=2048,Lc(9,nD.bind(null,n,r),{destroy:void 0},null)),[t,i,e]}function nD(e,t){e.action=t}function BE(e){var t=Fr(),r=Mt;if(r!==null)return SE(t,r,e);Fr(),t=t.memoizedState,r=Fr();var a=r.queue.dispatch;return r.memoizedState=e,[t,a,!1]}function Lc(e,t,r,a){return e={tag:e,create:t,inst:r,deps:a,next:null},t=ut.updateQueue,t===null&&(t=Oh(),ut.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function FE(){return Fr().memoizedState}function nf(e,t,r,a){var n=$s();ut.flags|=e,n.memoizedState=Lc(1|t,r,{destroy:void 0},a===void 0?null:a)}function Lh(e,t,r,a){var n=Fr();a=a===void 0?null:a;var i=n.memoizedState.inst;Mt!==null&&a!==null&&Dv(a,Mt.memoizedState.deps)?n.memoizedState=Lc(t,r,i,a):(ut.flags|=e,n.memoizedState=Lc(1|t,r,i,a))}function L2(e,t){nf(8390656,8,e,t)}function Ov(e,t){Lh(2048,8,e,t)}function TE(e,t){return Lh(4,2,e,t)}function ME(e,t){return Lh(4,4,e,t)}function RE(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function OE(e,t,r){r=r!=null?r.concat([e]):null,Lh(4,4,RE.bind(null,t,e),r)}function Pv(){}function PE(e,t){var r=Fr();t=t===void 0?null:t;var a=r.memoizedState;return t!==null&&Dv(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function LE(e,t){var r=Fr();t=t===void 0?null:t;var a=r.memoizedState;if(t!==null&&Dv(t,a[1]))return a[0];if(a=e(),so){Oi(!0);try{e()}finally{Oi(!1)}}return r.memoizedState=[a,t],a}function Lv(e,t,r){return r===void 0||Qi&1073741824?e.memoizedState=t:(e.memoizedState=r,e=C9(),ut.lanes|=e,Zi|=e,r)}function IE(e,t,r,a){return oa(r,t)?r:Oc.current!==null?(e=Lv(e,r,a),oa(e,t)||(Kr=!0),e):Qi&42?(e=C9(),ut.lanes|=e,Zi|=e,t):(Kr=!0,e.memoizedState=r)}function UE(e,t,r,a,n){var i=Vt.p;Vt.p=i!==0&&8>i?i:8;var l=ot.T,o={};ot.T=o,Uv(e,!1,t,r);try{var c=n(),d=ot.S;if(d!==null&&d(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var x=tD(c,a);id(e,t,x,la(e))}else id(e,t,a,la(e))}catch(u){id(e,t,{then:function(){},status:"rejected",reason:u},la())}finally{Vt.p=i,ot.T=l}}function iD(){}function kp(e,t,r,a){if(e.tag!==5)throw Error(Se(476));var n=$E(e).queue;UE(e,n,t,Ul,r===null?iD:function(){return zE(e),r(a)})}function $E(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Ul,baseState:Ul,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:Ul},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function zE(e){var t=$E(e).next.queue;id(e,t,{},la())}function Iv(){return bs(Yd)}function qE(){return Fr().memoizedState}function VE(){return Fr().memoizedState}function lD(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=la();e=qi(r);var a=Vi(t,e,r);a!==null&&(Ts(a,t,r),od(a,t,r)),t={cache:Av()},e.payload=t;return}t=t.return}}function oD(e,t,r){var a=la();r={lane:a,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},Ih(e)?WE(t,r):(r=_v(e,t,r,a),r!==null&&(Ts(r,e,a),GE(r,t,a)))}function HE(e,t,r){var a=la();id(e,t,r,a)}function id(e,t,r,a){var n={lane:a,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ih(e))WE(t,n);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(n.hasEagerState=!0,n.eagerState=o,oa(o,l))return Rh(e,t,n,0),Ut===null&&Mh(),!1}catch{}finally{}if(r=_v(e,t,n,a),r!==null)return Ts(r,e,a),GE(r,t,a),!0}return!1}function Uv(e,t,r,a){if(a={lane:2,revertLane:Kv(),action:a,hasEagerState:!1,eagerState:null,next:null},Ih(e)){if(t)throw Error(Se(479))}else t=_v(e,r,a,2),t!==null&&Ts(t,e,2)}function Ih(e){var t=e.alternate;return e===ut||t!==null&&t===ut}function WE(e,t){_c=kf=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function GE(e,t,r){if(r&4194176){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,R6(e,r)}}var An={readContext:bs,use:Ph,useCallback:yr,useContext:yr,useEffect:yr,useImperativeHandle:yr,useLayoutEffect:yr,useInsertionEffect:yr,useMemo:yr,useReducer:yr,useRef:yr,useState:yr,useDebugValue:yr,useDeferredValue:yr,useTransition:yr,useSyncExternalStore:yr,useId:yr};An.useCacheRefresh=yr;An.useMemoCache=yr;An.useHostTransitionStatus=yr;An.useFormState=yr;An.useActionState=yr;An.useOptimistic=yr;var _o={readContext:bs,use:Ph,useCallback:function(e,t){return $s().memoizedState=[e,t===void 0?null:t],e},useContext:bs,useEffect:L2,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,nf(4194308,4,RE.bind(null,t,e),r)},useLayoutEffect:function(e,t){return nf(4194308,4,e,t)},useInsertionEffect:function(e,t){nf(4,2,e,t)},useMemo:function(e,t){var r=$s();t=t===void 0?null:t;var a=e();if(so){Oi(!0);try{e()}finally{Oi(!1)}}return r.memoizedState=[a,t],a},useReducer:function(e,t,r){var a=$s();if(r!==void 0){var n=r(t);if(so){Oi(!0);try{r(t)}finally{Oi(!1)}}}else n=t;return a.memoizedState=a.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},a.queue=e,e=e.dispatch=oD.bind(null,ut,e),[a.memoizedState,e]},useRef:function(e){var t=$s();return e={current:e},t.memoizedState=e},useState:function(e){e=Cp(e);var t=e.queue,r=HE.bind(null,ut,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Pv,useDeferredValue:function(e,t){var r=$s();return Lv(r,e,t)},useTransition:function(){var e=Cp(!1);return e=UE.bind(null,ut,e.queue,!0,!1),$s().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var a=ut,n=$s();if(At){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=t(),Ut===null)throw Error(Se(349));_t&60||bE(a,t,r)}n.memoizedState=r;var i={value:r,getSnapshot:t};return n.queue=i,L2(wE.bind(null,a,i,e),[e]),a.flags|=2048,Lc(9,yE.bind(null,a,i,r,t),{destroy:void 0},null),r},useId:function(){var e=$s(),t=Ut.identifierPrefix;if(At){var r=Jn,a=Qn;r=(a&~(1<<32-ia(a)-1)).toString(32)+r,t=":"+t+"R"+r,r=Df++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=rD++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return $s().memoizedState=lD.bind(null,ut)}};_o.useMemoCache=Mv;_o.useHostTransitionStatus=Iv;_o.useFormState=kE;_o.useActionState=kE;_o.useOptimistic=function(e){var t=$s();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=Uv.bind(null,ut,!0,r),r.dispatch=t,[e,t]};var dl={readContext:bs,use:Ph,useCallback:PE,useContext:bs,useEffect:Ov,useImperativeHandle:OE,useInsertionEffect:TE,useLayoutEffect:ME,useMemo:LE,useReducer:af,useRef:FE,useState:function(){return af(li)},useDebugValue:Pv,useDeferredValue:function(e,t){var r=Fr();return IE(r,Mt.memoizedState,e,t)},useTransition:function(){var e=af(li)[0],t=Fr().memoizedState;return[typeof e=="boolean"?e:Rx(e),t]},useSyncExternalStore:vE,useId:qE};dl.useCacheRefresh=VE;dl.useMemoCache=Mv;dl.useHostTransitionStatus=Iv;dl.useFormState=DE;dl.useActionState=DE;dl.useOptimistic=function(e,t){var r=Fr();return jE(r,Mt,e,t)};var jo={readContext:bs,use:Ph,useCallback:PE,useContext:bs,useEffect:Ov,useImperativeHandle:OE,useInsertionEffect:TE,useLayoutEffect:ME,useMemo:LE,useReducer:Lm,useRef:FE,useState:function(){return Lm(li)},useDebugValue:Pv,useDeferredValue:function(e,t){var r=Fr();return Mt===null?Lv(r,e,t):IE(r,Mt.memoizedState,e,t)},useTransition:function(){var e=Lm(li)[0],t=Fr().memoizedState;return[typeof e=="boolean"?e:Rx(e),t]},useSyncExternalStore:vE,useId:qE};jo.useCacheRefresh=VE;jo.useMemoCache=Mv;jo.useHostTransitionStatus=Iv;jo.useFormState=BE;jo.useActionState=BE;jo.useOptimistic=function(e,t){var r=Fr();return Mt!==null?jE(r,Mt,e,t):(r.baseState=e,[e,r.queue.dispatch])};function Im(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:Gt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Dp={isMounted:function(e){return(e=e._reactInternals)?n0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=la(),n=qi(a);n.payload=t,r!=null&&(n.callback=r),t=Vi(e,n,a),t!==null&&(Ts(t,e,a),od(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=la(),n=qi(a);n.tag=1,n.payload=t,r!=null&&(n.callback=r),t=Vi(e,n,a),t!==null&&(Ts(t,e,a),od(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=la(),a=qi(r);a.tag=2,t!=null&&(a.callback=t),t=Vi(e,a,r),t!==null&&(Ts(t,e,r),od(t,e,r))}};function I2(e,t,r,a,n,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,i,l):t.prototype&&t.prototype.isPureReactComponent?!$d(r,a)||!$d(n,i):!0}function U2(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&Dp.enqueueReplaceState(t,t.state,null)}function ao(e,t){var r=t;if("ref"in t){r={};for(var a in t)a!=="ref"&&(r[a]=t[a])}if(e=e.defaultProps){r===t&&(r=Gt({},r));for(var n in e)r[n]===void 0&&(r[n]=e[n])}return r}var Sf=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function YE(e){Sf(e)}function XE(e){console.error(e)}function KE(e){Sf(e)}function Bf(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function $2(e,t,r){try{var a=e.onCaughtError;a(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function Sp(e,t,r){return r=qi(r),r.tag=3,r.payload={element:null},r.callback=function(){Bf(e,t)},r}function QE(e){return e=qi(e),e.tag=3,e}function JE(e,t,r,a){var n=r.type.getDerivedStateFromError;if(typeof n=="function"){var i=a.value;e.payload=function(){return n(i)},e.callback=function(){$2(t,r,a)}}var l=r.stateNode;l!==null&&typeof l.componentDidCatch=="function"&&(e.callback=function(){$2(t,r,a),typeof n!="function"&&(Wi===null?Wi=new Set([this]):Wi.add(this));var o=a.stack;this.componentDidCatch(a.value,{componentStack:o!==null?o:""})})}function cD(e,t,r,a,n){if(r.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=r.alternate,t!==null&&Ox(t,r,n,!0),r=Ra.current,r!==null){switch(r.tag){case 13:return _n===null?Hp():r.alternate===null&&ur===0&&(ur=3),r.flags&=-257,r.flags|=65536,r.lanes=n,a===_p?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([a]):t.add(a),Jm(e,a,n)),!1;case 22:return r.flags|=65536,a===_p?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([a]):r.add(a)),Jm(e,a,n)),!1}throw Error(Se(435,r.tag))}return Jm(e,a,n),Hp(),!1}if(At)return t=Ra.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=n,a!==Ep&&(e=Error(Se(422),{cause:a}),zd(Da(e,r)))):(a!==Ep&&(t=Error(Se(423),{cause:a}),zd(Da(t,r))),e=e.current.alternate,e.flags|=65536,n&=-n,e.lanes|=n,a=Da(a,r),n=Sp(e.stateNode,a,n),Hm(e,n),ur!==4&&(ur=2)),!1;var i=Error(Se(520),{cause:a});if(i=Da(i,r),ud===null?ud=[i]:ud.push(i),ur!==4&&(ur=2),t===null)return!0;a=Da(a,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=n&-n,r.lanes|=e,e=Sp(r.stateNode,a,e),Hm(r,e),!1;case 1:if(t=r.type,i=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||i!==null&&typeof i.componentDidCatch=="function"&&(Wi===null||!Wi.has(i))))return r.flags|=65536,n&=-n,r.lanes|=n,n=QE(n),JE(n,e,r,a),Hm(r,n),!1}r=r.return}while(r!==null);return!1}var ZE=Error(Se(461)),Kr=!1;function ns(e,t,r,a){t.child=e===null?fE(t,null,r,a):ro(t,e.child,r,a)}function z2(e,t,r,a,n){r=r.render;var i=t.ref;if("ref"in a){var l={};for(var o in a)o!=="ref"&&(l[o]=a[o])}else l=a;return no(t),a=Sv(e,t,r,l,i,n),o=Bv(),e!==null&&!Kr?(Fv(e,t,n),oi(e,t,n)):(At&&o&&jv(t),t.flags|=1,ns(e,t,a,n),t.child)}function q2(e,t,r,a,n){if(e===null){var i=r.type;return typeof i=="function"&&!Hv(i)&&i.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=i,e9(e,t,i,a,n)):(e=of(r.type,null,a,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!$v(e,n)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:$d,r(l,a)&&e.ref===t.ref)return oi(e,t,n)}return t.flags|=1,e=Hi(i,a),e.ref=t.ref,e.return=t,t.child=e}function e9(e,t,r,a,n){if(e!==null){var i=e.memoizedProps;if($d(i,a)&&e.ref===t.ref)if(Kr=!1,t.pendingProps=a=i,$v(e,n))e.flags&131072&&(Kr=!0);else return t.lanes=e.lanes,oi(e,t,n)}return Bp(e,t,r,a,n)}function t9(e,t,r){var a=t.pendingProps,n=a.children,i=(t.stateNode._pendingVisibility&2)!==0,l=e!==null?e.memoizedState:null;if(ld(e,t),a.mode==="hidden"||i){if(t.flags&128){if(a=l!==null?l.baseLanes|r:r,e!==null){for(n=t.child=e.child,i=0;n!==null;)i=i|n.lanes|n.childLanes,n=n.sibling;t.childLanes=i&~a}else t.childLanes=0,t.child=null;return V2(e,t,a,r)}if(r&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&sf(t,l!==null?l.cachePool:null),l!==null?T2(t,l):jp(),hE(t);else return t.lanes=t.childLanes=536870912,V2(e,t,l!==null?l.baseLanes|r:r,r)}else l!==null?(sf(t,l.cachePool),T2(t,l),Fi(),t.memoizedState=null):(e!==null&&sf(t,null),jp(),Fi());return ns(e,t,n,r),t.child}function V2(e,t,r,a){var n=kv();return n=n===null?null:{parent:Rr._currentValue,pool:n},t.memoizedState={baseLanes:r,cachePool:n},e!==null&&sf(t,null),jp(),hE(t),e!==null&&Ox(e,t,a,!0),null}function ld(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=2097664);else{if(typeof r!="function"&&typeof r!="object")throw Error(Se(284));(e===null||e.ref!==r)&&(t.flags|=2097664)}}function Bp(e,t,r,a,n){return no(t),r=Sv(e,t,r,a,void 0,n),a=Bv(),e!==null&&!Kr?(Fv(e,t,n),oi(e,t,n)):(At&&a&&jv(t),t.flags|=1,ns(e,t,r,n),t.child)}function H2(e,t,r,a,n,i){return no(t),t.updateQueue=null,r=pE(t,a,r,n),gE(e),a=Bv(),e!==null&&!Kr?(Fv(e,t,i),oi(e,t,i)):(At&&a&&jv(t),t.flags|=1,ns(e,t,r,i),t.child)}function W2(e,t,r,a,n){if(no(t),t.stateNode===null){var i=lc,l=r.contextType;typeof l=="object"&&l!==null&&(i=bs(l)),i=new r(a,i),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Dp,t.stateNode=i,i._reactInternals=t,i=t.stateNode,i.props=a,i.state=t.memoizedState,i.refs={},zv(t),l=r.contextType,i.context=typeof l=="object"&&l!==null?bs(l):lc,i.state=t.memoizedState,l=r.getDerivedStateFromProps,typeof l=="function"&&(Im(t,r,l,a),i.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(l=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),l!==i.state&&Dp.enqueueReplaceState(i,i.state,null),dd(t,a,i,n),cd(),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){i=t.stateNode;var o=t.memoizedProps,c=ao(r,o);i.props=c;var d=i.context,x=r.contextType;l=lc,typeof x=="object"&&x!==null&&(l=bs(x));var u=r.getDerivedStateFromProps;x=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function",o=t.pendingProps!==o,x||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o||d!==l)&&U2(t,i,a,l),Di=!1;var f=t.memoizedState;i.state=f,dd(t,a,i,n),cd(),d=t.memoizedState,o||f!==d||Di?(typeof u=="function"&&(Im(t,r,u,a),d=t.memoizedState),(c=Di||I2(t,r,c,a,f,d,l))?(x||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=d),i.props=a,i.state=d,i.context=l,a=c):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,Pp(e,t),l=t.memoizedProps,x=ao(r,l),i.props=x,u=t.pendingProps,f=i.context,d=r.contextType,c=lc,typeof d=="object"&&d!==null&&(c=bs(d)),o=r.getDerivedStateFromProps,(d=typeof o=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==u||f!==c)&&U2(t,i,a,c),Di=!1,f=t.memoizedState,i.state=f,dd(t,a,i,n),cd();var h=t.memoizedState;l!==u||f!==h||Di||e!==null&&e.dependencies!==null&&Ff(e.dependencies)?(typeof o=="function"&&(Im(t,r,o,a),h=t.memoizedState),(x=Di||I2(t,r,x,a,f,h,c)||e!==null&&e.dependencies!==null&&Ff(e.dependencies))?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(a,h,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(a,h,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=h),i.props=a,i.state=h,i.context=c,a=x):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),a=!1)}return i=a,ld(e,t),a=(t.flags&128)!==0,i||a?(i=t.stateNode,r=a&&typeof r.getDerivedStateFromError!="function"?null:i.render(),t.flags|=1,e!==null&&a?(t.child=ro(t,e.child,null,n),t.child=ro(t,null,r,n)):ns(e,t,r,n),t.memoizedState=i.state,e=t.child):e=oi(e,t,n),e}function G2(e,t,r,a){return Tx(),t.flags|=256,ns(e,t,r,a),t.child}var Um={dehydrated:null,treeContext:null,retryLane:0};function $m(e){return{baseLanes:e,cachePool:mE()}}function zm(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=Ba),e}function r9(e,t,r){var a=t.pendingProps,n=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(Pr.current&2)!==0),l&&(n=!0,t.flags&=-129),l=(t.flags&32)!==0,t.flags&=-33,e===null){if(At){if(n?Bi(t):Fi(),At){var o=ls,c;if(c=o){e:{for(c=o,o=gn;c.nodeType!==8;){if(!o){o=null;break e}if(c=Za(c.nextSibling),c===null){o=null;break e}}o=c}o!==null?(t.memoizedState={dehydrated:o,treeContext:$l!==null?{id:Qn,overflow:Jn}:null,retryLane:536870912},c=Sa(18,null,null,0),c.stateNode=o,c.return=t,t.child=c,Ss=t,ls=null,c=!0):c=!1}c||to(t)}if(o=t.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return o.data==="$!"?t.lanes=16:t.lanes=536870912,null;Zn(t)}return o=a.children,a=a.fallback,n?(Fi(),n=t.mode,o=Tp({mode:"hidden",children:o},n),a=ql(a,n,r,null),o.return=t,a.return=t,o.sibling=a,t.child=o,n=t.child,n.memoizedState=$m(r),n.childLanes=zm(e,l,r),t.memoizedState=Um,a):(Bi(t),Fp(t,o))}if(c=e.memoizedState,c!==null&&(o=c.dehydrated,o!==null)){if(i)t.flags&256?(Bi(t),t.flags&=-257,t=qm(e,t,r)):t.memoizedState!==null?(Fi(),t.child=e.child,t.flags|=128,t=null):(Fi(),n=a.fallback,o=t.mode,a=Tp({mode:"visible",children:a.children},o),n=ql(n,o,r,null),n.flags|=2,a.return=t,n.return=t,a.sibling=n,t.child=a,ro(t,e.child,null,r),a=t.child,a.memoizedState=$m(r),a.childLanes=zm(e,l,r),t.memoizedState=Um,t=n);else if(Bi(t),o.data==="$!"){if(l=o.nextSibling&&o.nextSibling.dataset,l)var d=l.dgst;l=d,a=Error(Se(419)),a.stack="",a.digest=l,zd({value:a,source:null,stack:null}),t=qm(e,t,r)}else if(Kr||Ox(e,t,r,!1),l=(r&e.childLanes)!==0,Kr||l){if(l=Ut,l!==null){if(a=r&-r,a&42)a=1;else switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=64;break;case 268435456:a=134217728;break;default:a=0}if(a=a&(l.suspendedLanes|r)?0:a,a!==0&&a!==c.retryLane)throw c.retryLane=a,Ki(e,a),Ts(l,e,a),ZE}o.data==="$?"||Hp(),t=qm(e,t,r)}else o.data==="$?"?(t.flags|=128,t.child=e.child,t=jD.bind(null,e),o._reactRetry=t,t=null):(e=c.treeContext,ls=Za(o.nextSibling),Ss=t,At=!0,Ya=null,gn=!1,e!==null&&(Na[Ca++]=Qn,Na[Ca++]=Jn,Na[Ca++]=$l,Qn=e.id,Jn=e.overflow,$l=t),t=Fp(t,a.children),t.flags|=4096);return t}return n?(Fi(),n=a.fallback,o=t.mode,c=e.child,d=c.sibling,a=Hi(c,{mode:"hidden",children:a.children}),a.subtreeFlags=c.subtreeFlags&31457280,d!==null?n=Hi(d,n):(n=ql(n,o,r,null),n.flags|=2),n.return=t,a.return=t,a.sibling=n,t.child=a,a=n,n=t.child,o=e.child.memoizedState,o===null?o=$m(r):(c=o.cachePool,c!==null?(d=Rr._currentValue,c=c.parent!==d?{parent:d,pool:d}:c):c=mE(),o={baseLanes:o.baseLanes|r,cachePool:c}),n.memoizedState=o,n.childLanes=zm(e,l,r),t.memoizedState=Um,a):(Bi(t),r=e.child,e=r.sibling,r=Hi(r,{mode:"visible",children:a.children}),r.return=t,r.sibling=null,e!==null&&(l=t.deletions,l===null?(t.deletions=[e],t.flags|=16):l.push(e)),t.child=r,t.memoizedState=null,r)}function Fp(e,t){return t=Tp({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Tp(e,t){return j9(e,t,0,null)}function qm(e,t,r){return ro(t,e.child,null,r),e=Fp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Y2(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),Rp(e.return,t,r)}function Vm(e,t,r,a,n){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:n}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=r,i.tailMode=n)}function s9(e,t,r){var a=t.pendingProps,n=a.revealOrder,i=a.tail;if(ns(e,t,a.children,r),a=Pr.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Y2(e,r,t);else if(e.tag===19)Y2(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(Xt(Pr,a),n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&Af(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),Vm(t,!1,n,r,i);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Af(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}Vm(t,!0,r,null,i);break;case"together":Vm(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function oi(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Zi|=t.lanes,!(r&t.childLanes))if(e!==null){if(Ox(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(Se(153));if(t.child!==null){for(e=t.child,r=Hi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Hi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function $v(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&Ff(e)))}function dD(e,t,r){switch(t.tag){case 3:vf(t,t.stateNode.containerInfo),Ti(t,Rr,e.memoizedState.cache),Tx();break;case 27:case 5:fp(t);break;case 4:vf(t,t.stateNode.containerInfo);break;case 10:Ti(t,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(Bi(t),t.flags|=128,null):r&t.child.childLanes?r9(e,t,r):(Bi(t),e=oi(e,t,r),e!==null?e.sibling:null);Bi(t);break;case 19:var n=(e.flags&128)!==0;if(a=(r&t.childLanes)!==0,a||(Ox(e,t,r,!1),a=(r&t.childLanes)!==0),n){if(a)return s9(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Xt(Pr,Pr.current),a)break;return null;case 22:case 23:return t.lanes=0,t9(e,t,r);case 24:Ti(t,Rr,e.memoizedState.cache)}return oi(e,t,r)}function a9(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)Kr=!0;else{if(!$v(e,r)&&!(t.flags&128))return Kr=!1,dD(e,t,r);Kr=!!(e.flags&131072)}else Kr=!1,At&&t.flags&1048576&&cE(t,Nf,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,n=a._init;if(a=n(a._payload),t.type=a,typeof a=="function")Hv(a)?(e=ao(a,e),t.tag=1,t=W2(null,t,a,e,r)):(t.tag=0,t=Bp(null,t,a,e,r));else{if(a!=null){if(n=a.$$typeof,n===uv){t.tag=11,t=z2(null,t,a,e,r);break e}else if(n===fv){t.tag=14,t=q2(null,t,a,e,r);break e}}throw t=xp(a)||a,Error(Se(306,t,""))}}return t;case 0:return Bp(e,t,t.type,t.pendingProps,r);case 1:return a=t.type,n=ao(a,t.pendingProps),W2(e,t,a,n,r);case 3:e:{if(vf(t,t.stateNode.containerInfo),e===null)throw Error(Se(387));var i=t.pendingProps;n=t.memoizedState,a=n.element,Pp(e,t),dd(t,i,null,r);var l=t.memoizedState;if(i=l.cache,Ti(t,Rr,i),i!==n.cache&&Op(t,[Rr],r,!0),cd(),i=l.element,n.isDehydrated)if(n={element:i,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=n,t.memoizedState=n,t.flags&256){t=G2(e,t,i,r);break e}else if(i!==a){a=Da(Error(Se(424)),t),zd(a),t=G2(e,t,i,r);break e}else for(ls=Za(t.stateNode.containerInfo.firstChild),Ss=t,At=!0,Ya=null,gn=!0,r=fE(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Tx(),i===a){t=oi(e,t,r);break e}ns(e,t,i,r)}t=t.child}return t;case 26:return ld(e,t),e===null?(r=uw(t.type,null,t.pendingProps,null))?t.memoizedState=r:At||(r=t.type,e=t.pendingProps,a=If(zi.current).createElement(r),a[vs]=t,a[Gs]=e,cs(a,r,e),Yr(a),t.stateNode=a):t.memoizedState=uw(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return fp(t),e===null&&At&&(a=t.stateNode=z9(t.type,t.pendingProps,zi.current),Ss=t,gn=!0,ls=Za(a.firstChild)),a=t.pendingProps.children,e!==null||At?ns(e,t,a,r):t.child=ro(t,null,a,r),ld(e,t),t.child;case 5:return e===null&&At&&((n=a=ls)&&(a=UD(a,t.type,t.pendingProps,gn),a!==null?(t.stateNode=a,Ss=t,ls=Za(a.firstChild),gn=!1,n=!0):n=!1),n||to(t)),fp(t),n=t.type,i=t.pendingProps,l=e!==null?e.memoizedProps:null,a=i.children,Kp(n,i)?a=null:l!==null&&Kp(n,l)&&(t.flags|=32),t.memoizedState!==null&&(n=Sv(e,t,sD,null,null,r),Yd._currentValue=n),ld(e,t),ns(e,t,a,r),t.child;case 6:return e===null&&At&&((e=r=ls)&&(r=$D(r,t.pendingProps,gn),r!==null?(t.stateNode=r,Ss=t,ls=null,e=!0):e=!1),e||to(t)),null;case 13:return r9(e,t,r);case 4:return vf(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=ro(t,null,a,r):ns(e,t,a,r),t.child;case 11:return z2(e,t,t.type,t.pendingProps,r);case 7:return ns(e,t,t.pendingProps,r),t.child;case 8:return ns(e,t,t.pendingProps.children,r),t.child;case 12:return ns(e,t,t.pendingProps.children,r),t.child;case 10:return a=t.pendingProps,Ti(t,t.type,a.value),ns(e,t,a.children,r),t.child;case 9:return n=t.type._context,a=t.pendingProps.children,no(t),n=bs(n),a=a(n),t.flags|=1,ns(e,t,a,r),t.child;case 14:return q2(e,t,t.type,t.pendingProps,r);case 15:return e9(e,t,t.type,t.pendingProps,r);case 19:return s9(e,t,r);case 22:return t9(e,t,r);case 24:return no(t),a=bs(Rr),e===null?(n=kv(),n===null&&(n=Ut,i=Av(),n.pooledCache=i,i.refCount++,i!==null&&(n.pooledCacheLanes|=r),n=i),t.memoizedState={parent:a,cache:n},zv(t),Ti(t,Rr,n)):(e.lanes&r&&(Pp(e,t),dd(t,null,null,r),cd()),n=e.memoizedState,i=t.memoizedState,n.parent!==a?(n={parent:a,cache:a},t.memoizedState=n,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=n),Ti(t,Rr,a)):(a=i.cache,Ti(t,Rr,a),a!==n.cache&&Op(t,[Rr],r,!0))),ns(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(Se(156,t.tag))}var Mp=Tn(null),No=null,ei=null;function Ti(e,t,r){Xt(Mp,t._currentValue),t._currentValue=r}function ri(e){e._currentValue=Mp.current,Jr(Mp)}function Rp(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function Op(e,t,r,a){var n=e.child;for(n!==null&&(n.return=e);n!==null;){var i=n.dependencies;if(i!==null){var l=n.child;i=i.firstContext;e:for(;i!==null;){var o=i;i=n;for(var c=0;c<t.length;c++)if(o.context===t[c]){i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Rp(i.return,r,e),a||(l=null);break e}i=o.next}}else if(n.tag===18){if(l=n.return,l===null)throw Error(Se(341));l.lanes|=r,i=l.alternate,i!==null&&(i.lanes|=r),Rp(l,r,e),l=null}else l=n.child;if(l!==null)l.return=n;else for(l=n;l!==null;){if(l===e){l=null;break}if(n=l.sibling,n!==null){n.return=l.return,l=n;break}l=l.return}n=l}}function Ox(e,t,r,a){e=null;for(var n=t,i=!1;n!==null;){if(!i){if(n.flags&524288)i=!0;else if(n.flags&262144)break}if(n.tag===10){var l=n.alternate;if(l===null)throw Error(Se(387));if(l=l.memoizedProps,l!==null){var o=n.type;oa(n.pendingProps.value,l.value)||(e!==null?e.push(o):e=[o])}}else if(n===pf.current){if(l=n.alternate,l===null)throw Error(Se(387));l.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(e!==null?e.push(Yd):e=[Yd])}n=n.return}e!==null&&Op(t,e,r,a),t.flags|=262144}function Ff(e){for(e=e.firstContext;e!==null;){if(!oa(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function no(e){No=e,ei=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function bs(e){return n9(No,e)}function gu(e,t){return No===null&&no(e),n9(e,t)}function n9(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},ei===null){if(e===null)throw Error(Se(308));ei=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ei=ei.next=t;return r}var Di=!1;function zv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function qi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Vi(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,sr&2){var n=a.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),a.pending=t,t=_f(e),oE(e,null,r),t}return Rh(e,a,t,r),_f(e)}function od(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194176)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,R6(e,r)}}function Hm(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var n=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};i===null?n=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?n=i=t:i=i.next=t}else n=i=t;r={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:a.shared,callbacks:a.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Lp=!1;function cd(){if(Lp){var e=Ec;if(e!==null)throw e}}function dd(e,t,r,a){Lp=!1;var n=e.updateQueue;Di=!1;var i=n.firstBaseUpdate,l=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var c=o,d=c.next;c.next=null,l===null?i=d:l.next=d,l=c;var x=e.alternate;x!==null&&(x=x.updateQueue,o=x.lastBaseUpdate,o!==l&&(o===null?x.firstBaseUpdate=d:o.next=d,x.lastBaseUpdate=c))}if(i!==null){var u=n.baseState;l=0,x=d=c=null,o=i;do{var f=o.lane&-536870913,h=f!==o.lane;if(h?(_t&f)===f:(a&f)===f){f!==0&&f===Pc&&(Lp=!0),x!==null&&(x=x.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,g=o;f=t;var y=r;switch(g.tag){case 1:if(p=g.payload,typeof p=="function"){u=p.call(y,u,f);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(y,u,f):p,f==null)break e;u=Gt({},u,f);break e;case 2:Di=!0}}f=o.callback,f!==null&&(e.flags|=64,h&&(e.flags|=8192),h=n.callbacks,h===null?n.callbacks=[f]:h.push(f))}else h={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},x===null?(d=x=h,c=u):x=x.next=h,l|=f;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;h=o,o=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);x===null&&(c=u),n.baseState=c,n.firstBaseUpdate=d,n.lastBaseUpdate=x,i===null&&(n.shared.lanes=0),Zi|=l,e.lanes=l,e.memoizedState=u}}function i9(e,t){if(typeof e!="function")throw Error(Se(191,e));e.call(t)}function l9(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)i9(r[e],t)}function Px(e,t){try{var r=t.updateQueue,a=r!==null?r.lastEffect:null;if(a!==null){var n=a.next;r=n;do{if((r.tag&e)===e){a=void 0;var i=r.create,l=r.inst;a=i(),l.destroy=a}r=r.next}while(r!==n)}}catch(o){Ot(t,t.return,o)}}function Ji(e,t,r){try{var a=t.updateQueue,n=a!==null?a.lastEffect:null;if(n!==null){var i=n.next;a=i;do{if((a.tag&e)===e){var l=a.inst,o=l.destroy;if(o!==void 0){l.destroy=void 0,n=t;var c=r;try{o()}catch(d){Ot(n,c,d)}}}a=a.next}while(a!==i)}}catch(d){Ot(t,t.return,d)}}function o9(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{l9(t,r)}catch(a){Ot(e,e.return,a)}}}function c9(e,t,r){r.props=ao(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(a){Ot(e,t,a)}}function Ol(e,t){try{var r=e.ref;if(r!==null){var a=e.stateNode;switch(e.tag){case 26:case 27:case 5:var n=a;break;default:n=a}typeof r=="function"?e.refCleanup=r(n):r.current=n}}catch(i){Ot(e,t,i)}}function ra(e,t){var r=e.ref,a=e.refCleanup;if(r!==null)if(typeof a=="function")try{a()}catch(n){Ot(e,t,n)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(n){Ot(e,t,n)}else r.current=null}function d9(e){var t=e.type,r=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&a.focus();break e;case"img":r.src?a.src=r.src:r.srcSet&&(a.srcset=r.srcSet)}}catch(n){Ot(e,e.return,n)}}function X2(e,t,r){try{var a=e.stateNode;RD(a,e.type,r,t),a[Gs]=t}catch(n){Ot(e,e.return,n)}}function x9(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27||e.tag===4}function Wm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||x9(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==27&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ip(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=zh));else if(a!==4&&a!==27&&(e=e.child,e!==null))for(Ip(e,t,r),e=e.sibling;e!==null;)Ip(e,t,r),e=e.sibling}function Tf(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&a!==27&&(e=e.child,e!==null))for(Tf(e,t,r),e=e.sibling;e!==null;)Tf(e,t,r),e=e.sibling}var Hn=!1,cr=!1,Gm=!1,K2=typeof WeakSet=="function"?WeakSet:Set,Hr=null,Q2=!1;function xD(e,t){if(e=e.containerInfo,Yp=qf,e=tE(e),wv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var n=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,d=0,x=0,u=e,f=null;t:for(;;){for(var h;u!==r||n!==0&&u.nodeType!==3||(o=l+n),u!==i||a!==0&&u.nodeType!==3||(c=l+a),u.nodeType===3&&(l+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===e)break t;if(f===r&&++d===n&&(o=l),f===i&&++x===a&&(c=l),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Xp={focusedElem:e,selectionRange:r},qf=!1,Hr=t;Hr!==null;)if(t=Hr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Hr=e;else for(;Hr!==null;){switch(t=Hr,i=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&i!==null){e=void 0,r=t,n=i.memoizedProps,i=i.memoizedState,a=r.stateNode;try{var p=ao(r.type,n,r.elementType===r.type);e=a.getSnapshotBeforeUpdate(p,i),a.__reactInternalSnapshotBeforeUpdate=e}catch(g){Ot(r,r.return,g)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)Qp(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Qp(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(Se(163))}if(e=t.sibling,e!==null){e.return=t.return,Hr=e;break}Hr=t.return}return p=Q2,Q2=!1,p}function u9(e,t,r){var a=r.flags;switch(r.tag){case 0:case 11:case 15:$n(e,r),a&4&&Px(5,r);break;case 1:if($n(e,r),a&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(o){Ot(r,r.return,o)}else{var n=ao(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){Ot(r,r.return,o)}}a&64&&o9(r),a&512&&Ol(r,r.return);break;case 3:if($n(e,r),a&64&&(a=r.updateQueue,a!==null)){if(e=null,r.child!==null)switch(r.child.tag){case 27:case 5:e=r.child.stateNode;break;case 1:e=r.child.stateNode}try{l9(a,e)}catch(o){Ot(r,r.return,o)}}break;case 26:$n(e,r),a&512&&Ol(r,r.return);break;case 27:case 5:$n(e,r),t===null&&a&4&&d9(r),a&512&&Ol(r,r.return);break;case 12:$n(e,r);break;case 13:$n(e,r),a&4&&m9(e,r);break;case 22:if(n=r.memoizedState!==null||Hn,!n){t=t!==null&&t.memoizedState!==null||cr;var i=Hn,l=cr;Hn=n,(cr=t)&&!l?Ni(e,r,(r.subtreeFlags&8772)!==0):$n(e,r),Hn=i,cr=l}a&512&&(r.memoizedProps.mode==="manual"?Ol(r,r.return):ra(r,r.return));break;default:$n(e,r)}}function f9(e){var t=e.alternate;t!==null&&(e.alternate=null,f9(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&mv(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ar=null,Js=!1;function Un(e,t,r){for(r=r.child;r!==null;)h9(e,t,r),r=r.sibling}function h9(e,t,r){if(na&&typeof na.onCommitFiberUnmount=="function")try{na.onCommitFiberUnmount(Dx,r)}catch{}switch(r.tag){case 26:cr||ra(r,t),Un(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:cr||ra(r,t);var a=Ar,n=Js;for(Ar=r.stateNode,Un(e,t,r),r=r.stateNode,t=r.attributes;t.length;)r.removeAttributeNode(t[0]);mv(r),Ar=a,Js=n;break;case 5:cr||ra(r,t);case 6:n=Ar;var i=Js;if(Ar=null,Un(e,t,r),Ar=n,Js=i,Ar!==null)if(Js)try{e=Ar,a=r.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)}catch(l){Ot(r,t,l)}else try{Ar.removeChild(r.stateNode)}catch(l){Ot(r,t,l)}break;case 18:Ar!==null&&(Js?(t=Ar,r=r.stateNode,t.nodeType===8?ng(t.parentNode,r):t.nodeType===1&&ng(t,r),Qd(t)):ng(Ar,r.stateNode));break;case 4:a=Ar,n=Js,Ar=r.stateNode.containerInfo,Js=!0,Un(e,t,r),Ar=a,Js=n;break;case 0:case 11:case 14:case 15:cr||Ji(2,r,t),cr||Ji(4,r,t),Un(e,t,r);break;case 1:cr||(ra(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"&&c9(r,t,a)),Un(e,t,r);break;case 21:Un(e,t,r);break;case 22:cr||ra(r,t),cr=(a=cr)||r.memoizedState!==null,Un(e,t,r),cr=a;break;default:Un(e,t,r)}}function m9(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Qd(e)}catch(r){Ot(t,t.return,r)}}function uD(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new K2),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new K2),t;default:throw Error(Se(435,e.tag))}}function Ym(e,t){var r=uD(e);t.forEach(function(a){var n=ND.bind(null,e,a);r.has(a)||(r.add(a),a.then(n,n))})}function ua(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var n=r[a],i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 27:case 5:Ar=o.stateNode,Js=!1;break e;case 3:Ar=o.stateNode.containerInfo,Js=!0;break e;case 4:Ar=o.stateNode.containerInfo,Js=!0;break e}o=o.return}if(Ar===null)throw Error(Se(160));h9(i,l,n),Ar=null,Js=!1,i=n.alternate,i!==null&&(i.return=null),n.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)g9(t,e),t=t.sibling}var Wa=null;function g9(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ua(t,e),fa(e),a&4&&(Ji(3,e,e.return),Px(3,e),Ji(5,e,e.return));break;case 1:ua(t,e),fa(e),a&512&&(cr||r===null||ra(r,r.return)),a&64&&Hn&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?a:r.concat(a))));break;case 26:var n=Wa;if(ua(t,e),fa(e),a&512&&(cr||r===null||ra(r,r.return)),a&4){var i=r!==null?r.memoizedState:null;if(a=e.memoizedState,r===null)if(a===null)if(e.stateNode===null){e:{a=e.type,r=e.memoizedProps,n=n.ownerDocument||n;t:switch(a){case"title":i=n.getElementsByTagName("title")[0],(!i||i[Ld]||i[vs]||i.namespaceURI==="http://www.w3.org/2000/svg"||i.hasAttribute("itemprop"))&&(i=n.createElement(a),n.head.insertBefore(i,n.querySelector("head > title"))),cs(i,a,r),i[vs]=e,Yr(i),a=i;break e;case"link":var l=hw("link","href",n).get(a+(r.href||""));if(l){for(var o=0;o<l.length;o++)if(i=l[o],i.getAttribute("href")===(r.href==null?null:r.href)&&i.getAttribute("rel")===(r.rel==null?null:r.rel)&&i.getAttribute("title")===(r.title==null?null:r.title)&&i.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){l.splice(o,1);break t}}i=n.createElement(a),cs(i,a,r),n.head.appendChild(i);break;case"meta":if(l=hw("meta","content",n).get(a+(r.content||""))){for(o=0;o<l.length;o++)if(i=l[o],i.getAttribute("content")===(r.content==null?null:""+r.content)&&i.getAttribute("name")===(r.name==null?null:r.name)&&i.getAttribute("property")===(r.property==null?null:r.property)&&i.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&i.getAttribute("charset")===(r.charSet==null?null:r.charSet)){l.splice(o,1);break t}}i=n.createElement(a),cs(i,a,r),n.head.appendChild(i);break;default:throw Error(Se(468,a))}i[vs]=e,Yr(i),a=i}e.stateNode=a}else mw(n,e.type,e.stateNode);else e.stateNode=fw(n,a,e.memoizedProps);else i!==a?(i===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):i.count--,a===null?mw(n,e.type,e.stateNode):fw(n,a,e.memoizedProps)):a===null&&e.stateNode!==null&&X2(e,e.memoizedProps,r.memoizedProps)}break;case 27:if(a&4&&e.alternate===null){n=e.stateNode,i=e.memoizedProps;try{for(var c=n.firstChild;c;){var d=c.nextSibling,x=c.nodeName;c[Ld]||x==="HEAD"||x==="BODY"||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&c.rel.toLowerCase()==="stylesheet"||n.removeChild(c),c=d}for(var u=e.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);cs(n,u,i),n[vs]=e,n[Gs]=i}catch(p){Ot(e,e.return,p)}}case 5:if(ua(t,e),fa(e),a&512&&(cr||r===null||ra(r,r.return)),e.flags&32){n=e.stateNode;try{Rc(n,"")}catch(p){Ot(e,e.return,p)}}a&4&&e.stateNode!=null&&(n=e.memoizedProps,X2(e,n,r!==null?r.memoizedProps:n)),a&1024&&(Gm=!0);break;case 6:if(ua(t,e),fa(e),a&4){if(e.stateNode===null)throw Error(Se(162));a=e.memoizedProps,r=e.stateNode;try{r.nodeValue=a}catch(p){Ot(e,e.return,p)}}break;case 3:if(df=null,n=Wa,Wa=Uf(t.containerInfo),ua(t,e),Wa=n,fa(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{Qd(t.containerInfo)}catch(p){Ot(e,e.return,p)}Gm&&(Gm=!1,p9(e));break;case 4:a=Wa,Wa=Uf(e.stateNode.containerInfo),ua(t,e),fa(e),Wa=a;break;case 12:ua(t,e),fa(e);break;case 13:ua(t,e),fa(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Yv=En()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,Ym(e,a)));break;case 22:if(a&512&&(cr||r===null||ra(r,r.return)),c=e.memoizedState!==null,d=r!==null&&r.memoizedState!==null,x=Hn,u=cr,Hn=x||c,cr=u||d,ua(t,e),cr=u,Hn=x,fa(e),t=e.stateNode,t._current=e,t._visibility&=-3,t._visibility|=t._pendingVisibility&2,a&8192&&(t._visibility=c?t._visibility&-2:t._visibility|1,c&&(t=Hn||cr,r===null||d||t||Yo(e)),e.memoizedProps===null||e.memoizedProps.mode!=="manual"))e:for(r=null,t=e;;){if(t.tag===5||t.tag===26||t.tag===27){if(r===null){d=r=t;try{if(n=d.stateNode,c)i=n.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none";else{l=d.stateNode,o=d.memoizedProps.style;var h=o!=null&&o.hasOwnProperty("display")?o.display:null;l.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(p){Ot(d,d.return,p)}}}else if(t.tag===6){if(r===null){d=t;try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(p){Ot(d,d.return,p)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(r=a.retryQueue,r!==null&&(a.retryQueue=null,Ym(e,r))));break;case 19:ua(t,e),fa(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,Ym(e,a)));break;case 21:break;default:ua(t,e),fa(e)}}function fa(e){var t=e.flags;if(t&2){try{if(e.tag!==27){e:{for(var r=e.return;r!==null;){if(x9(r)){var a=r;break e}r=r.return}throw Error(Se(160))}switch(a.tag){case 27:var n=a.stateNode,i=Wm(e);Tf(e,i,n);break;case 5:var l=a.stateNode;a.flags&32&&(Rc(l,""),a.flags&=-33);var o=Wm(e);Tf(e,o,l);break;case 3:case 4:var c=a.stateNode.containerInfo,d=Wm(e);Ip(e,d,c);break;default:throw Error(Se(161))}}}catch(x){Ot(e,e.return,x)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function p9(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;p9(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function $n(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)u9(e,t.alternate,t),t=t.sibling}function Yo(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ji(4,t,t.return),Yo(t);break;case 1:ra(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&c9(t,t.return,r),Yo(t);break;case 26:case 27:case 5:ra(t,t.return),Yo(t);break;case 22:ra(t,t.return),t.memoizedState===null&&Yo(t);break;default:Yo(t)}e=e.sibling}}function Ni(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,n=e,i=t,l=i.flags;switch(i.tag){case 0:case 11:case 15:Ni(n,i,r),Px(4,i);break;case 1:if(Ni(n,i,r),a=i,n=a.stateNode,typeof n.componentDidMount=="function")try{n.componentDidMount()}catch(d){Ot(a,a.return,d)}if(a=i,n=a.updateQueue,n!==null){var o=a.stateNode;try{var c=n.shared.hiddenCallbacks;if(c!==null)for(n.shared.hiddenCallbacks=null,n=0;n<c.length;n++)i9(c[n],o)}catch(d){Ot(a,a.return,d)}}r&&l&64&&o9(i),Ol(i,i.return);break;case 26:case 27:case 5:Ni(n,i,r),r&&a===null&&l&4&&d9(i),Ol(i,i.return);break;case 12:Ni(n,i,r);break;case 13:Ni(n,i,r),r&&l&4&&m9(n,i);break;case 22:i.memoizedState===null&&Ni(n,i,r),Ol(i,i.return);break;default:Ni(n,i,r)}t=t.sibling}}function qv(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Mx(r))}function Vv(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Mx(e))}function wi(e,t,r,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)v9(e,t,r,a),t=t.sibling}function v9(e,t,r,a){var n=t.flags;switch(t.tag){case 0:case 11:case 15:wi(e,t,r,a),n&2048&&Px(9,t);break;case 3:wi(e,t,r,a),n&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Mx(e)));break;case 12:if(n&2048){wi(e,t,r,a),e=t.stateNode;try{var i=t.memoizedProps,l=i.id,o=i.onPostCommit;typeof o=="function"&&o(l,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(c){Ot(t,t.return,c)}}else wi(e,t,r,a);break;case 23:break;case 22:i=t.stateNode,t.memoizedState!==null?i._visibility&4?wi(e,t,r,a):xd(e,t):i._visibility&4?wi(e,t,r,a):(i._visibility|=4,Xo(e,t,r,a,(t.subtreeFlags&10256)!==0)),n&2048&&qv(t.alternate,t);break;case 24:wi(e,t,r,a),n&2048&&Vv(t.alternate,t);break;default:wi(e,t,r,a)}}function Xo(e,t,r,a,n){for(n=n&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var i=e,l=t,o=r,c=a,d=l.flags;switch(l.tag){case 0:case 11:case 15:Xo(i,l,o,c,n),Px(8,l);break;case 23:break;case 22:var x=l.stateNode;l.memoizedState!==null?x._visibility&4?Xo(i,l,o,c,n):xd(i,l):(x._visibility|=4,Xo(i,l,o,c,n)),n&&d&2048&&qv(l.alternate,l);break;case 24:Xo(i,l,o,c,n),n&&d&2048&&Vv(l.alternate,l);break;default:Xo(i,l,o,c,n)}t=t.sibling}}function xd(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,a=t,n=a.flags;switch(a.tag){case 22:xd(r,a),n&2048&&qv(a.alternate,a);break;case 24:xd(r,a),n&2048&&Vv(a.alternate,a);break;default:xd(r,a)}t=t.sibling}}var G0=8192;function Ro(e){if(e.subtreeFlags&G0)for(e=e.child;e!==null;)b9(e),e=e.sibling}function b9(e){switch(e.tag){case 26:Ro(e),e.flags&G0&&e.memoizedState!==null&&eS(Wa,e.memoizedState,e.memoizedProps);break;case 5:Ro(e);break;case 3:case 4:var t=Wa;Wa=Uf(e.stateNode.containerInfo),Ro(e),Wa=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=G0,G0=16777216,Ro(e),G0=t):Ro(e));break;default:Ro(e)}}function y9(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function F0(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];Hr=a,E9(a,e)}y9(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)w9(e),e=e.sibling}function w9(e){switch(e.tag){case 0:case 11:case 15:F0(e),e.flags&2048&&Ji(9,e,e.return);break;case 3:F0(e);break;case 12:F0(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&4&&(e.return===null||e.return.tag!==13)?(t._visibility&=-5,lf(e)):F0(e);break;default:F0(e)}}function lf(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];Hr=a,E9(a,e)}y9(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ji(8,t,t.return),lf(t);break;case 22:r=t.stateNode,r._visibility&4&&(r._visibility&=-5,lf(t));break;default:lf(t)}e=e.sibling}}function E9(e,t){for(;Hr!==null;){var r=Hr;switch(r.tag){case 0:case 11:case 15:Ji(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var a=r.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:Mx(r.memoizedState.cache)}if(a=r.child,a!==null)a.return=r,Hr=a;else e:for(r=e;Hr!==null;){a=Hr;var n=a.sibling,i=a.return;if(f9(a),a===r){Hr=null;break e}if(n!==null){n.return=i,Hr=n;break e}Hr=i}}}function fD(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sa(e,t,r,a){return new fD(e,t,r,a)}function Hv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Hi(e,t){var r=e.alternate;return r===null?(r=Sa(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&31457280,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function _9(e,t){e.flags&=31457282;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function of(e,t,r,a,n,i){var l=0;if(a=e,typeof e=="function")Hv(e)&&(l=1);else if(typeof e=="string")l=JD(e,r,wn.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ec:return ql(r.children,n,i,t);case j6:l=8,n|=24;break;case op:return e=Sa(12,r,t,n|2),e.elementType=op,e.lanes=i,e;case cp:return e=Sa(13,r,t,n),e.elementType=cp,e.lanes=i,e;case dp:return e=Sa(19,r,t,n),e.elementType=dp,e.lanes=i,e;case C6:return j9(r,n,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case L7:case Kn:l=10;break e;case N6:l=9;break e;case uv:l=11;break e;case fv:l=14;break e;case ki:l=16,a=null;break e}l=29,r=Error(Se(130,e===null?"null":typeof e,"")),a=null}return t=Sa(l,r,t,n),t.elementType=e,t.type=a,t.lanes=i,t}function ql(e,t,r,a){return e=Sa(7,e,a,t),e.lanes=r,e}function j9(e,t,r,a){e=Sa(22,e,a,t),e.elementType=C6,e.lanes=r;var n={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var i=n._current;if(i===null)throw Error(Se(456));if(!(n._pendingVisibility&2)){var l=Ki(i,2);l!==null&&(n._pendingVisibility|=2,Ts(l,i,2))}},attach:function(){var i=n._current;if(i===null)throw Error(Se(456));if(n._pendingVisibility&2){var l=Ki(i,2);l!==null&&(n._pendingVisibility&=-3,Ts(l,i,2))}}};return e.stateNode=n,e}function Xm(e,t,r){return e=Sa(6,e,null,t),e.lanes=r,e}function Km(e,t,r){return t=Sa(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zn(e){e.flags|=4}function J2(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!H9(t)){if(t=Ra.current,t!==null&&((_t&4194176)===_t?_n!==null:(_t&62914560)!==_t&&!(_t&536870912)||t!==_n))throw ad=_p,dE;e.flags|=8192}}function pu(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?T6():536870912,e.lanes|=t,Ic|=t)}function T0(e,t){if(!At)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags&31457280,a|=n.flags&31457280,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function hD(e,t,r){var a=t.pendingProps;switch(Nv(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(t),null;case 1:return Zt(t),null;case 3:return r=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),ri(Rr),Tc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(S0(t)?zn(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ya!==null&&(Vp(Ya),Ya=null))),Zt(t),null;case 26:return r=t.memoizedState,e===null?(zn(t),r!==null?(Zt(t),J2(t,r)):(Zt(t),t.flags&=-16777217)):r?r!==e.memoizedState?(zn(t),Zt(t),J2(t,r)):(Zt(t),t.flags&=-16777217):(e.memoizedProps!==a&&zn(t),Zt(t),t.flags&=-16777217),null;case 27:bf(t),r=zi.current;var n=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==a&&zn(t);else{if(!a){if(t.stateNode===null)throw Error(Se(166));return Zt(t),null}e=wn.current,S0(t)?k2(t):(e=z9(n,a,r),t.stateNode=e,zn(t))}return Zt(t),null;case 5:if(bf(t),r=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&zn(t);else{if(!a){if(t.stateNode===null)throw Error(Se(166));return Zt(t),null}if(e=wn.current,S0(t))k2(t);else{switch(n=If(zi.current),e){case 1:e=n.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:e=n.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":e=n.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":e=n.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":e=n.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof a.is=="string"?n.createElement("select",{is:a.is}):n.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e=typeof a.is=="string"?n.createElement(r,{is:a.is}):n.createElement(r)}}e[vs]=t,e[Gs]=a;e:for(n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.tag!==27&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}t.stateNode=e;e:switch(cs(e,r,a),r){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&zn(t)}}return Zt(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&zn(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Se(166));if(e=zi.current,S0(t)){if(e=t.stateNode,r=t.memoizedProps,a=null,n=Ss,n!==null)switch(n.tag){case 27:case 5:a=n.memoizedProps}e[vs]=t,e=!!(e.nodeValue===r||a!==null&&a.suppressHydrationWarning===!0||I9(e.nodeValue,r)),e||to(t)}else e=If(e).createTextNode(a),e[vs]=t,t.stateNode=e}return Zt(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(n=S0(t),a!==null&&a.dehydrated!==null){if(e===null){if(!n)throw Error(Se(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Se(317));n[vs]=t}else Tx(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Zt(t),n=!1}else Ya!==null&&(Vp(Ya),Ya=null),n=!0;if(!n)return t.flags&256?(Zn(t),t):(Zn(t),null)}if(Zn(t),t.flags&128)return t.lanes=r,t;if(r=a!==null,e=e!==null&&e.memoizedState!==null,r){a=t.child,n=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(n=a.alternate.memoizedState.cachePool.pool);var i=null;a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==n&&(a.flags|=2048)}return r!==e&&r&&(t.child.flags|=8192),pu(t,t.updateQueue),Zt(t),null;case 4:return Tc(),e===null&&Qv(t.stateNode.containerInfo),Zt(t),null;case 10:return ri(t.type),Zt(t),null;case 19:if(Jr(Pr),n=t.memoizedState,n===null)return Zt(t),null;if(a=(t.flags&128)!==0,i=n.rendering,i===null)if(a)T0(n,!1);else{if(ur!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Af(e),i!==null){for(t.flags|=128,T0(n,!1),e=i.updateQueue,t.updateQueue=e,pu(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)_9(r,e),r=r.sibling;return Xt(Pr,Pr.current&1|2),t.child}e=e.sibling}n.tail!==null&&En()>Mf&&(t.flags|=128,a=!0,T0(n,!1),t.lanes=4194304)}else{if(!a)if(e=Af(i),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,pu(t,e),T0(n,!0),n.tail===null&&n.tailMode==="hidden"&&!i.alternate&&!At)return Zt(t),null}else 2*En()-n.renderingStartTime>Mf&&r!==536870912&&(t.flags|=128,a=!0,T0(n,!1),t.lanes=4194304);n.isBackwards?(i.sibling=t.child,t.child=i):(e=n.last,e!==null?e.sibling=i:t.child=i,n.last=i)}return n.tail!==null?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=En(),t.sibling=null,e=Pr.current,Xt(Pr,a?e&1|2:e&1),t):(Zt(t),null);case 22:case 23:return Zn(t),Cv(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?r&536870912&&!(t.flags&128)&&(Zt(t),t.subtreeFlags&6&&(t.flags|=8192)):Zt(t),r=t.updateQueue,r!==null&&pu(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==r&&(t.flags|=2048),e!==null&&Jr(zl),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),ri(Rr),Zt(t),null;case 25:return null}throw Error(Se(156,t.tag))}function mD(e,t){switch(Nv(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ri(Rr),Tc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return bf(t),null;case 13:if(Zn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Se(340));Tx()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Jr(Pr),null;case 4:return Tc(),null;case 10:return ri(t.type),null;case 22:case 23:return Zn(t),Cv(),e!==null&&Jr(zl),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return ri(Rr),null;case 25:return null;default:return null}}function N9(e,t){switch(Nv(t),t.tag){case 3:ri(Rr),Tc();break;case 26:case 27:case 5:bf(t);break;case 4:Tc();break;case 13:Zn(t);break;case 19:Jr(Pr);break;case 10:ri(t.type);break;case 22:case 23:Zn(t),Cv(),e!==null&&Jr(zl);break;case 24:ri(Rr)}}var gD={getCacheForType:function(e){var t=bs(Rr),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r}},pD=typeof WeakMap=="function"?WeakMap:Map,sr=0,Ut=null,gt=null,_t=0,It=0,Zs=null,Wn=!1,o0=!1,Wv=!1,ci=0,ur=0,Zi=0,Vl=0,Gv=0,Ba=0,Ic=0,ud=null,pn=null,Up=!1,Yv=0,Mf=1/0,Rf=null,Wi=null,vu=!1,Bl=null,fd=0,$p=0,zp=null,hd=0,qp=null;function la(){if(sr&2&&_t!==0)return _t&-_t;if(ot.T!==null){var e=Pc;return e!==0?e:Kv()}return P6()}function C9(){Ba===0&&(Ba=!(_t&536870912)||At?F6():536870912);var e=Ra.current;return e!==null&&(e.flags|=32),Ba}function Ts(e,t,r){(e===Ut&&It===2||e.cancelPendingCommit!==null)&&(Uc(e,0),Gn(e,_t,Ba,!1)),Bx(e,r),(!(sr&2)||e!==Ut)&&(e===Ut&&(!(sr&2)&&(Vl|=r),ur===4&&Gn(e,_t,Ba,!1)),Mn(e))}function A9(e,t,r){if(sr&6)throw Error(Se(327));var a=!r&&(t&60)===0&&(t&e.expiredLanes)===0||Sx(e,t),n=a?yD(e,t):Qm(e,t,!0),i=a;do{if(n===0){o0&&!a&&Gn(e,t,0,!1);break}else if(n===6)Gn(e,t,0,!Wn);else{if(r=e.current.alternate,i&&!vD(r)){n=Qm(e,t,!1),i=!1;continue}if(n===2){if(i=t,e.errorRecoveryDisabledLanes&i)var l=0;else l=e.pendingLanes&-536870913,l=l!==0?l:l&536870912?536870912:0;if(l!==0){t=l;e:{var o=e;n=ud;var c=o.current.memoizedState.isDehydrated;if(c&&(Uc(o,l).flags|=256),l=Qm(o,l,!1),l!==2){if(Wv&&!c){o.errorRecoveryDisabledLanes|=i,Vl|=i,n=4;break e}i=pn,pn=n,i!==null&&Vp(i)}n=l}if(i=!1,n!==2)continue}}if(n===1){Uc(e,0),Gn(e,t,0,!0);break}e:{switch(a=e,n){case 0:case 1:throw Error(Se(345));case 4:if((t&4194176)===t){Gn(a,t,Ba,!Wn);break e}break;case 2:pn=null;break;case 3:case 5:break;default:throw Error(Se(329))}if(a.finishedWork=r,a.finishedLanes=t,(t&62914560)===t&&(i=Yv+300-En(),10<i)){if(Gn(a,t,Ba,!Wn),Sh(a,0)!==0)break e;a.timeoutHandle=$9(Z2.bind(null,a,r,pn,Rf,Up,t,Ba,Vl,Ic,Wn,2,-0,0),i);break e}Z2(a,r,pn,Rf,Up,t,Ba,Vl,Ic,Wn,0,-0,0)}}break}while(!0);Mn(e)}function Vp(e){pn===null?pn=e:pn.push.apply(pn,e)}function Z2(e,t,r,a,n,i,l,o,c,d,x,u,f){var h=t.subtreeFlags;if((h&8192||(h&16785408)===16785408)&&(Gd={stylesheets:null,count:0,unsuspend:ZD},b9(t),t=tS(),t!==null)){e.cancelPendingCommit=t(tw.bind(null,e,r,a,n,l,o,c,1,u,f)),Gn(e,i,l,!d);return}tw(e,r,a,n,l,o,c,x,u,f)}function vD(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var a=0;a<r.length;a++){var n=r[a],i=n.getSnapshot;n=n.value;try{if(!oa(i(),n))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gn(e,t,r,a){t&=~Gv,t&=~Vl,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var n=t;0<n;){var i=31-ia(n),l=1<<i;a[i]=-1,n&=~l}r!==0&&M6(e,r,t)}function Uh(){return sr&6?!0:(Lx(0),!1)}function Xv(){if(gt!==null){if(It===0)var e=gt.return;else e=gt,ei=No=null,Tv(e),wc=null,qd=0,e=gt;for(;e!==null;)N9(e.alternate,e),e=e.return;gt=null}}function Uc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,PD(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),Xv(),Ut=e,gt=r=Hi(e.current,null),_t=t,It=0,Zs=null,Wn=!1,o0=Sx(e,t),Wv=!1,Ic=Ba=Gv=Vl=Zi=ur=0,pn=ud=null,Up=!1,t&8&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var n=31-ia(a),i=1<<n;t|=e[n],a&=~i}return ci=t,Mh(),r}function k9(e,t){ut=null,ot.H=An,t===sd?(t=B2(),It=3):t===dE?(t=B2(),It=4):It=t===ZE?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Zs=t,gt===null&&(ur=1,Bf(e,Da(t,e.current)))}function D9(){var e=ot.H;return ot.H=An,e===null?An:e}function S9(){var e=ot.A;return ot.A=gD,e}function Hp(){ur=4,Wn||(_t&4194176)!==_t&&Ra.current!==null||(o0=!0),!(Zi&134217727)&&!(Vl&134217727)||Ut===null||Gn(Ut,_t,Ba,!1)}function Qm(e,t,r){var a=sr;sr|=2;var n=D9(),i=S9();(Ut!==e||_t!==t)&&(Rf=null,Uc(e,t)),t=!1;var l=ur;e:do try{if(It!==0&&gt!==null){var o=gt,c=Zs;switch(It){case 8:Xv(),l=6;break e;case 3:case 2:case 6:Ra.current===null&&(t=!0);var d=It;if(It=0,Zs=null,dc(e,o,c,d),r&&o0){l=0;break e}break;default:d=It,It=0,Zs=null,dc(e,o,c,d)}}bD(),l=ur;break}catch(x){k9(e,x)}while(!0);return t&&e.shellSuspendCounter++,ei=No=null,sr=a,ot.H=n,ot.A=i,gt===null&&(Ut=null,_t=0,Mh()),l}function bD(){for(;gt!==null;)B9(gt)}function yD(e,t){var r=sr;sr|=2;var a=D9(),n=S9();Ut!==e||_t!==t?(Rf=null,Mf=En()+500,Uc(e,t)):o0=Sx(e,t);e:do try{if(It!==0&&gt!==null){t=gt;var i=Zs;t:switch(It){case 1:It=0,Zs=null,dc(e,t,i,1);break;case 2:if(S2(i)){It=0,Zs=null,ew(t);break}t=function(){It===2&&Ut===e&&(It=7),Mn(e)},i.then(t,t);break e;case 3:It=7;break e;case 4:It=5;break e;case 7:S2(i)?(It=0,Zs=null,ew(t)):(It=0,Zs=null,dc(e,t,i,7));break;case 5:var l=null;switch(gt.tag){case 26:l=gt.memoizedState;case 5:case 27:var o=gt;if(!l||H9(l)){It=0,Zs=null;var c=o.sibling;if(c!==null)gt=c;else{var d=o.return;d!==null?(gt=d,$h(d)):gt=null}break t}}It=0,Zs=null,dc(e,t,i,5);break;case 6:It=0,Zs=null,dc(e,t,i,6);break;case 8:Xv(),ur=6;break e;default:throw Error(Se(462))}}wD();break}catch(x){k9(e,x)}while(!0);return ei=No=null,ot.H=a,ot.A=n,sr=r,gt!==null?0:(Ut=null,_t=0,Mh(),ur)}function wD(){for(;gt!==null&&!q7();)B9(gt)}function B9(e){var t=a9(e.alternate,e,ci);e.memoizedProps=e.pendingProps,t===null?$h(e):gt=t}function ew(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=H2(r,t,t.pendingProps,t.type,void 0,_t);break;case 11:t=H2(r,t,t.pendingProps,t.type.render,t.ref,_t);break;case 5:Tv(t);default:N9(r,t),t=gt=_9(t,ci),t=a9(r,t,ci)}e.memoizedProps=e.pendingProps,t===null?$h(e):gt=t}function dc(e,t,r,a){ei=No=null,Tv(t),wc=null,qd=0;var n=t.return;try{if(cD(e,n,t,r,_t)){ur=1,Bf(e,Da(r,e.current)),gt=null;return}}catch(i){if(n!==null)throw gt=n,i;ur=1,Bf(e,Da(r,e.current)),gt=null;return}t.flags&32768?(At||a===1?e=!0:o0||_t&536870912?e=!1:(Wn=e=!0,(a===2||a===3||a===6)&&(a=Ra.current,a!==null&&a.tag===13&&(a.flags|=16384))),F9(t,e)):$h(t)}function $h(e){var t=e;do{if(t.flags&32768){F9(t,Wn);return}e=t.return;var r=hD(t.alternate,t,ci);if(r!==null){gt=r;return}if(t=t.sibling,t!==null){gt=t;return}gt=t=e}while(t!==null);ur===0&&(ur=5)}function F9(e,t){do{var r=mD(e.alternate,e);if(r!==null){r.flags&=32767,gt=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){gt=e;return}gt=e=r}while(e!==null);ur=6,gt=null}function tw(e,t,r,a,n,i,l,o,c,d){var x=ot.T,u=Vt.p;try{Vt.p=2,ot.T=null,ED(e,t,r,a,u,n,i,l,o,c,d)}finally{ot.T=x,Vt.p=u}}function ED(e,t,r,a,n,i,l,o){do Nc();while(Bl!==null);if(sr&6)throw Error(Se(327));var c=e.finishedWork;if(a=e.finishedLanes,c===null)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(Se(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var d=c.lanes|c.childLanes;if(d|=Ev,ek(e,a,d,i,l,o),e===Ut&&(gt=Ut=null,_t=0),!(c.subtreeFlags&10256)&&!(c.flags&10256)||vu||(vu=!0,$p=d,zp=r,CD(yf,function(){return Nc(),null})),r=(c.flags&15990)!==0,c.subtreeFlags&15990||r?(r=ot.T,ot.T=null,i=Vt.p,Vt.p=2,l=sr,sr|=4,xD(e,c),g9(c,e),Wk(Xp,e.containerInfo),qf=!!Yp,Xp=Yp=null,e.current=c,u9(e,c.alternate,c),V7(),sr=l,Vt.p=i,ot.T=r):e.current=c,vu?(vu=!1,Bl=e,fd=a):T9(e,d),d=e.pendingLanes,d===0&&(Wi=null),X7(c.stateNode),Mn(e),t!==null)for(n=e.onRecoverableError,c=0;c<t.length;c++)d=t[c],n(d.value,{componentStack:d.stack});return fd&3&&Nc(),d=e.pendingLanes,a&4194218&&d&42?e===qp?hd++:(hd=0,qp=e):hd=0,Lx(0),null}function T9(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Mx(t)))}function Nc(){if(Bl!==null){var e=Bl,t=$p;$p=0;var r=O6(fd),a=ot.T,n=Vt.p;try{if(Vt.p=32>r?32:r,ot.T=null,Bl===null)var i=!1;else{r=zp,zp=null;var l=Bl,o=fd;if(Bl=null,fd=0,sr&6)throw Error(Se(331));var c=sr;if(sr|=4,w9(l.current),v9(l,l.current,o,r),sr=c,Lx(0,!1),na&&typeof na.onPostCommitFiberRoot=="function")try{na.onPostCommitFiberRoot(Dx,l)}catch{}i=!0}return i}finally{Vt.p=n,ot.T=a,T9(e,t)}}return!1}function rw(e,t,r){t=Da(r,t),t=Sp(e.stateNode,t,2),e=Vi(e,t,2),e!==null&&(Bx(e,2),Mn(e))}function Ot(e,t,r){if(e.tag===3)rw(e,e,r);else for(;t!==null;){if(t.tag===3){rw(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Wi===null||!Wi.has(a))){e=Da(r,e),r=QE(2),a=Vi(t,r,2),a!==null&&(JE(r,a,t,e),Bx(a,2),Mn(a));break}}t=t.return}}function Jm(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new pD;var n=new Set;a.set(t,n)}else n=a.get(t),n===void 0&&(n=new Set,a.set(t,n));n.has(r)||(Wv=!0,n.add(r),e=_D.bind(null,e,t,r),t.then(e,e))}function _D(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Ut===e&&(_t&r)===r&&(ur===4||ur===3&&(_t&62914560)===_t&&300>En()-Yv?!(sr&2)&&Uc(e,0):Gv|=r,Ic===_t&&(Ic=0)),Mn(e)}function M9(e,t){t===0&&(t=T6()),e=Ki(e,t),e!==null&&(Bx(e,t),Mn(e))}function jD(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),M9(e,r)}function ND(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(Se(314))}a!==null&&a.delete(t),M9(e,r)}function CD(e,t){return hv(e,t)}var Of=null,Ko=null,Wp=!1,Pf=!1,Zm=!1,Hl=0;function Mn(e){e!==Ko&&e.next===null&&(Ko===null?Of=Ko=e:Ko=Ko.next=e),Pf=!0,Wp||(Wp=!0,kD(AD))}function Lx(e,t){if(!Zm&&Pf){Zm=!0;do for(var r=!1,a=Of;a!==null;){if(e!==0){var n=a.pendingLanes;if(n===0)var i=0;else{var l=a.suspendedLanes,o=a.pingedLanes;i=(1<<31-ia(42|e)+1)-1,i&=n&~(l&~o),i=i&201326677?i&201326677|1:i?i|2:0}i!==0&&(r=!0,sw(a,i))}else i=_t,i=Sh(a,a===Ut?i:0),!(i&3)||Sx(a,i)||(r=!0,sw(a,i));a=a.next}while(r);Zm=!1}}function AD(){Pf=Wp=!1;var e=0;Hl!==0&&(OD()&&(e=Hl),Hl=0);for(var t=En(),r=null,a=Of;a!==null;){var n=a.next,i=R9(a,t);i===0?(a.next=null,r===null?Of=n:r.next=n,n===null&&(Ko=r)):(r=a,(e!==0||i&3)&&(Pf=!0)),a=n}Lx(e)}function R9(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,n=e.expirationTimes,i=e.pendingLanes&-62914561;0<i;){var l=31-ia(i),o=1<<l,c=n[l];c===-1?(!(o&r)||o&a)&&(n[l]=Z7(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}if(t=Ut,r=_t,r=Sh(e,e===t?r:0),a=e.callbackNode,r===0||e===t&&It===2||e.cancelPendingCommit!==null)return a!==null&&a!==null&&Dm(a),e.callbackNode=null,e.callbackPriority=0;if(!(r&3)||Sx(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(a!==null&&Dm(a),O6(r)){case 2:case 8:r=S6;break;case 32:r=yf;break;case 268435456:r=B6;break;default:r=yf}return a=O9.bind(null,e),r=hv(r,a),e.callbackPriority=t,e.callbackNode=r,t}return a!==null&&a!==null&&Dm(a),e.callbackPriority=2,e.callbackNode=null,2}function O9(e,t){var r=e.callbackNode;if(Nc()&&e.callbackNode!==r)return null;var a=_t;return a=Sh(e,e===Ut?a:0),a===0?null:(A9(e,a,t),R9(e,En()),e.callbackNode!=null&&e.callbackNode===r?O9.bind(null,e):null)}function sw(e,t){if(Nc())return null;A9(e,t,!0)}function kD(e){LD(function(){sr&6?hv(D6,e):e()})}function Kv(){return Hl===0&&(Hl=F6()),Hl}function aw(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ef(""+e)}function nw(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function DD(e,t,r,a,n){if(t==="submit"&&r&&r.stateNode===n){var i=aw((n[Gs]||null).action),l=a.submitter;l&&(t=(t=l[Gs]||null)?aw(t.formAction):l.getAttribute("formAction"),t!==null&&(i=t,l=null));var o=new Bh("action","action",null,a,n);e.push({event:o,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(Hl!==0){var c=l?nw(n,l):new FormData(n);kp(r,{pending:!0,data:c,method:n.method,action:i},null,c)}}else typeof i=="function"&&(o.preventDefault(),c=l?nw(n,l):new FormData(n),kp(r,{pending:!0,data:c,method:n.method,action:i},i,c))},currentTarget:n}]})}}for(var eg=0;eg<C2.length;eg++){var tg=C2[eg],SD=tg.toLowerCase(),BD=tg[0].toUpperCase()+tg.slice(1);ln(SD,"on"+BD)}ln(sE,"onAnimationEnd");ln(aE,"onAnimationIteration");ln(nE,"onAnimationStart");ln("dblclick","onDoubleClick");ln("focusin","onFocus");ln("focusout","onBlur");ln(Yk,"onTransitionRun");ln(Xk,"onTransitionStart");ln(Kk,"onTransitionCancel");ln(iE,"onTransitionEnd");Mc("onMouseEnter",["mouseout","mouseover"]);Mc("onMouseLeave",["mouseout","mouseover"]);Mc("onPointerEnter",["pointerout","pointerover"]);Mc("onPointerLeave",["pointerout","pointerover"]);yo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yo("onBeforeInput",["compositionend","keypress","textInput","paste"]);yo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hd));function P9(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],n=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var l=a.length-1;0<=l;l--){var o=a[l],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&n.isPropagationStopped())break e;i=o,n.currentTarget=d;try{i(n)}catch(x){Sf(x)}n.currentTarget=null,i=c}else for(l=0;l<a.length;l++){if(o=a[l],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&n.isPropagationStopped())break e;i=o,n.currentTarget=d;try{i(n)}catch(x){Sf(x)}n.currentTarget=null,i=c}}}}function bt(e,t){var r=t[mp];r===void 0&&(r=t[mp]=new Set);var a=e+"__bubble";r.has(a)||(L9(t,e,2,!1),r.add(a))}function rg(e,t,r){var a=0;t&&(a|=4),L9(r,e,a,t)}var bu="_reactListening"+Math.random().toString(36).slice(2);function Qv(e){if(!e[bu]){e[bu]=!0,L6.forEach(function(r){r!=="selectionchange"&&(FD.has(r)||rg(r,!1,e),rg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[bu]||(t[bu]=!0,rg("selectionchange",!1,t))}}function L9(e,t,r,a){switch(K9(t)){case 2:var n=aS;break;case 8:n=nS;break;default:n=tb}r=n.bind(null,t,r,e),n=void 0,!bp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),a?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function sg(e,t,r,a,n){var i=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var l=a.tag;if(l===3||l===4){var o=a.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(l===4)for(l=a.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;l=l.return}for(;o!==null;){if(l=Rl(o),l===null)return;if(c=l.tag,c===5||c===6||c===26||c===27){a=i=l;continue e}o=o.parentNode}}a=a.return}W6(function(){var d=i,x=pv(r),u=[];e:{var f=lE.get(e);if(f!==void 0){var h=Bh,p=e;switch(e){case"keypress":if(rf(r)===0)break e;case"keydown":case"keyup":h=Nk;break;case"focusin":p="focus",h=Mm;break;case"focusout":p="blur",h=Mm;break;case"beforeblur":case"afterblur":h=Mm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=h2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=fk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=kk;break;case sE:case aE:case nE:h=gk;break;case iE:h=Sk;break;case"scroll":case"scrollend":h=xk;break;case"wheel":h=Fk;break;case"copy":case"cut":case"paste":h=vk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=g2;break;case"toggle":case"beforetoggle":h=Mk}var g=(t&4)!==0,y=!g&&(e==="scroll"||e==="scrollend"),v=g?f!==null?f+"Capture":null:f;g=[];for(var w=d,m;w!==null;){var b=w;if(m=b.stateNode,b=b.tag,b!==5&&b!==26&&b!==27||m===null||v===null||(b=Id(w,v),b!=null&&g.push(Wd(w,b,m))),y)break;w=w.return}0<g.length&&(f=new h(f,p,null,r,x),u.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&r!==vp&&(p=r.relatedTarget||r.fromElement)&&(Rl(p)||p[i0]))break e;if((h||f)&&(f=x.window===x?x:(f=x.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=r.relatedTarget||r.toElement,h=d,p=p?Rl(p):null,p!==null&&(y=n0(p),g=p.tag,p!==y||g!==5&&g!==27&&g!==6)&&(p=null)):(h=null,p=d),h!==p)){if(g=h2,b="onMouseLeave",v="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=g2,b="onPointerLeave",v="onPointerEnter",w="pointer"),y=h==null?f:W0(h),m=p==null?f:W0(p),f=new g(b,w+"leave",h,r,x),f.target=y,f.relatedTarget=m,b=null,Rl(x)===d&&(g=new g(v,w+"enter",p,r,x),g.target=m,g.relatedTarget=y,b=g),y=b,h&&p)t:{for(g=h,v=p,w=0,m=g;m;m=Oo(m))w++;for(m=0,b=v;b;b=Oo(b))m++;for(;0<w-m;)g=Oo(g),w--;for(;0<m-w;)v=Oo(v),m--;for(;w--;){if(g===v||v!==null&&g===v.alternate)break t;g=Oo(g),v=Oo(v)}g=null}else g=null;h!==null&&iw(u,f,h,g,!1),p!==null&&y!==null&&iw(u,y,p,g,!0)}}e:{if(f=d?W0(d):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var _=y2;else if(b2(f))if(J6)_=Vk;else{_=zk;var C=$k}else h=f.nodeName,!h||h.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?d&&gv(d.elementType)&&(_=y2):_=qk;if(_&&(_=_(e,d))){Q6(u,_,r,x);break e}C&&C(e,f,d),e==="focusout"&&d&&f.type==="number"&&d.memoizedProps.value!=null&&pp(f,"number",f.value)}switch(C=d?W0(d):window,e){case"focusin":(b2(C)||C.contentEditable==="true")&&(ac=C,yp=d,rd=null);break;case"focusout":rd=yp=ac=null;break;case"mousedown":wp=!0;break;case"contextmenu":case"mouseup":case"dragend":wp=!1,N2(u,r,x);break;case"selectionchange":if(Gk)break;case"keydown":case"keyup":N2(u,r,x)}var j;if(yv)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else sc?X6(e,r)&&(D="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(Y6&&r.locale!=="ko"&&(sc||D!=="onCompositionStart"?D==="onCompositionEnd"&&sc&&(j=G6()):(Pi=x,vv="value"in Pi?Pi.value:Pi.textContent,sc=!0)),C=Lf(d,D),0<C.length&&(D=new m2(D,e,null,r,x),u.push({event:D,listeners:C}),j?D.data=j:(j=K6(r),j!==null&&(D.data=j)))),(j=Ok?Pk(e,r):Lk(e,r))&&(D=Lf(d,"onBeforeInput"),0<D.length&&(C=new m2("onBeforeInput","beforeinput",null,r,x),u.push({event:C,listeners:D}),C.data=j)),DD(u,e,d,r,x)}P9(u,t)})}function Wd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Lf(e,t){for(var r=t+"Capture",a=[];e!==null;){var n=e,i=n.stateNode;n=n.tag,n!==5&&n!==26&&n!==27||i===null||(n=Id(e,r),n!=null&&a.unshift(Wd(e,n,i)),n=Id(e,t),n!=null&&a.push(Wd(e,n,i))),e=e.return}return a}function Oo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function iw(e,t,r,a,n){for(var i=t._reactName,l=[];r!==null&&r!==a;){var o=r,c=o.alternate,d=o.stateNode;if(o=o.tag,c!==null&&c===a)break;o!==5&&o!==26&&o!==27||d===null||(c=d,n?(d=Id(r,i),d!=null&&l.unshift(Wd(r,d,c))):n||(d=Id(r,i),d!=null&&l.push(Wd(r,d,c)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var TD=/\r\n?/g,MD=/\u0000|\uFFFD/g;function lw(e){return(typeof e=="string"?e:""+e).replace(TD,`
`).replace(MD,"")}function I9(e,t){return t=lw(t),lw(e)===t}function zh(){}function Tt(e,t,r,a,n,i){switch(r){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||Rc(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&Rc(e,""+a);break;case"className":xu(e,"class",a);break;case"tabIndex":xu(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":xu(e,r,a);break;case"style":H6(e,a,i);break;case"data":if(t!=="object"){xu(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=ef(""+a),e.setAttribute(r,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof i=="function"&&(r==="formAction"?(t!=="input"&&Tt(e,t,"name",n.name,n,null),Tt(e,t,"formEncType",n.formEncType,n,null),Tt(e,t,"formMethod",n.formMethod,n,null),Tt(e,t,"formTarget",n.formTarget,n,null)):(Tt(e,t,"encType",n.encType,n,null),Tt(e,t,"method",n.method,n,null),Tt(e,t,"target",n.target,n,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=ef(""+a),e.setAttribute(r,a);break;case"onClick":a!=null&&(e.onclick=zh);break;case"onScroll":a!=null&&bt("scroll",e);break;case"onScrollEnd":a!=null&&bt("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(Se(61));if(r=a.__html,r!=null){if(n.children!=null)throw Error(Se(60));e.innerHTML=r}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}r=ef(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""+a):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":a===!0?e.setAttribute(r,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,a):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(r,a):e.removeAttribute(r);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(r):e.setAttribute(r,a);break;case"popover":bt("beforetoggle",e),bt("toggle",e),Zu(e,"popover",a);break;case"xlinkActuate":In(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":In(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":In(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":In(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":In(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":In(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":In(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":In(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":In(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":Zu(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=ck.get(r)||r,Zu(e,r,a))}}function Gp(e,t,r,a,n,i){switch(r){case"style":H6(e,a,i);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(Se(61));if(r=a.__html,r!=null){if(n.children!=null)throw Error(Se(60));e.innerHTML=r}}break;case"children":typeof a=="string"?Rc(e,a):(typeof a=="number"||typeof a=="bigint")&&Rc(e,""+a);break;case"onScroll":a!=null&&bt("scroll",e);break;case"onScrollEnd":a!=null&&bt("scrollend",e);break;case"onClick":a!=null&&(e.onclick=zh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!I6.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(n=r.endsWith("Capture"),t=r.slice(2,n?r.length-7:void 0),i=e[Gs]||null,i=i!=null?i[r]:null,typeof i=="function"&&e.removeEventListener(t,i,n),typeof a=="function")){typeof i!="function"&&i!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,a,n);break e}r in e?e[r]=a:a===!0?e.setAttribute(r,""):Zu(e,r,a)}}}function cs(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":bt("error",e),bt("load",e);var a=!1,n=!1,i;for(i in r)if(r.hasOwnProperty(i)){var l=r[i];if(l!=null)switch(i){case"src":a=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Se(137,t));default:Tt(e,t,i,l,r,null)}}n&&Tt(e,t,"srcSet",r.srcSet,r,null),a&&Tt(e,t,"src",r.src,r,null);return;case"input":bt("invalid",e);var o=i=l=n=null,c=null,d=null;for(a in r)if(r.hasOwnProperty(a)){var x=r[a];if(x!=null)switch(a){case"name":n=x;break;case"type":l=x;break;case"checked":c=x;break;case"defaultChecked":d=x;break;case"value":i=x;break;case"defaultValue":o=x;break;case"children":case"dangerouslySetInnerHTML":if(x!=null)throw Error(Se(137,t));break;default:Tt(e,t,a,x,r,null)}}z6(e,i,o,c,d,l,n,!1),wf(e);return;case"select":bt("invalid",e),a=l=i=null;for(n in r)if(r.hasOwnProperty(n)&&(o=r[n],o!=null))switch(n){case"value":i=o;break;case"defaultValue":l=o;break;case"multiple":a=o;default:Tt(e,t,n,o,r,null)}t=i,r=l,e.multiple=!!a,t!=null?bc(e,!!a,t,!1):r!=null&&bc(e,!!a,r,!0);return;case"textarea":bt("invalid",e),i=n=a=null;for(l in r)if(r.hasOwnProperty(l)&&(o=r[l],o!=null))switch(l){case"value":a=o;break;case"defaultValue":n=o;break;case"children":i=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(Se(91));break;default:Tt(e,t,l,o,r,null)}V6(e,a,n,i),wf(e);return;case"option":for(c in r)if(r.hasOwnProperty(c)&&(a=r[c],a!=null))switch(c){case"selected":e.selected=a&&typeof a!="function"&&typeof a!="symbol";break;default:Tt(e,t,c,a,r,null)}return;case"dialog":bt("cancel",e),bt("close",e);break;case"iframe":case"object":bt("load",e);break;case"video":case"audio":for(a=0;a<Hd.length;a++)bt(Hd[a],e);break;case"image":bt("error",e),bt("load",e);break;case"details":bt("toggle",e);break;case"embed":case"source":case"link":bt("error",e),bt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in r)if(r.hasOwnProperty(d)&&(a=r[d],a!=null))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(Se(137,t));default:Tt(e,t,d,a,r,null)}return;default:if(gv(t)){for(x in r)r.hasOwnProperty(x)&&(a=r[x],a!==void 0&&Gp(e,t,x,a,r,void 0));return}}for(o in r)r.hasOwnProperty(o)&&(a=r[o],a!=null&&Tt(e,t,o,a,r,null))}function RD(e,t,r,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,i=null,l=null,o=null,c=null,d=null,x=null;for(h in r){var u=r[h];if(r.hasOwnProperty(h)&&u!=null)switch(h){case"checked":break;case"value":break;case"defaultValue":c=u;default:a.hasOwnProperty(h)||Tt(e,t,h,null,a,u)}}for(var f in a){var h=a[f];if(u=r[f],a.hasOwnProperty(f)&&(h!=null||u!=null))switch(f){case"type":i=h;break;case"name":n=h;break;case"checked":d=h;break;case"defaultChecked":x=h;break;case"value":l=h;break;case"defaultValue":o=h;break;case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(Se(137,t));break;default:h!==u&&Tt(e,t,f,h,a,u)}}gp(e,l,o,c,d,x,i,n);return;case"select":h=l=o=f=null;for(i in r)if(c=r[i],r.hasOwnProperty(i)&&c!=null)switch(i){case"value":break;case"multiple":h=c;default:a.hasOwnProperty(i)||Tt(e,t,i,null,a,c)}for(n in a)if(i=a[n],c=r[n],a.hasOwnProperty(n)&&(i!=null||c!=null))switch(n){case"value":f=i;break;case"defaultValue":o=i;break;case"multiple":l=i;default:i!==c&&Tt(e,t,n,i,a,c)}t=o,r=l,a=h,f!=null?bc(e,!!r,f,!1):!!a!=!!r&&(t!=null?bc(e,!!r,t,!0):bc(e,!!r,r?[]:"",!1));return;case"textarea":h=f=null;for(o in r)if(n=r[o],r.hasOwnProperty(o)&&n!=null&&!a.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Tt(e,t,o,null,a,n)}for(l in a)if(n=a[l],i=r[l],a.hasOwnProperty(l)&&(n!=null||i!=null))switch(l){case"value":f=n;break;case"defaultValue":h=n;break;case"children":break;case"dangerouslySetInnerHTML":if(n!=null)throw Error(Se(91));break;default:n!==i&&Tt(e,t,l,n,a,i)}q6(e,f,h);return;case"option":for(var p in r)if(f=r[p],r.hasOwnProperty(p)&&f!=null&&!a.hasOwnProperty(p))switch(p){case"selected":e.selected=!1;break;default:Tt(e,t,p,null,a,f)}for(c in a)if(f=a[c],h=r[c],a.hasOwnProperty(c)&&f!==h&&(f!=null||h!=null))switch(c){case"selected":e.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Tt(e,t,c,f,a,h)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in r)f=r[g],r.hasOwnProperty(g)&&f!=null&&!a.hasOwnProperty(g)&&Tt(e,t,g,null,a,f);for(d in a)if(f=a[d],h=r[d],a.hasOwnProperty(d)&&f!==h&&(f!=null||h!=null))switch(d){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(Se(137,t));break;default:Tt(e,t,d,f,a,h)}return;default:if(gv(t)){for(var y in r)f=r[y],r.hasOwnProperty(y)&&f!==void 0&&!a.hasOwnProperty(y)&&Gp(e,t,y,void 0,a,f);for(x in a)f=a[x],h=r[x],!a.hasOwnProperty(x)||f===h||f===void 0&&h===void 0||Gp(e,t,x,f,a,h);return}}for(var v in r)f=r[v],r.hasOwnProperty(v)&&f!=null&&!a.hasOwnProperty(v)&&Tt(e,t,v,null,a,f);for(u in a)f=a[u],h=r[u],!a.hasOwnProperty(u)||f===h||f==null&&h==null||Tt(e,t,u,f,a,h)}var Yp=null,Xp=null;function If(e){return e.nodeType===9?e:e.ownerDocument}function ow(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U9(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Kp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ag=null;function OD(){var e=window.event;return e&&e.type==="popstate"?e===ag?!1:(ag=e,!0):(ag=null,!1)}var $9=typeof setTimeout=="function"?setTimeout:void 0,PD=typeof clearTimeout=="function"?clearTimeout:void 0,cw=typeof Promise=="function"?Promise:void 0,LD=typeof queueMicrotask=="function"?queueMicrotask:typeof cw<"u"?function(e){return cw.resolve(null).then(e).catch(ID)}:$9;function ID(e){setTimeout(function(){throw e})}function ng(e,t){var r=t,a=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(a===0){e.removeChild(n),Qd(t);return}a--}else r!=="$"&&r!=="$?"&&r!=="$!"||a++;r=n}while(r);Qd(t)}function Qp(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Qp(r),mv(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function UD(e,t,r,a){for(;e.nodeType===1;){var n=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[Ld])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(i=e.getAttribute("rel"),i==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(i!==n.rel||e.getAttribute("href")!==(n.href==null?null:n.href)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin)||e.getAttribute("title")!==(n.title==null?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(i=e.getAttribute("src"),(i!==(n.src==null?null:n.src)||e.getAttribute("type")!==(n.type==null?null:n.type)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var i=n.name==null?null:""+n.name;if(n.type==="hidden"&&e.getAttribute("name")===i)return e}else return e;if(e=Za(e.nextSibling),e===null)break}return null}function $D(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Za(e.nextSibling),e===null))return null;return e}function Za(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}function dw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}function z9(e,t,r){switch(t=If(r),e){case"html":if(e=t.documentElement,!e)throw Error(Se(452));return e;case"head":if(e=t.head,!e)throw Error(Se(453));return e;case"body":if(e=t.body,!e)throw Error(Se(454));return e;default:throw Error(Se(451))}}var Oa=new Map,xw=new Set;function Uf(e){return typeof e.getRootNode=="function"?e.getRootNode():e.ownerDocument}var mi=Vt.d;Vt.d={f:zD,r:qD,D:VD,C:HD,L:WD,m:GD,X:XD,S:YD,M:KD};function zD(){var e=mi.f(),t=Uh();return e||t}function qD(e){var t=l0(e);t!==null&&t.tag===5&&t.type==="form"?zE(t):mi.r(e)}var c0=typeof document>"u"?null:document;function q9(e,t,r){var a=c0;if(a&&typeof t=="string"&&t){var n=ka(t);n='link[rel="'+e+'"][href="'+n+'"]',typeof r=="string"&&(n+='[crossorigin="'+r+'"]'),xw.has(n)||(xw.add(n),e={rel:e,crossOrigin:r,href:t},a.querySelector(n)===null&&(t=a.createElement("link"),cs(t,"link",e),Yr(t),a.head.appendChild(t)))}}function VD(e){mi.D(e),q9("dns-prefetch",e,null)}function HD(e,t){mi.C(e,t),q9("preconnect",e,t)}function WD(e,t,r){mi.L(e,t,r);var a=c0;if(a&&e&&t){var n='link[rel="preload"][as="'+ka(t)+'"]';t==="image"&&r&&r.imageSrcSet?(n+='[imagesrcset="'+ka(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(n+='[imagesizes="'+ka(r.imageSizes)+'"]')):n+='[href="'+ka(e)+'"]';var i=n;switch(t){case"style":i=$c(e);break;case"script":i=d0(e)}Oa.has(i)||(e=Gt({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Oa.set(i,e),a.querySelector(n)!==null||t==="style"&&a.querySelector(Ix(i))||t==="script"&&a.querySelector(Ux(i))||(t=a.createElement("link"),cs(t,"link",e),Yr(t),a.head.appendChild(t)))}}function GD(e,t){mi.m(e,t);var r=c0;if(r&&e){var a=t&&typeof t.as=="string"?t.as:"script",n='link[rel="modulepreload"][as="'+ka(a)+'"][href="'+ka(e)+'"]',i=n;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=d0(e)}if(!Oa.has(i)&&(e=Gt({rel:"modulepreload",href:e},t),Oa.set(i,e),r.querySelector(n)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Ux(i)))return}a=r.createElement("link"),cs(a,"link",e),Yr(a),r.head.appendChild(a)}}}function YD(e,t,r){mi.S(e,t,r);var a=c0;if(a&&e){var n=vc(a).hoistableStyles,i=$c(e);t=t||"default";var l=n.get(i);if(!l){var o={loading:0,preload:null};if(l=a.querySelector(Ix(i)))o.loading=5;else{e=Gt({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Oa.get(i))&&Jv(e,r);var c=l=a.createElement("link");Yr(c),cs(c,"link",e),c._p=new Promise(function(d,x){c.onload=d,c.onerror=x}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,cf(l,t,a)}l={type:"stylesheet",instance:l,count:1,state:o},n.set(i,l)}}}function XD(e,t){mi.X(e,t);var r=c0;if(r&&e){var a=vc(r).hoistableScripts,n=d0(e),i=a.get(n);i||(i=r.querySelector(Ux(n)),i||(e=Gt({src:e,async:!0},t),(t=Oa.get(n))&&Zv(e,t),i=r.createElement("script"),Yr(i),cs(i,"link",e),r.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(n,i))}}function KD(e,t){mi.M(e,t);var r=c0;if(r&&e){var a=vc(r).hoistableScripts,n=d0(e),i=a.get(n);i||(i=r.querySelector(Ux(n)),i||(e=Gt({src:e,async:!0,type:"module"},t),(t=Oa.get(n))&&Zv(e,t),i=r.createElement("script"),Yr(i),cs(i,"link",e),r.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},a.set(n,i))}}function uw(e,t,r,a){var n=(n=zi.current)?Uf(n):null;if(!n)throw Error(Se(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=$c(r.href),r=vc(n).hoistableStyles,a=r.get(t),a||(a={type:"style",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=$c(r.href);var i=vc(n).hoistableStyles,l=i.get(e);if(l||(n=n.ownerDocument||n,l={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},i.set(e,l),(i=n.querySelector(Ix(e)))&&!i._p&&(l.instance=i,l.state.loading=5),Oa.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Oa.set(e,r),i||QD(n,e,r,l.state))),t&&a===null)throw Error(Se(528,""));return l}if(t&&a!==null)throw Error(Se(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=d0(r),r=vc(n).hoistableScripts,a=r.get(t),a||(a={type:"script",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(Se(444,e))}}function $c(e){return'href="'+ka(e)+'"'}function Ix(e){return'link[rel="stylesheet"]['+e+"]"}function V9(e){return Gt({},e,{"data-precedence":e.precedence,precedence:null})}function QD(e,t,r,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),cs(t,"link",r),Yr(t),e.head.appendChild(t))}function d0(e){return'[src="'+ka(e)+'"]'}function Ux(e){return"script[async]"+e}function fw(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+ka(r.href)+'"]');if(a)return t.instance=a,Yr(a),a;var n=Gt({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),Yr(a),cs(a,"style",n),cf(a,r.precedence,e),t.instance=a;case"stylesheet":n=$c(r.href);var i=e.querySelector(Ix(n));if(i)return t.state.loading|=4,t.instance=i,Yr(i),i;a=V9(r),(n=Oa.get(n))&&Jv(a,n),i=(e.ownerDocument||e).createElement("link"),Yr(i);var l=i;return l._p=new Promise(function(o,c){l.onload=o,l.onerror=c}),cs(i,"link",a),t.state.loading|=4,cf(i,r.precedence,e),t.instance=i;case"script":return i=d0(r.src),(n=e.querySelector(Ux(i)))?(t.instance=n,Yr(n),n):(a=r,(n=Oa.get(i))&&(a=Gt({},r),Zv(a,n)),e=e.ownerDocument||e,n=e.createElement("script"),Yr(n),cs(n,"link",a),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(Se(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(a=t.instance,t.state.loading|=4,cf(a,r.precedence,e));return t.instance}function cf(e,t,r){for(var a=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=a.length?a[a.length-1]:null,i=n,l=0;l<a.length;l++){var o=a[l];if(o.dataset.precedence===t)i=o;else if(i!==n)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function Jv(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Zv(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var df=null;function hw(e,t,r){if(df===null){var a=new Map,n=df=new Map;n.set(r,a)}else n=df,a=n.get(r),a||(a=new Map,n.set(r,a));if(a.has(e))return a;for(a.set(e,null),r=r.getElementsByTagName(e),n=0;n<r.length;n++){var i=r[n];if(!(i[Ld]||i[vs]||e==="link"&&i.getAttribute("rel")==="stylesheet")&&i.namespaceURI!=="http://www.w3.org/2000/svg"){var l=i.getAttribute(t)||"";l=e+l;var o=a.get(l);o?o.push(i):a.set(l,[i])}}return a}function mw(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function JD(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function H9(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var Gd=null;function ZD(){}function eS(e,t,r){if(Gd===null)throw Error(Se(475));var a=Gd;if(t.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var n=$c(r.href),i=e.querySelector(Ix(n));if(i){e=i._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(a.count++,a=$f.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=i,Yr(i);return}i=e.ownerDocument||e,r=V9(r),(n=Oa.get(n))&&Jv(r,n),i=i.createElement("link"),Yr(i);var l=i;l._p=new Promise(function(o,c){l.onload=o,l.onerror=c}),cs(i,"link",r),t.instance=i}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(a.count++,t=$f.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}function tS(){if(Gd===null)throw Error(Se(475));var e=Gd;return e.stylesheets&&e.count===0&&Jp(e,e.stylesheets),0<e.count?function(t){var r=setTimeout(function(){if(e.stylesheets&&Jp(e,e.stylesheets),e.unsuspend){var a=e.unsuspend;e.unsuspend=null,a()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(r)}}:null}function $f(){if(this.count--,this.count===0){if(this.stylesheets)Jp(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var zf=null;function Jp(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,zf=new Map,t.forEach(rS,e),zf=null,$f.call(e))}function rS(e,t){if(!(t.state.loading&4)){var r=zf.get(e);if(r)var a=r.get(null);else{r=new Map,zf.set(e,r);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<n.length;i++){var l=n[i];(l.nodeName==="LINK"||l.getAttribute("media")!=="not all")&&(r.set(l.dataset.precedence,l),a=l)}a&&r.set(null,a)}n=t.instance,l=n.getAttribute("data-precedence"),i=r.get(l)||a,i===a&&r.set(null,n),r.set(l,n),this.count++,a=$f.bind(this),n.addEventListener("load",a),n.addEventListener("error",a),i?i.parentNode.insertBefore(n,i.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(n,e.firstChild)),t.state.loading|=4}}var Yd={$$typeof:Kn,Provider:null,Consumer:null,_currentValue:Ul,_currentValue2:Ul,_threadCount:0};function sS(e,t,r,a,n,i,l,o){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Sm(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sm(0),this.hiddenUpdates=Sm(null),this.identifierPrefix=a,this.onUncaughtError=n,this.onCaughtError=i,this.onRecoverableError=l,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function W9(e,t,r,a,n,i,l,o,c,d,x,u){return e=new sS(e,t,r,l,o,c,d,u),t=1,i===!0&&(t|=24),i=Sa(3,null,null,t),e.current=i,i.stateNode=e,t=Av(),t.refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:a,isDehydrated:r,cache:t},zv(i),e}function G9(e){return e?(e=lc,e):lc}function Y9(e,t,r,a,n,i){n=G9(n),a.context===null?a.context=n:a.pendingContext=n,a=qi(t),a.payload={element:r},i=i===void 0?null:i,i!==null&&(a.callback=i),r=Vi(e,a,t),r!==null&&(Ts(r,e,t),od(r,e,t))}function gw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function eb(e,t){gw(e,t),(e=e.alternate)&&gw(e,t)}function X9(e){if(e.tag===13){var t=Ki(e,67108864);t!==null&&Ts(t,e,67108864),eb(e,67108864)}}var qf=!0;function aS(e,t,r,a){var n=ot.T;ot.T=null;var i=Vt.p;try{Vt.p=2,tb(e,t,r,a)}finally{Vt.p=i,ot.T=n}}function nS(e,t,r,a){var n=ot.T;ot.T=null;var i=Vt.p;try{Vt.p=8,tb(e,t,r,a)}finally{Vt.p=i,ot.T=n}}function tb(e,t,r,a){if(qf){var n=Zp(a);if(n===null)sg(e,t,a,Vf,r),pw(e,a);else if(lS(n,e,t,r,a))a.stopPropagation();else if(pw(e,a),t&4&&-1<iS.indexOf(e)){for(;n!==null;){var i=l0(n);if(i!==null)switch(i.tag){case 3:if(i=i.stateNode,i.current.memoizedState.isDehydrated){var l=Cl(i.pendingLanes);if(l!==0){var o=i;for(o.pendingLanes|=2,o.entangledLanes|=2;l;){var c=1<<31-ia(l);o.entanglements[1]|=c,l&=~c}Mn(i),!(sr&6)&&(Mf=En()+500,Lx(0))}}break;case 13:o=Ki(i,2),o!==null&&Ts(o,i,2),Uh(),eb(i,2)}if(i=Zp(a),i===null&&sg(e,t,a,Vf,r),i===n)break;n=i}n!==null&&a.stopPropagation()}else sg(e,t,a,null,r)}}function Zp(e){return e=pv(e),rb(e)}var Vf=null;function rb(e){if(Vf=null,e=Rl(e),e!==null){var t=n0(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=A6(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Vf=e,null}function K9(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(H7()){case D6:return 2;case S6:return 8;case yf:case W7:return 32;case B6:return 268435456;default:return 32}default:return 32}}var e1=!1,Gi=null,Yi=null,Xi=null,Xd=new Map,Kd=new Map,Mi=[],iS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pw(e,t){switch(e){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":Xd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kd.delete(t.pointerId)}}function M0(e,t,r,a,n,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:i,targetContainers:[n]},t!==null&&(t=l0(t),t!==null&&X9(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function lS(e,t,r,a,n){switch(t){case"focusin":return Gi=M0(Gi,e,t,r,a,n),!0;case"dragenter":return Yi=M0(Yi,e,t,r,a,n),!0;case"mouseover":return Xi=M0(Xi,e,t,r,a,n),!0;case"pointerover":var i=n.pointerId;return Xd.set(i,M0(Xd.get(i)||null,e,t,r,a,n)),!0;case"gotpointercapture":return i=n.pointerId,Kd.set(i,M0(Kd.get(i)||null,e,t,r,a,n)),!0}return!1}function Q9(e){var t=Rl(e.target);if(t!==null){var r=n0(t);if(r!==null){if(t=r.tag,t===13){if(t=A6(r),t!==null){e.blockedOn=t,tk(e.priority,function(){if(r.tag===13){var a=la(),n=Ki(r,a);n!==null&&Ts(n,r,a),eb(r,a)}});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Zp(e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);vp=a,r.target.dispatchEvent(a),vp=null}else return t=l0(r),t!==null&&X9(t),e.blockedOn=r,!1;t.shift()}return!0}function vw(e,t,r){xf(e)&&r.delete(t)}function oS(){e1=!1,Gi!==null&&xf(Gi)&&(Gi=null),Yi!==null&&xf(Yi)&&(Yi=null),Xi!==null&&xf(Xi)&&(Xi=null),Xd.forEach(vw),Kd.forEach(vw)}function yu(e,t){e.blockedOn===t&&(e.blockedOn=null,e1||(e1=!0,Ur.unstable_scheduleCallback(Ur.unstable_NormalPriority,oS)))}var wu=null;function bw(e){wu!==e&&(wu=e,Ur.unstable_scheduleCallback(Ur.unstable_NormalPriority,function(){wu===e&&(wu=null);for(var t=0;t<e.length;t+=3){var r=e[t],a=e[t+1],n=e[t+2];if(typeof a!="function"){if(rb(a||r)===null)continue;break}var i=l0(r);i!==null&&(e.splice(t,3),t-=3,kp(i,{pending:!0,data:n,method:r.method,action:a},a,n))}}))}function Qd(e){function t(c){return yu(c,e)}Gi!==null&&yu(Gi,e),Yi!==null&&yu(Yi,e),Xi!==null&&yu(Xi,e),Xd.forEach(t),Kd.forEach(t);for(var r=0;r<Mi.length;r++){var a=Mi[r];a.blockedOn===e&&(a.blockedOn=null)}for(;0<Mi.length&&(r=Mi[0],r.blockedOn===null);)Q9(r),r.blockedOn===null&&Mi.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(a=0;a<r.length;a+=3){var n=r[a],i=r[a+1],l=n[Gs]||null;if(typeof i=="function")l||bw(r);else if(l){var o=null;if(i&&i.hasAttribute("formAction")){if(n=i,l=i[Gs]||null)o=l.formAction;else if(rb(n)!==null)continue}else o=l.action;typeof o=="function"?r[a+1]=o:(r.splice(a,3),a-=3),bw(r)}}}function sb(e){this._internalRoot=e}qh.prototype.render=sb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Se(409));var r=t.current,a=la();Y9(r,a,e,t,null,null)};qh.prototype.unmount=sb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;e.tag===0&&Nc(),Y9(e.current,2,null,e,null,null),Uh(),t[i0]=null}};function qh(e){this._internalRoot=e}qh.prototype.unstable_scheduleHydration=function(e){if(e){var t=P6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mi.length&&t!==0&&t<Mi[r].priority;r++);Mi.splice(r,0,e),r===0&&Q9(e)}};var yw=E6.version;if(yw!=="19.0.0")throw Error(Se(527,yw,"19.0.0"));Vt.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Se(188)):(e=Object.keys(e).join(","),Error(Se(268,e)));return e=z7(t),e=e!==null?k6(e):null,e=e===null?null:e.stateNode,e};var cS={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:ot,findFiberByHostInstance:Rl,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Eu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Eu.isDisabled&&Eu.supportsFiber)try{Dx=Eu.inject(cS),na=Eu}catch{}}kh.createRoot=function(e,t){if(!_6(e))throw Error(Se(299));var r=!1,a="",n=YE,i=XE,l=KE,o=null;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(n=t.onUncaughtError),t.onCaughtError!==void 0&&(i=t.onCaughtError),t.onRecoverableError!==void 0&&(l=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(o=t.unstable_transitionCallbacks)),t=W9(e,1,!1,null,null,r,a,n,i,l,o,null),e[i0]=t.current,Qv(e.nodeType===8?e.parentNode:e),new sb(t)};kh.hydrateRoot=function(e,t,r){if(!_6(e))throw Error(Se(299));var a=!1,n="",i=YE,l=XE,o=KE,c=null,d=null;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onUncaughtError!==void 0&&(i=r.onUncaughtError),r.onCaughtError!==void 0&&(l=r.onCaughtError),r.onRecoverableError!==void 0&&(o=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(c=r.unstable_transitionCallbacks),r.formState!==void 0&&(d=r.formState)),t=W9(e,1,!0,t,r??null,a,n,i,l,o,c,d),t.context=G9(null),r=t.current,a=la(),n=qi(a),n.callback=null,Vi(r,n,a),t.current.lanes=a,Bx(t,a),Mn(t),e[i0]=t.current,Qv(e),new qh(t)};kh.version="19.0.0";function J9(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(J9)}catch(e){console.error(e)}}J9(),g6.exports=kh;var dS=g6.exports;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jd(){return Jd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Jd.apply(this,arguments)}var Li;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Li||(Li={}));const ww="popstate";function xS(e){e===void 0&&(e={});function t(a,n){let{pathname:i,search:l,hash:o}=a.location;return t1("",{pathname:i,search:l,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:e_(n)}return fS(t,r,null,e)}function Ir(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Z9(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function uS(){return Math.random().toString(36).substr(2,8)}function Ew(e,t){return{usr:e.state,key:e.key,idx:t}}function t1(e,t,r,a){return r===void 0&&(r=null),Jd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?x0(t):t,{state:r,key:t&&t.key||a||uS()})}function e_(e){let{pathname:t="/",search:r="",hash:a=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function x0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function fS(e,t,r,a){a===void 0&&(a={});let{window:n=document.defaultView,v5Compat:i=!1}=a,l=n.history,o=Li.Pop,c=null,d=x();d==null&&(d=0,l.replaceState(Jd({},l.state,{idx:d}),""));function x(){return(l.state||{idx:null}).idx}function u(){o=Li.Pop;let y=x(),v=y==null?null:y-d;d=y,c&&c({action:o,location:g.location,delta:v})}function f(y,v){o=Li.Push;let w=t1(g.location,y,v);d=x()+1;let m=Ew(w,d),b=g.createHref(w);try{l.pushState(m,"",b)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;n.location.assign(b)}i&&c&&c({action:o,location:g.location,delta:1})}function h(y,v){o=Li.Replace;let w=t1(g.location,y,v);d=x();let m=Ew(w,d),b=g.createHref(w);l.replaceState(m,"",b),i&&c&&c({action:o,location:g.location,delta:0})}function p(y){let v=n.location.origin!=="null"?n.location.origin:n.location.href,w=typeof y=="string"?y:e_(y);return w=w.replace(/ $/,"%20"),Ir(v,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,v)}let g={get action(){return o},get location(){return e(n,l)},listen(y){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(ww,u),c=y,()=>{n.removeEventListener(ww,u),c=null}},createHref(y){return t(n,y)},createURL:p,encodeLocation(y){let v=p(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(y){return l.go(y)}};return g}var _w;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_w||(_w={}));function hS(e,t,r){return r===void 0&&(r="/"),mS(e,t,r)}function mS(e,t,r,a){let n=typeof t=="string"?x0(t):t,i=s_(n.pathname||"/",r);if(i==null)return null;let l=t_(e);gS(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=kS(i);o=NS(l[c],d)}return o}function t_(e,t,r,a){t===void 0&&(t=[]),r===void 0&&(r=[]),a===void 0&&(a="");let n=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(Ir(c.relativePath.startsWith(a),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(a.length));let d=Wl([a,c.relativePath]),x=r.concat(c);i.children&&i.children.length>0&&(Ir(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),t_(i.children,t,x,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:_S(d,i.index),routesMeta:x})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))n(i,l);else for(let c of r_(i.path))n(i,l,c)}),t}function r_(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,n=r.endsWith("?"),i=r.replace(/\?$/,"");if(a.length===0)return n?[i,""]:[i];let l=r_(a.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),n&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function gS(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:jS(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}const pS=/^:[\w-]+$/,vS=3,bS=2,yS=1,wS=10,ES=-2,jw=e=>e==="*";function _S(e,t){let r=e.split("/"),a=r.length;return r.some(jw)&&(a+=ES),t&&(a+=bS),r.filter(n=>!jw(n)).reduce((n,i)=>n+(pS.test(i)?vS:i===""?yS:wS),a)}function jS(e,t){return e.length===t.length&&e.slice(0,-1).every((a,n)=>a===t[n])?e[e.length-1]-t[t.length-1]:0}function NS(e,t,r){let{routesMeta:a}=e,n={},i="/",l=[];for(let o=0;o<a.length;++o){let c=a[o],d=o===a.length-1,x=i==="/"?t:t.slice(i.length)||"/",u=CS({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},x),f=c.route;if(!u)return null;Object.assign(n,u.params),l.push({params:n,pathname:Wl([i,u.pathname]),pathnameBase:MS(Wl([i,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(i=Wl([i,u.pathnameBase]))}return l}function CS(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=AS(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let i=n[0],l=i.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:a.reduce((d,x,u)=>{let{paramName:f,isOptional:h}=x;if(f==="*"){let g=o[u]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=o[u];return h&&!p?d[f]=void 0:d[f]=(p||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function AS(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Z9(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(a.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}function kS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Z9(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function s_(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}function DS(e,t){t===void 0&&(t="/");let{pathname:r,search:a="",hash:n=""}=typeof e=="string"?x0(e):e;return{pathname:r?r.startsWith("/")?r:SS(r,t):t,search:RS(a),hash:OS(n)}}function SS(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function ig(e,t,r,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BS(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function FS(e,t){let r=BS(e);return t?r.map((a,n)=>n===r.length-1?a.pathname:a.pathnameBase):r.map(a=>a.pathnameBase)}function TS(e,t,r,a){a===void 0&&(a=!1);let n;typeof e=="string"?n=x0(e):(n=Jd({},e),Ir(!n.pathname||!n.pathname.includes("?"),ig("?","pathname","search",n)),Ir(!n.pathname||!n.pathname.includes("#"),ig("#","pathname","hash",n)),Ir(!n.search||!n.search.includes("#"),ig("#","search","hash",n)));let i=e===""||n.pathname==="",l=i?"/":n.pathname,o;if(l==null)o=r;else{let u=t.length-1;if(!a&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),u-=1;n.pathname=f.join("/")}o=u>=0?t[u]:"/"}let c=DS(n,o),d=l&&l!=="/"&&l.endsWith("/"),x=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||x)&&(c.pathname+="/"),c}const Wl=e=>e.join("/").replace(/\/\/+/g,"/"),MS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),RS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,OS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function PS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const a_=["post","put","patch","delete"];new Set(a_);const LS=["get",...a_];new Set(LS);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zd(){return Zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Zd.apply(this,arguments)}const ab=E.createContext(null),IS=E.createContext(null),Vh=E.createContext(null),Hh=E.createContext(null),xl=E.createContext({outlet:null,matches:[],isDataRoute:!1}),n_=E.createContext(null);function Wh(){return E.useContext(Hh)!=null}function ul(){return Wh()||Ir(!1),E.useContext(Hh).location}function i_(e){E.useContext(Vh).static||E.useLayoutEffect(e)}function Qt(){let{isDataRoute:e}=E.useContext(xl);return e?eB():US()}function US(){Wh()||Ir(!1);let e=E.useContext(ab),{basename:t,future:r,navigator:a}=E.useContext(Vh),{matches:n}=E.useContext(xl),{pathname:i}=ul(),l=JSON.stringify(FS(n,r.v7_relativeSplatPath)),o=E.useRef(!1);return i_(()=>{o.current=!0}),E.useCallback(function(d,x){if(x===void 0&&(x={}),!o.current)return;if(typeof d=="number"){a.go(d);return}let u=TS(d,JSON.parse(l),i,x.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Wl([t,u.pathname])),(x.replace?a.replace:a.push)(u,x.state,x)},[t,a,l,i,e])}const l_=E.createContext(null);function $S(){return E.useContext(l_)}function zS(e){let t=E.useContext(xl).outlet;return t&&E.createElement(l_.Provider,{value:e},t)}function gi(){let{matches:e}=E.useContext(xl),t=e[e.length-1];return t?t.params:{}}function qS(e,t){return VS(e,t)}function VS(e,t,r,a){Wh()||Ir(!1);let{navigator:n}=E.useContext(Vh),{matches:i}=E.useContext(xl),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=ul(),x;if(t){var u;let y=typeof t=="string"?x0(t):t;c==="/"||(u=y.pathname)!=null&&u.startsWith(c)||Ir(!1),x=y}else x=d;let f=x.pathname||"/",h=f;if(c!=="/"){let y=c.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=hS(e,{pathname:h}),g=XS(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Wl([c,n.encodeLocation?n.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Wl([c,n.encodeLocation?n.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,a);return t&&g?E.createElement(Hh.Provider,{value:{location:Zd({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:Li.Pop}},g):g}function HS(){let e=ZS(),t=PS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},t),r?E.createElement("pre",{style:n},r):null,null)}const WS=E.createElement(HS,null);class GS extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?E.createElement(xl.Provider,{value:this.props.routeContext},E.createElement(n_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YS(e){let{routeContext:t,match:r,children:a}=e,n=E.useContext(ab);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),E.createElement(xl.Provider,{value:t},a)}function XS(e,t,r,a){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),a===void 0&&(a=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=a)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(n=r)==null?void 0:n.errors;if(o!=null){let x=l.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);x>=0||Ir(!1),l=l.slice(0,Math.min(l.length,x+1))}let c=!1,d=-1;if(r&&a&&a.v7_partialHydration)for(let x=0;x<l.length;x++){let u=l[x];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=x),u.route.id){let{loaderData:f,errors:h}=r,p=u.route.loader&&f[u.route.id]===void 0&&(!h||h[u.route.id]===void 0);if(u.route.lazy||p){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((x,u,f)=>{let h,p=!1,g=null,y=null;r&&(h=o&&u.route.id?o[u.route.id]:void 0,g=u.route.errorElement||WS,c&&(d<0&&f===0?(tB("route-fallback"),p=!0,y=null):d===f&&(p=!0,y=u.route.hydrateFallbackElement||null)));let v=t.concat(l.slice(0,f+1)),w=()=>{let m;return h?m=g:p?m=y:u.route.Component?m=E.createElement(u.route.Component,null):u.route.element?m=u.route.element:m=x,E.createElement(YS,{match:u,routeContext:{outlet:x,matches:v,isDataRoute:r!=null},children:m})};return r&&(u.route.ErrorBoundary||u.route.errorElement||f===0)?E.createElement(GS,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):w()},null)}var o_=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(o_||{}),c_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(c_||{});function KS(e){let t=E.useContext(ab);return t||Ir(!1),t}function QS(e){let t=E.useContext(IS);return t||Ir(!1),t}function JS(e){let t=E.useContext(xl);return t||Ir(!1),t}function d_(e){let t=JS(),r=t.matches[t.matches.length-1];return r.route.id||Ir(!1),r.route.id}function ZS(){var e;let t=E.useContext(n_),r=QS(),a=d_();return t!==void 0?t:(e=r.errors)==null?void 0:e[a]}function eB(){let{router:e}=KS(o_.UseNavigateStable),t=d_(c_.UseNavigateStable),r=E.useRef(!1);return i_(()=>{r.current=!0}),E.useCallback(function(n,i){i===void 0&&(i={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,Zd({fromRouteId:t},i)))},[e,t])}const Nw={};function tB(e,t,r){Nw[e]||(Nw[e]=!0)}function rB(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function sB(e){return zS(e.context)}function kt(e){Ir(!1)}function aB(e){let{basename:t="/",children:r=null,location:a,navigationType:n=Li.Pop,navigator:i,static:l=!1,future:o}=e;Wh()&&Ir(!1);let c=t.replace(/^\/*/,"/"),d=E.useMemo(()=>({basename:c,navigator:i,static:l,future:Zd({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof a=="string"&&(a=x0(a));let{pathname:x="/",search:u="",hash:f="",state:h=null,key:p="default"}=a,g=E.useMemo(()=>{let y=s_(x,c);return y==null?null:{location:{pathname:y,search:u,hash:f,state:h,key:p},navigationType:n}},[c,x,u,f,h,p,n]);return g==null?null:E.createElement(Vh.Provider,{value:d},E.createElement(Hh.Provider,{children:r,value:g}))}function lg(e){let{children:t,location:r}=e;return qS(r1(t),r)}new Promise(()=>{});function r1(e,t){t===void 0&&(t=[]);let r=[];return E.Children.forEach(e,(a,n)=>{if(!E.isValidElement(a))return;let i=[...t,n];if(a.type===E.Fragment){r.push.apply(r,r1(a.props.children,i));return}a.type!==kt&&Ir(!1),!a.props.index||!a.props.children||Ir(!1);let l={id:a.props.id||i.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(l.children=r1(a.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function s1(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return t.concat(Array.isArray(a)?a.map(n=>[r,n]):[[r,a]])},[]))}function nB(e,t){let r=s1(e);return t&&t.forEach((a,n)=>{r.has(n)||t.getAll(n).forEach(i=>{r.append(n,i)})}),r}const iB="6";try{window.__reactRouterVersion=iB}catch{}const lB="startTransition",Cw=B7[lB];function oB(e){let{basename:t,children:r,future:a,window:n}=e,i=E.useRef();i.current==null&&(i.current=xS({window:n,v5Compat:!0}));let l=i.current,[o,c]=E.useState({action:l.action,location:l.location}),{v7_startTransition:d}=a||{},x=E.useCallback(u=>{d&&Cw?Cw(()=>c(u)):c(u)},[c,d]);return E.useLayoutEffect(()=>l.listen(x),[l,x]),E.useEffect(()=>rB(a),[a]),E.createElement(aB,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:a})}var Aw;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Aw||(Aw={}));var kw;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(kw||(kw={}));function x_(e){let t=E.useRef(s1(e)),r=E.useRef(!1),a=ul(),n=E.useMemo(()=>nB(a.search,r.current?null:t.current),[a.search]),i=Qt(),l=E.useCallback((o,c)=>{const d=s1(typeof o=="function"?o(n):o);r.current=!0,i("?"+d,c)},[i,n]);return[n,l]}const cB="modulepreload",dB=function(e){return"/"+e},Dw={},u0=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=dB(c),c in Dw)return;Dw[c]=!0;const d=c.endsWith(".css"),x=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${x}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":cB,d||(u.as="script"),u.crossOrigin="",u.href=c,o&&u.setAttribute("nonce",o),document.head.appendChild(u),d)return new Promise((f,h)=>{u.addEventListener("load",f),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return n.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},xB=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>u0(async()=>{const{default:a}=await Promise.resolve().then(()=>f0);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)};class nb extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class uB extends nb{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Sw extends nb{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Bw extends nb{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var a1;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(a1||(a1={}));var fB=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};class hB{constructor(t,{headers:r={},customFetch:a,region:n=a1.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=xB(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var a;return fB(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:l}=r;let o={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${t}`);c&&c!=="any"&&(o["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let x;l&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",x=l):typeof l=="string"?(o["Content-Type"]="text/plain",x=l):typeof FormData<"u"&&l instanceof FormData?x=l:(o["Content-Type"]="application/json",x=JSON.stringify(l)));const u=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:x}).catch(g=>{throw new uB(g)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new Sw(u);if(!u.ok)throw new Bw(u);let h=((a=u.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield u.json():h==="application/octet-stream"?p=yield u.blob():h==="text/event-stream"?p=u:h==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null,response:u}}catch(n){return{data:null,error:n,response:n instanceof Bw||n instanceof Sw?n.context:void 0}}})}}var qs={},ib={},Gh={},$x={},Yh={},Xh={},mB=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},zc=mB();const gB=zc.fetch,u_=zc.fetch.bind(zc),f_=zc.Headers,pB=zc.Request,vB=zc.Response,f0=Object.freeze(Object.defineProperty({__proto__:null,Headers:f_,Request:pB,Response:vB,default:u_,fetch:gB},Symbol.toStringTag,{value:"Module"})),bB=f7(f0);var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});let yB=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Kh.default=yB;var h_=Os&&Os.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xh,"__esModule",{value:!0});const wB=h_(bB),EB=h_(Kh);let _B=class{constructor(t){var r,a;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(a=t.isMaybeSingle)!==null&&a!==void 0?a:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=wB.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var l,o,c,d;let x=null,u=null,f=null,h=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const w=await i.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((l=this.headers.get("Accept"))===null||l===void 0)&&l.includes("application/vnd.pgrst.plan+text"))?u=w:u=JSON.parse(w))}const y=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");y&&v&&v.length>1&&(f=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(x={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,h=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const y=await i.text();try{x=JSON.parse(y),Array.isArray(x)&&i.status===404&&(u=[],x=null,h=200,p="OK")}catch{i.status===404&&y===""?(h=204,p="No Content"):x={message:y}}if(x&&this.isMaybeSingle&&(!((d=x==null?void 0:x.details)===null||d===void 0)&&d.includes("0 rows"))&&(x=null,h=200,p="OK"),x&&this.shouldThrowOnError)throw new EB.default(x)}return{error:x,data:u,count:f,status:h,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var l,o,c;return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,r)}returns(){return this}overrideTypes(){return this}};Xh.default=_B;var jB=Os&&Os.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yh,"__esModule",{value:!0});const NB=jB(Xh);let CB=class extends NB.default{select(t){let r=!1;const a=(t??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:a,foreignTable:n,referencedTable:i=n}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:a=r}={}){const n=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,r,{foreignTable:a,referencedTable:n=a}={}){const i=typeof n>"u"?"offset":`${n}.offset`,l=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(l,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:a=!1,buffers:n=!1,wal:i=!1,format:l="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,a?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${d}"; options=${c};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Yh.default=CB;var AB=Os&&Os.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($x,"__esModule",{value:!0});const kB=AB(Yh);let DB=class extends kB.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const a=Array.from(new Set(r)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${a})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:a,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const l=a===void 0?"":`(${a})`;return this.url.searchParams.append(t,`${i}fts${l}.${r}`),this}match(t){return Object.entries(t).forEach(([r,a])=>{this.url.searchParams.append(r,`eq.${a}`)}),this}not(t,r,a){return this.url.searchParams.append(t,`not.${r}.${a}`),this}or(t,{foreignTable:r,referencedTable:a=r}={}){const n=a?`${a}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,r,a){return this.url.searchParams.append(t,`${r}.${a}`),this}};$x.default=DB;var SB=Os&&Os.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gh,"__esModule",{value:!0});const R0=SB($x);let BB=class{constructor(t,{headers:r={},schema:a,fetch:n}){this.url=t,this.headers=new Headers(r),this.schema=a,this.fetch=n}select(t,{head:r=!1,count:a}={}){const n=r?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),a&&this.headers.append("Prefer",`count=${a}`),new R0.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:a=!0}={}){var n;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(l.length>0){const o=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new R0.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:a=!1,count:n,defaultToNull:i=!0}={}){var l;const o="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,x)=>d.concat(Object.keys(x)),[]);if(c.length>0){const d=[...new Set(c)].map(x=>`"${x}"`);this.url.searchParams.set("columns",d.join(","))}}return new R0.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(t,{count:r}={}){var a;const n="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new R0.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:t}={}){var r;const a="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new R0.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Gh.default=BB;var m_=Os&&Os.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ib,"__esModule",{value:!0});const FB=m_(Gh),TB=m_($x);let MB=class g_{constructor(t,{headers:r={},schema:a,fetch:n}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=n}from(t){const r=new URL(`${this.url}/${t}`);return new FB.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new g_(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:n=!1,count:i}={}){var l;let o;const c=new URL(`${this.url}/rpc/${t}`);let d;a||n?(o=a?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{c.searchParams.append(u,f)})):(o="POST",d=r);const x=new Headers(this.headers);return i&&x.set("Prefer",`count=${i}`),new TB.default({method:o,url:c,headers:x,schema:this.schemaName,body:d,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};ib.default=MB;var h0=Os&&Os.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qs,"__esModule",{value:!0});qs.PostgrestError=qs.PostgrestBuilder=qs.PostgrestTransformBuilder=qs.PostgrestFilterBuilder=qs.PostgrestQueryBuilder=qs.PostgrestClient=void 0;const p_=h0(ib);qs.PostgrestClient=p_.default;const v_=h0(Gh);qs.PostgrestQueryBuilder=v_.default;const b_=h0($x);qs.PostgrestFilterBuilder=b_.default;const y_=h0(Yh);qs.PostgrestTransformBuilder=y_.default;const w_=h0(Xh);qs.PostgrestBuilder=w_.default;const E_=h0(Kh);qs.PostgrestError=E_.default;var RB=qs.default={PostgrestClient:p_.default,PostgrestQueryBuilder:v_.default,PostgrestFilterBuilder:b_.default,PostgrestTransformBuilder:y_.default,PostgrestBuilder:w_.default,PostgrestError:E_.default};const{PostgrestClient:OB,PostgrestQueryBuilder:pie,PostgrestFilterBuilder:vie,PostgrestTransformBuilder:bie,PostgrestBuilder:yie,PostgrestError:wie}=RB;class PB{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const LB="2.15.5",IB=`realtime-js/${LB}`,UB="1.0.0",n1=1e4,$B=1e3,zB=100;var md;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(md||(md={}));var Tr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Tr||(Tr={}));var Ga;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ga||(Ga={}));var i1;(function(e){e.websocket="websocket"})(i1||(i1={}));var Fl;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Fl||(Fl={}));class qB{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,r,a)}_decodeBroadcast(t,r,a){const n=r.getUint8(1),i=r.getUint8(2);let l=this.HEADER_LENGTH+2;const o=a.decode(t.slice(l,l+n));l=l+n;const c=a.decode(t.slice(l,l+i));l=l+i;const d=JSON.parse(a.decode(t.slice(l,t.byteLength)));return{ref:null,topic:o,event:c,payload:d}}}class __{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Lt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Lt||(Lt={}));const Fw=(e,t,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(t).reduce((i,l)=>(i[l]=VB(l,e,t,n),i),{})},VB=(e,t,r,a)=>{const n=t.find(o=>o.name===e),i=n==null?void 0:n.type,l=r[e];return i&&!a.includes(i)?j_(i,l):l1(l)},j_=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return YB(t,r)}switch(e){case Lt.bool:return HB(t);case Lt.float4:case Lt.float8:case Lt.int2:case Lt.int4:case Lt.int8:case Lt.numeric:case Lt.oid:return WB(t);case Lt.json:case Lt.jsonb:return GB(t);case Lt.timestamp:return XB(t);case Lt.abstime:case Lt.date:case Lt.daterange:case Lt.int4range:case Lt.int8range:case Lt.money:case Lt.reltime:case Lt.text:case Lt.time:case Lt.timestamptz:case Lt.timetz:case Lt.tsrange:case Lt.tstzrange:return l1(t);default:return l1(t)}},l1=e=>e,HB=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},WB=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},GB=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},YB=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>j_(t,o))}return e},XB=e=>typeof e=="string"?e.replace(" ","T"):e,N_=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class og{constructor(t,r,a={},n=n1){this.channel=t,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Tw;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Tw||(Tw={}));class gd{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gd.syncState(this.state,n,i,l),this.pendingDiffs.forEach(c=>{this.state=gd.syncDiff(this.state,c,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(a.diff,{},n=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=gd.syncDiff(this.state,n,i,l),o())}),this.onJoin((n,i,l)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:l})}),this.onLeave((n,i,l)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,n){const i=this.cloneDeep(t),l=this.transformState(r),o={},c={};return this.map(i,(d,x)=>{l[d]||(c[d]=x)}),this.map(l,(d,x)=>{const u=i[d];if(u){const f=x.map(y=>y.presence_ref),h=u.map(y=>y.presence_ref),p=x.filter(y=>h.indexOf(y.presence_ref)<0),g=u.filter(y=>f.indexOf(y.presence_ref)<0);p.length>0&&(o[d]=p),g.length>0&&(c[d]=g)}else o[d]=x}),this.syncDiff(i,{joins:o,leaves:c},a,n)}static syncDiff(t,r,a,n){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(i,(o,c)=>{var d;const x=(d=t[o])!==null&&d!==void 0?d:[];if(t[o]=this.cloneDeep(c),x.length>0){const u=t[o].map(h=>h.presence_ref),f=x.filter(h=>u.indexOf(h.presence_ref)<0);t[o].unshift(...f)}a(o,x,c)}),this.map(l,(o,c)=>{let d=t[o];if(!d)return;const x=c.map(u=>u.presence_ref);d=d.filter(u=>x.indexOf(u.presence_ref)<0),t[o]=d,n(o,d,c),d.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const n=t[a];return"metas"in n?r[a]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[a]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Mw;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Mw||(Mw={}));var pd;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(pd||(pd={}));var Vn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Vn||(Vn={}));class lb{constructor(t,r={config:{}},a){this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=Tr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new og(this,Ga.join,this.params,this.timeout),this.rejoinTimer=new __(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Tr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Tr.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ga.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new gd(this),this.broadcastEndpointURL=N_(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var a,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Tr.closed){const{config:{broadcast:l,presence:o,private:c}}=this.params,d=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(h=>h.filter))!==null&&n!==void 0?n:[],x=!!this.bindings[pd.PRESENCE]&&this.bindings[pd.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,u={},f={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:x}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(Vn.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(Vn.CLOSED)),this.updateJoinPayload(Object.assign({config:f},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var p;if(this.socket.setAuth(),h===void 0){t==null||t(Vn.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(p=g==null?void 0:g.length)!==null&&p!==void 0?p:0,v=[];for(let w=0;w<y;w++){const m=g[w],{filter:{event:b,schema:_,table:C,filter:j}}=m,D=h&&h[w];if(D&&D.event===b&&D.schema===_&&D.table===C&&D.filter===j)v.push(Object.assign(Object.assign({},m),{id:D.id}));else{this.unsubscribe(),this.state=Tr.errored,t==null||t(Vn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Vn.SUBSCRIBED);return}}).receive("error",h=>{this.state=Tr.errored,t==null||t(Vn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Vn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===Tr.joined&&t===pd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,a)}async send(t,r={}){var a,n;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:l}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Tr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ga.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new og(this,Ga.leave,{},t),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Tr.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const n=new AbortController,i=setTimeout(()=>n.abort(),a),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),l}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new og(this,t,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>zB){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var n,i;const l=t.toLocaleLowerCase(),{close:o,error:c,leave:d,join:x}=Ga;if(a&&[o,c,d,x].indexOf(l)>=0&&a!==this._joinRef())return;let f=this._onMessage(l,r,a);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(h=>{var p,g,y;return((p=h.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(g=h.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===l}).map(h=>h.callback(f,a)):(i=this.bindings[l])===null||i===void 0||i.filter(h=>{var p,g,y,v,w,m;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in h){const b=h.id,_=(p=h.filter)===null||p===void 0?void 0:p.event;return b&&((g=r.ids)===null||g===void 0?void 0:g.includes(b))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const b=(w=(v=h==null?void 0:h.filter)===null||v===void 0?void 0:v.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return b==="*"||b===((m=r==null?void 0:r.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===l}).map(h=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:g,table:y,commit_timestamp:v,type:w,errors:m}=p;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:v,eventType:w,new:{},old:{},errors:m}),this._getPayloadRecords(p))}h.callback(f,a)})}_isClosed(){return this.state===Tr.closed}_isJoined(){return this.state===Tr.joined}_isJoining(){return this.state===Tr.joining}_isLeaving(){return this.state===Tr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const n=t.toLocaleLowerCase(),i={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&lb.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ga.close,{},t)}_onError(t){this._on(Ga.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Tr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Fw(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Fw(t.columns,t.old_record)),r}}const cg=()=>{},_u={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},KB=[1e3,2e3,5e3,1e4],QB=1e4,JB=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ZB{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=n1,this.transport=null,this.heartbeatIntervalMs=_u.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cg,this.ref=0,this.reconnectTimer=null,this.logger=cg,this.conn=null,this.sendBuffer=[],this.serializer=new qB,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...l)=>u0(async()=>{const{default:o}=await Promise.resolve().then(()=>f0);return{default:o}},void 0).then(({default:o})=>o(...l)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...l)=>i(...l)},!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${i1.websocket}`,this.httpEndpoint=N_(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=PB.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:UB}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case md.connecting:return Fl.Connecting;case md.open:return Fl.Open;case md.closing:return Fl.Closing;default:return Fl.Closed}}isConnected(){return this.connectionState()===Fl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,n=this.getChannels().find(i=>i.topic===a);if(n)return n;{const i=new lb(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:a,payload:n,ref:i}=t,l=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${a} (${i})`,n),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close($B,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},_u.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:i,ref:l}=r,o=l?`(${l})`:"",c=i.status||"";this.log("receive",`${c} ${a} ${n} ${o}`.trim(),i),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(n,i,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ga.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${a}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([JB],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:IB};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Ga.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new __(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_u.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,n,i,l,o,c,d,x;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:n1,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:_u.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:cg,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:u=>KB[u-1]||QB,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(u,f)=>f(JSON.stringify(u)),this.decode=(x=t==null?void 0:t.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ob extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Mr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class eF extends ob{constructor(t,r,a){super(t),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class o1 extends ob{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var tF=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};const C_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>u0(async()=>{const{default:a}=await Promise.resolve().then(()=>f0);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},rF=()=>tF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield u0(()=>Promise.resolve().then(()=>f0),void 0)).Response:Response}),c1=e=>{if(Array.isArray(e))return e.map(r=>c1(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[n]=c1(a)}),t},sF=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Co=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};const dg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),aF=(e,t,r)=>Co(void 0,void 0,void 0,function*(){const a=yield rF();e instanceof a&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const i=e.status||500,l=(n==null?void 0:n.statusCode)||i+"";t(new eF(dg(n),i,l))}).catch(n=>{t(new o1(dg(n),n))}):t(new o1(dg(e),e))}),nF=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!a?n:(sF(a)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r))};function zx(e,t,r,a,n,i){return Co(this,void 0,void 0,function*(){return new Promise((l,o)=>{e(r,nF(t,a,n,i)).then(c=>{if(!c.ok)throw c;return a!=null&&a.noResolveJson?c:c.json()}).then(c=>l(c)).catch(c=>aF(c,o,a))})})}function Hf(e,t,r,a){return Co(this,void 0,void 0,function*(){return zx(e,"GET",t,r,a)})}function hn(e,t,r,a,n){return Co(this,void 0,void 0,function*(){return zx(e,"POST",t,a,n,r)})}function d1(e,t,r,a,n){return Co(this,void 0,void 0,function*(){return zx(e,"PUT",t,a,n,r)})}function iF(e,t,r,a){return Co(this,void 0,void 0,function*(){return zx(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function A_(e,t,r,a,n){return Co(this,void 0,void 0,function*(){return zx(e,"DELETE",t,a,n,r)})}var Cs=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};const lF={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Rw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oF{constructor(t,r={},a,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=a,this.fetch=C_(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,a,n){return Cs(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},Rw),n);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const c=l.metadata;typeof Blob<"u"&&a instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",a)):typeof FormData<"u"&&a instanceof FormData?(i=a,i.append("cacheControl",l.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=a,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const d=this._removeEmptyFolders(r),x=this._getFinalPath(d),u=yield(t=="PUT"?d1:hn)(this.fetch,`${this.url}/object/${x}`,i,Object.assign({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:d,id:u.Id,fullPath:u.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Mr(i))return{data:null,error:i};throw i}})}upload(t,r,a){return Cs(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,a)})}uploadToSignedUrl(t,r,a,n){return Cs(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),l=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${l}`);o.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:Rw.upsert},n),x=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&a instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",a)):typeof FormData<"u"&&a instanceof FormData?(c=a,c.append("cacheControl",d.cacheControl)):(c=a,x["cache-control"]=`max-age=${d.cacheControl}`,x["content-type"]=d.contentType);const u=yield d1(this.fetch,o.toString(),c,{headers:x});return{data:{path:i,fullPath:u.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Mr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Cs(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const i=yield hn(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),l=new URL(this.url+i.url),o=l.searchParams.get("token");if(!o)throw new ob("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:o},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mr(a))return{data:null,error:a};throw a}})}update(t,r,a){return Cs(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,a)})}move(t,r,a){return Cs(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mr(n))return{data:null,error:n};throw n}})}copy(t,r,a){return Cs(this,void 0,void 0,function*(){try{return{data:{path:(yield hn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mr(n))return{data:null,error:n};throw n}})}createSignedUrl(t,r,a){return Cs(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),i=yield hn(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const l=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mr(n))return{data:null,error:n};throw n}})}createSignedUrls(t,r,a){return Cs(this,void 0,void 0,function*(){try{const n=yield hn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mr(n))return{data:null,error:n};throw n}})}download(t,r){return Cs(this,void 0,void 0,function*(){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Hf(this.fetch,`${this.url}/${n}/${o}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Mr(o))return{data:null,error:o};throw o}})}info(t){return Cs(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const a=yield Hf(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:c1(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mr(a))return{data:null,error:a};throw a}})}exists(t){return Cs(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield iF(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mr(a)&&a instanceof o1){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,r){const a=this._getFinalPath(t),n=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${a}${d}`)}}}remove(t){return Cs(this,void 0,void 0,function*(){try{return{data:yield A_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mr(r))return{data:null,error:r};throw r}})}list(t,r,a){return Cs(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},lF),r),{prefix:t||""});return{data:yield hn(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mr(n))return{data:null,error:n};throw n}})}listV2(t,r){return Cs(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield hn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mr(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const cF="2.12.1",dF={"X-Client-Info":`storage-js/${cF}`};var Po=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};class xF{constructor(t,r={},a,n){this.shouldThrowOnError=!1;const i=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},dF),r),this.fetch=C_(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Po(this,void 0,void 0,function*(){try{return{data:yield Hf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Mr(t))return{data:null,error:t};throw t}})}getBucket(t){return Po(this,void 0,void 0,function*(){try{return{data:yield Hf(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Po(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mr(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return Po(this,void 0,void 0,function*(){try{return{data:yield d1(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mr(a))return{data:null,error:a};throw a}})}emptyBucket(t){return Po(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Po(this,void 0,void 0,function*(){try{return{data:yield A_(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mr(r))return{data:null,error:r};throw r}})}}class uF extends xF{constructor(t,r={},a,n){super(t,r,a,n)}from(t){return new oF(this.url,this.headers,t,this.fetch)}}const fF="2.57.4";let Y0="";typeof Deno<"u"?Y0="deno":typeof document<"u"?Y0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Y0="react-native":Y0="node";const hF={"X-Client-Info":`supabase-js-${Y0}/${fF}`},mF={headers:hF},gF={schema:"public"},pF={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vF={};var bF=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};const yF=e=>{let t;return e?t=e:typeof fetch>"u"?t=u_:t=fetch,(...r)=>t(...r)},wF=()=>typeof Headers>"u"?f_:Headers,EF=(e,t,r)=>{const a=yF(r),n=wF();return(i,l)=>bF(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let d=new n(l==null?void 0:l.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),a(i,Object.assign(Object.assign({},l),{headers:d}))})};var _F=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};function jF(e){return e.endsWith("/")?e:e+"/"}function NF(e,t){var r,a;const{db:n,auth:i,realtime:l,global:o}=e,{db:c,auth:d,realtime:x,global:u}=t,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},x),l),storage:{},global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},(r=u==null?void 0:u.headers)!==null&&r!==void 0?r:{}),(a=o==null?void 0:o.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>_F(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function CF(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(jF(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const k_="2.71.1",Qo=30*1e3,x1=3,xg=x1*Qo,AF="http://localhost:9999",kF="supabase.auth.token",DF={"X-Client-Info":`gotrue-js/${k_}`},u1="X-Supabase-Api-Version",D_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},SF=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,BF=10*60*1e3;class cb extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function it(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class FF extends cb{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function TF(e){return it(e)&&e.name==="AuthApiError"}class S_ extends cb{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class fl extends cb{constructor(t,r,a,n){super(t,a,n),this.name=r,this.status=a}}class Ci extends fl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function MF(e){return it(e)&&e.name==="AuthSessionMissingError"}class ju extends fl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Nu extends fl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Cu extends fl{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function RF(e){return it(e)&&e.name==="AuthImplicitGrantRedirectError"}class Ow extends fl{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class f1 extends fl{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ug(e){return it(e)&&e.name==="AuthRetryableFetchError"}class Pw extends fl{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class h1 extends fl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Wf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Lw=` 	
\r=`.split(""),OF=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Lw.length;t+=1)e[Lw[t].charCodeAt(0)]=-2;for(let t=0;t<Wf.length;t+=1)e[Wf[t].charCodeAt(0)]=t;return e})();function Iw(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Wf[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Wf[a]),t.queuedBits-=6}}function B_(e,t,r){const a=OF[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Uw(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=l=>{IF(l,a,r)};for(let l=0;l<e.length;l+=1)B_(e.charCodeAt(l),n,i);return t.join("")}function PF(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function LF(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}PF(a,t)}}function IF(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if(!(e>>7-a&1)){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function UF(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)B_(e.charCodeAt(n),r,a);return new Uint8Array(t)}function $F(e){const t=[];return LF(e,r=>t.push(r)),new Uint8Array(t)}function zF(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};return e.forEach(n=>Iw(n,r,a)),Iw(null,r,a),t.join("")}function qF(e){return Math.round(Date.now()/1e3)+e}function VF(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Va=()=>typeof window<"u"&&typeof document<"u",yl={tested:!1,writable:!1},F_=()=>{if(!Va())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(yl.tested)return yl.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),yl.tested=!0,yl.writable=!0}catch{yl.tested=!0,yl.writable=!1}return yl.writable};function HF(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{t[i]=n})}catch{}return r.searchParams.forEach((a,n)=>{t[n]=a}),t}const T_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>u0(async()=>{const{default:a}=await Promise.resolve().then(()=>f0);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},WF=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Jo=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},wl=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ei=async(e,t)=>{await e.removeItem(t)};class Qh{constructor(){this.promise=new Qh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Qh.promiseConstructor=Promise;function fg(e){const t=e.split(".");if(t.length!==3)throw new h1("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!SF.test(t[a]))throw new h1("JWT not in base64url format");return{header:JSON.parse(Uw(t[0])),payload:JSON.parse(Uw(t[1])),signature:UF(t[2]),raw:{header:t[0],payload:t[1]}}}async function GF(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function YF(e,t){return new Promise((a,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){a(l);return}}catch(l){if(!t(i,l)){n(l);return}}})()})}function XF(e){return("0"+e.toString(16)).substr(-2)}function KF(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(t),Array.from(t,XF).join("")}async function QF(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function JF(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await QF(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Lo(e,t,r=!1){const a=KF();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await Jo(e,`${t}-code-verifier`,n);const i=await JF(a);return[i,a===i?"plain":"s256"]}const ZF=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eT(e){const t=e.headers.get(u1);if(!t||!t.match(ZF))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function tT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function rT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Io(e){if(!sT.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hg(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function $w(e){return JSON.parse(JSON.stringify(e))}var aT=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r};const kl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),nT=[502,503,504];async function zw(e){var t;if(!WF(e))throw new f1(kl(e),0);if(nT.includes(e.status))throw new f1(kl(e),e.status);let r;try{r=await e.json()}catch(i){throw new S_(kl(i),i)}let a;const n=eT(e);if(n&&n.getTime()>=D_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Pw(kl(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new Ci}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new Pw(kl(r),e.status,r.weak_password.reasons);throw new FF(kl(r),e.status||500,a)}const iT=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function mt(e,t,r,a){var n;const i=Object.assign({},a==null?void 0:a.headers);i[u1]||(i[u1]=D_["2024-01-01"].name),a!=null&&a.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const l=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(l.redirect_to=a.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",c=await lT(e,t,r+o,{headers:i,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function lT(e,t,r,a,n,i){const l=iT(t,a,n,i);let o;try{o=await e(r,Object.assign({},l))}catch(c){throw console.error(c),new f1(kl(c),0)}if(o.ok||await zw(o),a!=null&&a.noResolveJson)return o;try{return await o.json()}catch(c){await zw(c)}}function qn(e){var t;let r=null;xT(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=qF(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function qw(e){const t=qn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ri(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function oT(e){return{data:e,error:null}}function cT(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i}=e,l=aT(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i},c=Object.assign({},l);return{data:{properties:o,user:c},error:null}}function dT(e){return e}function xT(e){return e.access_token&&e.refresh_token&&e.expires_in}const mg=["global","local","others"];var uT=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r};class fT{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=T_(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=mg[0]){if(mg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mg.join(", ")}`);try{return await mt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(it(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await mt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ri})}catch(a){if(it(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=uT(t,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await mt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:cT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(it(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await mt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ri})}catch(r){if(it(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,n,i,l,o,c;try{const d={nextPage:null,lastPage:0,total:0},x=await mt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:dT});if(x.error)throw x.error;const u=await x.json(),f=(l=x.headers.get("x-total-count"))!==null&&l!==void 0?l:0,h=(c=(o=x.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},u),d),error:null}}catch(d){if(it(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Io(t);try{return await mt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ri})}catch(r){if(it(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Io(t);try{return await mt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ri})}catch(a){if(it(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){Io(t);try{return await mt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ri})}catch(a){if(it(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Io(t.userId);try{const{data:r,error:a}=await mt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(it(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Io(t.userId),Io(t.id);try{return{data:await mt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}}}function Vw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function hT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Uo={debug:!!(globalThis&&F_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class M_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class mT extends M_{}async function gT(e,t,r){Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new mT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Uo.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}hT();const pT={url:AF,storageKey:kF,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DF,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Hw(e,t,r){return await r()}const $o={};class ex{constructor(t){var r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ex.nextInstanceID,ex.nextInstanceID+=1,this.instanceID>0&&Va()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},pT),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new fT({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=T_(n.fetch),this.lock=n.lock||Hw,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Va()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=gT:this.lock=Hw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:F_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Vw(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Vw(this.memoryStorage)),Va()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=$o[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){$o[this.storageKey]=Object.assign(Object.assign({},$o[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=$o[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){$o[this.storageKey]=Object.assign(Object.assign({},$o[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${k_}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=HF(window.location.href);let a="none";if(this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce"),Va()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),RF(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return it(r)?{error:r}:{error:new S_("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,n;try{const i=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:qn}),{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const c=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(it(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,a,n;try{let i;if("email"in t){const{email:x,password:u,options:f}=t;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await Lo(this.storage,this.storageKey)),i=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:x,password:u,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:p},xform:qn})}else if("phone"in t){const{phone:x,password:u,options:f}=t;i=await mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:u,data:(a=f==null?void 0:f.data)!==null&&a!==void 0?a:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:qn})}else throw new Nu("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return{data:{user:null,session:null},error:o};const c=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(it(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:o}=t;r=await mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:qw})}else if("phone"in t){const{phone:i,password:l,options:o}=t;r=await mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:qw})}else throw new Nu("You must provide either an email or phone number and a password");const{data:a,error:n}=r;return n?{data:{user:null,session:null},error:n}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new ju}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(it(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,a,n,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,a,n,i,l,o,c,d,x,u,f,h;let p,g;if("message"in t)p=t.message,g=t.signature;else{const{chain:y,wallet:v,statement:w,options:m}=t;let b;if(Va())if(typeof v=="object")b=v;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))b=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=v}const _=new URL((r=m==null?void 0:m.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const C=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),w?{statement:w}:null));let j;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")j=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)j=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)p=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),g=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${_.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(n=(a=m==null?void 0:m.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=m==null?void 0:m.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((l=m==null?void 0:m.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((o=m==null?void 0:m.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((d=m==null?void 0:m.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((u=(x=m==null?void 0:m.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||u===void 0)&&u.length?["Resources",...m.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const C=await b.signMessage(new TextEncoder().encode(p),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:y,error:v}=await mt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:zF(g)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:qn});if(v)throw v;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new ju}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:v})}catch(y){if(it(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const r=await wl(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:i,error:l}=await mt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:qn});if(await Ei(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ju}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:l})}catch(i){if(it(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:a,token:n,access_token:i,nonce:l}=t,o=await mt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:qn}),{data:c,error:d}=o;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new ju}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(it(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,a,n,i,l;try{if("email"in t){const{email:o,options:c}=t;let d=null,x=null;this.flowType==="pkce"&&([d,x]=await Lo(this.storage,this.storageKey));const{error:u}=await mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:x},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in t){const{phone:o,options:c}=t,{data:d,error:x}=await mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(l=c==null?void 0:c.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:x}}throw new Nu("You must provide either an email or phone number.")}catch(o){if(it(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,a;try{let n,i;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:l,error:o}=await mt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:qn});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const c=l.session,d=l.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(it(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var r,a,n;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await Lo(this.storage,this.storageKey)),await mt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:oT})}catch(i){if(it(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new Ci;const{error:n}=await mt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(it(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:n,options:i}=t,{error:l}=await mt(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:a,type:n,options:i}=t,{data:l,error:o}=await mt(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o}}throw new Nu("You must provide either an email or phone number and a type")}catch(r){if(it(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await wl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<xg:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const l=await wl(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=hg()}if(this.storage.isServer&&t.user){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,x)=>(!l&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,x))})}return{data:{session:t},error:null}}const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ri}):await this._useSession(async r=>{var a,n,i;const{data:l,error:o}=r;if(o)throw o;return!(!((a=l.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ci}:await mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Ri})})}catch(r){if(it(r))return MF(r)&&(await this._removeSession(),await Ei(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:n,error:i}=a;if(i)throw i;if(!n.session)throw new Ci;const l=n.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await Lo(this.storage,this.storageKey));const{data:d,error:x}=await mt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:l.access_token,xform:Ri});if(x)throw x;return l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(a){if(it(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ci;const r=Date.now()/1e3;let a=r,n=!0,i=null;const{payload:l}=fg(t.access_token);if(l.exp&&(a=l.exp,n=a<=r),n){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(it(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(a=l.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new Ci;const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(it(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Va())throw new Cu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Cu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ow("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Cu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ow("No code detected.");const{data:w,error:m}=await this._exchangeCodeForSession(t.code);if(m)throw m;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:i,refresh_token:l,expires_in:o,expires_at:c,token_type:d}=t;if(!i||!o||!l||!d)throw new Cu("No session defined in URL");const x=Math.round(Date.now()/1e3),u=parseInt(o);let f=x+u;c&&(f=parseInt(c));const h=f-x;h*1e3<=Qo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);const p=f-u;x-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,x):x-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,x);const{data:g,error:y}=await this._getUser(i);if(y)throw y;const v={provider_token:a,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:f,refresh_token:l,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(a){if(it(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await wl(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return{error:i};const l=(a=n.session)===null||a===void 0?void 0:a.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(TF(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Ei(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=VF(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,n;try{const{data:{session:i},error:l}=r;if(l)throw l;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Lo(this.storage,this.storageKey,!0));try{return await mt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(it(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:a,error:n}=await this._useSession(async i=>{var l,o,c,d,x;const{data:u,error:f}=i;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await mt(this.fetch,"GET",h,{headers:this.headers,jwt:(x=(d=u.session)===null||d===void 0?void 0:d.access_token)!==null&&x!==void 0?x:void 0})});if(n)throw n;return Va()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(it(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,n;const{data:i,error:l}=r;if(l)throw l;return await mt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(it(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await YF(async n=>(n>0&&await GF(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await mt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:qn})),(n,i)=>{const l=200*Math.pow(2,n);return i&&ug(i)&&Date.now()+l-a<Qo})}catch(a){if(this._debug(r,"error",a),it(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),Va()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await wl(this.storage,this.storageKey);if(n&&this.userStorage){let l=await wl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:n.user},await Jo(this.userStorage,this.storageKey+"-user",l)),n.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:hg()}else if(n&&!n.user&&!n.user){const l=await wl(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(n.user=l.user,await Ei(this.storage,this.storageKey+"-user"),await Jo(this.storage,this.storageKey,n)):n.user=hg()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<xg;if(this._debug(a,`session has${i?"":" not"} expired with margin of ${xg}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),ug(l)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(n.access_token);!o&&(l!=null&&l.user)?(n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(a,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new Ci;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Qh;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new Ci;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),it(i)){const l={session:null,error:i};return ug(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,a=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Jo(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=$w(n);await Jo(this.storage,this.storageKey,i)}else{const n=$w(r);await Jo(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Ei(this.storage,this.storageKey),await Ei(this.storage,this.storageKey+"-code-verifier"),await Ei(this.storage,this.storageKey+"-user"),this.userStorage&&await Ei(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Va()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Qo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-t)/Qo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Qo}ms, refresh threshold is ${x1} ticks`),n<=x1&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof M_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Va()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,l]=await Lo(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(o.toString())}if(a!=null&&a.queryParams){const i=new URLSearchParams(a.queryParams);n.push(i.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;return i?{data:null,error:i}:await mt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(it(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,n;const{data:i,error:l}=r;if(l)return{data:null,error:l};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=await mt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(it(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:l,error:o}=await mt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:o})})}catch(r){if(it(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;return i?{data:null,error:i}:await mt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(it(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const a=(t==null?void 0:t.factors)||[],n=a.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=a.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:a,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,a;const{data:{session:n},error:i}=t;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=fg(n.access_token);let o=null;l.aal&&(o=l.aal);let c=o;((a=(r=n.user.factors)===null||r===void 0?void 0:r.filter(u=>u.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(c="aal2");const x=l.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:x},error:null}}))}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(o=>o.kid===t);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(o=>o.kid===t),a&&this.jwks_cached_at+BF>n)return a;const{data:i,error:l}=await mt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,a=i.keys.find(o=>o.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:h,error:p}=await this.getSession();if(p||!h.session)return{data:null,error:p};a=h.session.access_token}const{header:n,payload:i,signature:l,raw:{header:o,payload:c}}=fg(a);r!=null&&r.allowExpired||tT(i.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:h}=await this.getUser(a);if(h)throw h;return{data:{claims:i,header:n,signature:l},error:null}}const x=rT(n.alg),u=await crypto.subtle.importKey("jwk",d,x,!0,["verify"]);if(!await crypto.subtle.verify(x,u,l,$F(`${o}.${c}`)))throw new h1("Invalid JWT signature");return{data:{claims:i,header:n,signature:l},error:null}}catch(a){if(it(a))return{data:null,error:a};throw a}}}ex.nextInstanceID=0;const vT=ex;class bT extends vT{constructor(t){super(t)}}var yT=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(x){try{d(a.next(x))}catch(u){l(u)}}function c(x){try{d(a.throw(x))}catch(u){l(u)}}function d(x){x.done?i(x.value):n(x.value).then(o,c)}d((a=a.apply(e,t||[])).next())})};class wT{constructor(t,r,a){var n,i,l;this.supabaseUrl=t,this.supabaseKey=r;const o=CF(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const c=`sb-${o.hostname.split(".")[0]}-auth-token`,d={db:gF,realtime:vF,auth:Object.assign(Object.assign({},pF),{storageKey:c}),global:mF},x=NF(a??{},d);this.storageKey=(n=x.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=x.global.headers)!==null&&i!==void 0?i:{},x.accessToken?(this.accessToken=x.accessToken,this.auth=new Proxy({},{get:(u,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=x.auth)!==null&&l!==void 0?l:{},this.headers,x.global.fetch),this.fetch=EF(r,this._getAccessToken.bind(this),x.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},x.realtime)),this.rest=new OB(new URL("rest/v1",o).href,{headers:this.headers,schema:x.db.schema,fetch:this.fetch}),this.storage=new uF(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),x.accessToken||this._listenForAuthEvents()}get functions(){return new hB(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},a={}){return this.rest.rpc(t,r,a)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return yT(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(r=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:i,storageKey:l,flowType:o,lock:c,debug:d},x,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bT({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),x),storageKey:l,autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:i,flowType:o,lock:c,debug:d,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new ZB(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,r,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ET=(e,t,r)=>new wT(e,t,r);function _T(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}_T()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const jT=/iPad|iPhone|iPod/.test(navigator.userAgent),NT=()=>{const e={};return{getItem:t=>{try{return localStorage.getItem(t)||e[t]||null}catch{return e[t]||null}},setItem:(t,r)=>{try{localStorage.setItem(t,r),e[t]=r}catch{e[t]=r}},removeItem:t=>{try{localStorage.removeItem(t),delete e[t]}catch{delete e[t]}}}},qc={employee:"",supervisor:"",trainer:"",expert:"",moderator:"",administrator:""},Ww={online_training:"-",in_person_training:" ",webinar:"",workshop:"-",conference:"",exam:"",welcome_course:"Welcome Course",online_marathon:"-",work_session:" ",practicum:"",case_marathon:"-",demo_laboratory:"-",complex_program:" ",business_game:" ",active_seminar:" ",team_tracking:" "},CT={general:"",event:"",test:"",task:"",system:""},AT={low:"",medium:"",high:"",urgent:""},kT="https://oaockmesooydvausfoca.supabase.co",DT="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hb2NrbWVzb295ZHZhdXNmb2NhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzNzI4NDEsImV4cCI6MjA2Njk0ODg0MX0.gwWS35APlyST7_IUvQvJtGO4QmGsvbE95lnQf0H1PUE",Z=ET(kT,DT,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1,storage:jT?NT():window.localStorage,storageKey:"sns-session-v1",flowType:"pkce",debug:!1,storageType:"localStorage"}}),m1="cached_users",Gw=5;function ST(e){try{const t=localStorage.getItem(m1);let r=t?JSON.parse(t):[];r=r.filter(a=>a.id!==e.id),r.unshift({...e,last_sign_in_at:new Date().toISOString()}),r.length>Gw&&(r=r.slice(0,Gw)),localStorage.setItem(m1,JSON.stringify(r))}catch(t){console.error("    :",t)}}function R_(){try{const e=localStorage.getItem(m1);if(e)return JSON.parse(e).sort((r,a)=>new Date(a.last_sign_in_at).getTime()-new Date(r.last_sign_in_at).getTime())}catch(e){console.error("   :",e)}return[]}function BT(){return R_().length>0}function Au(e){return R_().find(r=>r.id===e)||null}function El(e){e&&e.id&&e.email&&e.full_name&&ST({id:e.id,email:e.email,full_name:e.full_name,role:e.role||"employee",last_sign_in_at:new Date().toISOString(),avatar_url:e.avatar_url})}function ku(e){if(!e||!e.id||!e.email||!e.full_name)return!1;const t=new Date(e.last_sign_in_at),r=new Date;return r.setDate(r.getDate()-30),t>r}async function O_(){try{const{data:{session:e},error:t}=await Z.auth.getSession();return t?(console.error(" Error checking stored session:",t),!1):e!=null&&e.user?(console.log(" Stored session found:",e.user.email),!0):(console.log(" No stored session found"),!1)}catch(e){return console.error(" Exception checking stored session:",e),!1}}async function P_(){try{console.log(" Attempting to restore session from localStorage...");const{data:{session:e},error:t}=await Z.auth.getSession();if(t)return console.error(" Error restoring session:",t),!1;if(e!=null&&e.user){console.log(" Session restored successfully:",e.user.email);const r=e.expires_at;if(r){const a=Math.floor(Date.now()/1e3),n=r-a;if(console.log(` Session expires in ${Math.floor(n/60)} minutes`),n<10*60){console.log(" Token expiring soon, refreshing...");const{data:i,error:l}=await Z.auth.refreshSession();if(l)return console.error(" Error refreshing session:",l),!1;if(i.session)return console.log(" Session refreshed successfully"),!0}}return!0}return!1}catch(e){return console.error(" Exception restoring session:",e),!1}}async function L_(){console.log(" Initializing session recovery..."),await O_()?await P_():console.log(" No stored session to restore")}function I_(e,t){try{const r={email:e,fullName:t||e.split("@")[0],timestamp:Date.now()};localStorage.setItem("sns-last-login",JSON.stringify(r)),console.log(" Last login info saved:",e,t)}catch(r){console.error(" Error saving last login info:",r)}}function FT(e,t){try{const r={email:e,fullName:t||e.split("@")[0],timestamp:Date.now()};localStorage.setItem("sns-last-logout",JSON.stringify(r)),console.log(" Logout info saved:",e,t)}catch(r){console.error(" Error saving logout info:",r)}}function db(){try{const e=localStorage.getItem("sns-last-logout");return e?JSON.parse(e):null}catch(e){return console.error(" Error getting last logout info:",e),null}}function U_(){const e=db();if(!e)return!1;const r=Date.now()-e.timestamp;return Math.floor(r/6e4)<10}const TT=Object.freeze(Object.defineProperty({__proto__:null,checkStoredSession:O_,getLastLogoutInfo:db,initializeSessionRecovery:L_,restoreSession:P_,saveLastLoginInfo:I_,saveLogoutInfo:FT,shouldShowLastLoginInfo:U_},Symbol.toStringTag,{value:"Module"})),$_=E.createContext(void 0);function MT({children:e}){const[t,r]=E.useState(null),[a,n]=E.useState(null),[i,l]=E.useState(null),[o,c]=E.useState(!0),[d,x]=E.useState(null),[u,f]=E.useState("initializing"),[h,p]=E.useState(0);E.useCallback(()=>typeof window>"u"?!1:(window.location.pathname||"").startsWith("/auth/"),[]);const g=E.useRef(null),y=E.useRef(null);E.useEffect(()=>{y.current=t},[t]),E.useEffect(()=>{const P=async()=>{var F;if(document.visibilityState==="visible"&&!(i!=null&&i.user)&&!o){console.log(" App became visible, checking session...");try{const N=await m(1e4);if((F=N.data.session)!=null&&F.user){console.log(" Session restored on app visibility"),l(N.data.session);const T=Au(N.data.session.user.id);if(T&&ku(T)){console.log(" Using cached profile on app restore");const S={...T,role:T.role,subdivision:"management_company",status:"active",work_experience_days:0,is_active:!0,department:"management_company",phone:"",sap_number:void 0,position_id:void 0,branch_id:void 0,territory_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};r(S),n(S)}else j(N.data.session.user.id,{foreground:!1}).catch(S=>console.warn("bg profile fetch on restore failed",S))}}catch(N){console.warn("Session check on visibility change failed:",N)}}};return document.addEventListener("visibilitychange",P),()=>document.removeEventListener("visibilitychange",P)},[i==null?void 0:i.user,o]);const v=(P,F,N,T="emergency")=>{const S=F==="doirp@sns.ru",z={emergency:" ","auth-based":"   auth ",admin:" "};return{id:P,email:F||`emergency-${Date.now()}@sns.local`,full_name:N||(S?" ":`${z[T]} - `),role:S?"administrator":"employee",subdivision:"management_company",status:"active",work_experience_days:0,is_active:!0,department:"management_company",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}},w=P=>{if(!(P!=null&&P.user))return!1;const F=Math.floor(Date.now()/1e3),N=P.expires_at;return N&&F>=N-1800?(console.log(" Session token expires soon, will refresh"),!1):!0},m=async(P=3e4)=>{try{return await b(()=>Z.auth.getSession(),P)}catch(F){return console.warn("[Auth] getSession error/timeout:",(F==null?void 0:F.message)||F),{data:{session:null},error:F}}};async function b(P,F){return Promise.race([P(),new Promise((N,T)=>setTimeout(()=>T(new Error("timeout")),F))])}async function _(P){const{data:F,error:N}=await Z.from("users").select("*").eq("id",P).limit(1).maybeSingle();if(N)throw N;return F}async function C(P){var W,k,q;const{data:F}=await Z.auth.getUser(),N=((W=F==null?void 0:F.user)==null?void 0:W.user_metadata)||{},T={id:P,email:((k=F==null?void 0:F.user)==null?void 0:k.email)||`user-${P}@sns.local`,full_name:N.full_name||` ${P.slice(0,8)}`,role:((q=F==null?void 0:F.user)==null?void 0:q.email)==="doirp@sns.ru"?"administrator":"employee",subdivision:"management_company",status:"active",work_experience_days:0,is_active:!0,department:N.department||"management_company",phone:N.phone||"",sap_number:N.sap_number||null,position_id:N.position_id||null,branch_id:N.branch_id||null,territory_id:N.territory_id||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:S,error:z}=await Z.from("users").upsert(T,{onConflict:"id"}).select("*").maybeSingle();return z?(console.warn(" RLS/insert blocked, using fallback profile in-memory:",z.message),T):S||T}const j=E.useCallback(async(P,{foreground:F=!0}={})=>{if(!P){x("   ID "),c(!1),f("error");return}if(window.location.pathname.startsWith("/auth/")||window.authCallbackProcessing){console.log(" Bypass fetchUserProfile during auth flow");return}const{data:{session:N}}=await Z.auth.getSession();if(!(N!=null&&N.user)){console.log(" No session, skipping profile fetch");return}if(g.current){console.log(" Awaiting in-flight profile request");const S=await g.current;S&&(r(S),n(S),El(S)),F&&(c(!1),f("complete"));return}const T=(async()=>{var S,z,W;try{F&&(f("profile-fetch"),c(!0),x(null));const k=Au(P);if(k&&ku(k)){console.log(" Using cached user profile:",k.id);const I={...k,role:k.role,subdivision:"management_company",status:"active",work_experience_days:0,is_active:!0,department:"management_company",phone:"",sap_number:void 0,position_id:void 0,branch_id:void 0,territory_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};if(r(I),n(I),F)return c(!1),f("complete"),(async()=>{try{console.log(" Background profile refresh");const V=await b(()=>_(P),8e3);if(V){const H={...V,position:V.position||"  "};r(H),n(H),El(H)}}catch(V){console.warn("Background refresh failed:",V.message||V)}})(),I}try{const I=await b(()=>_(P),1e4);if(I){const Y={...I,position:I.position||"  "};return r(Y),n(Y),El(Y),F&&(c(!1),f("complete")),Y}const V=await b(()=>C(P),1e4),H={...V,position:V.position||"  "};return r(H),n(H),El(H),F&&(c(!1),f("complete")),H}catch(I){console.warn(" Profile fetch failed:",I.message||I)}console.warn(" Using auth-based fallback after retries");const{data:q}=await Z.auth.getUser(),A=v(P,(S=q==null?void 0:q.user)==null?void 0:S.email,(W=(z=q==null?void 0:q.user)==null?void 0:z.user_metadata)==null?void 0:W.full_name,"auth-based");return r(A),n(A),El(A),F&&(x("     .   ."),c(!1),f("complete")),A}finally{g.current=null}})();g.current=T,await T},[]);E.useEffect(()=>{!window.location.pathname.startsWith("/auth/")&&(i!=null&&i.user)&&!a&&(console.log(" Post-auth: fetching profile after callback"),j(i.user.id,{foreground:!1}).catch(P=>console.warn("post-auth bg fetch failed",P)))},[i==null?void 0:i.user,a]);const D=async()=>{var P;if(h>=3){console.warn(" Maximum retry attempts reached"),x("   .   .");return}(P=i==null?void 0:i.user)!=null&&P.id&&(p(F=>F+1),console.log(` Retrying profile fetch (attempt ${h+1}/3)`),await j(i.user.id,{foreground:!0}))},R=async()=>{if(i!=null&&i.user){console.log(" Refreshing user profile...");try{await j(i.user.id,{foreground:!0}),console.log(" Profile refresh completed")}catch(P){console.warn(" Refresh failed:",P==null?void 0:P.message)}}},M=()=>{console.log(" Resetting authentication state and clearing cache"),c(!1),r(null),x(null),n(null),l(null),p(0),f("reset");try{const P=localStorage.getItem("cached_users");sessionStorage.clear(),localStorage.clear(),P&&(localStorage.setItem("cached_users",P),console.log("      ")),console.log(" Cleared sessionStorage, preserved user cache")}catch(P){console.warn(" Could not clear storage:",P)}Z.auth.signOut()},O=async(P,F)=>{var N,T;console.log(` Attempting to sign in with identifier: ${P}`),x(null),c(!0),f("auth-change");try{const S=P.includes("@");if(console.log(` Login type: ${S?"email":"SAP"}`),S){const z=await b(()=>Z.auth.signInWithPassword({email:P,password:F}),1e4);if(z.error){const W=B(z.error.message);return x(W),c(!1),f("error"),console.log(" Sign in error:",W),{data:z.data,error:{message:W}}}return console.log(" Email sign in success"),x(null),(N=z.data)!=null&&N.user&&El(z.data.user),z}else{const z=await b(()=>Promise.resolve(Z.from("users").select("email").eq("sap_number",P.trim()).maybeSingle()),8e3),{data:W,error:k}=z;if(k||!(W!=null&&W.email)){const A="   SAP   ";return x(A),c(!1),f("error"),{data:null,error:{message:A}}}const q=await b(()=>Z.auth.signInWithPassword({email:W.email,password:F}),1e4);if(q.error){const A=q.error.message.includes("Invalid login credentials")?"    SAP ":B(q.error.message);return x(A),c(!1),f("error"),{data:q.data,error:{message:A}}}return console.log(" SAP sign in success"),x(null),(T=q.data)!=null&&T.user&&El(q.data.user),q}}catch(S){console.error(" Error in signIn:",S);const z=S.message==="timeout"?"  .    .":` : ${S.message||" "}`;return x(z),c(!1),f("error"),{data:null,error:{message:z}}}},B=P=>P.includes("Invalid login credentials")?"  .    .":P.includes("Email not confirmed")?"Email  .     .":P.includes("Too many requests")?"   .  .":P.includes("User not found")?"  . ,     .":P,L=async()=>{var T,S;console.log(" Signing out user");const P=(t==null?void 0:t.email)||(a==null?void 0:a.email)||"unknown",F=(a==null?void 0:a.full_name)||((T=t==null?void 0:t.user_metadata)==null?void 0:T.full_name)||((S=t==null?void 0:t.user_metadata)==null?void 0:S.name)||P.split("@")[0],{saveLogoutInfo:N}=await u0(async()=>{const{saveLogoutInfo:z}=await Promise.resolve().then(()=>TT);return{saveLogoutInfo:z}},void 0);N(P,F),r(null),n(null),l(null),x(null),p(0),f("logged-out");try{sessionStorage.clear(),console.log(" Cleared sessionStorage, preserved localStorage with session")}catch(z){console.warn(" Could not clear sessionStorage:",z)}return{error:null}};E.useEffect(()=>{let P=!0,F=null,N=0,T=!1;console.log(" Auth provider initialized"),console.log(" useAuth: window.authCallbackProcessing =",window.authCallbackProcessing),(async()=>{var q,A,I;if(window.authCallbackProcessing){console.log(" AuthCallback is processing, skipping initialization"),f("auth-change"),c(!0),setTimeout(()=>{window.authCallbackProcessing&&(console.log(" useAuth: Force clearing flag after timeout"),window.authCallbackProcessing=!1)},2e3);return}const{data:{session:k}}=await Z.auth.getSession();if(k!=null&&k.user&&t){console.log(" User already authenticated and profile loaded, skipping initialization"),f("complete"),c(!1);return}f("session-fetch"),console.log(" Starting session fetch"),await L_();try{const V=await m(3e4);if(!P)return;const H=V.data.session;if(l(H),H!=null&&H.user){console.log(" Initial session found");const Y=((q=H.user.user_metadata)==null?void 0:q.full_name)||((A=H.user.user_metadata)==null?void 0:A.name)||((I=H.user.email)==null?void 0:I.split("@")[0])||"";if(I_(H.user.email||"unknown",Y),window.location.pathname.startsWith("/auth/")||window.authCallbackProcessing)console.log(" Skip initial profile fetch during auth flow"),f("ready"),c(!1);else{const Q=Au(H.user.id);if(Q&&ku(Q)){console.log(" Using cached user profile");const te={...Q,role:Q.role,subdivision:"management_company",status:"active",work_experience_days:0,is_active:!0,department:"management_company",phone:"",sap_number:void 0,position_id:void 0,branch_id:void 0,territory_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};r(te),n(te),f("complete"),c(!1),j(H.user.id,{foreground:!1}).catch(re=>console.warn("bg profile update failed",re))}else f("ready"),c(!1),j(H.user.id,{foreground:!1}).catch(te=>console.warn("initial profile fetch failed",te))}}else console.log(" No initial session found"),f("ready"),c(!1)}catch(V){if(console.error(" Error in initializeAuth:",V),!P)return;console.warn(" Auth initialization failed:",V.message),f("ready"),c(!1)}})();const z=()=>{F&&clearInterval(F),F=setInterval(async()=>{var k,q;if(!(!P||T))try{const{data:{session:A}}=await Z.auth.getSession();if(A!=null&&A.user){const I=Date.now();if(I-N<5*60*1e3){console.log(" Skipping refresh - too soon since last refresh");return}console.log(" Periodic token refresh triggered (keep-alive)"),T=!0,N=I;const{data:V,error:H}=await Z.auth.refreshSession();if(H){if(console.warn("Periodic refresh failed:",H),(k=H.message)!=null&&k.includes("expired")||(q=H.message)!=null&&q.includes("invalid")){console.log(" Token expired, attempting to restore session...");const{data:Y}=await Z.auth.getSession();Y!=null&&Y.session&&(console.log(" Session restored from storage"),l(Y.session))}}else V.session&&(console.log(" Periodic refresh successful - session extended"),l(V.session))}}catch(A){console.warn("Periodic refresh error:",A)}finally{T=!1}},30*60*1e3)},W=Z.auth.onAuthStateChange(async(k,q)=>{var A,I,V;if(P&&(console.log(" Auth state changed:",k,(I=(A=q==null?void 0:q.user)==null?void 0:A.id)==null?void 0:I.substring(0,8)),console.log(" useAuth: window.authCallbackProcessing =",window.authCallbackProcessing),l(q),q!=null&&q.user?z():F&&(clearInterval(F),F=null),k!=="INITIAL_SESSION")){if(k==="TOKEN_REFRESHED"){console.log(" Token refreshed by Supabase"),T=!1,N=Date.now();return}if(window.authCallbackProcessing||window.location.pathname.startsWith("/auth/")){console.log(" Skip profile fetch during auth flow"),f("ready"),c(!1);return}if(q!=null&&q.user&&w(q)){if(console.log(" Valid session found after auth change"),((V=y.current)==null?void 0:V.id)===q.user.id){console.log(" User ID matches existing user, keeping current profile"),f("complete"),c(!1);return}const H=Au(q.user.id);if(H&&ku(H)){console.log(" Using cached profile for session restoration");const Y={...H,role:H.role,subdivision:"management_company",status:"active",work_experience_days:0,is_active:!0,department:"management_company",phone:"",sap_number:void 0,position_id:void 0,branch_id:void 0,territory_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};r(Y),n(Y),f("complete"),c(!1),j(q.user.id,{foreground:!1}).catch(Q=>console.warn("bg profile update failed",Q))}else console.log(" Fetching profile for user:",q.user.id),f("complete"),c(!1),j(q.user.id,{foreground:!1}).catch(Y=>console.warn("bg profile fetch failed",Y))}else if(k==="SIGNED_OUT")console.log(" User signed out, clearing state"),f("logged-out"),r(null),n(null),c(!1);else if(q!=null&&q.user&&!w(q)){const H=Date.now();if(T||H-N<2*60*1e3){console.log(" Skipping refresh - too soon or already refreshing");return}console.log(" Session invalid, attempting refresh"),T=!0,N=H;const Y=async(Q=0)=>{try{const{data:te,error:re}=await Z.auth.refreshSession();if(re)throw re;if(te.session){console.log(" Session refreshed successfully"),l(te.session),T=!1;return}}catch(te){console.warn(`Failed to refresh session (attempt ${Q+1}):`,te),Q<1?setTimeout(()=>Y(Q+1),5e3):(console.warn("All refresh attempts failed, signing out"),T=!1,f("logged-out"),r(null),n(null),c(!1))}};Y()}else console.log(" No session but not signed out, keeping current state")}});return()=>{var k,q,A;console.log(" useAuth: Cleanup function called"),P=!1,F&&(console.log(" useAuth: Clearing refresh interval"),clearInterval(F)),console.log(" useAuth: Unsubscribing from auth changes"),(A=(q=(k=W==null?void 0:W.data)==null?void 0:k.subscription)==null?void 0:q.unsubscribe)==null||A.call(q),console.log(" useAuth: Cleanup completed")}},[]);const U={user:t,userProfile:a,session:i,loading:o,authError:d,loadingPhase:u,signIn:O,signOut:L,resetAuth:M,refreshProfile:R,retryFetchProfile:D};return s.jsx($_.Provider,{value:U,children:e})}function st(){const e=E.useContext($_);if(e===void 0)throw console.error(" useAuth used outside AuthProvider - this is a critical error"),new Error("useAuth must be used within an AuthProvider");return e}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OT=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),Yw=e=>{const t=OT(e);return t.charAt(0).toUpperCase()+t.slice(1)},z_=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),PT=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var LT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IT=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:l,...o},c)=>E.createElement("svg",{ref:c,...LT,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:z_("lucide",n),...!i&&!PT(o)&&{"aria-hidden":"true"},...o},[...l.map(([d,x])=>E.createElement(d,x)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=(e,t)=>{const r=E.forwardRef(({className:a,...n},i)=>E.createElement(IT,{ref:i,iconNode:t,className:z_(`lucide-${RT(Yw(e))}`,`lucide-${e}`,a),...n}));return r.displayName=Yw(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=[["circle",{cx:"12",cy:"13",r:"8",key:"3y4lt7"}],["path",{d:"M12 9v4l2 2",key:"1c63tq"}],["path",{d:"M5 3 2 6",key:"18tl5t"}],["path",{d:"m22 6-3-3",key:"1opdir"}],["path",{d:"M6.38 18.7 4 21",key:"17xu3x"}],["path",{d:"M17.64 18.67 20 21",key:"kv2oe2"}]],$T=Fe("alarm-clock",UT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=[["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}],["path",{d:"M10 4v4",key:"pp8u80"}],["path",{d:"M2 8h20",key:"d11cs7"}],["path",{d:"M6 4v4",key:"1svtjw"}]],qT=Fe("app-window",zT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],HT=Fe("arrow-down",VT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],kn=Fe("arrow-left",WT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],io=Fe("arrow-right",GT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],XT=Fe("arrow-up-down",YT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],QT=Fe("arrow-up",KT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],er=Fe("award",JT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Gl=Fe("bell",ZT);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],lo=Fe("book-open",eM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],rM=Fe("brain",tM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],tx=Fe("briefcase",sM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],Ka=Fe("building-2",aM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],vd=Fe("building",nM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],lM=Fe("calendar-check",iM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],cM=Fe("calendar-clock",oM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],di=Fe("calendar-days",dM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],zt=Fe("calendar",xM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],oo=Fe("camera",uM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M8 17v-3",key:"17ska0"}]],hM=Fe("chart-column-increasing",fM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mM=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Dn=Fe("chart-column",mM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],mn=Fe("check",gM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xi=Fe("chevron-down",pM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Sn=Fe("chevron-left",vM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Fa=Fe("chevron-right",bM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Vc=Fe("chevron-up",yM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ar=Fe("circle-alert",wM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EM=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],at=Fe("circle-check-big",EM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Pa=Fe("circle-check",_M);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],q_=Fe("circle-plus",jM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],CM=Fe("circle-user-round",NM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ds=Fe("circle-x",AM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],V_=Fe("clipboard-check",kM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],SM=Fe("clipboard-list",DM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],FM=Fe("clipboard",BM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TM=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],MM=Fe("clock-3",TM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],wr=Fe("clock",RM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Hc=Fe("copy",OM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Bn=Fe("download",PM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],IM=Fe("ellipsis-vertical",LM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],H_=Fe("eye-off",UM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],el=Fe("eye",$M);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Yn=Fe("file-spreadsheet",zM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Et=Fe("file-text",qM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],HM=Fe("flag",VM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Jh=Fe("funnel",WM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],YM=Fe("gauge",GM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Wc=Fe("graduation-cap",XM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],W_=Fe("grip-vertical",KM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],rx=Fe("hash",QM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],G_=Fe("house",JM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Vs=Fe("info",ZM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],tR=Fe("lightbulb",eR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],sR=Fe("link",rR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],nR=Fe("list-filter",aR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Er=Fe("loader-circle",iR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Xw=Fe("lock",lR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],g1=Fe("log-out",oR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ao=Fe("mail",cR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],nr=Fe("map-pin",dR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],xb=Fe("menu",xR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],La=Fe("message-square",uR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],hR=Fe("mouse-pointer",fR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],gR=Fe("octagon-alert",mR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Y_=Fe("pause",pR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],bR=Fe("pen-line",vR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],gg=Fe("pen",yR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ER=Fe("pencil-line",wR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],jR=Fe("percent",_R);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],tl=Fe("phone",NR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Xn=Fe("play",CR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],es=Fe("plus",AR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]],Kw=Fe("presentation",kR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],Zh=Fe("qr-code",DR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],en=Fe("refresh-cw",SR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],X_=Fe("rotate-ccw",BR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ps=Fe("save",FR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ia=Fe("search",TR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],rl=Fe("send",MR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gf=Fe("settings",RR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],K_=Fe("shield-check",OR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],co=Fe("shield",PR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],IR=Fe("smartphone",LR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}]],$R=Fe("sparkle",UR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Yf=Fe("sparkles",zR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],sn=Fe("square-pen",qR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ms=Fe("star",VR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ys=Fe("target",HR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],GR=Fe("test-tube",WR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],XR=Fe("text-align-start",YR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Zr=Fe("trash-2",KR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],sx=Fe("trending-up",QR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],an=Fe("triangle-alert",JR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],eO=Fe("trophy",ZR);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tO=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],xo=Fe("upload",tO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],sO=Fe("user-check",rO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ax=Fe("user-plus",aO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],qt=Fe("user",nO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],nt=Fe("users",iO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],ub=Fe("users-round",lO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oO=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Q_=Fe("video",oO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qe=Fe("x",cO);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dO=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],fb=Fe("zap",dO);function J_(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=J_(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function Ve(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=J_(e))&&(a&&(a+=" "),a+=t);return a}const Qw=wt.memo(({isCollapsed:e,onToggle:t,className:r})=>s.jsx("button",{className:Ve("hidden lg:flex items-center justify-center z-50 rounded-full transition backdrop-blur bg-white/60 border border-white/40 shadow-2xl","w-10 h-10",r),onClick:t,title:e?" ":" ",style:{outline:"none"},children:e?s.jsx(Fa,{size:22,className:"text-gray-400 hover:text-gray-600 transition-colors"}):s.jsx(Sn,{size:22,className:"text-gray-400 hover:text-gray-600 transition-colors"})})),xO=[{id:"dashboard",label:"",icon:s.jsx(qT,{}),href:"/dashboard",description:"  ",roles:["employee","supervisor","trainer","expert","moderator","administrator"]},{id:"events",label:" ",icon:s.jsx(lo,{}),href:"/events",description:" ",roles:["employee","supervisor","trainer","moderator","administrator"]},{id:"tests",label:"",icon:s.jsx(Et,{}),href:"/testing",description:" ",roles:["employee","supervisor","trainer","moderator","administrator"]},{id:"employees",label:" ",icon:s.jsx(nt,{}),href:"/employees",description:" ",roles:["supervisor","trainer","moderator","administrator"]},{id:"representatives",label:" ",icon:s.jsx(Ka,{}),href:"/representatives",description:"  ",roles:["supervisor","trainer","moderator","administrator"],disabled:!0,disabledReason:" "},{id:"supervisors",label:"",icon:s.jsx(Wc,{}),href:"/supervisors",description:" ",roles:["trainer","moderator","administrator"],disabled:!0,disabledReason:" "},{id:"expert-events",label:" ",icon:s.jsx(Ms,{}),href:"/expert-events",description:" ",roles:["trainer","moderator","administrator"],disabled:!0,disabledReason:" "},{id:"exam-management",label:"  ",icon:s.jsx(Wc,{}),href:"/exam-reserve",description:" ",roles:["moderator","administrator"]},{id:"analytics",label:"",icon:s.jsx(Dn,{}),href:"/analytics",description:"  ",roles:["supervisor","trainer","moderator","administrator"],disabled:!0,disabledReason:" "},{id:"tasks",label:" ",icon:s.jsx(ar,{}),href:"/tasks",badge:3,description:" ",roles:["supervisor","trainer","moderator","administrator"],disabled:!0,disabledReason:" "},{id:"testing",label:"",icon:s.jsx(GR,{}),href:"/testing",description:" ",roles:["trainer","moderator","administrator"]},{id:"trainer-territories",label:" ",icon:s.jsx(Ka,{}),href:"/trainer-territories",description:" ",roles:["trainer","moderator","administrator"]},{id:"admin",label:"",icon:s.jsx(co,{}),href:"/admin",description:" ",roles:["administrator"]},{id:"schedule",label:"",icon:s.jsx(zt,{}),href:"/expert-schedule",description:" ",roles:["expert","administrator"]}];function O0({activeItem:e,onItemClick:t,isCollapsed:r=!1,onToggle:a,isMobile:n=!1,onMobileClose:i}){var h,p;const{user:l,userProfile:o}=st(),[c,d]=E.useState(!1);E.useEffect(()=>{if(n){const g=()=>{d(window.scrollY>10)};return window.addEventListener("scroll",g),()=>window.removeEventListener("scroll",g)}},[n]);const x=xO.filter(g=>!g.roles||g.roles.includes((o==null?void 0:o.role)||(l==null?void 0:l.role)||"employee")),u=((h=o==null?void 0:o.full_name)==null?void 0:h.split(" ").map(g=>g[0]).join("").slice(0,2))||(l!=null&&l.email?l.email[0].toUpperCase():"U"),f=(o==null?void 0:o.full_name)||((p=l==null?void 0:l.email)==null?void 0:p.split("@")[0])||"";return s.jsxs("aside",{className:Ve("transition-all duration-300 ease-out flex flex-col",n?"w-full mobile-menu-full-height rounded-none pt-safe-top pb-safe-bottom mobile-glass-effect":"fixed left-4 top-[96px] z-40 rounded-2xl h-[calc(100vh-96px-2rem)] pt-0 mb-8 bg-white/95 backdrop-blur-xl shadow-2xl border border-gray-100/50",r?"lg:w-20":"lg:w-80","w-full"),children:[n&&i&&s.jsxs("div",{className:Ve("flex items-center justify-between p-4 transition-all duration-300 flex-shrink-0 mobile-glass-header","mobile-glass-header"),children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""}),s.jsx("p",{className:"text-sm text-gray-500",children:"   "})]}),s.jsx("button",{onClick:i,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/60 rounded-xl transition-all duration-200 active:scale-95 backdrop-blur-sm",title:" ",children:s.jsx(Qe,{size:24})})]}),s.jsx("nav",{className:Ve("flex-1 overflow-y-auto",n?"mobile-glass-nav":""),children:s.jsx("div",{className:Ve("space-y-1",n?"px-4 py-4":"px-2 py-2"),children:x.length>0?x.map(g=>{const y=e===g.id;return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>!g.disabled&&t(g.id),disabled:g.disabled,className:Ve("group relative w-full transition-all duration-300 font-medium text-sm rounded-2xl",n?"flex items-center px-4 py-4 h-16":r?"h-12 flex items-center justify-center":"flex items-center px-4 py-3 h-14",g.disabled?"opacity-50 cursor-not-allowed bg-gray-50/50 text-gray-400":y?"bg-gradient-to-r from-[#06A478] to-[#059669] text-white shadow-xl shadow-[#06A478]/30 backdrop-blur-sm":n?"hover:bg-white/70 text-gray-700 hover:text-gray-900 hover:shadow-md hover:backdrop-blur-sm":"hover:bg-gray-50/80 text-gray-700 hover:text-gray-900 hover:shadow-sm hover:backdrop-blur-sm"),title:g.disabled?g.disabledReason:g.label,children:[s.jsx("div",{className:Ve("flex items-center justify-center rounded-xl transition-all duration-300",n?"w-10 h-10":"w-9 h-9",g.disabled?"bg-gray-100/50":y?"bg-white/20 backdrop-blur-sm":"bg-transparent group-hover:bg-[#06A478]/10 group-hover:backdrop-blur-sm"),children:wt.cloneElement(g.icon,{size:n?22:20,strokeWidth:2,className:Ve("transition-all duration-300",g.disabled?"text-gray-400":y?"text-white drop-shadow-sm":"text-gray-600 group-hover:text-[#06A478] group-hover:scale-110")})}),(n||!r)&&s.jsxs("div",{className:"flex-1 min-w-0 ml-3 text-left",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:Ve("font-medium truncate",n?"text-base":"text-sm",g.disabled?"text-gray-400":y?"text-white font-semibold":"text-gray-700"),children:g.label}),g.disabled&&s.jsx("span",{className:"text-xs text-gray-500 font-normal mt-0.5",children:" "})]}),g.badge&&s.jsx("span",{className:"ml-2 bg-gradient-to-r from-red-500 to-red-600 text-white text-xs rounded-full px-2.5 py-1 font-semibold min-w-[24px] text-center shadow-sm border border-red-400/20",children:g.badge})]}),n&&g.description&&!g.disabled&&s.jsx("p",{className:Ve("text-xs truncate mt-0.5",y?"text-white/80":"text-gray-500"),children:g.description})]}),n&&s.jsx("div",{className:"p-1 rounded-lg bg-gray-100/50",children:s.jsx(Fa,{size:16,className:Ve("transition-all duration-300",g.disabled?"text-gray-300":y?"text-white/80":"text-gray-500 group-hover:text-[#06A478] group-hover:scale-110")})})]}),g.badge&&!n&&r&&s.jsx("span",{className:"absolute top-1 right-1 bg-gradient-to-r from-red-500 to-red-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center shadow-md font-semibold border border-red-400/20",children:g.badge}),!n&&r&&s.jsxs("div",{className:"absolute left-full ml-3 px-4 py-3 bg-gray-900/95 backdrop-blur-md text-white text-sm rounded-2xl shadow-2xl border border-gray-700/50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50 pointer-events-none whitespace-nowrap",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-medium",children:g.label}),g.disabled&&s.jsx("span",{className:"text-xs text-gray-400 font-normal mt-1",children:" "})]}),g.badge&&!g.disabled&&s.jsx("span",{className:"ml-2 bg-gradient-to-r from-red-500 to-red-600 text-white text-xs rounded-full px-2.5 py-1 shadow-sm border border-red-400/20",children:g.badge}),s.jsx("div",{className:"absolute top-1/2 left-0 -translate-y-1/2 -translate-x-1 w-2 h-2 bg-gray-900/95 rotate-45 border-l border-t border-gray-700/50"})]})]},g.id)}):s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm text-gray-500",children:"  "})})})}),s.jsx("div",{className:Ve("mt-0 transition-all duration-300 flex-shrink-0",n?"p-6 pb-safe-bottom mobile-glass-user":"p-4 border-t border-gray-100/50"),children:n?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#06A478] to-[#059669] rounded-xl flex items-center justify-center shadow-lg",children:s.jsx("span",{className:"text-white font-semibold text-sm",children:u})}),s.jsx("button",{onClick:()=>{},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-white/90 backdrop-blur-sm rounded-lg flex items-center justify-center shadow-sm hover:scale-110 transition-all duration-200",title:" ",children:s.jsx(oo,{size:12,className:"text-gray-600"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-base font-semibold text-gray-900 truncate",children:f}),s.jsx("p",{className:"text-sm text-gray-500 truncate",children:o!=null&&o.role?qc[o.role]:"  "})]})]}),s.jsxs("div",{className:"space-y-2",children:[(o==null?void 0:o.role)!=="expert"&&s.jsxs("button",{className:"flex items-center space-x-3 w-full p-3 text-left rounded-xl hover:bg-white/60 transition-all duration-200 active:scale-95 backdrop-blur-sm",children:[s.jsx(Gf,{size:18,className:"text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]}),s.jsxs("button",{onClick:()=>{},className:"flex items-center space-x-3 w-full p-3 text-left rounded-xl hover:bg-red-50/80 transition-all duration-200 active:scale-95 backdrop-blur-sm",children:[s.jsx(g1,{size:18,className:"text-red-500"}),s.jsx("span",{className:"text-sm font-medium text-red-600",children:""})]})]})]}):s.jsx(s.Fragment,{children:r?s.jsxs("div",{className:"relative flex flex-col items-center gap-2",children:[s.jsx("div",{className:"relative z-10 w-8 h-8 bg-gradient-to-br from-[#06A478] to-[#059669] rounded-xl flex items-center justify-center shadow-lg",children:s.jsx("span",{className:"text-white font-semibold text-xs",children:u})}),!n&&a&&s.jsx(Qw,{isCollapsed:r,onToggle:a,className:"absolute right-[-72px] top-1/2 -translate-y-1/2 hidden lg:flex z-0"})]}):s.jsxs("div",{className:"relative flex items-center space-x-3",children:[s.jsx("div",{className:"relative z-10 w-8 h-8 bg-gradient-to-br from-[#06A478] to-[#059669] rounded-xl flex items-center justify-center shadow-lg",children:s.jsx("span",{className:"text-white font-semibold text-xs",children:u})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:f}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:o!=null&&o.role?qc[o.role]:"  "})]}),!n&&a&&s.jsx(Qw,{isCollapsed:r,onToggle:a,className:"absolute right-[-72px] top-1/2 -translate-y-1/2 hidden lg:flex"})]})})})]})}function uO({isOpen:e,onClose:t,user:r,onSuccess:a}){const[n,i]=E.useState(!1),[l,o]=E.useState("idle"),[c,d]=E.useState(""),[x,u]=E.useState(null),[f,h]=E.useState(null),[p,g]=E.useState(Date.now()),y=E.useRef(null);if(wt.useEffect(()=>{e&&g(Date.now())},[e]),!e)return null;const v=C=>["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(C.type)?C.size>5242880?{isValid:!1,error:"     5 "}:C.size<1024?{isValid:!1,error:"  .    "}:{isValid:!0}:{isValid:!1,error:"  : JPG, PNG, GIF, WebP"},w=C=>{const j=new FileReader;j.onload=D=>{var M;const R=new Image;R.onload=()=>{var L;const O=document.createElement("canvas"),B=O.getContext("2d");if(B){const U=Math.max(R.width,R.height);O.width=U,O.height=U;const P=(U-R.width)/2,F=(U-R.height)/2;B.drawImage(R,P,F);const N=O.toDataURL("image/jpeg",.8);h(N)}else h((L=D.target)==null?void 0:L.result)},R.src=(M=D.target)==null?void 0:M.result},j.readAsDataURL(C)},m=C=>{var R;const j=(R=C.target.files)==null?void 0:R[0];if(!j)return;d(""),o("idle");const D=v(j);if(!D.isValid){d(D.error||"  "),o("error");return}u(j),w(j)},b=()=>{u(null),h(null),d(""),o("idle"),y.current&&(y.current.value="")},_=async()=>{if(!x||!(r!=null&&r.id)){d("    ");return}i(!0),o("uploading"),d("");try{const C=x.name.split(".").pop(),j=`public/${r.id}.${C}`,{data:D,error:R}=await Z.storage.from("avatars").upload(j,x,{upsert:!0,contentType:x.type});if(R)throw R;const{data:M}=Z.storage.from("avatars").getPublicUrl(j),O=M==null?void 0:M.publicUrl;if(!O)throw new Error("     ");const{data:B,error:L}=await Z.from("users").update({avatar_url:O}).eq("id",r.id).select("avatar_url, full_name, email");if(L)throw L;const U=`${O}?t=${Date.now()}`;o("success"),g(Date.now()),a(),setTimeout(()=>{t()},1500)}catch(C){console.error("Error uploading avatar:",C),d(C.message||"  .   ."),o("error")}finally{i(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full shadow-2xl border border-gray-100 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"   "})]}),s.jsx("button",{onClick:t,className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center transition-colors",disabled:n,children:s.jsx(Qe,{size:18,className:"text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl flex items-center justify-center overflow-hidden shadow-lg",children:r!=null&&r.avatar_url?s.jsx("img",{src:`${r.avatar_url}?t=${p}`,alt:r.full_name,className:"w-full h-full object-cover"}):s.jsx(oo,{size:32,className:"text-gray-400"})}),s.jsx("div",{className:"absolute -bottom-1 -right-1 w-7 h-7 bg-[#06A478] rounded-lg border-2 border-white flex items-center justify-center",children:s.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-3 font-medium",children:r==null?void 0:r.full_name}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:" "})]}),s.jsxs("div",{className:"space-y-4",children:[f&&s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-center mb-3",children:s.jsx("p",{className:"text-sm font-medium text-gray-700",children:" "})}),s.jsxs("div",{className:"relative mx-auto w-32 h-32 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl overflow-hidden border-2 border-dashed border-gray-200 shadow-lg",children:[s.jsx("img",{src:f,alt:" ",className:"w-full h-full object-cover"}),s.jsx("button",{onClick:b,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 hover:bg-red-600 rounded-lg flex items-center justify-center transition-colors shadow-lg",title:" ",children:s.jsx(Zr,{size:16,className:"text-white"})})]}),s.jsx("div",{className:"text-center mt-3",children:s.jsx("p",{className:"text-xs text-gray-500",children:"      "})})]}),!x&&s.jsxs("label",{className:"block",children:[s.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:m,className:"hidden",disabled:n}),s.jsx("div",{className:"w-full p-8 border-2 border-dashed border-gray-300 rounded-2xl hover:border-[#06A478] hover:bg-[#06A478]/5 transition-all duration-200 cursor-pointer group",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-[#06A478]/10 rounded-2xl flex items-center justify-center mx-auto mb-4 group-hover:bg-[#06A478]/20 transition-colors",children:s.jsx(xo,{size:28,className:"text-[#06A478]"})}),s.jsx("p",{className:"text-base font-medium text-gray-700 mb-2",children:"  "}),s.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"  400x400 "}),s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-100 rounded-lg",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"JPG, PNG, GIF, WebP"}),s.jsx("span",{className:"text-xs text-gray-400",children:""}),s.jsx("span",{className:"text-xs text-gray-600",children:". 5 "})]})]})})]}),x&&s.jsx("div",{className:"bg-gradient-to-r from-[#06A478]/5 to-[#2621BE]/5 rounded-2xl p-4 border border-[#06A478]/20",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-2 h-2 bg-[#06A478] rounded-full"}),s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:x.name})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[s.jsxs("span",{children:[(x.size/1024/1024).toFixed(2)," "]}),s.jsx("span",{children:""}),s.jsx("span",{children:x.type.split("/")[1].toUpperCase()})]})]}),s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-8 h-8 bg-[#06A478]/10 rounded-lg flex items-center justify-center",children:s.jsx(at,{size:16,className:"text-[#06A478]"})})})]})}),c&&s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-2xl",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:s.jsx(ar,{size:20,className:"text-red-500"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-red-700",children:" "}),s.jsx("p",{className:"text-xs text-red-600 mt-0.5",children:c})]})]}),l==="success"&&s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-2xl",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center flex-shrink-0",children:s.jsx(at,{size:20,className:"text-green-500"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-green-700",children:" !"}),s.jsx("p",{className:"text-xs text-green-600 mt-0.5",children:"  "})]})]})]})]}),s.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-100 bg-gray-50",children:[s.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 text-gray-700 bg-white border border-gray-300 rounded-2xl hover:bg-gray-50 transition-colors font-medium shadow-sm",disabled:n,children:""}),s.jsx("button",{onClick:_,disabled:!x||n,className:"flex-1 px-4 py-3 bg-gradient-to-r from-[#06A478] to-[#059669] text-white rounded-2xl hover:from-[#059669] hover:to-[#048A5A] transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-[#06A478]/25",children:n?s.jsxs(s.Fragment,{children:[s.jsx(Er,{size:18,className:"animate-spin"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(xo,{size:18})," "]})})]})]})})}function Z_(){const{user:e}=st(),[t,r]=E.useState([]),[a,n]=E.useState(!0),[i,l]=E.useState(null),o=async()=>{if(e!=null&&e.id)try{n(!0),l(null);const{data:f,error:h}=await Z.from("notification_tasks").select("*").eq("assigned_to",e.id).order("created_at",{ascending:!1}).limit(50);if(h)throw h;r(f||[])}catch(f){console.error("  :",f),l(f.message||"  ")}finally{n(!1)}},c=async f=>{try{const{error:h}=await Z.from("notification_tasks").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",f);if(h)throw h;r(p=>p.map(g=>g.id===f?{...g,status:"completed",completed_at:new Date().toISOString()}:g))}catch(h){console.error("  :",h),l(h.message||"  ")}},d=async(f,h,p,g="general",y="medium",v={})=>{try{const{data:w,error:m}=await Z.from("notification_tasks").insert({user_id:e==null?void 0:e.id,assigned_to:f,title:h,description:p,type:g,priority:y,metadata:v}).select().single();if(m)throw m;return f===(e==null?void 0:e.id)&&r(b=>[w,...b]),w}catch(w){throw console.error("  :",w),l(w.message||"  "),w}},x=()=>t.filter(f=>f.status==="pending").length,u=f=>{const h=new Date(f),g=Math.floor((new Date().getTime()-h.getTime())/(1e3*60));if(g<1)return" ";if(g<60)return`${g}  `;const y=Math.floor(g/60);if(y<24)return`${y} ${y>1?"":""} `;const v=Math.floor(y/24);return v<7?`${v} ${v>1?"":""} `:h.toLocaleDateString("ru-RU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})};return E.useEffect(()=>{e!=null&&e.id?o():(r([]),n(!1))},[e==null?void 0:e.id]),{notifications:t,loading:a,error:i,fetchNotifications:o,markAsRead:c,createNotification:d,getUnreadCount:x,formatTime:u}}function fO(){const[e,t]=E.useState(!1),{notifications:r,loading:a,error:n,markAsRead:i,getUnreadCount:l,formatTime:o}=Z_(),c=l();return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>t(!e),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors relative",children:[s.jsx(Gl,{size:20}),c>0&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:c})]}),e&&s.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-200 z-50",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:""}),s.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:16})})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:a?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto mb-2"})," ..."]}):n?s.jsxs("div",{className:"p-4 text-center text-red-500",children:[s.jsx(ar,{size:20,className:"mx-auto mb-2"}),"  "]}):r.length===0?s.jsx("div",{className:"p-4 text-center text-gray-500",children:" "}):r.map(d=>s.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors ${d.status==="pending"?"bg-blue-50":""}`,onClick:()=>{d.status==="pending"&&i(d.id)},children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900",children:d.title}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${d.priority==="urgent"?"bg-red-100 text-red-700":d.priority==="high"?"bg-orange-100 text-orange-700":d.priority==="medium"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:AT[d.priority]})]}),d.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:d.description}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsx(wr,{size:12}),s.jsx("span",{children:o(d.created_at)}),s.jsx("span",{className:"text-gray-300",children:""}),s.jsx("span",{children:CT[d.type]})]})]}),d.status==="pending"&&s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full ml-2 mt-1 flex-shrink-0"})]})},d.id))})]})]})}function pg({onMobileMenuToggle:e}){const{user:t,userProfile:r,loading:a,signOut:n,refreshProfile:i}=st(),[l,o]=E.useState(!1),[c,d]=E.useState(Date.now()),[x,u]=E.useState(!1),[f,h]=E.useState(!1);Qt();const p=ul();E.useEffect(()=>{const _=()=>{u(window.scrollY>10)};return window.addEventListener("scroll",_),()=>window.removeEventListener("scroll",_)},[]);const g=_=>{var j;if(!_)return"?";const C=_.trim().split(" ");return C.length>=2?`${C[0][0]}${C[1][0]}`.toUpperCase():((j=_[0])==null?void 0:j.toUpperCase())||"?"},y=()=>{d(Date.now()),i()};r==null||r.role;const v=E.useMemo(()=>{var _;return a?"...":(r==null?void 0:r.full_name)||((_=t==null?void 0:t.email)==null?void 0:_.split("@")[0])||""},[r,t,a]),w=E.useMemo(()=>a?"...":r!=null&&r.role?qc[r.role]:"  ",[r,a]),m=()=>{switch(p.pathname){case"/":return"";case"/events":return"";case"/testing":return"";case"/employees":return"";case"/representatives":return"";case"/supervisors":return"";case"/expert-events":return" ";case"/analytics":return"";case"/tasks":return"";case"/admin":return"";case"/trainer-territories":return"";default:return" "}},b=async()=>{try{await n()}catch{}};return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:`
        fixed top-0 left-0 right-0 z-50 transition-all duration-300 ease-out
        ${x?"bg-white/80 backdrop-blur-xl border-b border-gray-200/50 shadow-lg":"bg-white/95 backdrop-blur-md border-b border-gray-100"}
      `,children:s.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[s.jsx("button",{onClick:e,className:"lg:hidden p-2 -ml-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-xl transition-all duration-200 active:scale-95",title:" ",children:s.jsx(xb,{size:24})}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:"https://static.tildacdn.com/tild3434-6235-4334-b731-653564373934/Group.svg",alt:"SNS Group of companies",className:"h-7 sm:h-8 w-auto"}),s.jsx("div",{className:"hidden sm:block border-l border-gray-200 h-6"})]}),s.jsxs("div",{className:"hidden sm:block ml-4",children:[s.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:" "})]})]}),s.jsx("div",{className:"sm:hidden flex-1 text-center",children:s.jsx("h2",{className:"text-base font-semibold text-gray-900 truncate",children:m()})}),s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[s.jsx("button",{className:"hidden lg:flex p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-xl transition-all duration-200",children:s.jsx(Ia,{size:20})}),s.jsx("div",{className:"hidden lg:block",children:s.jsx(fO,{})}),s.jsx("div",{className:"lg:hidden",children:s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>h(!f),className:"flex items-center space-x-2 p-2 rounded-xl hover:bg-gray-100 transition-all duration-200 active:scale-95",children:[s.jsxs("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-100 to-gray-200 rounded-xl flex items-center justify-center overflow-hidden shadow-sm",children:[r!=null&&r.avatar_url?s.jsx("img",{src:`${r.avatar_url}?t=${c}`,alt:r.full_name,className:"w-full h-full object-cover",onError:_=>{var C;_.currentTarget.style.display="none",(C=_.currentTarget.nextElementSibling)==null||C.classList.remove("hidden")}}):null,s.jsx("div",{className:`w-full h-full flex items-center justify-center ${r!=null&&r.avatar_url?"hidden":""}`,children:s.jsx("span",{className:"text-xs font-bold text-gray-600",children:g(r==null?void 0:r.full_name)})})]}),s.jsx(xi,{size:16,className:`text-gray-500 transition-transform duration-200 ${f?"rotate-180":""}`})]}),f&&s.jsxs("div",{className:"absolute right-0 top-full mt-2 w-72 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden z-50",children:[s.jsx("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-br from-gray-50 to-white",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-100 to-gray-200 rounded-xl flex items-center justify-center overflow-hidden shadow-sm",children:[r!=null&&r.avatar_url?s.jsx("img",{src:`${r.avatar_url}?t=${c}`,alt:r.full_name,className:"w-full h-full object-cover",onError:_=>{var C;_.currentTarget.style.display="none",(C=_.currentTarget.nextElementSibling)==null||C.classList.remove("hidden")}}):null,s.jsx("div",{className:`w-full h-full flex items-center justify-center ${r!=null&&r.avatar_url?"hidden":""}`,children:s.jsx("span",{className:"text-sm font-bold text-gray-600",children:g(r==null?void 0:r.full_name)})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:v}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:w})]}),s.jsx("button",{onClick:()=>o(!0),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:" ",children:s.jsx(oo,{size:16})})]})}),s.jsxs("div",{className:"p-3 border-t border-gray-100",children:[(r==null?void 0:r.role)!=="expert"&&s.jsxs("button",{onClick:()=>{h(!1)},className:"flex items-center space-x-3 w-full p-3 text-left rounded-xl hover:bg-gray-50 transition-all duration-200 active:scale-95",children:[s.jsx(Gf,{size:18,className:"text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]}),s.jsxs("button",{onClick:()=>{b(),h(!1)},className:"flex items-center space-x-3 w-full p-3 text-left rounded-xl hover:bg-red-50 transition-all duration-200 active:scale-95",children:[s.jsx(g1,{size:18,className:"text-red-500"}),s.jsx("span",{className:"text-sm font-medium text-red-600",children:""})]})]})]})]})}),s.jsx("div",{className:"hidden lg:flex items-center space-x-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:v}),s.jsx("div",{className:"flex items-center space-x-1",children:s.jsx("p",{className:"text-xs text-gray-500",children:w})})]}),s.jsxs("div",{className:"relative group",children:[s.jsxs("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl flex items-center justify-center overflow-hidden shadow-sm",children:[r!=null&&r.avatar_url?s.jsx("img",{src:`${r.avatar_url}?t=${c}`,alt:r.full_name,className:"w-full h-full object-cover transition-transform duration-200 group-hover:scale-105",onError:_=>{var C;_.currentTarget.style.display="none",(C=_.currentTarget.nextElementSibling)==null||C.classList.remove("hidden")}}):null,s.jsx("div",{className:`w-full h-full flex items-center justify-center ${r!=null&&r.avatar_url?"hidden":""}`,children:s.jsx("span",{className:"text-base font-bold text-gray-600",children:g(r==null?void 0:r.full_name)})})]}),s.jsx("button",{onClick:()=>o(!0),className:"absolute -bottom-1 -right-1 w-6 h-6 bg-[#06A478] rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-200 shadow-sm hover:scale-110",title:" ",tabIndex:-1,children:s.jsx(oo,{size:14,className:"text-white"})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-xl transition-all duration-200",title:"",children:s.jsx(Gf,{size:18})}),s.jsxs("button",{onClick:b,className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-xl transition-all duration-200 flex items-center space-x-1",title:"",children:[s.jsx(g1,{size:18}),s.jsx("span",{className:"text-xs hidden sm:inline",children:""})]})]})]})})]})]})})}),f&&s.jsx("div",{className:"fixed inset-0 z-40 lg:hidden",onClick:()=>h(!1)}),s.jsx(uO,{isOpen:l,onClose:()=>o(!1),user:r,onSuccess:y})]})}const Yl=E.forwardRef(function({size:t=28,className:r,label:a,color:n,strokeWidth:i=2,light:l=!1,direction:o="vertical",labelClassName:c,iconClassName:d},x){const u={width:t,height:t,color:n||void 0};return s.jsxs("div",{ref:x,className:Ve("flex items-center justify-center gap-2",o==="horizontal"?"flex-row":"flex-col",r),role:"status","aria-live":"polite",children:[s.jsx(Er,{className:Ve("animate-spin text-sns-green drop-shadow-sm",l&&"text-white/80",d),style:u,strokeWidth:i,"aria-hidden":"true"}),a&&s.jsx("span",{className:Ve("text-xs font-medium text-gray-500",l&&"text-white/80",o==="horizontal"?"text-sm":"",c),children:a})]})}),hO={dashboard:G_,events:lM,testing:SM,employees:ub,profile:CM,calendar:di};function mO({activeItem:e,items:t,onSelect:r,isVisible:a=!0,showCreateButton:n=!1,onCreatePress:i,busy:l=!1}){return s.jsx("div",{className:Ve("pointer-events-none fixed inset-x-0 bottom-0 z-40 px-4 pb-4 lg:hidden transition-all duration-300",a?"translate-y-0 opacity-100":"translate-y-10 opacity-0"),children:s.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center gap-3",children:[s.jsx("nav",{className:"pointer-events-auto w-full rounded-3xl border border-white/60 bg-white/90 shadow-xl backdrop-blur-xl",children:s.jsx("ul",{className:"flex items-stretch justify-between",children:t.map(o=>{const c=o.icon||hO[o.id]||G_,d=e===o.id;return s.jsx("li",{className:"flex-1",children:s.jsxs("button",{type:"button",onClick:()=>!o.disabled&&r(o.id),disabled:o.disabled,className:Ve("group relative flex w-full flex-col items-center justify-center gap-1 py-3 text-xs font-medium transition-all duration-200 touch-target",d?"text-sns-green":"text-slate-500 hover:text-sns-green focus:text-sns-green",o.disabled&&"opacity-40"),children:[s.jsx(c,{className:Ve("h-5 w-5 transition-transform duration-200",d&&"scale-110")}),s.jsx("span",{children:o.label}),o.badge&&s.jsx("span",{className:"absolute right-6 top-2 inline-flex min-w-[1.25rem] items-center justify-center rounded-full bg-red-500 px-1.5 text-[10px] font-semibold text-white",children:o.badge})]})},o.id)})})}),(n||l)&&s.jsx("div",{className:"pointer-events-auto",children:s.jsx("button",{type:"button",onClick:i,disabled:l,className:"flex items-center gap-2 rounded-full bg-sns-green px-6 py-3 text-sm font-semibold text-white shadow-xl transition-all duration-200 hover:bg-emerald-600 active:scale-95",children:l?s.jsx(Yl,{size:18,light:!0,direction:"horizontal",label:", ",labelClassName:"text-white"}):s.jsxs(E.Fragment,{children:[s.jsx(q_,{className:"h-5 w-5"}),s.jsx("span",{children:""})]})})})]})})}function gO({children:e,currentView:t,testTitle:r}){const[a,n]=E.useState(!1),i=()=>n(B=>!B),{user:l,userProfile:o}=st(),[c,d]=E.useState(!1),[x,u]=E.useState(!1),[f,h]=E.useState(""),[p,g]=E.useState(!1),y=Qt(),v=ul(),w=(o==null?void 0:o.role)||(l==null?void 0:l.role)||"employee";E.useEffect(()=>{const B=()=>{u(window.scrollY>10)};return window.addEventListener("scroll",B),()=>window.removeEventListener("scroll",B)},[]),E.useEffect(()=>{d(!1)},[v.pathname]),E.useEffect(()=>{const B=new CustomEvent("mobileMenuStateChange",{detail:{isOpen:c}});window.dispatchEvent(B)},[c]),E.useEffect(()=>{const B=L=>{h(L.detail.title)};return window.addEventListener("examTabChanged",B),()=>{window.removeEventListener("examTabChanged",B)}},[]),E.useEffect(()=>{const B=L=>{g(L.detail.isOpen)};return window.addEventListener("modalStateChanged",B),()=>{window.removeEventListener("modalStateChanged",B)}},[]),E.useEffect(()=>(c?document.body.classList.add("mobile-menu-open"):document.body.classList.remove("mobile-menu-open"),()=>{document.body.classList.remove("mobile-menu-open")}),[c]);const m=t==="take-test",b=v.pathname.includes("/expert-exam/")||v.pathname.includes("/case-evaluation/"),_=t==="create-event"?"events":t,C=v.pathname.includes("/case-evaluation/")||v.pathname.includes("/evaluations")||v.pathname.includes("/expert-exam/")&&(v.pathname.includes("/evaluations")||v.pathname.includes("/dossiers")),j=["trainer","moderator","administrator"].includes(w),D=["supervisor","trainer","administrator"].includes(w),R=[{id:"dashboard",label:""},{id:"events",label:""}];j?R.push({id:"testing",label:""}):D&&R.push({id:"employees",label:""}),R.some(B=>B.id==="calendar")||R.push({id:"calendar",label:""});const M=!p&&!b&&!C&&!c,O=B=>{switch(B){case"dashboard":y("/");break;case"events":y("/events");break;case"tests":y("/testing");break;case"calendar":y("/calendar");break;case"employees":y("/employees");break;case"representatives":y("/representatives");break;case"supervisors":y("/supervisors");break;case"expert-events":y("/expert-events");break;case"exam-management":y("/exam-reserve");break;case"analytics":y("/analytics");break;case"tasks":y("/tasks");break;case"testing":y("/testing");break;case"admin":y("/admin");break;case"trainer-territories":y("/trainer-territories");break;case"schedule":y("/expert-schedule");break;default:y("/")}d(!1)};return m?s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"lg:hidden px-4 pt-4 pb-safe-bottom",children:e}),s.jsxs("div",{className:"hidden lg:flex min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[s.jsx("div",{className:"relative flex-shrink-0",children:s.jsx(O0,{activeItem:_,onItemClick:O,isCollapsed:a,onToggle:i})}),s.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[s.jsx(pg,{onMobileMenuToggle:()=>d(!0)}),s.jsx("main",{className:Ve("flex-1 overflow-auto pt-20 transition-all duration-300",a?"lg:ml-20":"lg:ml-80"),children:s.jsx("div",{className:"py-6",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e})})})]})]})]}):C?s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"lg:hidden px-4 pt-4 pb-safe-bottom",children:e}),s.jsxs("div",{className:"hidden lg:flex min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[s.jsx("div",{className:"relative flex-shrink-0",children:s.jsx(O0,{activeItem:_,onItemClick:O,isCollapsed:a,onToggle:i})}),s.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[s.jsx(pg,{onMobileMenuToggle:()=>d(!0)}),s.jsx("main",{className:Ve("flex-1 overflow-auto pt-20 transition-all duration-300",a?"lg:ml-20":"lg:ml-80"),children:s.jsx("div",{className:"py-6",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e})})})]})]})]}):b?s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100",children:[!p&&s.jsx("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-md border-b border-gray-100",children:s.jsx("div",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("button",{onClick:()=>d(!0),className:"p-2 -ml-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-xl transition-all duration-200 active:scale-95",title:" ",children:s.jsx(xb,{className:"w-6 h-6"})}),s.jsx("div",{className:"text-center flex-1",children:s.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:f})}),s.jsx("div",{className:"w-10"})," "]})})}),s.jsx("div",{className:p?"pt-0":"pt-16 lg:pt-0",children:e}),c&&!p&&s.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>d(!1)}),s.jsx(O0,{activeItem:_,onItemClick:O,isMobile:!0,onMobileClose:()=>d(!1)})]})]}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex",children:[s.jsxs("div",{className:Ve("fixed inset-0 flex z-50 lg:hidden transition-all duration-300",c?"pointer-events-auto":"pointer-events-none"),children:[s.jsx("div",{className:Ve("fixed inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300",c?"opacity-100":"opacity-0"),onClick:()=>d(!1)}),s.jsx("div",{className:Ve("relative flex-1 flex flex-col max-w-xs w-full transform transition-transform duration-300 ease-out h-full",c?"translate-x-0":"-translate-x-full"),children:s.jsx(O0,{activeItem:_,onItemClick:O,isMobile:!0,onMobileClose:()=>d(!1)})})]}),s.jsx("div",{className:"relative hidden lg:flex lg:flex-shrink-0",children:s.jsx(O0,{activeItem:_,onItemClick:O,isCollapsed:a,onToggle:i})}),s.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[s.jsx("div",{className:Ve("transition-all duration-300",p?"opacity-0 pointer-events-none transform scale-95":"opacity-100"),children:s.jsx(pg,{onMobileMenuToggle:()=>d(!0)})}),s.jsx("main",{className:Ve("flex-1 overflow-auto transition-all duration-300","pt-16 lg:pt-20",M?"pb-28":"pb-safe-bottom",a?"lg:ml-20":"lg:ml-80"),children:s.jsx("div",{className:"py-4 sm:py-6",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e})})})]}),s.jsx(mO,{activeItem:_,items:R,onSelect:O,isVisible:M})]})}var ej={exports:{}};(function(e,t){(function(a,n){e.exports=n()})(typeof self<"u"?self:Os,function(){return function(r){var a={};function n(i){if(a[i])return a[i].exports;var l=a[i]={i,l:!1,exports:{}};return r[i].call(l.exports,l,l.exports,n),l.l=!0,l.exports}return n.m=r,n.c=a,n.d=function(i,l,o){n.o(i,l)||Object.defineProperty(i,l,{configurable:!1,enumerable:!0,get:o})},n.n=function(i){var l=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(l,"a",l),l},n.o=function(i,l){return Object.prototype.hasOwnProperty.call(i,l)},n.p="",n(n.s=3)}([function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function l(o,c){this.width=c,this.height=o.length/c,this.data=o}return l.createEmpty=function(o,c){return new l(new Uint8ClampedArray(o*c),o)},l.prototype.get=function(o,c){return o<0||o>=this.width||c<0||c>=this.height?!1:!!this.data[c*this.width+o]},l.prototype.set=function(o,c,d){this.data[c*this.width+o]=d?1:0},l.prototype.setRegion=function(o,c,d,x,u){for(var f=c;f<c+x;f++)for(var h=o;h<o+d;h++)this.set(h,f,!!u)},l}();a.BitMatrix=i},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(2);function l(c,d){return c^d}a.addOrSubtractGF=l;var o=function(){function c(d,x,u){this.primitive=d,this.size=x,this.generatorBase=u,this.expTable=new Array(this.size),this.logTable=new Array(this.size);for(var f=1,h=0;h<this.size;h++)this.expTable[h]=f,f=f*2,f>=this.size&&(f=(f^this.primitive)&this.size-1);for(var h=0;h<this.size-1;h++)this.logTable[this.expTable[h]]=h;this.zero=new i.default(this,Uint8ClampedArray.from([0])),this.one=new i.default(this,Uint8ClampedArray.from([1]))}return c.prototype.multiply=function(d,x){return d===0||x===0?0:this.expTable[(this.logTable[d]+this.logTable[x])%(this.size-1)]},c.prototype.inverse=function(d){if(d===0)throw new Error("Can't invert 0");return this.expTable[this.size-this.logTable[d]-1]},c.prototype.buildMonomial=function(d,x){if(d<0)throw new Error("Invalid monomial degree less than 0");if(x===0)return this.zero;var u=new Uint8ClampedArray(d+1);return u[0]=x,new i.default(this,u)},c.prototype.log=function(d){if(d===0)throw new Error("Can't take log(0)");return this.logTable[d]},c.prototype.exp=function(d){return this.expTable[d]},c}();a.default=o},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(1),l=function(){function o(c,d){if(d.length===0)throw new Error("No coefficients.");this.field=c;var x=d.length;if(x>1&&d[0]===0){for(var u=1;u<x&&d[u]===0;)u++;if(u===x)this.coefficients=c.zero.coefficients;else{this.coefficients=new Uint8ClampedArray(x-u);for(var f=0;f<this.coefficients.length;f++)this.coefficients[f]=d[u+f]}}else this.coefficients=d}return o.prototype.degree=function(){return this.coefficients.length-1},o.prototype.isZero=function(){return this.coefficients[0]===0},o.prototype.getCoefficient=function(c){return this.coefficients[this.coefficients.length-1-c]},o.prototype.addOrSubtract=function(c){var d;if(this.isZero())return c;if(c.isZero())return this;var x=this.coefficients,u=c.coefficients;x.length>u.length&&(d=[u,x],x=d[0],u=d[1]);for(var f=new Uint8ClampedArray(u.length),h=u.length-x.length,p=0;p<h;p++)f[p]=u[p];for(var p=h;p<u.length;p++)f[p]=i.addOrSubtractGF(x[p-h],u[p]);return new o(this.field,f)},o.prototype.multiply=function(c){if(c===0)return this.field.zero;if(c===1)return this;for(var d=this.coefficients.length,x=new Uint8ClampedArray(d),u=0;u<d;u++)x[u]=this.field.multiply(this.coefficients[u],c);return new o(this.field,x)},o.prototype.multiplyPoly=function(c){if(this.isZero()||c.isZero())return this.field.zero;for(var d=this.coefficients,x=d.length,u=c.coefficients,f=u.length,h=new Uint8ClampedArray(x+f-1),p=0;p<x;p++)for(var g=d[p],y=0;y<f;y++)h[p+y]=i.addOrSubtractGF(h[p+y],this.field.multiply(g,u[y]));return new o(this.field,h)},o.prototype.multiplyByMonomial=function(c,d){if(c<0)throw new Error("Invalid degree less than 0");if(d===0)return this.field.zero;for(var x=this.coefficients.length,u=new Uint8ClampedArray(x+c),f=0;f<x;f++)u[f]=this.field.multiply(this.coefficients[f],d);return new o(this.field,u)},o.prototype.evaluateAt=function(c){var d=0;if(c===0)return this.getCoefficient(0);var x=this.coefficients.length;if(c===1)return this.coefficients.forEach(function(f){d=i.addOrSubtractGF(d,f)}),d;d=this.coefficients[0];for(var u=1;u<x;u++)d=i.addOrSubtractGF(this.field.multiply(c,d),this.coefficients[u]);return d},o}();a.default=l},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(4),l=n(5),o=n(11),c=n(12);function d(f){var h=c.locate(f);if(!h)return null;for(var p=0,g=h;p<g.length;p++){var y=g[p],v=o.extract(f,y),w=l.decode(v.matrix);if(w)return{binaryData:w.bytes,data:w.text,chunks:w.chunks,version:w.version,location:{topRightCorner:v.mappingFunction(y.dimension,0),topLeftCorner:v.mappingFunction(0,0),bottomRightCorner:v.mappingFunction(y.dimension,y.dimension),bottomLeftCorner:v.mappingFunction(0,y.dimension),topRightFinderPattern:y.topRight,topLeftFinderPattern:y.topLeft,bottomLeftFinderPattern:y.bottomLeft,bottomRightAlignmentPattern:y.alignmentPattern}}}return null}var x={inversionAttempts:"attemptBoth"};function u(f,h,p,g){g===void 0&&(g={});var y=x;Object.keys(y||{}).forEach(function(j){y[j]=g[j]||y[j]});var v=y.inversionAttempts==="attemptBoth"||y.inversionAttempts==="invertFirst",w=y.inversionAttempts==="onlyInvert"||y.inversionAttempts==="invertFirst",m=i.binarize(f,h,p,v),b=m.binarized,_=m.inverted,C=d(w?_:b);return!C&&(y.inversionAttempts==="attemptBoth"||y.inversionAttempts==="invertFirst")&&(C=d(w?b:_)),C}u.default=u,a.default=u},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(0),l=8,o=24;function c(u,f,h){return u<f?f:u>h?h:u}var d=function(){function u(f,h){this.width=f,this.data=new Uint8ClampedArray(f*h)}return u.prototype.get=function(f,h){return this.data[h*this.width+f]},u.prototype.set=function(f,h,p){this.data[h*this.width+f]=p},u}();function x(u,f,h,p){if(u.length!==f*h*4)throw new Error("Malformed data passed to binarizer.");for(var g=new d(f,h),y=0;y<f;y++)for(var v=0;v<h;v++){var w=u[(v*f+y)*4+0],m=u[(v*f+y)*4+1],b=u[(v*f+y)*4+2];g.set(y,v,.2126*w+.7152*m+.0722*b)}for(var _=Math.ceil(f/l),C=Math.ceil(h/l),j=new d(_,C),D=0;D<C;D++)for(var R=0;R<_;R++){for(var M=0,O=1/0,B=0,v=0;v<l;v++)for(var y=0;y<l;y++){var L=g.get(R*l+y,D*l+v);M+=L,O=Math.min(O,L),B=Math.max(B,L)}var U=M/Math.pow(l,2);if(B-O<=o&&(U=O/2,D>0&&R>0)){var P=(j.get(R,D-1)+2*j.get(R-1,D)+j.get(R-1,D-1))/4;O<P&&(U=P)}j.set(R,D,U)}var F=i.BitMatrix.createEmpty(f,h),N=null;p&&(N=i.BitMatrix.createEmpty(f,h));for(var D=0;D<C;D++)for(var R=0;R<_;R++){for(var T=c(R,2,_-3),S=c(D,2,C-3),M=0,z=-2;z<=2;z++)for(var W=-2;W<=2;W++)M+=j.get(T+z,S+W);for(var k=M/25,z=0;z<l;z++)for(var W=0;W<l;W++){var y=R*l+z,v=D*l+W,q=g.get(y,v);F.set(y,v,q<=k),p&&N.set(y,v,!(q<=k))}}return p?{binarized:F,inverted:N}:{binarized:F}}a.binarize=x},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(0),l=n(6),o=n(9),c=n(10);function d(b,_){for(var C=b^_,j=0;C;)j++,C&=C-1;return j}function x(b,_){return _<<1|b}var u=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,dataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,formatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,dataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],f=[function(b){return(b.y+b.x)%2===0},function(b){return b.y%2===0},function(b){return b.x%3===0},function(b){return(b.y+b.x)%3===0},function(b){return(Math.floor(b.y/2)+Math.floor(b.x/3))%2===0},function(b){return b.x*b.y%2+b.x*b.y%3===0},function(b){return(b.y*b.x%2+b.y*b.x%3)%2===0},function(b){return((b.y+b.x)%2+b.y*b.x%3)%2===0}];function h(b){var _=17+4*b.versionNumber,C=i.BitMatrix.createEmpty(_,_);C.setRegion(0,0,9,9,!0),C.setRegion(_-8,0,8,9,!0),C.setRegion(0,_-8,9,8,!0);for(var j=0,D=b.alignmentPatternCenters;j<D.length;j++)for(var R=D[j],M=0,O=b.alignmentPatternCenters;M<O.length;M++){var B=O[M];R===6&&B===6||R===6&&B===_-7||R===_-7&&B===6||C.setRegion(R-2,B-2,5,5,!0)}return C.setRegion(6,9,1,_-17,!0),C.setRegion(9,6,_-17,1,!0),b.versionNumber>6&&(C.setRegion(_-11,0,3,6,!0),C.setRegion(0,_-11,6,3,!0)),C}function p(b,_,C){for(var j=f[C.dataMask],D=b.height,R=h(_),M=[],O=0,B=0,L=!0,U=D-1;U>0;U-=2){U===6&&U--;for(var P=0;P<D;P++)for(var F=L?D-1-P:P,N=0;N<2;N++){var T=U-N;if(!R.get(T,F)){B++;var S=b.get(T,F);j({y:F,x:T})&&(S=!S),O=x(S,O),B===8&&(M.push(O),B=0,O=0)}}L=!L}return M}function g(b){var _=b.height,C=Math.floor((_-17)/4);if(C<=6)return c.VERSIONS[C-1];for(var j=0,D=5;D>=0;D--)for(var R=_-9;R>=_-11;R--)j=x(b.get(R,D),j);for(var M=0,R=5;R>=0;R--)for(var D=_-9;D>=_-11;D--)M=x(b.get(R,D),M);for(var O=1/0,B,L=0,U=c.VERSIONS;L<U.length;L++){var P=U[L];if(P.infoBits===j||P.infoBits===M)return P;var F=d(j,P.infoBits);F<O&&(B=P,O=F),F=d(M,P.infoBits),F<O&&(B=P,O=F)}if(O<=3)return B}function y(b){for(var _=0,C=0;C<=8;C++)C!==6&&(_=x(b.get(C,8),_));for(var j=7;j>=0;j--)j!==6&&(_=x(b.get(8,j),_));for(var D=b.height,R=0,j=D-1;j>=D-7;j--)R=x(b.get(8,j),R);for(var C=D-8;C<D;C++)R=x(b.get(C,8),R);for(var M=1/0,O=null,B=0,L=u;B<L.length;B++){var U=L[B],P=U.bits,F=U.formatInfo;if(P===_||P===R)return F;var N=d(_,P);N<M&&(O=F,M=N),_!==R&&(N=d(R,P),N<M&&(O=F,M=N))}return M<=3?O:null}function v(b,_,C){var j=_.errorCorrectionLevels[C],D=[],R=0;if(j.ecBlocks.forEach(function(S){for(var z=0;z<S.numBlocks;z++)D.push({numDataCodewords:S.dataCodewordsPerBlock,codewords:[]}),R+=S.dataCodewordsPerBlock+j.ecCodewordsPerBlock}),b.length<R)return null;b=b.slice(0,R);for(var M=j.ecBlocks[0].dataCodewordsPerBlock,O=0;O<M;O++)for(var B=0,L=D;B<L.length;B++){var U=L[B];U.codewords.push(b.shift())}if(j.ecBlocks.length>1)for(var P=j.ecBlocks[0].numBlocks,F=j.ecBlocks[1].numBlocks,O=0;O<F;O++)D[P+O].codewords.push(b.shift());for(;b.length>0;)for(var N=0,T=D;N<T.length;N++){var U=T[N];U.codewords.push(b.shift())}return D}function w(b){var _=g(b);if(!_)return null;var C=y(b);if(!C)return null;var j=p(b,_,C),D=v(j,_,C.errorCorrectionLevel);if(!D)return null;for(var R=D.reduce(function(N,T){return N+T.numDataCodewords},0),M=new Uint8ClampedArray(R),O=0,B=0,L=D;B<L.length;B++){var U=L[B],P=o.decode(U.codewords,U.codewords.length-U.numDataCodewords);if(!P)return null;for(var F=0;F<U.numDataCodewords;F++)M[O++]=P[F]}try{return l.decode(M,_.versionNumber)}catch{return null}}function m(b){if(b==null)return null;var _=w(b);if(_)return _;for(var C=0;C<b.width;C++)for(var j=C+1;j<b.height;j++)b.get(C,j)!==b.get(j,C)&&(b.set(C,j,!b.get(C,j)),b.set(j,C,!b.get(j,C)));return w(b)}a.decode=m},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(7),l=n(8),o;(function(g){g.Numeric="numeric",g.Alphanumeric="alphanumeric",g.Byte="byte",g.Kanji="kanji",g.ECI="eci"})(o=a.Mode||(a.Mode={}));var c;(function(g){g[g.Terminator=0]="Terminator",g[g.Numeric=1]="Numeric",g[g.Alphanumeric=2]="Alphanumeric",g[g.Byte=4]="Byte",g[g.Kanji=8]="Kanji",g[g.ECI=7]="ECI"})(c||(c={}));function d(g,y){for(var v=[],w="",m=[10,12,14][y],b=g.readBits(m);b>=3;){var _=g.readBits(10);if(_>=1e3)throw new Error("Invalid numeric value above 999");var C=Math.floor(_/100),j=Math.floor(_/10)%10,D=_%10;v.push(48+C,48+j,48+D),w+=C.toString()+j.toString()+D.toString(),b-=3}if(b===2){var _=g.readBits(7);if(_>=100)throw new Error("Invalid numeric value above 99");var C=Math.floor(_/10),j=_%10;v.push(48+C,48+j),w+=C.toString()+j.toString()}else if(b===1){var _=g.readBits(4);if(_>=10)throw new Error("Invalid numeric value above 9");v.push(48+_),w+=_.toString()}return{bytes:v,text:w}}var x=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function u(g,y){for(var v=[],w="",m=[9,11,13][y],b=g.readBits(m);b>=2;){var _=g.readBits(11),C=Math.floor(_/45),j=_%45;v.push(x[C].charCodeAt(0),x[j].charCodeAt(0)),w+=x[C]+x[j],b-=2}if(b===1){var C=g.readBits(6);v.push(x[C].charCodeAt(0)),w+=x[C]}return{bytes:v,text:w}}function f(g,y){for(var v=[],w="",m=[8,16,16][y],b=g.readBits(m),_=0;_<b;_++){var C=g.readBits(8);v.push(C)}try{w+=decodeURIComponent(v.map(function(j){return"%"+("0"+j.toString(16)).substr(-2)}).join(""))}catch{}return{bytes:v,text:w}}function h(g,y){for(var v=[],w="",m=[8,10,12][y],b=g.readBits(m),_=0;_<b;_++){var C=g.readBits(13),j=Math.floor(C/192)<<8|C%192;j<7936?j+=33088:j+=49472,v.push(j>>8,j&255),w+=String.fromCharCode(l.shiftJISTable[j])}return{bytes:v,text:w}}function p(g,y){for(var v,w,m,b,_=new i.BitStream(g),C=y<=9?0:y<=26?1:2,j={text:"",bytes:[],chunks:[],version:y};_.available()>=4;){var D=_.readBits(4);if(D===c.Terminator)return j;if(D===c.ECI)_.readBits(1)===0?j.chunks.push({type:o.ECI,assignmentNumber:_.readBits(7)}):_.readBits(1)===0?j.chunks.push({type:o.ECI,assignmentNumber:_.readBits(14)}):_.readBits(1)===0?j.chunks.push({type:o.ECI,assignmentNumber:_.readBits(21)}):j.chunks.push({type:o.ECI,assignmentNumber:-1});else if(D===c.Numeric){var R=d(_,C);j.text+=R.text,(v=j.bytes).push.apply(v,R.bytes),j.chunks.push({type:o.Numeric,text:R.text})}else if(D===c.Alphanumeric){var M=u(_,C);j.text+=M.text,(w=j.bytes).push.apply(w,M.bytes),j.chunks.push({type:o.Alphanumeric,text:M.text})}else if(D===c.Byte){var O=f(_,C);j.text+=O.text,(m=j.bytes).push.apply(m,O.bytes),j.chunks.push({type:o.Byte,bytes:O.bytes,text:O.text})}else if(D===c.Kanji){var B=h(_,C);j.text+=B.text,(b=j.bytes).push.apply(b,B.bytes),j.chunks.push({type:o.Kanji,bytes:B.bytes,text:B.text})}}if(_.available()===0||_.readBits(_.available())===0)return j}a.decode=p},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function l(o){this.byteOffset=0,this.bitOffset=0,this.bytes=o}return l.prototype.readBits=function(o){if(o<1||o>32||o>this.available())throw new Error("Cannot read "+o.toString()+" bits");var c=0;if(this.bitOffset>0){var d=8-this.bitOffset,x=o<d?o:d,u=d-x,f=255>>8-x<<u;c=(this.bytes[this.byteOffset]&f)>>u,o-=x,this.bitOffset+=x,this.bitOffset===8&&(this.bitOffset=0,this.byteOffset++)}if(o>0){for(;o>=8;)c=c<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,o-=8;if(o>0){var u=8-o,f=255>>u<<u;c=c<<o|(this.bytes[this.byteOffset]&f)>>u,this.bitOffset+=o}}return c},l.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},l}();a.BitStream=i},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0}),a.shiftJISTable={32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:165,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:8254,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:92,33120:12316,33121:8214,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:8722,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:162,33170:163,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:172,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081}},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(1),l=n(2);function o(u,f,h,p){var g;f.degree()<h.degree()&&(g=[h,f],f=g[0],h=g[1]);for(var y=f,v=h,w=u.zero,m=u.one;v.degree()>=p/2;){var b=y,_=w;if(y=v,w=m,y.isZero())return null;v=b;for(var C=u.zero,j=y.getCoefficient(y.degree()),D=u.inverse(j);v.degree()>=y.degree()&&!v.isZero();){var R=v.degree()-y.degree(),M=u.multiply(v.getCoefficient(v.degree()),D);C=C.addOrSubtract(u.buildMonomial(R,M)),v=v.addOrSubtract(y.multiplyByMonomial(R,M))}if(m=C.multiplyPoly(w).addOrSubtract(_),v.degree()>=y.degree())return null}var O=m.getCoefficient(0);if(O===0)return null;var B=u.inverse(O);return[m.multiply(B),v.multiply(B)]}function c(u,f){var h=f.degree();if(h===1)return[f.getCoefficient(1)];for(var p=new Array(h),g=0,y=1;y<u.size&&g<h;y++)f.evaluateAt(y)===0&&(p[g]=u.inverse(y),g++);return g!==h?null:p}function d(u,f,h){for(var p=h.length,g=new Array(p),y=0;y<p;y++){for(var v=u.inverse(h[y]),w=1,m=0;m<p;m++)y!==m&&(w=u.multiply(w,i.addOrSubtractGF(1,u.multiply(h[m],v))));g[y]=u.multiply(f.evaluateAt(v),u.inverse(w)),u.generatorBase!==0&&(g[y]=u.multiply(g[y],v))}return g}function x(u,f){var h=new Uint8ClampedArray(u.length);h.set(u);for(var p=new i.default(285,256,0),g=new l.default(p,h),y=new Uint8ClampedArray(f),v=!1,w=0;w<f;w++){var m=g.evaluateAt(p.exp(w+p.generatorBase));y[y.length-1-w]=m,m!==0&&(v=!0)}if(!v)return h;var b=new l.default(p,y),_=o(p,p.buildMonomial(f,1),b,f);if(_===null)return null;var C=c(p,_[0]);if(C==null)return null;for(var j=d(p,_[1],C),D=0;D<C.length;D++){var R=h.length-1-p.log(C[D]);if(R<0)return null;h[R]=i.addOrSubtractGF(h[R],j[D])}return h}a.decode=x},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0}),a.VERSIONS=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,versionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,dataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,versionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},{numBlocks:61,dataCodewordsPerBlock:16}]}]}]},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=n(0);function l(x,u,f,h){var p=x.x-u.x+f.x-h.x,g=x.y-u.y+f.y-h.y;if(p===0&&g===0)return{a11:u.x-x.x,a12:u.y-x.y,a13:0,a21:f.x-u.x,a22:f.y-u.y,a23:0,a31:x.x,a32:x.y,a33:1};var y=u.x-f.x,v=h.x-f.x,w=u.y-f.y,m=h.y-f.y,b=y*m-v*w,_=(p*m-v*g)/b,C=(y*g-p*w)/b;return{a11:u.x-x.x+_*u.x,a12:u.y-x.y+_*u.y,a13:_,a21:h.x-x.x+C*h.x,a22:h.y-x.y+C*h.y,a23:C,a31:x.x,a32:x.y,a33:1}}function o(x,u,f,h){var p=l(x,u,f,h);return{a11:p.a22*p.a33-p.a23*p.a32,a12:p.a13*p.a32-p.a12*p.a33,a13:p.a12*p.a23-p.a13*p.a22,a21:p.a23*p.a31-p.a21*p.a33,a22:p.a11*p.a33-p.a13*p.a31,a23:p.a13*p.a21-p.a11*p.a23,a31:p.a21*p.a32-p.a22*p.a31,a32:p.a12*p.a31-p.a11*p.a32,a33:p.a11*p.a22-p.a12*p.a21}}function c(x,u){return{a11:x.a11*u.a11+x.a21*u.a12+x.a31*u.a13,a12:x.a12*u.a11+x.a22*u.a12+x.a32*u.a13,a13:x.a13*u.a11+x.a23*u.a12+x.a33*u.a13,a21:x.a11*u.a21+x.a21*u.a22+x.a31*u.a23,a22:x.a12*u.a21+x.a22*u.a22+x.a32*u.a23,a23:x.a13*u.a21+x.a23*u.a22+x.a33*u.a23,a31:x.a11*u.a31+x.a21*u.a32+x.a31*u.a33,a32:x.a12*u.a31+x.a22*u.a32+x.a32*u.a33,a33:x.a13*u.a31+x.a23*u.a32+x.a33*u.a33}}function d(x,u){for(var f=o({x:3.5,y:3.5},{x:u.dimension-3.5,y:3.5},{x:u.dimension-6.5,y:u.dimension-6.5},{x:3.5,y:u.dimension-3.5}),h=l(u.topLeft,u.topRight,u.alignmentPattern,u.bottomLeft),p=c(h,f),g=i.BitMatrix.createEmpty(u.dimension,u.dimension),y=function(C,j){var D=p.a13*C+p.a23*j+p.a33;return{x:(p.a11*C+p.a21*j+p.a31)/D,y:(p.a12*C+p.a22*j+p.a32)/D}},v=0;v<u.dimension;v++)for(var w=0;w<u.dimension;w++){var m=w+.5,b=v+.5,_=y(m,b);g.set(w,v,x.get(Math.floor(_.x),Math.floor(_.y)))}return{matrix:g,mappingFunction:y}}a.extract=d},function(r,a,n){Object.defineProperty(a,"__esModule",{value:!0});var i=4,l=.5,o=1.5,c=function(m,b){return Math.sqrt(Math.pow(b.x-m.x,2)+Math.pow(b.y-m.y,2))};function d(m){return m.reduce(function(b,_){return b+_})}function x(m,b,_){var C,j,D,R,M=c(m,b),O=c(b,_),B=c(m,_),L,U,P;return O>=M&&O>=B?(C=[b,m,_],L=C[0],U=C[1],P=C[2]):B>=O&&B>=M?(j=[m,b,_],L=j[0],U=j[1],P=j[2]):(D=[m,_,b],L=D[0],U=D[1],P=D[2]),(P.x-U.x)*(L.y-U.y)-(P.y-U.y)*(L.x-U.x)<0&&(R=[P,L],L=R[0],P=R[1]),{bottomLeft:L,topLeft:U,topRight:P}}function u(m,b,_,C){var j=(d(h(m,_,C,5))/7+d(h(m,b,C,5))/7+d(h(_,m,C,5))/7+d(h(b,m,C,5))/7)/4;if(j<1)throw new Error("Invalid module size");var D=Math.round(c(m,b)/j),R=Math.round(c(m,_)/j),M=Math.floor((D+R)/2)+7;switch(M%4){case 0:M++;break;case 2:M--;break}return{dimension:M,moduleSize:j}}function f(m,b,_,C){var j=[{x:Math.floor(m.x),y:Math.floor(m.y)}],D=Math.abs(b.y-m.y)>Math.abs(b.x-m.x),R,M,O,B;D?(R=Math.floor(m.y),M=Math.floor(m.x),O=Math.floor(b.y),B=Math.floor(b.x)):(R=Math.floor(m.x),M=Math.floor(m.y),O=Math.floor(b.x),B=Math.floor(b.y));for(var L=Math.abs(O-R),U=Math.abs(B-M),P=Math.floor(-L/2),F=R<O?1:-1,N=M<B?1:-1,T=!0,S=R,z=M;S!==O+F;S+=F){var W=D?z:S,k=D?S:z;if(_.get(W,k)!==T&&(T=!T,j.push({x:W,y:k}),j.length===C+1))break;if(P+=U,P>0){if(z===B)break;z+=N,P-=L}}for(var q=[],A=0;A<C;A++)j[A]&&j[A+1]?q.push(c(j[A],j[A+1])):q.push(0);return q}function h(m,b,_,C){var j,D=b.y-m.y,R=b.x-m.x,M=f(m,b,_,Math.ceil(C/2)),O=f(m,{x:m.x-R,y:m.y-D},_,Math.ceil(C/2)),B=M.shift()+O.shift()-1;return(j=O.concat(B)).concat.apply(j,M)}function p(m,b){var _=d(m)/d(b),C=0;return b.forEach(function(j,D){C+=Math.pow(m[D]-j*_,2)}),{averageSize:_,error:C}}function g(m,b,_){try{var C=h(m,{x:-1,y:m.y},_,b.length),j=h(m,{x:m.x,y:-1},_,b.length),D={x:Math.max(0,m.x-m.y)-1,y:Math.max(0,m.y-m.x)-1},R=h(m,D,_,b.length),M={x:Math.min(_.width,m.x+m.y)+1,y:Math.min(_.height,m.y+m.x)+1},O=h(m,M,_,b.length),B=p(C,b),L=p(j,b),U=p(R,b),P=p(O,b),F=Math.sqrt(B.error*B.error+L.error*L.error+U.error*U.error+P.error*P.error),N=(B.averageSize+L.averageSize+U.averageSize+P.averageSize)/4,T=(Math.pow(B.averageSize-N,2)+Math.pow(L.averageSize-N,2)+Math.pow(U.averageSize-N,2)+Math.pow(P.averageSize-N,2))/N;return F+T}catch{return 1/0}}function y(m,b){for(var _=Math.round(b.x);m.get(_,Math.round(b.y));)_--;for(var C=Math.round(b.x);m.get(C,Math.round(b.y));)C++;for(var j=(_+C)/2,D=Math.round(b.y);m.get(Math.round(j),D);)D--;for(var R=Math.round(b.y);m.get(Math.round(j),R);)R++;var M=(D+R)/2;return{x:j,y:M}}function v(m){for(var b=[],_=[],C=[],j=[],D=function(W){for(var k=0,q=!1,A=[0,0,0,0,0],I=function(H){var Y=m.get(H,W);if(Y===q)k++;else{A=[A[1],A[2],A[3],A[4],k],k=1,q=Y;var Q=d(A)/7,te=Math.abs(A[0]-Q)<Q&&Math.abs(A[1]-Q)<Q&&Math.abs(A[2]-3*Q)<3*Q&&Math.abs(A[3]-Q)<Q&&Math.abs(A[4]-Q)<Q&&!Y,re=d(A.slice(-3))/3,X=Math.abs(A[2]-re)<re&&Math.abs(A[3]-re)<re&&Math.abs(A[4]-re)<re&&Y;if(te){var je=H-A[3]-A[4],J=je-A[2],ue={startX:J,endX:je,y:W},de=_.filter(function(pe){return J>=pe.bottom.startX&&J<=pe.bottom.endX||je>=pe.bottom.startX&&J<=pe.bottom.endX||J<=pe.bottom.startX&&je>=pe.bottom.endX&&A[2]/(pe.bottom.endX-pe.bottom.startX)<o&&A[2]/(pe.bottom.endX-pe.bottom.startX)>l});de.length>0?de[0].bottom=ue:_.push({top:ue,bottom:ue})}if(X){var ce=H-A[4],fe=ce-A[3],ue={startX:fe,y:W,endX:ce},de=j.filter(function(ne){return fe>=ne.bottom.startX&&fe<=ne.bottom.endX||ce>=ne.bottom.startX&&fe<=ne.bottom.endX||fe<=ne.bottom.startX&&ce>=ne.bottom.endX&&A[2]/(ne.bottom.endX-ne.bottom.startX)<o&&A[2]/(ne.bottom.endX-ne.bottom.startX)>l});de.length>0?de[0].bottom=ue:j.push({top:ue,bottom:ue})}}},V=-1;V<=m.width;V++)I(V);b.push.apply(b,_.filter(function(H){return H.bottom.y!==W&&H.bottom.y-H.top.y>=2})),_=_.filter(function(H){return H.bottom.y===W}),C.push.apply(C,j.filter(function(H){return H.bottom.y!==W})),j=j.filter(function(H){return H.bottom.y===W})},R=0;R<=m.height;R++)D(R);b.push.apply(b,_.filter(function(W){return W.bottom.y-W.top.y>=2})),C.push.apply(C,j);var M=b.filter(function(W){return W.bottom.y-W.top.y>=2}).map(function(W){var k=(W.top.startX+W.top.endX+W.bottom.startX+W.bottom.endX)/4,q=(W.top.y+W.bottom.y+1)/2;if(m.get(Math.round(k),Math.round(q))){var A=[W.top.endX-W.top.startX,W.bottom.endX-W.bottom.startX,W.bottom.y-W.top.y+1],I=d(A)/A.length,V=g({x:Math.round(k),y:Math.round(q)},[1,1,3,1,1],m);return{score:V,x:k,y:q,size:I}}}).filter(function(W){return!!W}).sort(function(W,k){return W.score-k.score}).map(function(W,k,q){if(k>i)return null;var A=q.filter(function(V,H){return k!==H}).map(function(V){return{x:V.x,y:V.y,score:V.score+Math.pow(V.size-W.size,2)/W.size,size:V.size}}).sort(function(V,H){return V.score-H.score});if(A.length<2)return null;var I=W.score+A[0].score+A[1].score;return{points:[W].concat(A.slice(0,2)),score:I}}).filter(function(W){return!!W}).sort(function(W,k){return W.score-k.score});if(M.length===0)return null;var O=x(M[0].points[0],M[0].points[1],M[0].points[2]),B=O.topRight,L=O.topLeft,U=O.bottomLeft,P=w(m,C,B,L,U),F=[];P&&F.push({alignmentPattern:{x:P.alignmentPattern.x,y:P.alignmentPattern.y},bottomLeft:{x:U.x,y:U.y},dimension:P.dimension,topLeft:{x:L.x,y:L.y},topRight:{x:B.x,y:B.y}});var N=y(m,B),T=y(m,L),S=y(m,U),z=w(m,C,N,T,S);return z&&F.push({alignmentPattern:{x:z.alignmentPattern.x,y:z.alignmentPattern.y},bottomLeft:{x:S.x,y:S.y},topLeft:{x:T.x,y:T.y},topRight:{x:N.x,y:N.y},dimension:z.dimension}),F.length===0?null:F}a.locate=v;function w(m,b,_,C,j){var D,R,M;try{D=u(C,_,j,m),R=D.dimension,M=D.moduleSize}catch{return null}var O={x:_.x-C.x+j.x,y:_.y-C.y+j.y},B=(c(C,j)+c(C,_))/2/M,L=1-3/B,U={x:C.x+L*(O.x-C.x),y:C.y+L*(O.y-C.y)},P=b.map(function(N){var T=(N.top.startX+N.top.endX+N.bottom.startX+N.bottom.endX)/4,S=(N.top.y+N.bottom.y+1)/2;if(m.get(Math.floor(T),Math.floor(S))){var z=[N.top.endX-N.top.startX,N.bottom.endX-N.bottom.startX,N.bottom.y-N.top.y+1];d(z)/z.length;var W=g({x:Math.floor(T),y:Math.floor(S)},[1,1,1],m),k=W+c({x:T,y:S},U);return{x:T,y:S,score:k}}}).filter(function(N){return!!N}).sort(function(N,T){return N.score-T.score}),F=B>=15&&P.length?P[0]:U;return{alignmentPattern:F,dimension:R}}}]).default})})(ej);var pO=ej.exports;const vO=iv(pO);function bO({isOpen:e,onClose:t,onScan:r}){const a=E.useRef(null),n=E.useRef(null),[i,l]=E.useState(""),[o,c]=E.useState(!1),d=E.useRef(null),x=E.useRef();E.useEffect(()=>{if(!e){x.current&&cancelAnimationFrame(x.current),d.current&&(d.current.getTracks().forEach(g=>g.stop()),d.current=null);return}const h=async()=>{try{l(""),c(!0);const g={video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1};console.log("    ...");try{const v=await navigator.permissions.query({name:"camera"});console.log("   :",v.state),v.state==="granted"&&console.log("   ")}catch{console.log(" Permissions API  ")}const y=await navigator.mediaDevices.getUserMedia(g);console.log("    "),a.current&&(a.current.srcObject=y,d.current=y,await new Promise(v=>{a.current.onloadedmetadata=()=>{a.current.play().then(v).catch(w=>{console.error("  :",w),l("   "),c(!1)})}})),p()}catch(g){console.error("  :",g),l(`     : ${g.message||" "}`),c(!1)}},p=()=>{const g=a.current,y=n.current;if(!g||!y)return;const v=y.getContext("2d");if(!v)return;const w=()=>{if(!g||g.readyState!==g.HAVE_ENOUGH_DATA){x.current=requestAnimationFrame(w);return}y.width=g.videoWidth,y.height=g.videoHeight,v.drawImage(g,0,0,y.width,y.height);const m=v.getImageData(0,0,y.width,y.height),b=vO(m.data,m.width,m.height);b&&b.data?u(b.data):x.current=requestAnimationFrame(w)};w()};return h(),()=>{x.current&&cancelAnimationFrame(x.current),d.current&&(d.current.getTracks().forEach(g=>g.stop()),d.current=null),c(!1)}},[e]);const u=h=>{console.log(" QR- :",h);const p=h.match(/\/auth\/qr\/([a-f0-9]{64})/);if(p&&p[1]){const g=p[1];console.log("  :",g.substring(0,8)+"..."),r(g),t()}else l(" QR-.  QR- ."),setTimeout(()=>l(""),3e3)},f=()=>{const h=prompt("  QR- (64 ):");h&&h.length===64?(r(h),t()):h&&l("  .    64 .")};return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:[s.jsxs("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-emerald-50 to-white",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-500 text-white",children:s.jsx(oo,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" QR"}),s.jsx("p",{className:"text-xs text-gray-500",children:"   QR-"})]})]}),s.jsx("button",{onClick:t,className:"flex h-8 w-8 items-center justify-center rounded-lg text-gray-400 hover:bg-gray-100 hover:text-gray-900 transition-colors",children:s.jsx(Qe,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"relative bg-black",children:[o?s.jsxs(s.Fragment,{children:[s.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-auto",style:{maxHeight:"400px",objectFit:"cover"}}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsxs("div",{className:"relative w-64 h-64",children:[s.jsx("div",{className:"absolute top-0 left-0 w-12 h-12 border-t-4 border-l-4 border-emerald-400 rounded-tl-lg"}),s.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 border-t-4 border-r-4 border-emerald-400 rounded-tr-lg"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-12 border-b-4 border-l-4 border-emerald-400 rounded-bl-lg"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-12 h-12 border-b-4 border-r-4 border-emerald-400 rounded-br-lg"}),s.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-lg",children:s.jsx("div",{className:"absolute left-0 right-0 h-1 bg-gradient-to-r from-transparent via-emerald-400 to-transparent",style:{top:"50%",animation:"scanLine 2s ease-in-out infinite"}})})]})}),s.jsx("div",{className:"absolute inset-0 bg-black/50 pointer-events-none",style:{clipPath:"polygon(0% 0%, 0% 100%, 25% 100%, 25% 25%, 75% 25%, 75% 75%, 25% 75%, 25% 100%, 100% 100%, 100% 0%)"}})]}):s.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-900",children:s.jsxs("div",{className:"text-center text-white",children:[s.jsx(IR,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-sm",children:" ..."})]})}),s.jsx("canvas",{ref:n,className:"hidden"})]}),i&&s.jsxs("div",{className:"mx-6 mt-4 flex items-start gap-2 rounded-lg bg-red-50 border border-red-200 px-4 py-3 animate-fade-in",children:[s.jsx(ar,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-red-600 font-medium",children:i}),i.includes("")&&s.jsx("p",{className:"text-xs text-red-500 mt-1",children:"    "})]})]}),s.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-gray-50 to-emerald-50 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:o?"...":" "}),s.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:o?"   QR-":"   "})]}),s.jsx("button",{onClick:f,className:"text-sm text-emerald-600 hover:text-emerald-700 font-semibold whitespace-nowrap px-3 py-1.5 rounded-lg hover:bg-emerald-100 transition-colors",children:" "})]})})]}),s.jsx("style",{children:`
        @keyframes scanLine {
          0%, 100% { 
            transform: translateY(-100%); 
            opacity: 0;
          }
          50% { 
            transform: translateY(100%); 
            opacity: 1;
          }
        }
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
          animation: fadeIn 0.3s ease-out;
        }
      `})]}):null}function yO({email:e,fullName:t,timestamp:r,onLoginAgain:a}){const n=c=>{const d=new Date(c),u=new Date().getTime()-d.getTime(),f=Math.floor(u/6e4),h=Math.floor(u/36e5),p=Math.floor(u/864e5);return f<1?" ":f<60?`${f} ${i(f)} `:h<24?`${h} ${l(h)} `:p===1?"":p<7?`${p} ${o(p)} `:d.toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})},i=c=>c%10===1&&c%100!==11?"":[2,3,4].includes(c%10)&&![12,13,14].includes(c%100)?"":"",l=c=>c%10===1&&c%100!==11?"":[2,3,4].includes(c%10)&&![12,13,14].includes(c%100)?"":"",o=c=>c%10===1&&c%100!==11?"":[2,3,4].includes(c%10)&&![12,13,14].includes(c%100)?"":"";return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden",style:{borderRadius:"28px"},children:[s.jsx("div",{className:"px-6 py-5 bg-gradient-to-r from-blue-50 to-cyan-50 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-blue-500 text-white",children:s.jsx(qt,{className:"h-6 w-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"   "}),s.jsx("p",{className:"text-sm text-gray-600",children:"  ?"})]})]})}),s.jsxs("div",{className:"px-6 py-6 space-y-4",children:[s.jsx("div",{className:"rounded-xl bg-gray-50 p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-blue-100 text-blue-600 flex-shrink-0",children:s.jsx(zt,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:" "}),s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",title:t,children:t}),s.jsx("p",{className:"text-xs text-gray-500 truncate",title:e,children:e}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n(r)})]})]})}),s.jsx("div",{className:"rounded-xl bg-blue-50 p-4 border border-blue-200",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[" ",s.jsx("strong",{children:":"}),"      "]})})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 space-y-3",children:[s.jsxs("button",{onClick:a,className:"w-full bg-gradient-to-r from-blue-600 via-cyan-600 to-teal-600 text-white py-3 px-4 font-semibold hover:shadow-lg hover:shadow-blue-500/30 focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all duration-300 transform hover:scale-[1.01] active:scale-[0.99] text-sm flex items-center justify-center gap-2",style:{borderRadius:"14px"},children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"   ",t]}),s.jsx("button",{onClick:()=>window.location.href="/",className:"w-full bg-white border-2 border-gray-300 text-gray-700 py-3 px-4 font-semibold hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-300 transition-all duration-200 text-sm",style:{borderRadius:"14px"},children:"  "})]})]})})}function wO({onSuccess:e}){const[t,r]=E.useState(""),[a,n]=E.useState(""),[i,l]=E.useState(!1),[o,c]=E.useState(!1),[d,x]=E.useState(!1),[u,f]=E.useState(!1),[h,p]=E.useState(null),{signIn:g,user:y,loading:v,authError:w}=st();Qt(),E.useEffect(()=>{if(U_()){const D=db();D&&(p(D),f(!0))}},[]);const m=y&&!v,b=D=>D.includes("@")?D:D+"@sns.ru",_=async D=>{if(D.preventDefault(),o)return;c(!0);const R=b(t);!(await g(R,a)).error&&e&&e(),c(!1)},C=D=>{x(!1),setTimeout(()=>{window.location.href=`/auth/qr/${D}`},100)},j=async()=>{if(h){f(!1);try{console.log(" Attempting to restore session for:",h.email);const{data:{session:D},error:R}=await Z.auth.getSession();if(D!=null&&D.user&&!R){console.log(" Session restored successfully:",D.user.email),window.location.href="/";return}console.log(" No active session found, showing login form");const M=h.email.replace("@sns.ru","");r(M),setTimeout(()=>{const O=document.getElementById("password");O&&O.focus()},100)}catch(D){console.error(" Error restoring session:",D);const R=h.email.replace("@sns.ru","");r(R),setTimeout(()=>{const M=document.getElementById("password");M&&M.focus()},100)}}};return m?s.jsx("div",{className:"w-full max-w-md mx-auto",children:s.jsx("div",{className:"bg-white/80 backdrop-blur-2xl rounded-3xl p-8 shadow-2xl border border-white/50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-emerald-500 to-green-600 rounded-full mx-auto flex items-center justify-center mb-6 shadow-xl shadow-green-500/30 animate-pulse",children:s.jsx(Pa,{className:"h-10 w-10 text-white"})}),s.jsx("h2",{className:"text-3xl font-semibold text-gray-900 mb-2",children:" !"}),s.jsx("p",{className:"text-gray-700 font-medium mb-6",children:y.full_name||y.email}),s.jsx("div",{className:"flex items-center justify-center text-green-600",children:s.jsx(Yl,{size:20,direction:"horizontal",iconClassName:"text-green-600",label:"...",labelClassName:"text-green-600 font-medium"})})]})})}):v?s.jsx("div",{className:"w-full max-w-md mx-auto",children:s.jsx("div",{className:"bg-white/80 backdrop-blur-2xl rounded-3xl p-8 shadow-2xl border border-white/50",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Yl,{size:48,className:"mx-auto mb-6",label:""}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:" ..."}),s.jsx("p",{className:"text-gray-600",children:", "})]})})}):s.jsxs("div",{className:"w-full",children:[s.jsxs("div",{className:"bg-white/95 backdrop-blur-3xl p-6 shadow-2xl border border-white/50",style:{borderRadius:"28px"},children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 via-cyan-500 to-teal-500 mx-auto flex items-center justify-center mb-4 shadow-xl shadow-blue-500/30",style:{borderRadius:"20px"},children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),s.jsx("h1",{className:"text-2xl font-semibold text-gray-900 mb-1 tracking-tight",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"   SNS"})]}),s.jsxs("form",{onSubmit:_,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{htmlFor:"identifier",className:"block text-sm font-medium text-gray-800",children:"   SAP "}),s.jsx("div",{className:"relative",children:s.jsx("input",{id:"identifier",name:"identifier",type:"text",inputMode:"text",required:!0,value:t,onChange:D=>r(D.target.value),className:"w-full px-3.5 py-2.5 border-2 border-gray-200 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10 transition-all duration-200 bg-white/70 text-gray-900 placeholder-gray-500 font-medium text-sm",style:{borderRadius:"14px"},placeholder:"   SAP ",disabled:o})})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-800",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"password",name:"password",type:i?"text":"password",required:!0,value:a,onChange:D=>n(D.target.value),className:"w-full px-3.5 py-2.5 pr-11 border-2 border-gray-200 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10 transition-all duration-200 bg-white/70 text-gray-900 placeholder-gray-500 font-medium text-sm",style:{borderRadius:"14px"},placeholder:" ",disabled:o}),s.jsx("button",{type:"button",onClick:()=>l(!i),className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-700 transition-colors p-1 rounded-lg hover:bg-gray-100",disabled:o,children:i?s.jsx(H_,{className:"h-4 w-4"}):s.jsx(el,{className:"h-4 w-4"})})]})]}),w&&s.jsxs("div",{className:"bg-red-50 border border-red-200 p-3 flex items-start",style:{borderRadius:"14px"},children:[s.jsx(ar,{className:"h-4 w-4 text-red-500 mr-2 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-red-600",children:w})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:o||v,className:"w-full bg-gradient-to-r from-blue-600 via-cyan-600 to-teal-600 text-white py-3 px-4 font-semibold hover:shadow-lg hover:shadow-blue-500/30 focus:outline-none focus:ring-2 focus:ring-blue-500/50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-[1.01] active:scale-[0.99] text-sm",style:{borderRadius:"14px"},children:o||v?s.jsx("div",{className:"flex items-center justify-center text-white",children:s.jsx(Yl,{size:20,direction:"horizontal",light:!0,label:"...",labelClassName:"text-white"})}):s.jsxs("span",{className:"flex items-center justify-center",children:[s.jsx("span",{children:"  "}),s.jsx("svg",{className:"ml-2 w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})})]}),s.jsx("div",{className:"mt-4",children:s.jsxs("button",{type:"button",onClick:()=>x(!0),className:"w-full flex items-center justify-center px-3 py-2 border border-gray-300 text-gray-600 bg-white/50 hover:bg-gray-50 hover:text-gray-700 focus:outline-none focus:ring-1 focus:ring-gray-300 transition-all duration-200 text-xs",style:{borderRadius:"12px"},children:[s.jsx(Zh,{className:"h-3.5 w-3.5 mr-1.5"}),s.jsx("span",{children:" QR"})]})}),s.jsxs("div",{className:"mt-5 text-center",children:[s.jsx("p",{className:"text-[10px] text-gray-500 font-medium leading-tight",children:"      SNS  2025"}),s.jsx("div",{className:"mt-1",children:s.jsx("a",{href:"https://sns.ru",target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-blue-600 hover:text-blue-700 transition-colors font-medium",children:"sns.ru"})})]})]}),s.jsx(bO,{isOpen:d,onClose:()=>x(!1),onScan:C}),u&&h&&s.jsx(yO,{email:h.email,fullName:h.fullName,timestamp:h.timestamp,onLoginAgain:j})]})}function EO({onSuccess:e}){return s.jsxs("div",{className:"fixed inset-0 overflow-hidden bg-gradient-to-br from-[#f4fff9] via-white to-[#e6f7f1]",children:[s.jsxs("div",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",children:[s.jsx("div",{className:"absolute top-[-20%] right-[-15%] w-[620px] h-[620px] rounded-full bg-gradient-to-br from-[#06A478]/25 via-[#0fbf89]/20 to-[#22d3a0]/20 blur-3xl animate-pulse",style:{animationDuration:"8s"}}),s.jsx("div",{className:"absolute bottom-[-22%] left-[-15%] w-[760px] h-[760px] rounded-full bg-gradient-to-tr from-[#0fbf89]/20 via-[#06A478]/25 to-[#c8f5e2]/30 blur-3xl animate-pulse",style:{animationDuration:"11s",animationDelay:"2s"}}),s.jsx("div",{className:"absolute top-[18%] left-[12%] w-[420px] h-[420px] rounded-full bg-gradient-to-bl from-[#bbf7d0]/25 via-[#86efac]/20 to-transparent blur-3xl animate-pulse",style:{animationDuration:"13s",animationDelay:"4s"}})]}),s.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_60%_40%,rgba(6,164,120,0.12),transparent_55%)] pointer-events-none"}),s.jsx("div",{className:"h-full w-full flex items-center justify-center p-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsx(wO,{onSuccess:e})})}),s.jsx("div",{className:"absolute bottom-4 right-4 z-20 pointer-events-none",children:s.jsx("p",{className:"text-[10px] text-gray-500/60 font-mono",children:"Build dd97d01 (2025-10-20 10:35)"})})]})}function _O({onCategorySelect:e,onGroupNameChange:t,onExpertEmailsChange:r,onExpertsChange:a,onTitleUpdate:n,onDescriptionUpdate:i,selectedCategory:l,groupName:o="",expertEmails:c=[],experts:d=[]}){const[x,u]=E.useState([]),[f,h]=E.useState(!0),[p,g]=E.useState(!1),[y,v]=E.useState({fullName:"",position:"",email:""}),[w,m]=E.useState([]),b=async()=>{try{h(!0);const{data:B,error:L}=await Z.from("talent_categories").select("*").order("name_ru");if(L)throw L;u(B||[]),console.log("  :",B)}catch(B){console.error("Error fetching talent categories:",B)}finally{h(!1)}};E.useEffect(()=>{b()},[]),E.useEffect(()=>{m(d)},[d]);const _=(B,L)=>{if(!B)return;const U=`   - ${B.name_ru}${L?` (${L})`:""}`,P=`        "${B.name_ru}". ${B.description}${L?` : ${L}.`:""}    :  ,     .`;n==null||n(U),i==null||i(P)},C=B=>{e(B),_(B,o),g(!1)},j=B=>{t(B),l&&_(l,B)},D=()=>{if(y.fullName.trim()&&y.email.trim()){const B={id:Date.now().toString(),fullName:y.fullName.trim(),position:y.position.trim(),email:y.email.trim()},L=[...w,B];m(L),a==null||a(L);const U=L.map(P=>P.email);r(U),v({fullName:"",position:"",email:""})}},R=B=>{const L=w.filter(P=>P.id!==B);m(L),a==null||a(L);const U=L.map(P=>P.email);r(U)},M=(B,L)=>{v(U=>({...U,[B]:L}))},O=B=>{switch(B){case"talent_sv":return s.jsx(Ms,{className:"h-5 w-5"});case"potential_gdf":return s.jsx(nt,{className:"h-5 w-5"});case"professionals_rm":return s.jsx(tx,{className:"h-5 w-5"});default:return s.jsx(nt,{className:"h-5 w-5"})}};return f?(console.log("ExamTypeSelector:   ..."),s.jsx("div",{className:"flex items-center justify-center py-4",children:s.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})})):(console.log("ExamTypeSelector:   :",x),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"   *"}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{type:"button",onClick:()=>g(!p),className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-white text-left focus:ring-2 focus:ring-blue-500 focus:border-blue-500 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-3",children:l?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:l.color+"20"},children:O(l.name)}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:l.name_ru}),s.jsx("div",{className:"text-sm text-gray-500",children:l.description})]})]}):s.jsx("span",{className:"text-gray-500",children:"   "})}),s.jsx(xi,{className:`h-5 w-5 text-gray-400 transition-transform ${p?"rotate-180":""}`})]}),p&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:x.map(B=>s.jsxs("button",{type:"button",onClick:()=>C(B),className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:B.color+"20"},children:O(B.name)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:B.name_ru}),s.jsx("div",{className:"text-sm text-gray-500",children:B.description})]}),(l==null?void 0:l.id)===B.id&&s.jsx(mn,{className:"h-5 w-5 text-blue-500"})]},B.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"}),s.jsx("input",{type:"text",value:o,onChange:B=>j(B.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:": 21",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-4 flex items-center",children:[s.jsx(nt,{className:"w-4 h-4 text-[#06A478] mr-2"})," *"]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4 mb-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:" "}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" *"}),s.jsx("input",{type:"text",value:y.fullName,onChange:B=>M("fullName",B.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-[#06A478]",placeholder:"  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:y.position,onChange:B=>M("position",B.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-[#06A478]",placeholder:" "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Email *"}),s.jsx("input",{type:"email",value:y.email,onChange:B=>M("email",B.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-[#06A478]",placeholder:"expert@company.com"})]})]}),s.jsxs("button",{type:"button",onClick:D,disabled:!y.fullName.trim()||!y.email.trim(),className:"mt-3 px-4 py-2 bg-[#06A478] text-white text-sm font-medium rounded-lg hover:bg-[#05976b] disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center",children:[s.jsx(es,{className:"w-4 h-4 mr-2"})," "]})]}),w.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700",children:" "}),w.map(B=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(qt,{className:"w-4 h-4 text-gray-500 mr-2"}),s.jsx("span",{className:"font-medium text-gray-800",children:B.fullName})]}),B.position&&s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:B.position}),s.jsx("p",{className:"text-sm text-blue-600",children:B.email})]}),s.jsx("button",{type:"button",onClick:()=>R(B.id),className:"ml-4 p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors",children:s.jsx(Qe,{className:"w-4 h-4"})})]},B.id))]}),w.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(nt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),s.jsx("p",{className:"text-sm",children:"    "})]})]})]}))}async function xc(e,t,r="employee",a="123456",n={}){var i;try{const l=n.sap_number&&n.sap_number.trim()!==""?n.sap_number:null,o=await fetch("https://oaockmesooydvausfoca.supabase.co/functions/v1/create-user-and-auth",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${((i=(await Z.auth.getSession()).data.session)==null?void 0:i.access_token)||""}`},body:JSON.stringify({email:e,password:a,full_name:t.trim(),role:r,sap_number:l,phone:n.phone,territory_id:n.territory_id,branch_id:n.branch_id,position_id:n.position_id,work_experience_days:n.work_experience_days||0})});if(!o.ok){const d=await o.json();if(d.error&&(d.error.includes("already registered")||d.error.includes("already exists")||d.error.includes("A user with this email address has already been registered")))return{success:!0,message:"   email  ",email:e,password:a};throw new Error(d.error||` HTTP ${o.status}`)}const c=await o.json();return c.success?{success:!0,message:c.message||"  ",email:e,password:c.tempPassword||a,user:c.user}:c.error&&(c.error.includes("already registered")||c.error.includes("already exists")||c.error.includes("A user with this email address has already been registered"))?{success:!0,message:"   email  ",email:e,password:a}:{success:!1,message:c.message||c.error||"    ",configurationRequired:c.configurationRequired}}catch(l){if(l instanceof Error){if(l.message.includes("already registered")||l.message.includes("already exists")||l.message.includes("A user with this email address has already been registered"))return{success:!0,message:"   email  ",email:e,password:a};if(l.message.includes("Email confirm")||l.message.includes("email_confirmation"))return{success:!1,message:"   email   Supabase",configurationRequired:!0}}return{success:!1,message:l instanceof Error?l.message:"    "}}}async function jO(e){var t;try{console.log("  :",e);try{const r=await fetch("https://oaockmesooydvausfoca.supabase.co/functions/v1/delete-user",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${((t=(await Z.auth.getSession()).data.session)==null?void 0:t.access_token)||""}`},body:JSON.stringify({userId:e})});if(!r.ok){const n=await r.json();throw console.warn(" Edge Function :",n),new Error(n.error||` HTTP ${r.status}`)}const a=await r.json();if(a.success)return{success:!0,message:"  "};throw new Error(a.error||"    ")}catch(r){console.warn("Edge Function  ,  RPC :",r);const{data:a,error:n}=await Z.rpc("rpc_delete_user_complete",{p_user_id:e});if(n){console.warn("RPC   ,   :",n);const{error:i}=await Z.from("users").delete().eq("id",e);if(i)throw new Error(`    : ${i.message}`);return{success:!0,message:"     "}}if(a&&a.success)return{success:!0,message:"  "};throw new Error((a==null?void 0:a.message)||"  ")}}catch(r){return console.error("   :",r),{success:!1,message:r instanceof Error?r.message:"  "}}}async function NO(e,t){var r;try{console.log("    :",e,t);try{const a=await fetch("https://oaockmesooydvausfoca.supabase.co/functions/v1/password-management",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${((r=(await Z.auth.getSession()).data.session)==null?void 0:r.access_token)||""}`},body:JSON.stringify({action:"reset_password",userId:e,email:t})});if(!a.ok){const i=await a.json();throw console.warn(" Edge Function :",i),new Error(i.error||` HTTP ${a.status}`)}const n=await a.json();if(n.success)return{success:!0,message:"  ",password:n.password||"123456"};throw new Error(n.error||"    ")}catch(a){console.warn("Edge Function  ,  RPC :",a);try{const{data:n,error:i}=await Z.rpc("rpc_repair_user_auth",{p_user_id:e});if(!i&&(n==null?void 0:n.status)==="success")return console.log("    RPC "),{success:!0,message:"  ",password:n.password||"123456"};throw i||new Error((n==null?void 0:n.message)||"  ")}catch(n){console.warn(" RPC   :",n),console.log("  : 123456");try{await Z.from("users").update({password_changed_at:new Date().toISOString()}).eq("id",e)}catch(i){console.warn("    :",i)}return{success:!0,message:"  : 123456",password:"123456"}}}}catch(a){return console.error("   :",a),{success:!1,message:a instanceof Error?a.message:"  "}}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xf={};Xf.version="0.18.5";var tj=1252,CO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],hb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mb=function(e){CO.indexOf(e)!=-1&&(tj=hb[0]=e)};function AO(){mb(1252)}var Qa=function(e){mb(e)};function gb(){Qa(1200),AO()}function Jw(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function kO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function rj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var X0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?kO(e.slice(2)):t==254&&r==255?rj(e.slice(2)):t==65279?e.slice(1):e},Du=function(t){return String.fromCharCode(t)},Zw=function(t){return String.fromCharCode(t)},nx,Ii="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ix(e){for(var t="",r=0,a=0,n=0,i=0,l=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),l=(r&3)<<4|a>>4,n=e.charCodeAt(d++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),t+=Ii.charAt(i)+Ii.charAt(l)+Ii.charAt(o)+Ii.charAt(c);return t}function ca(e){var t="",r=0,a=0,n=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Ii.indexOf(e.charAt(d++)),l=Ii.indexOf(e.charAt(d++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=Ii.indexOf(e.charAt(d++)),a=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),c=Ii.indexOf(e.charAt(d++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),pi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function sl(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function e4(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var sa=function(t){return xt?pi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function em(e){if(typeof ArrayBuffer>"u")return sa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function hl(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function DO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function pb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return pb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xr=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:pi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function SO(e){for(var t=[],r=0,a=e.length+250,n=sl(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|o>>6&15|(l&3)<<4,n[r++]=128|o&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(t.push(n.slice(0,r)),r=0,n=sl(65535),a=65530)}return t.push(n.slice(0,r)),Xr(t)}var Rs=/\u0000/g,K0=/[\u0001-\u0006]/g;function Cc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ja(e,t){var r=""+e;return r.length>=t?r:xr("0",t-r.length)+r}function vb(e,t){var r=""+e;return r.length>=t?r:xr(" ",t-r.length)+r}function Kf(e,t){var r=""+e;return r.length>=t?r:r+xr(" ",t-r.length)}function BO(e,t){var r=""+Math.round(e);return r.length>=t?r:xr("0",t-r.length)+r}function FO(e,t){var r=""+e;return r.length>=t?r:xr("0",t-r.length)+r}var t4=Math.pow(2,32);function zo(e,t){if(e>t4||e<-t4)return BO(e,t);var r=Math.round(e);return FO(r,t)}function Qf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var r4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function TO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},s4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},MO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jf(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,l=1,o=0,c=1,d=0,x=0,u=Math.floor(n);d<t&&(u=Math.floor(n),o=u*l+i,x=u*d+c,!(n-u<5e-8));)n=1/(n-u),i=l,l=o,c=d,d=x;if(x>t&&(d>t?(x=c,o=i):(x=d,o=l)),!r)return[0,a*o,x];var f=Math.floor(a*o/x);return[f,a*o-f*x,x]}function Pl(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,l=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=UO(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var sj=new Date(1899,11,31,0,0,0),RO=sj.getTime(),OO=new Date(1900,2,1,0,0,0);function aj(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=OO&&(r+=24*60*60*1e3),(r-(RO+(e.getTimezoneOffset()-sj.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function bb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function PO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function LO(e){var t=e<0?12:11,r=bb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function IO(e){var t=bb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function lx(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=LO(e):t===10?r=e.toFixed(10).substr(0,12):r=IO(e),bb(PO(r.toUpperCase()))}function uo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):lx(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ua(14,aj(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function UO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function $O(e,t,r,a){var n="",i=0,l=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return vg[r.m-1][1];case 5:return vg[r.m-1][0];default:return vg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return r4[r.q][0];default:return r4[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ja(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(n=Ja(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var x=d>0?Ja(c,d):"";return x}function Ui(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var nj=/%/g;function zO(e,t,r){var a=t.replace(nj,""),n=t.length-a.length;return si(e,a,r*Math.pow(10,2*n))+xr("%",n)}function qO(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return si(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function ij(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ij(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,x){return c+d+x.substr(0,(n+i)%n)+"."+x.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var lj=/# (\?+)( ?)\/( ?)(\d+)/;function VO(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),l=n-i*a,o=a;return r+(i===0?"":""+i)+" "+(l===0?xr(" ",e[1].length+1+e[4].length):vb(l,e[1].length)+e[2]+"/"+e[3]+Ja(o,e[4].length))}function HO(e,t,r){return r+(t===0?"":""+t)+xr(" ",e[1].length+2+e[4].length)}var oj=/^#*0*\.([0#]+)/,cj=/\).*[0#]/,dj=/\(###\) ###\\?-####/;function ks(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function a4(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function n4(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function WO(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function GO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ga(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cj)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ga("n",a,r):"("+ga("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qO(e,t,r);if(t.indexOf("%")!==-1)return zO(e,t,r);if(t.indexOf("E")!==-1)return ij(t,r);if(t.charCodeAt(0)===36)return"$"+ga(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+zo(c,t.length);if(t.match(/^[#?]+$/))return n=zo(r,0),n==="0"&&(n=""),n.length>t.length?n:ks(t.substr(0,t.length-n.length))+n;if(i=t.match(lj))return VO(i,c,d);if(t.match(/^#+0+$/))return d+zo(c,t.length-t.indexOf("0"));if(i=t.match(oj))return n=a4(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ks(i[1])).replace(/\.$/,"."+ks(i[1])).replace(/\.(\d*)$/,function(p,g){return"."+g+xr("0",ks(i[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+a4(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ui(zo(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ga(e,t,-r):Ui(""+(Math.floor(r)+WO(r,i[1].length)))+"."+Ja(n4(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ga(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Cc(ga(e,t.replace(/[\\-]/g,""),r)),l=0,Cc(Cc(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<n.length?n.charAt(l++):p==="0"?"0":""}));if(t.match(dj))return n=ga(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var x="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Jf(c,Math.pow(10,l)-1,!1),n=""+d,x=si("n",i[1],o[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),n+=x+i[2]+"/"+i[3],x=Kf(o[2],l),x.length<i[4].length&&(x=ks(i[4].substr(i[4].length-x.length))+x),n+=x,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Jf(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vb(o[1],l)+i[2]+"/"+i[3]+Kf(o[2],l):xr(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=zo(r,0),t.length<=n.length?n:ks(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var u=t.indexOf(".")-l,f=t.length-n.length-u;return ks(t.substr(0,u)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=n4(r,i[1].length),r<0?"-"+ga(e,t,-r):Ui(GO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ja(0,3-p.length):"")+p})+"."+Ja(l,i[1].length);switch(t){case"###,##0.00":return ga(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Ui(zo(c,0));return h!=="0"?d+h:"";case"###,###.00":return ga(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ga(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function YO(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return si(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function XO(e,t,r){var a=t.replace(nj,""),n=t.length-a.length;return si(e,a,r*Math.pow(10,2*n))+xr("%",n)}function xj(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+xj(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,x){return c+d+x.substr(0,(n+i)%n)+"."+x.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function un(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cj)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?un("n",a,r):"("+un("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return YO(e,t,r);if(t.indexOf("%")!==-1)return XO(e,t,r);if(t.indexOf("E")!==-1)return xj(t,r);if(t.charCodeAt(0)===36)return"$"+un(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ja(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:ks(t.substr(0,t.length-n.length))+n;if(i=t.match(lj))return HO(i,c,d);if(t.match(/^#+0+$/))return d+Ja(c,t.length-t.indexOf("0"));if(i=t.match(oj))return n=(""+r).replace(/^([^\.]+)$/,"$1."+ks(i[1])).replace(/\.$/,"."+ks(i[1])),n=n.replace(/\.(\d*)$/,function(p,g){return"."+g+xr("0",ks(i[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ui(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+un(e,t,-r):Ui(""+r)+"."+xr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return un(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Cc(un(e,t.replace(/[\\-]/g,""),r)),l=0,Cc(Cc(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<n.length?n.charAt(l++):p==="0"?"0":""}));if(t.match(dj))return n=un(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var x="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Jf(c,Math.pow(10,l)-1,!1),n=""+d,x=si("n",i[1],o[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),n+=x+i[2]+"/"+i[3],x=Kf(o[2],l),x.length<i[4].length&&(x=ks(i[4].substr(i[4].length-x.length))+x),n+=x,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Jf(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vb(o[1],l)+i[2]+"/"+i[3]+Kf(o[2],l):xr(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:ks(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var u=t.indexOf(".")-l,f=t.length-n.length-u;return ks(t.substr(0,u)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+un(e,t,-r):Ui(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ja(0,3-p.length):"")+p})+"."+Ja(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Ui(""+c);return h!=="0"?d+h:"";default:if(t.match(/\.[0#?]*$/))return un(e,t.slice(0,t.lastIndexOf(".")),r)+ks(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function si(e,t,r){return(r|0)===r?un(e,t,r):ga(e,t,r)}function KO(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var uj=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function m0(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Qf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(uj))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function QO(e,t,r,a){for(var n=[],i="",l=0,o="",c="t",d,x,u,f="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Qf(e,l))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(u=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(u);n[n.length]={t:"t",v:i},++l;break;case"\\":var h=e.charAt(++l),p=h==="("||h===")"?h:"t";n[n.length]={t:p,v:h},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(d==null&&(d=Pl(t,r,e.charAt(l+1)==="2"),d==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Pl(t,r),d==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var g={t:o,v:o};if(d==null&&(d=Pl(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(g.v=d.H>=12?"P":"A"),g.t="T",f="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(g.v=d.H>=12?"PM":"AM"),g.t="T",l+=5,f="h"):e.substr(l,5).toUpperCase()==="/"?(d!=null&&(g.v=d.H>=12?"":""),g.t="T",l+=5,f="h"):(g.t="t",++l),d==null&&g.t==="T")return"";n[n.length]=g,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(uj)){if(d==null&&(d=Pl(t,r),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",m0(e)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++l;break}var y=0,v=0,w;for(l=n.length-1,c="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=f,c="h",y<1&&(y=1);break;case"s":(w=n[l].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=n[l].t;break;case"m":c==="s"&&(n[l].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&n[l].v.match(/[Hh]/)&&(y=1),y<2&&n[l].v.match(/[Mm]/)&&(y=2),y<3&&n[l].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var m="",b;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=$O(n[l].t.charCodeAt(0),n[l].v,d,v),n[l].t="t";break;case"n":case"?":for(b=l+1;n[b]!=null&&((o=n[b].t)==="?"||o==="D"||(o===" "||o==="t")&&n[b+1]!=null&&(n[b+1].t==="?"||n[b+1].t==="t"&&n[b+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[b].v==="/"||n[b].v===" "&&n[b+1]!=null&&n[b+1].t=="?"));)n[l].v+=n[b].v,n[b]={v:"",t:";"},++b;m+=n[l].v,l=b-1;break;case"G":n[l].t="t",n[l].v=uo(t,r);break}var _="",C,j;if(m.length>0){m.charCodeAt(0)==40?(C=t<0&&m.charCodeAt(0)===45?-t:t,j=si("n",m,C)):(C=t<0&&a>1?-t:t,j=si("n",m,C),C<0&&n[0]&&n[0].t=="t"&&(j=j.substr(1),n[0].v="-"+n[0].v)),b=j.length-1;var D=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){D=l;break}var R=n.length;if(D===n.length&&j.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(b>=n[l].v.length-1?(b-=n[l].v.length,n[l].v=j.substr(b+1,n[l].v.length)):b<0?n[l].v="":(n[l].v=j.substr(0,b+1),b=-1),n[l].t="t",R=l);b>=0&&R<n.length&&(n[R].v=j.substr(0,b+1)+n[R].v)}else if(D!==n.length&&j.indexOf("E")===-1){for(b=j.indexOf(".")-1,l=D;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(x=n[l].v.indexOf(".")>-1&&l===D?n[l].v.indexOf(".")-1:n[l].v.length-1,_=n[l].v.substr(x+1);x>=0;--x)b>=0&&(n[l].v.charAt(x)==="0"||n[l].v.charAt(x)==="#")&&(_=j.charAt(b--)+_);n[l].v=_,n[l].t="t",R=l}for(b>=0&&R<n.length&&(n[R].v=j.substr(0,b+1)+n[R].v),b=j.indexOf(".")+1,l=D;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==D)){for(x=n[l].v.indexOf(".")>-1&&l===D?n[l].v.indexOf(".")+1:0,_=n[l].v.substr(0,x);x<n[l].v.length;++x)b<j.length&&(_+=j.charAt(b++));n[l].v=_,n[l].t="t",R=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(C=a>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=si(n[l].t,n[l].v,C),n[l].t="t");var M="";for(l=0;l!==n.length;++l)n[l]!=null&&(M+=n[l].v);return M}var i4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function l4(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function JO(e,t){var r=KO(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(i4),o=r[1].match(i4);return l4(t,l)?[a,r[0]]:l4(t,o)?[a,r[1]]:[a,r[l!=null&&o!=null?2:1]]}return[a,i]}function Ua(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ze)[e],a==null&&(a=r.table&&r.table[s4[e]]||Ze[s4[e]]),a==null&&(a=MO[e]||"General");break}if(Qf(a,0))return uo(t,r);t instanceof Date&&(t=aj(t,r.date1904));var n=JO(a,t);if(Qf(n[1]))return uo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return QO(n[1],t,r,n[0])}function ai(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ze[r]==null){t<0&&(t=r);continue}if(Ze[r]==e){t=r;break}}t<0&&(t=391)}return Ze[t]=e,t}function tm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ai(e[t],t)}function g0(){Ze=TO()}var ZO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},fj=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eP(e){var t=typeof e=="number"?Ze[e]:e;return t=t.replace(fj,"(\\d+)"),new RegExp("^"+t+"$")}function tP(e,t,r){var a=-1,n=-1,i=-1,l=-1,o=-1,c=-1;(t.match(fj)||[]).forEach(function(u,f){var h=parseInt(r[f+1],10);switch(u.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":l=h;break;case"s":c=h;break;case"m":l>=0?o=h:n=h;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var x=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?d:a==-1&&n==-1&&i==-1?x:d+"T"+x}var rP=function(){var e={};e.version="1.2.0";function t(){for(var j=0,D=new Array(256),R=0;R!=256;++R)j=R,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,D[R]=j;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function a(j){var D=0,R=0,M=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)O[M]=j[M];for(M=0;M!=256;++M)for(R=j[M],D=256+M;D<4096;D+=256)R=O[D]=R>>>8^j[R&255];var B=[];for(M=1;M!=16;++M)B[M-1]=typeof Int32Array<"u"?O.subarray(M*256,M*256+256):O.slice(M*256,M*256+256);return B}var n=a(r),i=n[0],l=n[1],o=n[2],c=n[3],d=n[4],x=n[5],u=n[6],f=n[7],h=n[8],p=n[9],g=n[10],y=n[11],v=n[12],w=n[13],m=n[14];function b(j,D){for(var R=D^-1,M=0,O=j.length;M<O;)R=R>>>8^r[(R^j.charCodeAt(M++))&255];return~R}function _(j,D){for(var R=D^-1,M=j.length-15,O=0;O<M;)R=m[j[O++]^R&255]^w[j[O++]^R>>8&255]^v[j[O++]^R>>16&255]^y[j[O++]^R>>>24]^g[j[O++]]^p[j[O++]]^h[j[O++]]^f[j[O++]]^u[j[O++]]^x[j[O++]]^d[j[O++]]^c[j[O++]]^o[j[O++]]^l[j[O++]]^i[j[O++]]^r[j[O++]];for(M+=15;O<M;)R=R>>>8^r[(R^j[O++])&255];return~R}function C(j,D){for(var R=D^-1,M=0,O=j.length,B=0,L=0;M<O;)B=j.charCodeAt(M++),B<128?R=R>>>8^r[(R^B)&255]:B<2048?(R=R>>>8^r[(R^(192|B>>6&31))&255],R=R>>>8^r[(R^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,L=j.charCodeAt(M++)&1023,R=R>>>8^r[(R^(240|B>>8&7))&255],R=R>>>8^r[(R^(128|B>>2&63))&255],R=R>>>8^r[(R^(128|L>>6&15|(B&3)<<4))&255],R=R>>>8^r[(R^(128|L&63))&255]):(R=R>>>8^r[(R^(224|B>>12&15))&255],R=R>>>8^r[(R^(128|B>>6&63))&255],R=R>>>8^r[(R^(128|B&63))&255]);return~R}return e.table=r,e.bstr=b,e.buf=_,e.str=C,e}(),Xe=function(){var t={};t.version="1.2.1";function r(K,ie){for(var ee=K.split("/"),se=ie.split("/"),le=0,oe=0,we=Math.min(ee.length,se.length);le<we;++le){if(oe=ee[le].length-se[le].length)return oe;if(ee[le]!=se[le])return ee[le]<se[le]?-1:1}return ee.length-se.length}function a(K){if(K.charAt(K.length-1)=="/")return K.slice(0,-1).indexOf("/")===-1?K:a(K.slice(0,-1));var ie=K.lastIndexOf("/");return ie===-1?K:K.slice(0,ie+1)}function n(K){if(K.charAt(K.length-1)=="/")return n(K.slice(0,-1));var ie=K.lastIndexOf("/");return ie===-1?K:K.slice(ie+1)}function i(K,ie){typeof ie=="string"&&(ie=new Date(ie));var ee=ie.getHours();ee=ee<<6|ie.getMinutes(),ee=ee<<5|ie.getSeconds()>>>1,K.write_shift(2,ee);var se=ie.getFullYear()-1980;se=se<<4|ie.getMonth()+1,se=se<<5|ie.getDate(),K.write_shift(2,se)}function l(K){var ie=K.read_shift(2)&65535,ee=K.read_shift(2)&65535,se=new Date,le=ee&31;ee>>>=5;var oe=ee&15;ee>>>=4,se.setMilliseconds(0),se.setFullYear(ee+1980),se.setMonth(oe-1),se.setDate(le);var we=ie&31;ie>>>=5;var ke=ie&63;return ie>>>=6,se.setHours(ie),se.setMinutes(ke),se.setSeconds(we<<1),se}function o(K){is(K,0);for(var ie={},ee=0;K.l<=K.length-4;){var se=K.read_shift(2),le=K.read_shift(2),oe=K.l+le,we={};switch(se){case 21589:ee=K.read_shift(1),ee&1&&(we.mtime=K.read_shift(4)),le>5&&(ee&2&&(we.atime=K.read_shift(4)),ee&4&&(we.ctime=K.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}K.l=oe,ie[se]=we}return ie}var c;function d(){return c||(c={})}function x(K,ie){if(K[0]==80&&K[1]==75)return Mo(K,ie);if((K[0]|32)==109&&(K[1]|32)==105)return cn(K,ie);if(K.length<512)throw new Error("CFB file size "+K.length+" < 512");var ee=3,se=512,le=0,oe=0,we=0,ke=0,be=0,Ee=[],G=K.slice(0,512);is(G,0);var ae=u(G);switch(ee=ae[0],ee){case 3:se=512;break;case 4:se=4096;break;case 0:if(ae[1]==0)return Mo(K,ie);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}se!==512&&(G=K.slice(0,se),is(G,28));var xe=K.slice(0,se);f(G,ee);var he=G.read_shift(4,"i");if(ee===3&&he!==0)throw new Error("# Directory Sectors: Expected 0 saw "+he);G.l+=4,we=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),ke=G.read_shift(4,"i"),le=G.read_shift(4,"i"),be=G.read_shift(4,"i"),oe=G.read_shift(4,"i");for(var me=-1,ge=0;ge<109&&(me=G.read_shift(4,"i"),!(me<0));++ge)Ee[ge]=me;var ve=h(K,se);y(be,oe,ve,se,Ee);var Ie=w(ve,we,Ee,se);Ie[we].name="!Directory",le>0&&ke!==L&&(Ie[ke].name="!MiniFAT"),Ie[Ee[0]].name="!FAT",Ie.fat_addrs=Ee,Ie.ssz=se;var ze={},qe=[],$e=[],We=[];m(we,Ie,ve,qe,le,ze,$e,ke),p($e,We,qe),qe.shift();var Ke={FileIndex:$e,FullPaths:We};return ie&&ie.raw&&(Ke.raw={header:xe,sectors:ve}),Ke}function u(K){if(K[K.l]==80&&K[K.l+1]==75)return[0,0];K.chk(U,"Header Signature: "),K.l+=16;var ie=K.read_shift(2,"u");return[K.read_shift(2,"u"),ie]}function f(K,ie){var ee=9;switch(K.l+=2,ee=K.read_shift(2)){case 9:if(ie!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(ie!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}K.chk("0600","Mini Sector Shift: "),K.chk("000000000000","Reserved: ")}function h(K,ie){for(var ee=Math.ceil(K.length/ie)-1,se=[],le=1;le<ee;++le)se[le-1]=K.slice(le*ie,(le+1)*ie);return se[ee-1]=K.slice(ee*ie),se}function p(K,ie,ee){for(var se=0,le=0,oe=0,we=0,ke=0,be=ee.length,Ee=[],G=[];se<be;++se)Ee[se]=G[se]=se,ie[se]=ee[se];for(;ke<G.length;++ke)se=G[ke],le=K[se].L,oe=K[se].R,we=K[se].C,Ee[se]===se&&(le!==-1&&Ee[le]!==le&&(Ee[se]=Ee[le]),oe!==-1&&Ee[oe]!==oe&&(Ee[se]=Ee[oe])),we!==-1&&(Ee[we]=se),le!==-1&&se!=Ee[se]&&(Ee[le]=Ee[se],G.lastIndexOf(le)<ke&&G.push(le)),oe!==-1&&se!=Ee[se]&&(Ee[oe]=Ee[se],G.lastIndexOf(oe)<ke&&G.push(oe));for(se=1;se<be;++se)Ee[se]===se&&(oe!==-1&&Ee[oe]!==oe?Ee[se]=Ee[oe]:le!==-1&&Ee[le]!==le&&(Ee[se]=Ee[le]));for(se=1;se<be;++se)if(K[se].type!==0){if(ke=se,ke!=Ee[ke])do ke=Ee[ke],ie[se]=ie[ke]+"/"+ie[se];while(ke!==0&&Ee[ke]!==-1&&ke!=Ee[ke]);Ee[se]=-1}for(ie[0]+="/",se=1;se<be;++se)K[se].type!==2&&(ie[se]+="/")}function g(K,ie,ee){for(var se=K.start,le=K.size,oe=[],we=se;ee&&le>0&&we>=0;)oe.push(ie.slice(we*B,we*B+B)),le-=B,we=Tl(ee,we*4);return oe.length===0?Ae(0):Xr(oe).slice(0,K.size)}function y(K,ie,ee,se,le){var oe=L;if(K===L){if(ie!==0)throw new Error("DIFAT chain shorter than expected")}else if(K!==-1){var we=ee[K],ke=(se>>>2)-1;if(!we)return;for(var be=0;be<ke&&(oe=Tl(we,be*4))!==L;++be)le.push(oe);y(Tl(we,se-4),ie-1,ee,se,le)}}function v(K,ie,ee,se,le){var oe=[],we=[];le||(le=[]);var ke=se-1,be=0,Ee=0;for(be=ie;be>=0;){le[be]=!0,oe[oe.length]=be,we.push(K[be]);var G=ee[Math.floor(be*4/se)];if(Ee=be*4&ke,se<4+Ee)throw new Error("FAT boundary crossed: "+be+" 4 "+se);if(!K[G])break;be=Tl(K[G],Ee)}return{nodes:oe,data:b4([we])}}function w(K,ie,ee,se){var le=K.length,oe=[],we=[],ke=[],be=[],Ee=se-1,G=0,ae=0,xe=0,he=0;for(G=0;G<le;++G)if(ke=[],xe=G+ie,xe>=le&&(xe-=le),!we[xe]){be=[];var me=[];for(ae=xe;ae>=0;){me[ae]=!0,we[ae]=!0,ke[ke.length]=ae,be.push(K[ae]);var ge=ee[Math.floor(ae*4/se)];if(he=ae*4&Ee,se<4+he)throw new Error("FAT boundary crossed: "+ae+" 4 "+se);if(!K[ge]||(ae=Tl(K[ge],he),me[ae]))break}oe[xe]={nodes:ke,data:b4([be])}}return oe}function m(K,ie,ee,se,le,oe,we,ke){for(var be=0,Ee=se.length?2:0,G=ie[K].data,ae=0,xe=0,he;ae<G.length;ae+=128){var me=G.slice(ae,ae+128);is(me,64),xe=me.read_shift(2),he=Cb(me,0,xe-Ee),se.push(he);var ge={name:he,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},ve=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);ve!==0&&(ge.ct=b(me,me.l-8));var Ie=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Ie!==0&&(ge.mt=b(me,me.l-8)),ge.start=me.read_shift(4,"i"),ge.size=me.read_shift(4,"i"),ge.size<0&&ge.start<0&&(ge.size=ge.type=0,ge.start=L,ge.name=""),ge.type===5?(be=ge.start,le>0&&be!==L&&(ie[be].name="!StreamData")):ge.size>=4096?(ge.storage="fat",ie[ge.start]===void 0&&(ie[ge.start]=v(ee,ge.start,ie.fat_addrs,ie.ssz)),ie[ge.start].name=ge.name,ge.content=ie[ge.start].data.slice(0,ge.size)):(ge.storage="minifat",ge.size<0?ge.size=0:be!==L&&ge.start!==L&&ie[be]&&(ge.content=g(ge,ie[be].data,(ie[ke]||{}).data))),ge.content&&is(ge.content,0),oe[he]=ge,we.push(ge)}}function b(K,ie){return new Date((ta(K,ie+4)/1e7*Math.pow(2,32)+ta(K,ie)/1e7-11644473600)*1e3)}function _(K,ie){return d(),x(c.readFileSync(K),ie)}function C(K,ie){var ee=ie&&ie.type;switch(ee||xt&&Buffer.isBuffer(K)&&(ee="buffer"),ee||"base64"){case"file":return _(K,ie);case"base64":return x(sa(ca(K)),ie);case"binary":return x(sa(K),ie)}return x(K,ie)}function j(K,ie){var ee=ie||{},se=ee.root||"Root Entry";if(K.FullPaths||(K.FullPaths=[]),K.FileIndex||(K.FileIndex=[]),K.FullPaths.length!==K.FileIndex.length)throw new Error("inconsistent CFB structure");K.FullPaths.length===0&&(K.FullPaths[0]=se+"/",K.FileIndex[0]={name:se,type:5}),ee.CLSID&&(K.FileIndex[0].clsid=ee.CLSID),D(K)}function D(K){var ie="Sh33tJ5";if(!Xe.find(K,"/"+ie)){var ee=Ae(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,K.FileIndex.push({name:ie,type:2,content:ee,size:4,L:69,R:69,C:69}),K.FullPaths.push(K.FullPaths[0]+ie),R(K)}}function R(K,ie){j(K);for(var ee=!1,se=!1,le=K.FullPaths.length-1;le>=0;--le){var oe=K.FileIndex[le];switch(oe.type){case 0:se?ee=!0:(K.FileIndex.pop(),K.FullPaths.pop());break;case 1:case 2:case 5:se=!0,isNaN(oe.R*oe.L*oe.C)&&(ee=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!ie)){var we=new Date(1987,1,19),ke=0,be=Object.create?Object.create(null):{},Ee=[];for(le=0;le<K.FullPaths.length;++le)be[K.FullPaths[le]]=!0,K.FileIndex[le].type!==0&&Ee.push([K.FullPaths[le],K.FileIndex[le]]);for(le=0;le<Ee.length;++le){var G=a(Ee[le][0]);se=be[G],se||(Ee.push([G,{name:n(G).replace("/",""),type:1,clsid:F,ct:we,mt:we,content:null}]),be[G]=!0)}for(Ee.sort(function(he,me){return r(he[0],me[0])}),K.FullPaths=[],K.FileIndex=[],le=0;le<Ee.length;++le)K.FullPaths[le]=Ee[le][0],K.FileIndex[le]=Ee[le][1];for(le=0;le<Ee.length;++le){var ae=K.FileIndex[le],xe=K.FullPaths[le];if(ae.name=n(xe).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||F,le===0)ae.C=Ee.length>1?1:-1,ae.size=0,ae.type=5;else if(xe.slice(-1)=="/"){for(ke=le+1;ke<Ee.length&&a(K.FullPaths[ke])!=xe;++ke);for(ae.C=ke>=Ee.length?-1:ke,ke=le+1;ke<Ee.length&&a(K.FullPaths[ke])!=a(xe);++ke);ae.R=ke>=Ee.length?-1:ke,ae.type=1}else a(K.FullPaths[le+1]||"")==a(xe)&&(ae.R=le+1),ae.type=2}}}function M(K,ie){var ee=ie||{};if(ee.fileType=="mad")return pr(K,ee);switch(R(K),ee.fileType){case"zip":return Nr(K,ee)}var se=function(he){for(var me=0,ge=0,ve=0;ve<he.FileIndex.length;++ve){var Ie=he.FileIndex[ve];if(Ie.content){var ze=Ie.content.length;ze>0&&(ze<4096?me+=ze+63>>6:ge+=ze+511>>9)}}for(var qe=he.FullPaths.length+3>>2,$e=me+7>>3,We=me+127>>7,Ke=$e+ge+qe+We,Ge=Ke+127>>7,ht=Ge<=109?0:Math.ceil((Ge-109)/127);Ke+Ge+ht+127>>7>Ge;)ht=++Ge<=109?0:Math.ceil((Ge-109)/127);var Oe=[1,ht,Ge,We,qe,ge,me,0];return he.FileIndex[0].size=me<<6,Oe[7]=(he.FileIndex[0].start=Oe[0]+Oe[1]+Oe[2]+Oe[3]+Oe[4]+Oe[5])+(Oe[6]+7>>3),Oe}(K),le=Ae(se[7]<<9),oe=0,we=0;{for(oe=0;oe<8;++oe)le.write_shift(1,P[oe]);for(oe=0;oe<8;++oe)le.write_shift(2,0);for(le.write_shift(2,62),le.write_shift(2,3),le.write_shift(2,65534),le.write_shift(2,9),le.write_shift(2,6),oe=0;oe<3;++oe)le.write_shift(2,0);for(le.write_shift(4,0),le.write_shift(4,se[2]),le.write_shift(4,se[0]+se[1]+se[2]+se[3]-1),le.write_shift(4,0),le.write_shift(4,4096),le.write_shift(4,se[3]?se[0]+se[1]+se[2]-1:L),le.write_shift(4,se[3]),le.write_shift(-4,se[1]?se[0]-1:L),le.write_shift(4,se[1]),oe=0;oe<109;++oe)le.write_shift(-4,oe<se[2]?se[1]+oe:-1)}if(se[1])for(we=0;we<se[1];++we){for(;oe<236+we*127;++oe)le.write_shift(-4,oe<se[2]?se[1]+oe:-1);le.write_shift(-4,we===se[1]-1?L:we+1)}var ke=function(he){for(we+=he;oe<we-1;++oe)le.write_shift(-4,oe+1);he&&(++oe,le.write_shift(-4,L))};for(we=oe=0,we+=se[1];oe<we;++oe)le.write_shift(-4,N.DIFSECT);for(we+=se[2];oe<we;++oe)le.write_shift(-4,N.FATSECT);ke(se[3]),ke(se[4]);for(var be=0,Ee=0,G=K.FileIndex[0];be<K.FileIndex.length;++be)G=K.FileIndex[be],G.content&&(Ee=G.content.length,!(Ee<4096)&&(G.start=we,ke(Ee+511>>9)));for(ke(se[6]+7>>3);le.l&511;)le.write_shift(-4,N.ENDOFCHAIN);for(we=oe=0,be=0;be<K.FileIndex.length;++be)G=K.FileIndex[be],G.content&&(Ee=G.content.length,!(!Ee||Ee>=4096)&&(G.start=we,ke(Ee+63>>6)));for(;le.l&511;)le.write_shift(-4,N.ENDOFCHAIN);for(oe=0;oe<se[4]<<2;++oe){var ae=K.FullPaths[oe];if(!ae||ae.length===0){for(be=0;be<17;++be)le.write_shift(4,0);for(be=0;be<3;++be)le.write_shift(4,-1);for(be=0;be<12;++be)le.write_shift(4,0);continue}G=K.FileIndex[oe],oe===0&&(G.start=G.size?G.start-1:L);var xe=oe===0&&ee.root||G.name;if(Ee=2*(xe.length+1),le.write_shift(64,xe,"utf16le"),le.write_shift(2,Ee),le.write_shift(1,G.type),le.write_shift(1,G.color),le.write_shift(-4,G.L),le.write_shift(-4,G.R),le.write_shift(-4,G.C),G.clsid)le.write_shift(16,G.clsid,"hex");else for(be=0;be<4;++be)le.write_shift(4,0);le.write_shift(4,G.state||0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,G.start),le.write_shift(4,G.size),le.write_shift(4,0)}for(oe=1;oe<K.FileIndex.length;++oe)if(G=K.FileIndex[oe],G.size>=4096)if(le.l=G.start+1<<9,xt&&Buffer.isBuffer(G.content))G.content.copy(le,le.l,0,G.size),le.l+=G.size+511&-512;else{for(be=0;be<G.size;++be)le.write_shift(1,G.content[be]);for(;be&511;++be)le.write_shift(1,0)}for(oe=1;oe<K.FileIndex.length;++oe)if(G=K.FileIndex[oe],G.size>0&&G.size<4096)if(xt&&Buffer.isBuffer(G.content))G.content.copy(le,le.l,0,G.size),le.l+=G.size+63&-64;else{for(be=0;be<G.size;++be)le.write_shift(1,G.content[be]);for(;be&63;++be)le.write_shift(1,0)}if(xt)le.l=le.length;else for(;le.l<le.length;)le.write_shift(1,0);return le}function O(K,ie){var ee=K.FullPaths.map(function(be){return be.toUpperCase()}),se=ee.map(function(be){var Ee=be.split("/");return Ee[Ee.length-(be.slice(-1)=="/"?2:1)]}),le=!1;ie.charCodeAt(0)===47?(le=!0,ie=ee[0].slice(0,-1)+ie):le=ie.indexOf("/")!==-1;var oe=ie.toUpperCase(),we=le===!0?ee.indexOf(oe):se.indexOf(oe);if(we!==-1)return K.FileIndex[we];var ke=!oe.match(K0);for(oe=oe.replace(Rs,""),ke&&(oe=oe.replace(K0,"!")),we=0;we<ee.length;++we)if((ke?ee[we].replace(K0,"!"):ee[we]).replace(Rs,"")==oe||(ke?se[we].replace(K0,"!"):se[we]).replace(Rs,"")==oe)return K.FileIndex[we];return null}var B=64,L=-2,U="d0cf11e0a1b11ae1",P=[208,207,17,224,161,177,26,225],F="00000000000000000000000000000000",N={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:F,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function T(K,ie,ee){d();var se=M(K,ee);c.writeFileSync(ie,se)}function S(K){for(var ie=new Array(K.length),ee=0;ee<K.length;++ee)ie[ee]=String.fromCharCode(K[ee]);return ie.join("")}function z(K,ie){var ee=M(K,ie);switch(ie&&ie.type||"buffer"){case"file":return d(),c.writeFileSync(ie.filename,ee),ee;case"binary":return typeof ee=="string"?ee:S(ee);case"base64":return ix(typeof ee=="string"?ee:S(ee));case"buffer":if(xt)return Buffer.isBuffer(ee)?ee:pi(ee);case"array":return typeof ee=="string"?sa(ee):ee}return ee}var W;function k(K){try{var ie=K.InflateRaw,ee=new ie;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)W=K;else throw new Error("zlib does not expose bytesRead")}catch(se){console.error("cannot use native zlib: "+(se.message||se))}}function q(K,ie){if(!W)return zr(K,ie);var ee=W.InflateRaw,se=new ee,le=se._processChunk(K.slice(K.l),se._finishFlushFlag);return K.l+=se.bytesRead,le}function A(K){return W?W.deflateRawSync(K):Ue(K)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(K){var ie=(K<<1|K<<11)&139536|(K<<5|K<<15)&558144;return(ie>>16|ie>>8|ie)&255}for(var Q=typeof Uint8Array<"u",te=Q?new Uint8Array(256):[],re=0;re<256;++re)te[re]=Y(re);function X(K,ie){var ee=te[K&255];return ie<=8?ee>>>8-ie:(ee=ee<<8|te[K>>8&255],ie<=16?ee>>>16-ie:(ee=ee<<8|te[K>>16&255],ee>>>24-ie))}function je(K,ie){var ee=ie&7,se=ie>>>3;return(K[se]|(ee<=6?0:K[se+1]<<8))>>>ee&3}function J(K,ie){var ee=ie&7,se=ie>>>3;return(K[se]|(ee<=5?0:K[se+1]<<8))>>>ee&7}function ue(K,ie){var ee=ie&7,se=ie>>>3;return(K[se]|(ee<=4?0:K[se+1]<<8))>>>ee&15}function de(K,ie){var ee=ie&7,se=ie>>>3;return(K[se]|(ee<=3?0:K[se+1]<<8))>>>ee&31}function ce(K,ie){var ee=ie&7,se=ie>>>3;return(K[se]|(ee<=1?0:K[se+1]<<8))>>>ee&127}function fe(K,ie,ee){var se=ie&7,le=ie>>>3,oe=(1<<ee)-1,we=K[le]>>>se;return ee<8-se||(we|=K[le+1]<<8-se,ee<16-se)||(we|=K[le+2]<<16-se,ee<24-se)||(we|=K[le+3]<<24-se),we&oe}function pe(K,ie,ee){var se=ie&7,le=ie>>>3;return se<=5?K[le]|=(ee&7)<<se:(K[le]|=ee<<se&255,K[le+1]=(ee&7)>>8-se),ie+3}function Ne(K,ie,ee){var se=ie&7,le=ie>>>3;return ee=(ee&1)<<se,K[le]|=ee,ie+1}function ne(K,ie,ee){var se=ie&7,le=ie>>>3;return ee<<=se,K[le]|=ee&255,ee>>>=8,K[le+1]=ee,ie+8}function _e(K,ie,ee){var se=ie&7,le=ie>>>3;return ee<<=se,K[le]|=ee&255,ee>>>=8,K[le+1]=ee&255,K[le+2]=ee>>>8,ie+16}function Te(K,ie){var ee=K.length,se=2*ee>ie?2*ee:ie+5,le=0;if(ee>=ie)return K;if(xt){var oe=e4(se);if(K.copy)K.copy(oe);else for(;le<K.length;++le)oe[le]=K[le];return oe}else if(Q){var we=new Uint8Array(se);if(we.set)we.set(K);else for(;le<ee;++le)we[le]=K[le];return we}return K.length=se,K}function Me(K){for(var ie=new Array(K),ee=0;ee<K;++ee)ie[ee]=0;return ie}function ye(K,ie,ee){var se=1,le=0,oe=0,we=0,ke=0,be=K.length,Ee=Q?new Uint16Array(32):Me(32);for(oe=0;oe<32;++oe)Ee[oe]=0;for(oe=be;oe<ee;++oe)K[oe]=0;be=K.length;var G=Q?new Uint16Array(be):Me(be);for(oe=0;oe<be;++oe)Ee[le=K[oe]]++,se<le&&(se=le),G[oe]=0;for(Ee[0]=0,oe=1;oe<=se;++oe)Ee[oe+16]=ke=ke+Ee[oe-1]<<1;for(oe=0;oe<be;++oe)ke=K[oe],ke!=0&&(G[oe]=Ee[ke+16]++);var ae=0;for(oe=0;oe<be;++oe)if(ae=K[oe],ae!=0)for(ke=X(G[oe],se)>>se-ae,we=(1<<se+4-ae)-1;we>=0;--we)ie[ke|we<<ae]=ae&15|oe<<4;return se}var Re=Q?new Uint16Array(512):Me(512),De=Q?new Uint16Array(32):Me(32);if(!Q){for(var Ce=0;Ce<512;++Ce)Re[Ce]=0;for(Ce=0;Ce<32;++Ce)De[Ce]=0}(function(){for(var K=[],ie=0;ie<32;ie++)K.push(5);ye(K,De,32);var ee=[];for(ie=0;ie<=143;ie++)ee.push(8);for(;ie<=255;ie++)ee.push(9);for(;ie<=279;ie++)ee.push(7);for(;ie<=287;ie++)ee.push(8);ye(ee,Re,288)})();var Ye=function(){for(var ie=Q?new Uint8Array(32768):[],ee=0,se=0;ee<H.length-1;++ee)for(;se<H[ee+1];++se)ie[se]=ee;for(;se<32768;++se)ie[se]=29;var le=Q?new Uint8Array(259):[];for(ee=0,se=0;ee<V.length-1;++ee)for(;se<V[ee+1];++se)le[se]=ee;function oe(ke,be){for(var Ee=0;Ee<ke.length;){var G=Math.min(65535,ke.length-Ee),ae=Ee+G==ke.length;for(be.write_shift(1,+ae),be.write_shift(2,G),be.write_shift(2,~G&65535);G-- >0;)be[be.l++]=ke[Ee++]}return be.l}function we(ke,be){for(var Ee=0,G=0,ae=Q?new Uint16Array(32768):[];G<ke.length;){var xe=Math.min(65535,ke.length-G);if(xe<10){for(Ee=pe(be,Ee,+(G+xe==ke.length)),Ee&7&&(Ee+=8-(Ee&7)),be.l=Ee/8|0,be.write_shift(2,xe),be.write_shift(2,~xe&65535);xe-- >0;)be[be.l++]=ke[G++];Ee=be.l*8;continue}Ee=pe(be,Ee,+(G+xe==ke.length)+2);for(var he=0;xe-- >0;){var me=ke[G];he=(he<<5^me)&32767;var ge=-1,ve=0;if((ge=ae[he])&&(ge|=G&-32768,ge>G&&(ge-=32768),ge<G))for(;ke[ge+ve]==ke[G+ve]&&ve<250;)++ve;if(ve>2){me=le[ve],me<=22?Ee=ne(be,Ee,te[me+1]>>1)-1:(ne(be,Ee,3),Ee+=5,ne(be,Ee,te[me-23]>>5),Ee+=3);var Ie=me<8?0:me-4>>2;Ie>0&&(_e(be,Ee,ve-V[me]),Ee+=Ie),me=ie[G-ge],Ee=ne(be,Ee,te[me]>>3),Ee-=3;var ze=me<4?0:me-2>>1;ze>0&&(_e(be,Ee,G-ge-H[me]),Ee+=ze);for(var qe=0;qe<ve;++qe)ae[he]=G&32767,he=(he<<5^ke[G])&32767,++G;xe-=ve-1}else me<=143?me=me+48:Ee=Ne(be,Ee,1),Ee=ne(be,Ee,te[me]),ae[he]=G&32767,++G}Ee=ne(be,Ee,0)-1}return be.l=(Ee+7)/8|0,be.l}return function(be,Ee){return be.length<8?oe(be,Ee):we(be,Ee)}}();function Ue(K){var ie=Ae(50+Math.floor(K.length*1.1)),ee=Ye(K,ie);return ie.slice(0,ee)}var He=Q?new Uint16Array(32768):Me(32768),pt=Q?new Uint16Array(32768):Me(32768),Je=Q?new Uint16Array(128):Me(128),Jt=1,or=1;function vt(K,ie){var ee=de(K,ie)+257;ie+=5;var se=de(K,ie)+1;ie+=5;var le=ue(K,ie)+4;ie+=4;for(var oe=0,we=Q?new Uint8Array(19):Me(19),ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,Ee=Q?new Uint8Array(8):Me(8),G=Q?new Uint8Array(8):Me(8),ae=we.length,xe=0;xe<le;++xe)we[I[xe]]=oe=J(K,ie),be<oe&&(be=oe),Ee[oe]++,ie+=3;var he=0;for(Ee[0]=0,xe=1;xe<=be;++xe)G[xe]=he=he+Ee[xe-1]<<1;for(xe=0;xe<ae;++xe)(he=we[xe])!=0&&(ke[xe]=G[he]++);var me=0;for(xe=0;xe<ae;++xe)if(me=we[xe],me!=0){he=te[ke[xe]]>>8-me;for(var ge=(1<<7-me)-1;ge>=0;--ge)Je[he|ge<<me]=me&7|xe<<3}var ve=[];for(be=1;ve.length<ee+se;)switch(he=Je[ce(K,ie)],ie+=he&7,he>>>=3){case 16:for(oe=3+je(K,ie),ie+=2,he=ve[ve.length-1];oe-- >0;)ve.push(he);break;case 17:for(oe=3+J(K,ie),ie+=3;oe-- >0;)ve.push(0);break;case 18:for(oe=11+ce(K,ie),ie+=7;oe-- >0;)ve.push(0);break;default:ve.push(he),be<he&&(be=he);break}var Ie=ve.slice(0,ee),ze=ve.slice(ee);for(xe=ee;xe<286;++xe)Ie[xe]=0;for(xe=se;xe<30;++xe)ze[xe]=0;return Jt=ye(Ie,He,286),or=ye(ze,pt,30),ie}function Is(K,ie){if(K[0]==3&&!(K[1]&3))return[sl(ie),2];for(var ee=0,se=0,le=e4(ie||1<<18),oe=0,we=le.length>>>0,ke=0,be=0;!(se&1);){if(se=J(K,ee),ee+=3,se>>>1)se>>1==1?(ke=9,be=5):(ee=vt(K,ee),ke=Jt,be=or);else{ee&7&&(ee+=8-(ee&7));var Ee=K[ee>>>3]|K[(ee>>>3)+1]<<8;if(ee+=32,Ee>0)for(!ie&&we<oe+Ee&&(le=Te(le,oe+Ee),we=le.length);Ee-- >0;)le[oe++]=K[ee>>>3],ee+=8;continue}for(;;){!ie&&we<oe+32767&&(le=Te(le,oe+32767),we=le.length);var G=fe(K,ee,ke),ae=se>>>1==1?Re[G]:He[G];if(ee+=ae&15,ae>>>=4,!(ae>>>8&255))le[oe++]=ae;else{if(ae==256)break;ae-=257;var xe=ae<8?0:ae-4>>2;xe>5&&(xe=0);var he=oe+V[ae];xe>0&&(he+=fe(K,ee,xe),ee+=xe),G=fe(K,ee,be),ae=se>>>1==1?De[G]:pt[G],ee+=ae&15,ae>>>=4;var me=ae<4?0:ae-2>>1,ge=H[ae];for(me>0&&(ge+=fe(K,ee,me),ee+=me),!ie&&we<he&&(le=Te(le,he+100),we=le.length);oe<he;)le[oe]=le[oe-ge],++oe}}}return ie?[le,ee+7>>>3]:[le.slice(0,oe),ee+7>>>3]}function zr(K,ie){var ee=K.slice(K.l||0),se=Is(ee,ie);return K.l+=se[1],se[0]}function za(K,ie){if(K)typeof console<"u"&&console.error(ie);else throw new Error(ie)}function Mo(K,ie){var ee=K;is(ee,0);var se=[],le=[],oe={FileIndex:se,FullPaths:le};j(oe,{root:ie.root});for(var we=ee.length-4;(ee[we]!=80||ee[we+1]!=75||ee[we+2]!=5||ee[we+3]!=6)&&we>=0;)--we;ee.l=we+4,ee.l+=4;var ke=ee.read_shift(2);ee.l+=6;var be=ee.read_shift(4);for(ee.l=be,we=0;we<ke;++we){ee.l+=20;var Ee=ee.read_shift(4),G=ee.read_shift(4),ae=ee.read_shift(2),xe=ee.read_shift(2),he=ee.read_shift(2);ee.l+=8;var me=ee.read_shift(4),ge=o(ee.slice(ee.l+ae,ee.l+ae+xe));ee.l+=ae+xe+he;var ve=ee.l;ee.l=me+4,N0(ee,Ee,G,oe,ge),ee.l=ve}return oe}function N0(K,ie,ee,se,le){K.l+=2;var oe=K.read_shift(2),we=K.read_shift(2),ke=l(K);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var be=K.read_shift(4),Ee=K.read_shift(4),G=K.read_shift(4),ae=K.read_shift(2),xe=K.read_shift(2),he="",me=0;me<ae;++me)he+=String.fromCharCode(K[K.l++]);if(xe){var ge=o(K.slice(K.l,K.l+xe));(ge[21589]||{}).mt&&(ke=ge[21589].mt),((le||{})[21589]||{}).mt&&(ke=le[21589].mt)}K.l+=xe;var ve=K.slice(K.l,K.l+Ee);switch(we){case 8:ve=q(K,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var Ie=!1;oe&8&&(be=K.read_shift(4),be==134695760&&(be=K.read_shift(4),Ie=!0),Ee=K.read_shift(4),G=K.read_shift(4)),Ee!=ie&&za(Ie,"Bad compressed size: "+ie+" != "+Ee),G!=ee&&za(Ie,"Bad uncompressed size: "+ee+" != "+G),us(se,he,ve,{unsafe:!0,mt:ke})}function Nr(K,ie){var ee=ie||{},se=[],le=[],oe=Ae(1),we=ee.compression?8:0,ke=0,be=0,Ee=0,G=0,ae=0,xe=K.FullPaths[0],he=xe,me=K.FileIndex[0],ge=[],ve=0;for(be=1;be<K.FullPaths.length;++be)if(he=K.FullPaths[be].slice(xe.length),me=K.FileIndex[be],!(!me.size||!me.content||he=="Sh33tJ5")){var Ie=G,ze=Ae(he.length);for(Ee=0;Ee<he.length;++Ee)ze.write_shift(1,he.charCodeAt(Ee)&127);ze=ze.slice(0,ze.l),ge[ae]=rP.buf(me.content,0);var qe=me.content;we==8&&(qe=A(qe)),oe=Ae(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,ke),oe.write_shift(2,we),me.mt?i(oe,me.mt):oe.write_shift(4,0),oe.write_shift(-4,ge[ae]),oe.write_shift(4,qe.length),oe.write_shift(4,me.content.length),oe.write_shift(2,ze.length),oe.write_shift(2,0),G+=oe.length,se.push(oe),G+=ze.length,se.push(ze),G+=qe.length,se.push(qe),oe=Ae(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,ke),oe.write_shift(2,we),oe.write_shift(4,0),oe.write_shift(-4,ge[ae]),oe.write_shift(4,qe.length),oe.write_shift(4,me.content.length),oe.write_shift(2,ze.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,Ie),ve+=oe.l,le.push(oe),ve+=ze.length,le.push(ze),++ae}return oe=Ae(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,ae),oe.write_shift(2,ae),oe.write_shift(4,ve),oe.write_shift(4,G),oe.write_shift(2,0),Xr([Xr(se),Xr(le),oe])}var mr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ts(K,ie){if(K.ctype)return K.ctype;var ee=K.name||"",se=ee.match(/\.([^\.]+)$/);return se&&mr[se[1]]||ie&&(se=(ee=ie).match(/[\.\\]([^\.\\])+$/),se&&mr[se[1]])?mr[se[1]]:"application/octet-stream"}function xa(K){for(var ie=ix(K),ee=[],se=0;se<ie.length;se+=76)ee.push(ie.slice(se,se+76));return ee.join(`\r
`)+`\r
`}function xs(K){var ie=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var G=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(G.length==1?"0"+G:G)});ie=ie.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ie.charAt(0)==`
`&&(ie="=0D"+ie.slice(1)),ie=ie.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],se=ie.split(`\r
`),le=0;le<se.length;++le){var oe=se[le];if(oe.length==0){ee.push("");continue}for(var we=0;we<oe.length;){var ke=76,be=oe.slice(we,we+ke);be.charAt(ke-1)=="="?ke--:be.charAt(ke-2)=="="?ke-=2:be.charAt(ke-3)=="="&&(ke-=3),be=oe.slice(we,we+ke),we+=ke,we<oe.length&&(be+="="),ee.push(be)}}return ee.join(`\r
`)}function gr(K){for(var ie=[],ee=0;ee<K.length;++ee){for(var se=K[ee];ee<=K.length&&se.charAt(se.length-1)=="=";)se=se.slice(0,se.length-1)+K[++ee];ie.push(se)}for(var le=0;le<ie.length;++le)ie[le]=ie[le].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return sa(ie.join(`\r
`))}function Us(K,ie,ee){for(var se="",le="",oe="",we,ke=0;ke<10;++ke){var be=ie[ke];if(!be||be.match(/^\s*$/))break;var Ee=be.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":se=Ee[2].trim();break;case"content-type":oe=Ee[2].trim();break;case"content-transfer-encoding":le=Ee[2].trim();break}}switch(++ke,le.toLowerCase()){case"base64":we=sa(ca(ie.slice(ke).join("")));break;case"quoted-printable":we=gr(ie.slice(ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+le)}var G=us(K,se.slice(ee.length),we,{unsafe:!0});oe&&(G.ctype=oe)}function cn(K,ie){if(S(K.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=ie&&ie.root||"",se=(xt&&Buffer.isBuffer(K)?K.toString("binary"):S(K)).split(`\r
`),le=0,oe="";for(le=0;le<se.length;++le)if(oe=se[le],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),ee||(ee=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),oe.slice(0,ee.length)!=ee););var we=(se[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var ke="--"+(we[1]||""),be=[],Ee=[],G={FileIndex:be,FullPaths:Ee};j(G);var ae,xe=0;for(le=0;le<se.length;++le){var he=se[le];he!==ke&&he!==ke+"--"||(xe++&&Us(G,se.slice(ae,le),ee),ae=le)}return G}function pr(K,ie){var ee=ie||{},se=ee.boundary||"SheetJS";se="------="+se;for(var le=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+se.slice(2)+'"',"","",""],oe=K.FullPaths[0],we=oe,ke=K.FileIndex[0],be=1;be<K.FullPaths.length;++be)if(we=K.FullPaths[be].slice(oe.length),ke=K.FileIndex[be],!(!ke.size||!ke.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ve){return"_x"+ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ve){return"_u"+ve.charCodeAt(0).toString(16)+"_"});for(var Ee=ke.content,G=xt&&Buffer.isBuffer(Ee)?Ee.toString("binary"):S(Ee),ae=0,xe=Math.min(1024,G.length),he=0,me=0;me<=xe;++me)(he=G.charCodeAt(me))>=32&&he<128&&++ae;var ge=ae>=xe*4/5;le.push(se),le.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+we),le.push("Content-Transfer-Encoding: "+(ge?"quoted-printable":"base64")),le.push("Content-Type: "+ts(ke,we)),le.push(""),le.push(ge?xs(G):xa(G))}return le.push(se+`--\r
`),le.join(`\r
`)}function Qs(K){var ie={};return j(ie,K),ie}function us(K,ie,ee,se){var le=se&&se.unsafe;le||j(K);var oe=!le&&Xe.find(K,ie);if(!oe){var we=K.FullPaths[0];ie.slice(0,we.length)==we?we=ie:(we.slice(-1)!="/"&&(we+="/"),we=(we+ie).replace("//","/")),oe={name:n(ie),type:2},K.FileIndex.push(oe),K.FullPaths.push(we),le||Xe.utils.cfb_gc(K)}return oe.content=ee,oe.size=ee?ee.length:0,se&&(se.CLSID&&(oe.clsid=se.CLSID),se.mt&&(oe.mt=se.mt),se.ct&&(oe.ct=se.ct)),oe}function Ns(K,ie){j(K);var ee=Xe.find(K,ie);if(ee){for(var se=0;se<K.FileIndex.length;++se)if(K.FileIndex[se]==ee)return K.FileIndex.splice(se,1),K.FullPaths.splice(se,1),!0}return!1}function Ln(K,ie,ee){j(K);var se=Xe.find(K,ie);if(se){for(var le=0;le<K.FileIndex.length;++le)if(K.FileIndex[le]==se)return K.FileIndex[le].name=n(ee),K.FullPaths[le]=ee,!0}return!1}function dn(K){R(K,!0)}return t.find=O,t.read=C,t.parse=x,t.write=z,t.writeFile=T,t.utils={cfb_new:Qs,cfb_add:us,cfb_del:Ns,cfb_mov:Ln,cfb_gc:dn,ReadShift:bd,CheckField:Rj,prep_blob:is,bconcat:Xr,use_zlib:k,_deflateRaw:Ue,_inflateRaw:zr,consts:N},t}();function sP(e){return typeof e=="string"?em(e):Array.isArray(e)?DO(e):e}function qx(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=em(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?yn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([sP(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=hl(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function aP(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function hr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function o4(e,t){for(var r=[],a=hr(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function rm(e){for(var t=[],r=hr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function sm(e){for(var t=[],r=hr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function nP(e){for(var t=[],r=hr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Zf=new Date(1899,11,30,0,0,0);function $r(e,t){var r=e.getTime(),a=Zf.getTime()+(e.getTimezoneOffset()-Zf.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var hj=new Date,iP=Zf.getTime()+(hj.getTimezoneOffset()-Zf.getTimezoneOffset())*6e4,c4=hj.getTimezoneOffset();function am(e){var t=new Date;return t.setTime(e*24*60*60*1e3+iP),t.getTimezoneOffset()!==c4&&t.setTime(t.getTime()+(t.getTimezoneOffset()-c4)*6e4),t}function lP(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var d4=new Date("2017-02-19T19:06:09.000Z"),mj=isNaN(d4.getFullYear())?new Date("2/19/17"):d4,oP=mj.getFullYear()==2017;function Ht(e,t){var r=new Date(e);if(oP)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(mj.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function fo(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return yn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return yn(rj(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return yn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return yn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Wt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Wt(e[r]));return t}function xr(e,t){for(var r="";r.length<t;)r+=e;return r}function tn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var cP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Gc(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&cP.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var dP=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}}();function gj(e){return e?e.content&&e.type?fo(e.content,!0):e.data?X0(e.data):e.asNodeBuffer&&xt?X0(e.asNodeBuffer().toString("binary")):e.asBinary?X0(e.asBinary()):e._data&&e._data.getContent?X0(fo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function pj(e){if(!e)return null;if(e.data)return Jw(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Jw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function xP(e){return e&&e.name.slice(-4)===".bin"?pj(e):gj(e)}function ya(e,t){for(var r=e.FullPaths||hr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function yb(e,t){var r=ya(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function kr(e,t,r){if(!r)return xP(yb(e,t));if(!t)return null;try{return kr(e,t)}catch{return null}}function aa(e,t,r){if(!r)return gj(yb(e,t));if(!t)return null;try{return aa(e,t)}catch{return null}}function uP(e,t,r){return pj(yb(e,t))}function x4(e){for(var t=e.FullPaths||hr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function ct(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return xt?a=pi(r):a=SO(r),Xe.utils.cfb_add(e,t,a)}Xe.utils.cfb_add(e,t,r)}else e.file(t,r)}function wb(){return Xe.utils.cfb_new()}function vj(e,t){switch(t.type){case"base64":return Xe.read(e,{type:"base64"});case"binary":return Xe.read(e,{type:"binary"});case"buffer":case"array":return Xe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Q0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var jr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,u4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hP=/<[^>]*>/g,js=jr.match(u4)?u4:hP,mP=/<\w*:/,gP=/<(\/?)\w+:/;function rt(e,t,r){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var l=e.match(fP),o=0,c="",d=0,x="",u="",f=1;if(l)for(d=0;d!=l.length;++d){for(u=l[d],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(x=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(f=(n=u.charCodeAt(i+1))==34||n==39?1:0,c=u.slice(i+1+f,u.length-f),o=0;o!=x.length&&x.charCodeAt(o)!==58;++o);if(o===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),a[x]=c,a[x.toLowerCase()]=c;else{var h=(o===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(o+1);if(a[h]&&x.slice(o-3,o)=="ext")continue;a[h]=c,a[h.toLowerCase()]=c}}return a}function Rn(e){return e.replace(gP,"<$1")}var bj={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Eb=rm(bj),jt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return bj[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,l)+r(n.slice(l+3))}}(),_b=/[&<>'"]/g,pP=/[\u0000-\u0008\u000b-\u001f]/g;function Ft(e){var t=e+"";return t.replace(_b,function(r){return Eb[r]}).replace(pP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function f4(e){return Ft(e).replace(/ /g,"_x0020_")}var yj=/[\u0000-\u001f]/g;function jb(e){var t=e+"";return t.replace(_b,function(r){return Eb[r]}).replace(/\n/g,"<br/>").replace(yj,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function vP(e){var t=e+"";return t.replace(_b,function(r){return Eb[r]}).replace(yj,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var h4=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function bP(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function $t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bg(e){for(var t="",r=0,a=0,n=0,i=0,l=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function m4(e){var t=sl(2*e.length),r,a,n=1,i=0,l=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function g4(e){return pi(e,"binary").toString("utf8")}var Su="foo bar baz",Rt=xt&&(g4(Su)==bg(Su)&&g4||m4(Su)==bg(Su)&&m4)||bg,yn=xt?function(e){return pi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},ox=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),wj=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),yP=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),wP=/<\/?(?:vt:)?variant>/g,EP=/<(?:vt:)([^>]*)>([\s\S]*)</;function p4(e,t){var r=rt(e),a=e.match(yP(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var l=i.replace(wP,"").match(EP);l&&n.push({v:Rt(l[2]),t:l[1]})}),n}var Ej=/(^\s|\s$|\n)/;function os(e,t){return"<"+e+(t.match(Ej)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function cx(e){return hr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Pe(e,t,r){return"<"+e+(r!=null?cx(r):"")+(t!=null?(t.match(Ej)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function p1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function _P(e,t){switch(typeof e){case"string":var r=Pe("vt:lpwstr",Ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Pe((e|0)==e?"vt:i4":"vt:r8",Ft(String(e)));case"boolean":return Pe("vt:bool",e?"true":"false")}if(e instanceof Date)return Pe("vt:filetime",p1(e));throw new Error("Unable to serialize "+e)}function Nb(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Rt(hl(pb(e)));throw new Error("Bad input format: expected Buffer or string")}var dx=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Lr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ko=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ea={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function jP(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function NP(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,l=a?-t:t;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var v4=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},b4=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:pi(t)})):v4(e)}:v4,y4=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(ti(e,n)));return a.join("").replace(Rs,"")},Cb=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Rs,""):y4(e,t,r)}:y4,w4=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},_j=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):w4(e,t,r)}:w4,E4=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Zo(e,n)));return a.join("")},Vx=xt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):E4(t,r,a)}:E4,jj=function(e,t){var r=ta(e,t);return r>0?Vx(e,t+4,t+4+r-1):""},Nj=jj,Cj=function(e,t){var r=ta(e,t);return r>0?Vx(e,t+4,t+4+r-1):""},Aj=Cj,kj=function(e,t){var r=2*ta(e,t);return r>0?Vx(e,t+4,t+4+r-1):""},Dj=kj,Sj=function(t,r){var a=ta(t,r);return a>0?Cb(t,r+4,r+4+a):""},Bj=Sj,Fj=function(e,t){var r=ta(e,t);return r>0?Vx(e,t+4,t+4+r):""},Tj=Fj,Mj=function(e,t){return jP(e,t)},eh=Mj,Ab=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(Nj=function(t,r){if(!Buffer.isBuffer(t))return jj(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Aj=function(t,r){if(!Buffer.isBuffer(t))return Cj(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Dj=function(t,r){if(!Buffer.isBuffer(t))return kj(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Bj=function(t,r){if(!Buffer.isBuffer(t))return Sj(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Tj=function(t,r){if(!Buffer.isBuffer(t))return Fj(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},eh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Mj(t,r)},Ab=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Zo=function(e,t){return e[t]},ti=function(e,t){return e[t+1]*256+e[t]},CP=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ta=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Tl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},AP=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function bd(e,t){var r="",a,n,i=[],l,o,c,d;switch(t){case"dbcs":if(d=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(ti(this,d)),d+=2;e*=2;break;case"utf8":r=Vx(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Cb(this,this.l,this.l+e);break;case"wstr":return bd.call(this,e,"dbcs");case"lpstr-ansi":r=Nj(this,this.l),e=4+ta(this,this.l);break;case"lpstr-cp":r=Aj(this,this.l),e=4+ta(this,this.l);break;case"lpwstr":r=Dj(this,this.l),e=4+2*ta(this,this.l);break;case"lpp4":e=4+ta(this,this.l),r=Bj(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ta(this,this.l),r=Tj(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Zo(this,this.l+e++))!==0;)i.push(Du(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=ti(this,this.l+e))!==0;)i.push(Du(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Zo(this,d),this.l=d+1,o=bd.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Du(ti(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Zo(this,d),this.l=d+1,o=bd.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Du(Zo(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=Zo(this,this.l),this.l++,a;case 2:return a=(t==="i"?CP:ti)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Tl:AP)(this,this.l),this.l+=4,a):(n=ta(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=eh(this,this.l):n=eh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=_j(this,this.l,e);break}}return this.l+=e,r}var kP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},DP=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},SP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function BP(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)SP(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,kP(this,t,this.l);break;case 8:if(a=8,r==="f"){NP(this,t,this.l);break}case 16:break;case-4:a=4,DP(this,t,this.l);break}return this.l+=a,this}function Rj(e,t){var r=_j(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function is(e,t){e.l=t,e.read_shift=bd,e.chk=Rj,e.write_shift=BP}function _s(e,t){e.l+=t}function Ae(e){var t=sl(e);return is(t,0),t}function vi(e,t,r){if(e){var a,n,i;is(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var d=gx[o]||gx[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var x=d.f&&d.f(e,i,r);if(e.l=c,t(x,d,o))return}}}function Ws(){var e=[],t=xt?256:2048,r=function(d){var x=Ae(d);return is(x,0),x},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(n(),a=r(Math.max(d+1,t)))},l=function(){return n(),Xr(e)},o=function(d){n(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function Be(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=gx[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=e.next(i);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&Ab(r)&&e.push(r)}}function yd(e,t,r){var a=Wt(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function _4(e,t,r){var a=Wt(e);return a.s=yd(a.s,t.s,r),a.e=yd(a.e,t.s,r),a}function wd(e,t){if(e.cRel&&e.c<0)for(e=Wt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Wt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=et(e);return!e.cRel&&e.cRel!=null&&(r=MP(r)),!e.rRel&&e.rRel!=null&&(r=FP(r)),r}function yg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ir(e.s.c)+":"+(e.e.cRel?"":"$")+ir(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+_r(e.s.r)+":"+(e.e.rRel?"":"$")+_r(e.e.r):wd(e.s,t.biff)+":"+wd(e.e,t.biff)}function kb(e){return parseInt(TP(e),10)-1}function _r(e){return""+(e+1)}function FP(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function TP(e){return e.replace(/\$(\d+)$/,"$1")}function Db(e){for(var t=RP(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function ir(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function MP(e){return e.replace(/^([A-Z])/,"$$$1")}function RP(e){return e.replace(/^\$([A-Z])/,"$1")}function OP(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function lr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function et(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ys(e){var t=e.indexOf(":");return t==-1?{s:lr(e),e:lr(e)}:{s:lr(e.slice(0,t)),e:lr(e.slice(t+1))}}function lt(e,t){return typeof t>"u"||typeof t=="number"?lt(e.s,e.e):(typeof e!="string"&&(e=et(e)),typeof t!="string"&&(t=et(t)),e==t?e:e+":"+t)}function Nt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function j4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ua(e.z,r?$r(t):t)}catch{}try{return e.w=Ua((e.XF||{}).numFmtId||(r?14:0),r?$r(t):t)}catch{return""+t}}function ui(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?bi[e.v]||e.v:t==null?j4(e,e.v):j4(e,t))}function ml(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Oj(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),l=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?lr(a.origin):a.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var x=Nt(i["!ref"]);d.s.c=x.s.c,d.s.r=x.s.r,d.e.c=Math.max(d.e.c,x.e.c),d.e.r=Math.max(d.e.r,x.e.r),l==-1&&(d.e.r=l=x.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[u].length;++f)if(!(typeof t[u][f]>"u")){var h={v:t[u][f]},p=l+u,g=o+f;if(d.s.r>p&&(d.s.r=p),d.s.c>g&&(d.s.c=g),d.e.r<p&&(d.e.r=p),d.e.c<g&&(d.e.c=g),t[u][f]&&typeof t[u][f]=="object"&&!Array.isArray(t[u][f])&&!(t[u][f]instanceof Date))h=t[u][f];else if(Array.isArray(h.v)&&(h.f=t[u][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||Ze[14],a.cellDates?(h.t="d",h.w=Ua(h.z,$r(h.v))):(h.t="n",h.v=$r(h.v),h.w=Ua(h.z,h.v))):h.t="s";if(n)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(h.z=i[p][g].z),i[p][g]=h;else{var y=et({c:g,r:p});i[y]&&i[y].z&&(h.z=i[y].z),i[y]=h}}}return d.s.c<1e7&&(i["!ref"]=lt(d)),i}function p0(e,t){return Oj(null,e,t)}function PP(e){return e.read_shift(4,"i")}function rn(e,t){return t||(t=Ae(4)),t.write_shift(4,e),t}function Es(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Qr(e,t){var r=!1;return t==null&&(r=!0,t=Ae(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function LP(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function IP(e,t){return t||(t=Ae(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Sb(e,t){var r=e.l,a=e.read_shift(1),n=Es(e),i=[],l={t:n,h:n};if(a&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(LP(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function UP(e,t){var r=!1;return t==null&&(r=!0,t=Ae(15+4*e.t.length)),t.write_shift(1,0),Qr(e.t,t),r?t.slice(0,t.l):t}var $P=Sb;function zP(e,t){var r=!1;return t==null&&(r=!0,t=Ae(23+4*e.t.length)),t.write_shift(1,1),Qr(e.t,t),t.write_shift(4,1),IP({},t),r?t.slice(0,t.l):t}function $a(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Do(e,t){return t==null&&(t=Ae(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function So(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Bo(e,t){return t==null&&(t=Ae(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var qP=Es,Pj=Qr;function Bb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function th(e,t){var r=!1;return t==null&&(r=!0,t=Ae(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var VP=Es,v1=Bb,Fb=th;function Tb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?eh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Tl(t,0)>>2;return r?n/100:n}function Lj(e,t){t==null&&(t=Ae(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Ij(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function HP(e,t){return t||(t=Ae(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Fo=Ij,v0=HP;function ps(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ho(e,t){return(t||Ae(8)).write_shift(8,e,"f")}function WP(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var d=Xl[n];d&&(t.rgb=ux(d));break;case 2:t.rgb=ux([l,o,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function rh(e,t){if(t||(t=Ae(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function GP(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function YP(e,t){t||(t=Ae(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Uj(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function XP(e){return Uj(e,1)}function KP(e){return Uj(e,2)}var Mb=2,zs=3,Bu=11,N4=12,sh=19,Fu=64,QP=65,JP=71,ZP=4108,eL=4126,Vr=80,$j=81,tL=[Vr,$j],b1={1:{n:"CodePage",t:Mb},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:zs},5:{n:"LineCount",t:zs},6:{n:"ParagraphCount",t:zs},7:{n:"SlideCount",t:zs},8:{n:"NoteCount",t:zs},9:{n:"HiddenCount",t:zs},10:{n:"MultimediaClipCount",t:zs},11:{n:"ScaleCrop",t:Bu},12:{n:"HeadingPairs",t:ZP},13:{n:"TitlesOfParts",t:eL},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:Bu},17:{n:"CharacterCount",t:zs},19:{n:"SharedDoc",t:Bu},22:{n:"HyperlinksChanged",t:Bu},23:{n:"AppVersion",t:zs,p:"version"},24:{n:"DigSig",t:QP},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:sh},2147483651:{n:"Behavior",t:sh},1919054434:{}},y1={1:{n:"CodePage",t:Mb},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:Fu},11:{n:"LastPrinted",t:Fu},12:{n:"CreatedDate",t:Fu},13:{n:"ModifiedDate",t:Fu},14:{n:"PageCount",t:zs},15:{n:"WordCount",t:zs},16:{n:"CharCount",t:zs},17:{n:"Thumbnail",t:JP},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:zs},255:{},2147483648:{n:"Locale",t:sh},2147483651:{n:"Behavior",t:sh},1919054434:{}},C4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function sL(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var aL=sL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xl=Wt(aL),bi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zj={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},w1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Tu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Rb(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nL(e){var t=Rb();if(!e||!e.match)return t;var r={};if((e.match(js)||[]).forEach(function(a){var n=rt(a);switch(n[0].replace(mP,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[w1[n.ContentType]]!==void 0&&t[w1[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Lr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function qj(e,t){var r=nP(w1),a=[],n;a[a.length]=jr,a[a.length]=Pe("Types",null,{xmlns:Lr.CT,"xmlns:xsd":Lr.xsd,"xmlns:xsi":Lr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Pe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=Pe("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Tu[c][t.bookType]||Tu[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Pe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Tu[c][t.bookType]||Tu[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Pe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ft={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xx(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ed(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(js)||[]).forEach(function(n){var i=rt(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Q0(i.Target,t);r[o]=l,a[i.Id]=l}}),r["!id"]=a,r}function Ac(e){var t=[jr,Pe("Relationships",null,{xmlns:Lr.RELS})];return hr(e["!id"]).forEach(function(r){t[t.length]=Pe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Bt(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[ft.HLINK,ft.XPATH,ft.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var iL="application/vnd.oasis.opendocument.spreadsheet";function lL(e,t){for(var r=Nb(e),a,n;a=dx.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=rt(a[0],!1),n.path=="/"&&n.type!==iL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function oL(e){var t=[jr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function A4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function cL(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function dL(e){var t=[jr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(A4(e[r][0],e[r][1])),t.push(cL("",e[r][0]));return t.push(A4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Vj(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xf.version+"</meta:generator></office:meta></office:document-meta>"}var Ta=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xL=function(){for(var e=new Array(Ta.length),t=0;t<Ta.length;++t){var r=Ta[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function Hj(e){var t={};e=Rt(e);for(var r=0;r<Ta.length;++r){var a=Ta[r],n=e.match(xL[r]);n!=null&&n.length>0&&(t[a[1]]=jt(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Ht(t[a[1]]))}return t}function wg(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Ft(t),a[a.length]=r?Pe(e,t,r):os(e,t))}function Wj(e,t){var r=t||{},a=[jr,Pe("cp:coreProperties",null,{"xmlns:cp":Lr.CORE_PROPS,"xmlns:dc":Lr.dc,"xmlns:dcterms":Lr.dcterms,"xmlns:dcmitype":Lr.dcmitype,"xmlns:xsi":Lr.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&wg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:p1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&wg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:p1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=Ta.length;++i){var l=Ta[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&wg(l[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Kl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Gj=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Yj(e,t,r,a){var n=[];if(typeof e=="string")n=p4(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(x){return{v:x}}));var l=typeof t=="string"?p4(t,a).map(function(x){return x.v}):t,o=0,c=0;if(l.length>0)for(var d=0;d!==n.length;d+=2){switch(c=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=l.slice(o,o+c);break}o+=c}}function uL(e,t,r){var a={};return t||(t={}),e=Rt(e),Kl.forEach(function(n){var i=(e.match(ox(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=jt(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Yj(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Xj(e){var t=[],r=Pe;return e||(e={}),e.Application="SheetJS",t[t.length]=jr,t[t.length]=Pe("Properties",null,{xmlns:Lr.EXT_PROPS,"xmlns:vt":Lr.vt}),Kl.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Ft(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Ft(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fL=/<[^>]+>[^<]*/g;function hL(e,t){var r={},a="",n=e.match(fL);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=rt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=jt(o.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),d=c[0].slice(4),x=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=jt(x);break;case"bool":r[a]=$t(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(x,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(x);break;case"filetime":case"date":r[a]=Ht(x);break;case"cy":case"error":r[a]=jt(x);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function Kj(e){var t=[jr,Pe("Properties",null,{xmlns:Lr.CUST_PROPS,"xmlns:vt":Lr.vt})];if(!e)return t.join("");var r=1;return hr(e).forEach(function(n){++r,t[t.length]=Pe("property",_P(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ft(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var E1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Eg;function mL(e,t,r){Eg||(Eg=rm(E1)),t=Eg[t]||t,e[t]=r}function gL(e,t){var r=[];return hr(E1).map(function(a){for(var n=0;n<Ta.length;++n)if(Ta[n][1]==a)return Ta[n];for(n=0;n<Kl.length;++n)if(Kl[n][1]==a)return Kl[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(os(E1[a[1]]||a[1],n))}}),Pe("DocumentProperties",r.join(""),{xmlns:ea.o})}function pL(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&hr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<Ta.length;++l)if(i==Ta[l][1])return;for(l=0;l<Kl.length;++l)if(i==Kl[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(Pe(f4(i),o,{"dt:dt":c}))}}),t&&hr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Pe(f4(i),l,{"dt:dt":o}))}}),"<"+a+' xmlns="'+ea.o+'">'+n.join("")+"</"+a+">"}function Ob(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vL(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var l=Ae(8);return l.write_shift(4,a),l.write_shift(4,n),l}function Qj(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function Jj(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function Zj(e,t,r){return t===31?Jj(e):Qj(e,t,r)}function _1(e,t,r){return Zj(e,t,r===!1?0:4)}function bL(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Zj(e,t,0)}function yL(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Rs,""),e.l-n&2&&(e.l+=2)}return r}function wL(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Rs,"");return r}function EL(e){var t=e.l,r=ah(e,$j);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=ah(e,zs);return[r,a]}function _L(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(EL(e));return r}function k4(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var i=e.read_shift(4),l=e.read_shift(4);a[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Rs,"").replace(K0,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function e3(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function jL(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ah(e,t,r){var a=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==N4&&a!==t&&tL.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===N4?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return Qj(e,a,4).replace(Rs,"");case 31:return Jj(e);case 64:return Ob(e);case 65:return e3(e);case 71:return jL(e);case 80:return _1(e,a,!i.raw).replace(Rs,"");case 81:return bL(e,a).replace(Rs,"");case 4108:return _L(e);case 4126:case 4127:return a==4127?yL(e):wL(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function D4(e,t){var r=Ae(4),a=Ae(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Ae(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=vL(t);break;case 31:case 80:for(a=Ae(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Xr([r,a])}function S4(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0,o=0,c=-1,d={};for(l=0;l!=n;++l){var x=e.read_shift(4),u=e.read_shift(4);i[l]=[x,u+r]}i.sort(function(w,m){return w[1]-m[1]});var f={};for(l=0;l!=n;++l){if(e.l!==i[l][1]){var h=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],h=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(h=!1,e.l=i[l][1]),h)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[i[l][0]];if(f[p.n]=ah(e,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qa(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(i[l][0]===1){if(o=f.CodePage=ah(e,Mb),Qa(o),c!==-1){var g=e.l;e.l=i[c][1],d=k4(e,o),e.l=g}}else if(i[l][0]===0){if(o===0){c=l,e.l=i[l+1][1];continue}d=k4(e,o)}else{var y=d[i[l][0]],v;switch(e[e.l]){case 65:e.l+=4,v=e3(e);break;case 30:e.l+=4,v=_1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=_1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=vr(e,4);break;case 64:e.l+=4,v=Ht(Ob(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[y]=v}}return e.l=r+a,f}var t3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function NL(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function B4(e,t,r){var a=Ae(8),n=[],i=[],l=8,o=0,c=Ae(8),d=Ae(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),n.push(d),l+=8+c.length,!t){d=Ae(8),d.write_shift(4,0),n.unshift(d);var x=[Ae(4)];for(x[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for(c=Ae(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);x.push(c)}c=Xr(x),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(t3.indexOf(e[o][0])>-1||Gj.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],h=0;if(t){h=+t[e[o][0]];var p=r[h];if(p.p=="version"&&typeof f=="string"){var g=f.split(".");f=(+g[0]<<16)+(+g[1]||0)}c=D4(p.t,f)}else{var y=NL(f);y==-1&&(y=31,f=String(f)),c=D4(y,f)}i.push(c),d=Ae(8),d.write_shift(4,t?h:2+o),n.push(d),l+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,v),v+=i[o].length;return a.write_shift(4,l),a.write_shift(4,i.length),Xr([a].concat(n).concat(i))}function F4(e,t,r){var a=e.content;if(!a)return{};is(a,0);var n,i,l,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),x=a.read_shift(16);if(x!==Xe.utils.consts.HEADER_CLSID&&x!==r)throw new Error("Bad PropertySet CLSID "+x);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(l=a.read_shift(16),c=a.read_shift(4));var u=S4(a,t),f={SystemIdentifier:d};for(var h in u)f[h]=u[h];if(f.FMTID=i,n===1)return f;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var p;try{p=S4(a,null)}catch{}for(h in p)f[h]=p[h];return f.FMTID=[i,l],f}function T4(e,t,r,a,n,i){var l=Ae(n?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Xe.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,n?68:48);var c=B4(e,r,a);if(o.push(c),n){var d=B4(n,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(d)}return Xr(o)}function _i(e,t){return e.read_shift(t),null}function CL(e,t){t||(t=Ae(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function AL(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function vr(e,t){return e.read_shift(t)===1}function Ds(e,t){return t||(t=Ae(2)),t.write_shift(2,+!!e),t}function Dr(e){return e.read_shift(2,"u")}function Ea(e,t){return t||(t=Ae(2)),t.write_shift(2,e),t}function r3(e,t){return AL(e,t,Dr)}function kL(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function s3(e,t,r){return r||(r=Ae(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Hx(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return l}function DL(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,i=1+(r&1),l=0,o,c={};n&&(l=e.read_shift(2)),a&&(o=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",x=t===0?"":e.read_shift(t,d);return n&&(e.l+=4*l),a&&(e.l+=o),c.t=x,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function SL(e){var t=e.t||"",r=Ae(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Ae(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return Xr(n)}function mo(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Wx(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):mo(e,a,r)}function To(e,t,r){if(r.biff>5)return Wx(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function a3(e,t,r){return r||(r=Ae(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function BL(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function FL(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Rs,"");return a&&(e.l+=24),n}function TL(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(Rs,"");return r+l}function ML(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return FL(e);case"0303000000000000c000000000000046":return TL(e);default:throw new Error("Unsupported Moniker "+r)}}function Mu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Rs,""):"";return r}function M4(e,t){t||(t=Ae(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function RL(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,l,o,c,d="",x,u;n&16&&(i=Mu(e,r-e.l)),n&128&&(l=Mu(e,r-e.l)),(n&257)===257&&(o=Mu(e,r-e.l)),(n&257)===1&&(c=ML(e,r-e.l)),n&8&&(d=Mu(e,r-e.l)),n&32&&(x=e.read_shift(16)),n&64&&(u=Ob(e)),e.l=r;var f=l||o||c||"";f&&d&&(f+="#"+d),f||(f="#"+d),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return x&&(h.guid=x),u&&(h.time=u),i&&(h.Tooltip=i),h}function OL(e){var t=Ae(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)a=a.slice(1),M4(a,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&M4(n>-1?a.slice(n+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function n3(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function i3(e,t){var r=n3(e);return r[3]=0,r}function On(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function go(e,t,r,a){return a||(a=Ae(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function PL(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function LL(e,t,r){return t===0?"":To(e,t,r)}function IL(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[n,i,l]}function l3(e){var t=e.read_shift(2),r=Tb(e);return[t,r]}function UL(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Hx(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function nm(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function o3(e,t){return t||(t=Ae(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function c3(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var $L=c3;function d3(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function zL(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function qL(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function fs(e){e.l+=2,e.l+=e.read_shift(2)}var VL={0:fs,4:fs,5:fs,6:fs,7:qL,8:fs,9:fs,10:fs,11:fs,12:fs,13:zL,14:fs,15:fs,16:fs,17:fs,18:fs,19:fs,20:fs,21:d3};function HL(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(VL[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Ru(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Pb(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ae(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function WL(e,t){return t===0||e.read_shift(2),1200}function GL(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=To(e,0,r);return e.read_shift(t+a-e.l),n}function YL(e,t){var r=!t||t.biff==8,a=Ae(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function XL(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function KL(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Hx(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:i,name:l}}function QL(e,t){var r=!t||t.biff>=8?2:1,a=Ae(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function JL(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0;l!=n&&e.l<r;++l)i.push(DL(e));return i.Count=a,i.Unique=n,i}function ZL(e,t){var r=Ae(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=SL(e[n]);var i=Xr([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function eI(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function tI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function rI(e){var t=PL(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function sI(e){return e.read_shift(2),e.read_shift(4)}function R4(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function aI(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:i,CurTab:l,FirstTab:o,Selected:c,TabRatio:d}}function nI(){var e=Ae(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function iI(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function lI(e){var t=Ae(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function oI(){}function cI(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Hx(e,0,r),a}function dI(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=Ae(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function xI(e){var t=On(e);return t.isst=e.read_shift(4),t}function uI(e,t,r,a){var n=Ae(10);return go(e,t,a,n),n.write_shift(4,r),n}function fI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=On(e);r.biff==2&&e.l++;var i=Wx(e,a-e.l,r);return n.val=i,n}function hI(e,t,r,a,n){var i=!n||n.biff==8,l=Ae(8+ +i+(1+i)*r.length);return go(e,t,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function mI(e,t,r){var a=e.read_shift(2),n=To(e,0,r);return[a,n]}function gI(e,t,r,a){var n=r&&r.biff==5;a||(a=Ae(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var pI=To;function O4(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:l,c}}}function vI(e,t){var r=t.biff==8||!t.biff?4:2,a=Ae(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function bI(e){var t=e.read_shift(2),r=e.read_shift(2),a=l3(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function yI(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(l3(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:i}}function wI(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:i}}function EI(e,t,r,a){var n={},i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=rL[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function _I(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=EI(e,t,a.fStyle,r),a}function P4(e,t,r,a){var n=r&&r.biff==5;a||(a=Ae(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function jI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function NI(e){var t=Ae(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function L4(e,t,r){var a=On(e);(r.biff==2||t==9)&&++e.l;var n=kL(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function CI(e,t,r,a,n,i){var l=Ae(8);return go(e,t,a,l),s3(r,i,l),l}function AI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=On(e),n=ps(e);return a.val=n,a}function kI(e,t,r,a){var n=Ae(14);return go(e,t,a,n),ho(r,n),n}var I4=LL;function DI(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=mo(e,i),o=[];a>e.l;)o.push(Wx(e));return[i,n,l,o]}function U4(e,t,r){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=UL(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var SI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function $4(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=mo(e,l,r);n&32&&(d=SI[d.charCodeAt(0)]);var x=a-e.l;r&&r.biff==2&&--x;var u=a==e.l||o===0||!(x>0)?[]:Hq(e,x,r,o);return{chKey:i,Name:d,itab:c,rgce:u}}function x3(e,t,r){if(r.biff<8)return BI(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(IL(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function BI(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Hx(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function FI(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),i=mo(e,a,r),l=mo(e,n,r);return[i,l]}function TI(e,t,r){var a=c3(e);e.l++;var n=e.read_shift(1);return t-=8,[Wq(e,t,r),n,a]}function z4(e,t,r){var a=$L(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,qq(e,t,r)]}function MI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function RI(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=To(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},o,l,i]}}function OI(e,t,r){return RI(e,t,r)}function PI(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(nm(e));return r}function LI(e){var t=Ae(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)o3(e[r],t);return t}function II(e,t,r){if(r&&r.biff<8)return $I(e,t,r);var a=d3(e),n=HL(e,t-22,a[1]);return{cmo:a,ft:n}}var UI={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function $I(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((UI[a]||_s)(e,t,r)),{cmo:[n,a,i],ft:l}}function zI(e,t,r){var a=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=BL(e,6,r);var o=e.read_shift(2);e.read_shift(2),Dr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var x=e[e.l],u=mo(e,e.lens[d+1]-e.lens[d]-1);if(n+=u,n.length>=(x?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function qI(e,t){var r=nm(e);e.l+=16;var a=RL(e,t-24);return[r,a]}function VI(e){var t=Ae(24),r=lr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return Xr([t,OL(e[1])])}function HI(e,t){e.read_shift(2);var r=nm(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Rs,""),[r,a]}function WI(e){var t=e[1].Tooltip,r=Ae(10+2*(t.length+1));r.write_shift(2,2048);var a=lr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function GI(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=C4[r]||r,r=e.read_shift(2),t[1]=C4[r]||r,t}function YI(e){return e||(e=Ae(4)),e.write_shift(2,1),e.write_shift(2,1),e}function XI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(i3(e));return r}function KI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(i3(e));return r}function QI(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function u3(e,t,r){if(!r.cellStyles)return _s(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s:n,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function JI(e,t){var r=Ae(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function ZI(e,t){var r={};return t<32||(e.l+=16,r.header=ps(e),r.footer=ps(e),e.l+=2),r}function eU(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function tU(e){for(var t=Ae(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var rU=On,sU=r3,aU=Wx;function nU(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function iU(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=On(e);++e.l;var n=To(e,t-7,r);return a.t="str",a.val=n,a}function lU(e){var t=On(e);++e.l;var r=ps(e);return t.t="n",t.val=r,t}function oU(e,t,r){var a=Ae(15);return Kx(a,e,t),a.write_shift(8,r,"f"),a}function cU(e){var t=On(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function dU(e,t,r){var a=Ae(9);return Kx(a,e,t),a.write_shift(2,r),a}function xU(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function uU(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function fU(e,t,r){var a=e.l+t,n=On(e),i=e.read_shift(2),l=mo(e,i,r);return e.l=a,n.t="str",n.val=l,n}var hU=[2,3,48,49,131,139,140,245],j1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],x=sl(1);switch(c.type){case"base64":x=sa(ca(o));break;case"binary":x=sa(o);break;case"buffer":case"array":x=o;break}is(x,0);var u=x.read_shift(1),f=!!(u&136),h=!1,p=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var g=0,y=521;u==2&&(g=x.read_shift(2)),x.l+=3,u!=2&&(g=x.read_shift(4)),g>1048576&&(g=1e6),u!=2&&(y=x.read_shift(2));var v=x.read_shift(2),w=c.codepage||1252;u!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(w=e[x[x.l]]),x.l+=1,x.l+=2),p&&(x.l+=36);for(var m=[],b={},_=Math.min(x.length,u==2?521:y-10-(h?264:0)),C=p?32:11;x.l<_&&x[x.l]!=13;)switch(b={},b.name=nx.utils.decode(w,x.slice(x.l,x.l+C)).replace(/[\u0000\r\n].*$/g,""),x.l+=C,b.type=String.fromCharCode(x.read_shift(1)),u!=2&&!p&&(b.offset=x.read_shift(4)),b.len=x.read_shift(1),u==2&&(b.offset=x.read_shift(2)),b.dec=x.read_shift(1),b.name.length&&m.push(b),u!=2&&(x.l+=p?13:14),b.type){case"B":(!h||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(x[x.l]!==13&&(x.l=y-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=y;var j=0,D=0;for(d[0]=[],D=0;D!=m.length;++D)d[0][D]=m[D].name;for(;g-- >0;){if(x[x.l]===42){x.l+=v;continue}for(++x.l,d[++j]=[],D=0,D=0;D!=m.length;++D){var R=x.slice(x.l,x.l+m[D].len);x.l+=m[D].len,is(R,0);var M=nx.utils.decode(w,R);switch(m[D].type){case"C":M.trim().length&&(d[j][D]=M.replace(/\s+$/,""));break;case"D":M.length===8?d[j][D]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):d[j][D]=M;break;case"F":d[j][D]=parseFloat(M.trim());break;case"+":case"I":d[j][D]=p?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":d[j][D]=!0;break;case"N":case"F":d[j][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));d[j][D]="##MEMO##"+(p?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(d[j][D]=+M||0);break;case"@":d[j][D]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":d[j][D]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":d[j][D]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[j][D]=-R.read_shift(-8,"f");break;case"B":if(h&&m[D].len==8){d[j][D]=R.read_shift(8,"f");break}case"G":case"P":R.l+=m[D].len;break;case"0":if(m[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+m[D].type)}}}if(u!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=m,d}function a(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var x=p0(r(o,d),d);return x["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,x}function n(o,c){try{return ml(a(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var d=c||{};if(+d.codepage>=0&&Qa(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var x=Ws(),u=ch(o,{header:1,raw:!0,cellDates:!0}),f=u[0],h=u.slice(1),p=o["!cols"]||[],g=0,y=0,v=0,w=1;for(g=0;g<f.length;++g){if(((p[g]||{}).DBF||{}).name){f[g]=p[g].DBF.name,++v;continue}if(f[g]!=null){if(++v,typeof f[g]=="number"&&(f[g]=f[g].toString(10)),typeof f[g]!="string")throw new Error("DBF Invalid column name "+f[g]+" |"+typeof f[g]+"|");if(f.indexOf(f[g])!==g){for(y=0;y<1024;++y)if(f.indexOf(f[g]+"_"+y)==-1){f[g]+="_"+y;break}}}}var m=Nt(o["!ref"]),b=[],_=[],C=[];for(g=0;g<=m.e.c-m.s.c;++g){var j="",D="",R=0,M=[];for(y=0;y<h.length;++y)h[y][g]!=null&&M.push(h[y][g]);if(M.length==0||f[g]==null){b[g]="?";continue}for(y=0;y<M.length;++y){switch(typeof M[y]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=M[y]instanceof Date?"D":"C";break;default:D="C"}R=Math.max(R,String(M[y]).length),j=j&&j!=D?"C":D}R>250&&(R=250),D=((p[g]||{}).DBF||{}).type,D=="C"&&p[g].DBF.len>R&&(R=p[g].DBF.len),j=="B"&&D=="N"&&(j="N",C[g]=p[g].DBF.dec,R=p[g].DBF.len),_[g]=j=="C"||D=="N"?R:i[j]||0,w+=_[g],b[g]=j}var O=x.next(32);for(O.write_shift(4,318902576),O.write_shift(4,h.length),O.write_shift(2,296+32*v),O.write_shift(2,w),g=0;g<4;++g)O.write_shift(4,0);for(O.write_shift(4,0|(+t[tj]||3)<<8),g=0,y=0;g<f.length;++g)if(f[g]!=null){var B=x.next(32),L=(f[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,L,"sbcs"),B.write_shift(1,b[g]=="?"?"C":b[g],"sbcs"),B.write_shift(4,y),B.write_shift(1,_[g]||i[b[g]]||0),B.write_shift(1,C[g]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),y+=_[g]||i[b[g]]||0}var U=x.next(264);for(U.write_shift(4,13),g=0;g<65;++g)U.write_shift(4,0);for(g=0;g<h.length;++g){var P=x.next(w);for(P.write_shift(1,0),y=0;y<f.length;++y)if(f[y]!=null)switch(b[y]){case"L":P.write_shift(1,h[g][y]==null?63:h[g][y]?84:70);break;case"B":P.write_shift(8,h[g][y]||0,"f");break;case"N":var F="0";for(typeof h[g][y]=="number"&&(F=h[g][y].toFixed(C[y]||0)),v=0;v<_[y]-F.length;++v)P.write_shift(1,32);P.write_shift(1,F,"sbcs");break;case"D":h[g][y]?(P.write_shift(4,("0000"+h[g][y].getFullYear()).slice(-4),"sbcs"),P.write_shift(2,("00"+(h[g][y].getMonth()+1)).slice(-2),"sbcs"),P.write_shift(2,("00"+h[g][y].getDate()).slice(-2),"sbcs")):P.write_shift(8,"00000000","sbcs");break;case"C":var N=String(h[g][y]!=null?h[g][y]:"").slice(0,_[y]);for(P.write_shift(1,N,"sbcs"),v=0;v<_[y]-N.length;++v)P.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}}(),f3=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var p=e[h];return typeof p=="number"?Zw(p):p},a=function(f,h,p){var g=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return g==59?f:Zw(g)};e["|"]=254;function n(f,h){switch(h.type){case"base64":return i(ca(f),h);case"binary":return i(f,h);case"buffer":return i(xt&&Buffer.isBuffer(f)?f.toString("binary"):hl(f),h);case"array":return i(fo(f),h)}throw new Error("Unrecognized type "+h.type)}function i(f,h){var p=f.split(/[\n\r]+/),g=-1,y=-1,v=0,w=0,m=[],b=[],_=null,C={},j=[],D=[],R=[],M=0,O;for(+h.codepage>=0&&Qa(+h.codepage);v!==p.length;++v){M=0;var B=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),L=B.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),U=L[0],P;if(B.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&b.push(B.slice(3).replace(/;;/g,";"));break;case"C":var F=!1,N=!1,T=!1,S=!1,z=-1,W=-1;for(w=1;w<L.length;++w)switch(L[w].charAt(0)){case"A":break;case"X":y=parseInt(L[w].slice(1))-1,N=!0;break;case"Y":for(g=parseInt(L[w].slice(1))-1,N||(y=0),O=m.length;O<=g;++O)m[O]=[];break;case"K":P=L[w].slice(1),P.charAt(0)==='"'?P=P.slice(1,P.length-1):P==="TRUE"?P=!0:P==="FALSE"?P=!1:isNaN(tn(P))?isNaN(Gc(P).getDate())||(P=Ht(P)):(P=tn(P),_!==null&&m0(_)&&(P=am(P))),F=!0;break;case"E":S=!0;var k=kc(L[w].slice(1),{r:g,c:y});m[g][y]=[m[g][y],k];break;case"S":T=!0,m[g][y]=[m[g][y],"S5S"];break;case"G":break;case"R":z=parseInt(L[w].slice(1))-1;break;case"C":W=parseInt(L[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+B)}if(F&&(m[g][y]&&m[g][y].length==2?m[g][y][0]=P:m[g][y]=P,_=null),T){if(S)throw new Error("SYLK shared formula cannot have own formula");var q=z>-1&&m[z][W];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");m[g][y][1]=B3(q[1],{r:g-z,c:y-W})}break;case"F":var A=0;for(w=1;w<L.length;++w)switch(L[w].charAt(0)){case"X":y=parseInt(L[w].slice(1))-1,++A;break;case"Y":for(g=parseInt(L[w].slice(1))-1,O=m.length;O<=g;++O)m[O]=[];break;case"M":M=parseInt(L[w].slice(1))/20;break;case"F":break;case"G":break;case"P":_=b[parseInt(L[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=L[w].slice(1).split(" "),O=parseInt(R[0],10);O<=parseInt(R[1],10);++O)M=parseInt(R[2],10),D[O-1]=M===0?{hidden:!0}:{wch:M},al(D[O-1]);break;case"C":y=parseInt(L[w].slice(1))-1,D[y]||(D[y]={});break;case"R":g=parseInt(L[w].slice(1))-1,j[g]||(j[g]={}),M>0?(j[g].hpt=M,j[g].hpx=Xc(M)):M===0&&(j[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+B)}A<1&&(_=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+B)}}return j.length>0&&(C["!rows"]=j),D.length>0&&(C["!cols"]=D),h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),[m,C]}function l(f,h){var p=n(f,h),g=p[0],y=p[1],v=p0(g,h);return hr(y).forEach(function(w){v[w]=y[w]}),v}function o(f,h){return ml(l(f,h),h)}function c(f,h,p,g){var y="C;Y"+(p+1)+";X"+(g+1)+";K";switch(f.t){case"n":y+=f.v||0,f.f&&!f.F&&(y+=";E"+qb(f.f,{r:p,c:g}));break;case"b":y+=f.v?"TRUE":"FALSE";break;case"e":y+=f.w||f.v;break;case"d":y+='"'+(f.w||f.v)+'"';break;case"s":y+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function d(f,h){h.forEach(function(p,g){var y="F;W"+(g+1)+" "+(g+1)+" ";p.hidden?y+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=fx(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=hx(p.wpx)),typeof p.wch=="number"&&(y+=Math.round(p.wch))),y.charAt(y.length-1)!=" "&&f.push(y)})}function x(f,h){h.forEach(function(p,g){var y="F;";p.hidden?y+="M0;":p.hpt?y+="M"+20*p.hpt+";":p.hpx&&(y+="M"+20*mx(p.hpx)+";"),y.length>2&&f.push(y+"R"+(g+1))})}function u(f,h){var p=["ID;PWXL;N;E"],g=[],y=Nt(f["!ref"]),v,w=Array.isArray(f),m=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&d(p,f["!cols"]),f["!rows"]&&x(p,f["!rows"]),p.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var b=y.s.r;b<=y.e.r;++b)for(var _=y.s.c;_<=y.e.c;++_){var C=et({r:b,c:_});v=w?(f[b]||[])[_]:f[C],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,f,b,_))}return p.join(m)+m+g.join(m)+m+"E"+m}return{to_workbook:o,to_sheet:l,from_sheet:u}}(),h3=function(){function e(i,l){switch(l.type){case"base64":return t(ca(i),l);case"binary":return t(i,l);case"buffer":return t(xt&&Buffer.isBuffer(i)?i.toString("binary"):hl(i),l);case"array":return t(fo(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,d=-1,x=0,u=[];x!==o.length;++x){if(o[x].trim()==="BOT"){u[++c]=[],d=0;continue}if(!(c<0)){var f=o[x].trim().split(","),h=f[0],p=f[1];++x;for(var g=o[x]||"";(g.match(/["]/g)||[]).length&1&&x<o.length-1;)g+=`
`+o[++x];switch(g=g.trim(),+h){case-1:if(g==="BOT"){u[++c]=[],d=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?u[c][d]=!0:g==="FALSE"?u[c][d]=!1:isNaN(tn(p))?isNaN(Gc(p).getDate())?u[c][d]=p:u[c][d]=Ht(p):u[c][d]=tn(p),++d;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),u[c][d++]=g!==""?g:null;break}if(g==="EOD")break}}return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),u}function r(i,l){return p0(e(i,l),l)}function a(i,l){return ml(r(i,l),l)}var n=function(){var i=function(c,d,x,u,f){c.push(d),c.push(x+","+u),c.push('"'+f.replace(/"/g,'""')+'"')},l=function(c,d,x,u){c.push(d+","+x),c.push(d==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var d=[],x=Nt(c["!ref"]),u,f=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,x.e.r-x.s.r+1,""),i(d,"TUPLES",0,x.e.c-x.s.c+1,""),i(d,"DATA",0,0,"");for(var h=x.s.r;h<=x.e.r;++h){l(d,-1,0,"BOT");for(var p=x.s.c;p<=x.e.c;++p){var g=et({r:h,c:p});if(u=f?(c[h]||[])[p]:c[g],!u){l(d,1,0,"");continue}switch(u.t){case"n":var y=u.w;!y&&u.v!=null&&(y=u.v),y==null?u.f&&!u.F?l(d,1,0,"="+u.f):l(d,1,0,""):l(d,0,y,"V");break;case"b":l(d,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=Ua(u.z||Ze[14],$r(Ht(u.v)))),l(d,0,u.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var v=`\r
`,w=d.join(v);return w}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),m3=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(u,f){for(var h=u.split(`
`),p=-1,g=-1,y=0,v=[];y!==h.length;++y){var w=h[y].trim().split(":");if(w[0]==="cell"){var m=lr(w[1]);if(v.length<=m.r)for(p=v.length;p<=m.r;++p)v[p]||(v[p]=[]);switch(p=m.r,g=m.c,w[2]){case"t":v[p][g]=e(w[3]);break;case"v":v[p][g]=+w[3];break;case"vtf":var b=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[p][g]=!!+w[4];break;default:v[p][g]=+w[4];break}w[2]=="vtf"&&(v[p][g]=[v[p][g],b])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function a(u,f){return p0(r(u,f),f)}function n(u,f){return ml(a(u,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(u){if(!u||!u["!ref"])return"";for(var f=[],h=[],p,g="",y=Ys(u["!ref"]),v=Array.isArray(u),w=y.s.r;w<=y.e.r;++w)for(var m=y.s.c;m<=y.e.c;++m)if(g=et({r:w,c:m}),p=v?(u[w]||[])[m]:u[g],!(!p||p.v==null||p.t==="z")){switch(h=["cell",g,"t"],p.t){case"s":case"str":h.push(t(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=t(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var b=$r(Ht(p.v));h[2]="vtc",h[3]="nd",h[4]=""+b,h[5]=p.w||Ua(p.z||Ze[14],b);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function x(u){return[i,l,o,l,d(u),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:x}}(),Yc=function(){function e(x,u,f,h,p){p.raw?u[f][h]=x:x===""||(x==="TRUE"?u[f][h]=!0:x==="FALSE"?u[f][h]=!1:isNaN(tn(x))?isNaN(Gc(x).getDate())?u[f][h]=x:u[f][h]=Ht(x):u[f][h]=tn(x))}function t(x,u){var f=u||{},h=[];if(!x||x.length===0)return h;for(var p=x.split(/[\r\n]/),g=p.length-1;g>=0&&p[g].length===0;)--g;for(var y=10,v=0,w=0;w<=g;++w)v=p[w].indexOf(" "),v==-1?v=p[w].length:v++,y=Math.max(y,v);for(w=0;w<=g;++w){h[w]=[];var m=0;for(e(p[w].slice(0,y).trim(),h,w,m,f),m=1;m<=(p[w].length-y)/10+1;++m)e(p[w].slice(y+(m-1)*10,y+m*10).trim(),h,w,m,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(x){for(var u={},f=!1,h=0,p=0;h<x.length;++h)(p=x.charCodeAt(h))==34?f=!f:!f&&p in r&&(u[p]=(u[p]||0)+1);p=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&p.push([u[h],h]);if(!p.length){u=a;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&p.push([u[h],h])}return p.sort(function(g,y){return g[0]-y[0]||a[g[1]]-a[y[1]]}),r[p.pop()[1]]||44}function i(x,u){var f=u||{},h="",p=f.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(h=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(h=x.charAt(4),x=x.slice(6)):h=n(x.slice(0,1024)):f&&f.FS?h=f.FS:h=n(x.slice(0,1024));var y=0,v=0,w=0,m=0,b=0,_=h.charCodeAt(0),C=!1,j=0,D=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var R=f.dateNF!=null?eP(f.dateNF):null;function M(){var O=x.slice(m,b),B={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)B.t="z";else if(f.raw)B.t="s",B.v=O;else if(O.trim().length===0)B.t="s",B.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(B.t="s",B.v=O.slice(2,-1).replace(/""/g,'"')):Dz(O)?(B.t="n",B.f=O.slice(1)):(B.t="s",B.v=O);else if(O=="TRUE")B.t="b",B.v=!0;else if(O=="FALSE")B.t="b",B.v=!1;else if(!isNaN(w=tn(O)))B.t="n",f.cellText!==!1&&(B.w=O),B.v=w;else if(!isNaN(Gc(O).getDate())||R&&O.match(R)){B.z=f.dateNF||Ze[14];var L=0;R&&O.match(R)&&(O=tP(O,f.dateNF,O.match(R)||[]),L=1),f.cellDates?(B.t="d",B.v=Ht(O,L)):(B.t="n",B.v=$r(Ht(O,L))),f.cellText!==!1&&(B.w=Ua(B.z,B.v instanceof Date?$r(B.v):B.v)),f.cellNF||delete B.z}else B.t="s",B.v=O;if(B.t=="z"||(f.dense?(p[y]||(p[y]=[]),p[y][v]=B):p[et({c:v,r:y})]=B),m=b+1,D=x.charCodeAt(m),g.e.c<v&&(g.e.c=v),g.e.r<y&&(g.e.r=y),j==_)++v;else if(v=0,++y,f.sheetRows&&f.sheetRows<=y)return!0}e:for(;b<x.length;++b)switch(j=x.charCodeAt(b)){case 34:D===34&&(C=!C);break;case _:case 10:case 13:if(!C&&M())break e;break}return b-m>0&&M(),p["!ref"]=lt(g),p}function l(x,u){return!(u&&u.PRN)||u.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?i(x,u):p0(t(x,u),u)}function o(x,u){var f="",h=u.type=="string"?[0,0,0,0]:Qb(x,u);switch(u.type){case"base64":f=ca(x);break;case"binary":f=x;break;case"buffer":u.codepage==65001?f=x.toString("utf8"):u.codepage&&typeof nx<"u"||(f=xt&&Buffer.isBuffer(x)?x.toString("binary"):hl(x));break;case"array":f=fo(x);break;case"string":f=x;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Rt(f.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?f=Rt(f):u.type=="binary"&&typeof nx<"u",f.slice(0,19)=="socialcalc:version:"?m3.to_sheet(u.type=="string"?f:Rt(f),u):l(f,u)}function c(x,u){return ml(o(x,u),u)}function d(x){for(var u=[],f=Nt(x["!ref"]),h,p=Array.isArray(x),g=f.s.r;g<=f.e.r;++g){for(var y=[],v=f.s.c;v<=f.e.c;++v){var w=et({r:g,c:v});if(h=p?(x[g]||[])[v]:x[w],!h||h.v==null){y.push("          ");continue}for(var m=(h.w||(ui(h),h.w)||"").slice(0,10);m.length<10;)m+=" ";y.push(m+(v===0?" ":""))}u.push(y.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}}();function mU(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=f3.to_workbook(e,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Yc.to_workbook(e,t)}}var Ql=function(){function e(k,q,A){if(k){is(k,k.l||0);for(var I=A.Enum||z;k.l<k.length;){var V=k.read_shift(2),H=I[V]||I[65535],Y=k.read_shift(2),Q=k.l+Y,te=H.f&&H.f(k,Y,A);if(k.l=Q,q(te,H,V))return}}}function t(k,q){switch(q.type){case"base64":return r(sa(ca(k)),q);case"binary":return r(sa(k),q);case"buffer":case"array":return r(k,q)}throw"Unsupported type "+q.type}function r(k,q){if(!k)return k;var A=q||{},I=A.dense?[]:{},V="Sheet1",H="",Y=0,Q={},te=[],re=[],X={s:{r:0,c:0},e:{r:0,c:0}},je=A.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)A.Enum=z,e(k,function(ce,fe,pe){switch(pe){case 0:A.vers=ce,ce>=4096&&(A.qpro=!0);break;case 6:X=ce;break;case 204:ce&&(H=ce);break;case 222:H=ce;break;case 15:case 51:A.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:pe==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=A.dateNF||Ze[14],A.cellDates&&(ce[1].t="d",ce[1].v=am(ce[1].v))),A.qpro&&ce[3]>Y&&(I["!ref"]=lt(X),Q[V]=I,te.push(V),I=A.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Y=ce[3],V=H||"Sheet"+(Y+1),H="");var Ne=A.dense?(I[ce[0].r]||[])[ce[0].c]:I[et(ce[0])];if(Ne){Ne.t=ce[1].t,Ne.v=ce[1].v,ce[1].z!=null&&(Ne.z=ce[1].z),ce[1].f!=null&&(Ne.f=ce[1].f);break}A.dense?(I[ce[0].r]||(I[ce[0].r]=[]),I[ce[0].r][ce[0].c]=ce[1]):I[et(ce[0])]=ce[1];break}},A);else if(k[2]==26||k[2]==14)A.Enum=W,k[2]==14&&(A.qpro=!0,k.l=0),e(k,function(ce,fe,pe){switch(pe){case 204:V=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>Y&&(I["!ref"]=lt(X),Q[V]=I,te.push(V),I=A.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Y=ce[3],V="Sheet"+(Y+1)),je>0&&ce[0].r>=je)break;A.dense?(I[ce[0].r]||(I[ce[0].r]=[]),I[ce[0].r][ce[0].c]=ce[1]):I[et(ce[0])]=ce[1],X.e.c<ce[0].c&&(X.e.c=ce[0].c),X.e.r<ce[0].r&&(X.e.r=ce[0].r);break;case 27:ce[14e3]&&(re[ce[14e3][0]]=ce[14e3][1]);break;case 1537:re[ce[0]]=ce[1],ce[0]==Y&&(V=ce[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(I["!ref"]=lt(X),Q[H||V]=I,te.push(H||V),!re.length)return{SheetNames:te,Sheets:Q};for(var J={},ue=[],de=0;de<re.length;++de)Q[te[de]]?(ue.push(re[de]||te[de]),J[re[de]]=Q[re[de]]||Q[te[de]]):(ue.push(re[de]),J[re[de]]={"!ref":"A1"});return{SheetNames:ue,Sheets:J}}function a(k,q){var A=q||{};if(+A.codepage>=0&&Qa(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Ws(),V=Nt(k["!ref"]),H=Array.isArray(k),Y=[];Le(I,0,i(1030)),Le(I,6,c(V));for(var Q=Math.min(V.e.r,8191),te=V.s.r;te<=Q;++te)for(var re=_r(te),X=V.s.c;X<=V.e.c;++X){te===V.s.r&&(Y[X]=ir(X));var je=Y[X]+re,J=H?(k[te]||[])[X]:k[je];if(!(!J||J.t=="z"))if(J.t=="n")(J.v|0)==J.v&&J.v>=-32768&&J.v<=32767?Le(I,13,h(te,X,J.v)):Le(I,14,g(te,X,J.v));else{var ue=ui(J);Le(I,15,u(te,X,ue.slice(0,239)))}}return Le(I,1),I.end()}function n(k,q){var A=q||{};if(+A.codepage>=0&&Qa(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Ws();Le(I,0,l(k));for(var V=0,H=0;V<k.SheetNames.length;++V)(k.Sheets[k.SheetNames[V]]||{})["!ref"]&&Le(I,27,S(k.SheetNames[V],H++));var Y=0;for(V=0;V<k.SheetNames.length;++V){var Q=k.Sheets[k.SheetNames[V]];if(!(!Q||!Q["!ref"])){for(var te=Nt(Q["!ref"]),re=Array.isArray(Q),X=[],je=Math.min(te.e.r,8191),J=te.s.r;J<=je;++J)for(var ue=_r(J),de=te.s.c;de<=te.e.c;++de){J===te.s.r&&(X[de]=ir(de));var ce=X[de]+ue,fe=re?(Q[J]||[])[de]:Q[ce];if(!(!fe||fe.t=="z"))if(fe.t=="n")Le(I,23,M(J,de,Y,fe.v));else{var pe=ui(fe);Le(I,22,j(J,de,Y,pe.slice(0,239)))}}++Y}}return Le(I,1),I.end()}function i(k){var q=Ae(2);return q.write_shift(2,k),q}function l(k){var q=Ae(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var A=0,I=0,V=0,H=0;H<k.SheetNames.length;++H){var Y=k.SheetNames[H],Q=k.Sheets[Y];if(!(!Q||!Q["!ref"])){++V;var te=Ys(Q["!ref"]);A<te.e.r&&(A=te.e.r),I<te.e.c&&(I=te.e.c)}}return A>8191&&(A=8191),q.write_shift(2,A),q.write_shift(1,V),q.write_shift(1,I),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(k,q,A){var I={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&A.qpro?(I.s.c=k.read_shift(1),k.l++,I.s.r=k.read_shift(2),I.e.c=k.read_shift(1),k.l++,I.e.r=k.read_shift(2),I):(I.s.c=k.read_shift(2),I.s.r=k.read_shift(2),q==12&&A.qpro&&(k.l+=2),I.e.c=k.read_shift(2),I.e.r=k.read_shift(2),q==12&&A.qpro&&(k.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function c(k){var q=Ae(8);return q.write_shift(2,k.s.c),q.write_shift(2,k.s.r),q.write_shift(2,k.e.c),q.write_shift(2,k.e.r),q}function d(k,q,A){var I=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(I[0].c=k.read_shift(1),I[3]=k.read_shift(1),I[0].r=k.read_shift(2),k.l+=2):(I[2]=k.read_shift(1),I[0].c=k.read_shift(2),I[0].r=k.read_shift(2)),I}function x(k,q,A){var I=k.l+q,V=d(k,q,A);if(V[1].t="s",A.vers==20768){k.l++;var H=k.read_shift(1);return V[1].v=k.read_shift(H,"utf8"),V}return A.qpro&&k.l++,V[1].v=k.read_shift(I-k.l,"cstr"),V}function u(k,q,A){var I=Ae(7+A.length);I.write_shift(1,255),I.write_shift(2,q),I.write_shift(2,k),I.write_shift(1,39);for(var V=0;V<I.length;++V){var H=A.charCodeAt(V);I.write_shift(1,H>=128?95:H)}return I.write_shift(1,0),I}function f(k,q,A){var I=d(k,q,A);return I[1].v=k.read_shift(2,"i"),I}function h(k,q,A){var I=Ae(7);return I.write_shift(1,255),I.write_shift(2,q),I.write_shift(2,k),I.write_shift(2,A,"i"),I}function p(k,q,A){var I=d(k,q,A);return I[1].v=k.read_shift(8,"f"),I}function g(k,q,A){var I=Ae(13);return I.write_shift(1,255),I.write_shift(2,q),I.write_shift(2,k),I.write_shift(8,A,"f"),I}function y(k,q,A){var I=k.l+q,V=d(k,q,A);if(V[1].v=k.read_shift(8,"f"),A.qpro)k.l=I;else{var H=k.read_shift(2);b(k.slice(k.l,k.l+H),V),k.l+=H}return V}function v(k,q,A){var I=q&32768;return q&=-32769,q=(I?k:0)+(q>=8192?q-16384:q),(I?"":"$")+(A?ir(q):_r(q))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},m=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(k,q){is(k,0);for(var A=[],I=0,V="",H="",Y="",Q="";k.l<k.length;){var te=k[k.l++];switch(te){case 0:A.push(k.read_shift(8,"f"));break;case 1:H=v(q[0].c,k.read_shift(2),!0),V=v(q[0].r,k.read_shift(2),!1),A.push(H+V);break;case 2:{var re=v(q[0].c,k.read_shift(2),!0),X=v(q[0].r,k.read_shift(2),!1);H=v(q[0].c,k.read_shift(2),!0),V=v(q[0].r,k.read_shift(2),!1),A.push(re+X+":"+H+V)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(k.read_shift(2));break;case 6:{for(var je="";te=k[k.l++];)je+=String.fromCharCode(te);A.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:Q=A.pop(),Y=A.pop(),A.push(["AND","OR"][te-20]+"("+Y+","+Q+")");break;default:if(te<32&&m[te])Q=A.pop(),Y=A.pop(),A.push(Y+m[te]+Q);else if(w[te]){if(I=w[te][1],I==69&&(I=k[k.l++]),I>A.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+A.join("|")+"|");return}var J=A.slice(-I);A.length-=I,A.push(w[te][0]+"("+J.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}A.length==1?q[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function _(k){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=k.read_shift(2),q[3]=k[k.l++],q[0].c=k[k.l++],q}function C(k,q){var A=_(k);return A[1].t="s",A[1].v=k.read_shift(q-4,"cstr"),A}function j(k,q,A,I){var V=Ae(6+I.length);V.write_shift(2,k),V.write_shift(1,A),V.write_shift(1,q),V.write_shift(1,39);for(var H=0;H<I.length;++H){var Y=I.charCodeAt(H);V.write_shift(1,Y>=128?95:Y)}return V.write_shift(1,0),V}function D(k,q){var A=_(k);A[1].v=k.read_shift(2);var I=A[1].v>>1;if(A[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return A[1].v=I,A}function R(k,q){var A=_(k),I=k.read_shift(4),V=k.read_shift(4),H=k.read_shift(2);if(H==65535)return I===0&&V===3221225472?(A[1].t="e",A[1].v=15):I===0&&V===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var Y=H&32768;return H=(H&32767)-16446,A[1].v=(1-Y*2)*(V*Math.pow(2,H+32)+I*Math.pow(2,H)),A}function M(k,q,A,I){var V=Ae(14);if(V.write_shift(2,k),V.write_shift(1,A),V.write_shift(1,q),I==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var H=0,Y=0,Q=0,te=0;return I<0&&(H=1,I=-I),Y=Math.log2(I)|0,I/=Math.pow(2,Y-31),te=I>>>0,te&2147483648||(I/=2,++Y,te=I>>>0),I-=te,te|=2147483648,te>>>=0,I*=Math.pow(2,32),Q=I>>>0,V.write_shift(4,Q),V.write_shift(4,te),Y+=16383+(H?32768:0),V.write_shift(2,Y),V}function O(k,q){var A=R(k);return k.l+=q-14,A}function B(k,q){var A=_(k),I=k.read_shift(4);return A[1].v=I>>6,A}function L(k,q){var A=_(k),I=k.read_shift(8,"f");return A[1].v=I,A}function U(k,q){var A=L(k);return k.l+=q-10,A}function P(k,q){return k[k.l+q-1]==0?k.read_shift(q,"cstr"):""}function F(k,q){var A=k[k.l++];A>q-1&&(A=q-1);for(var I="";I.length<A;)I+=String.fromCharCode(k[k.l++]);return I}function N(k,q,A){if(!(!A.qpro||q<21)){var I=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var V=k.read_shift(q-21,"cstr");return[I,V]}}function T(k,q){for(var A={},I=k.l+q;k.l<I;){var V=k.read_shift(2);if(V==14e3){for(A[V]=[0,""],A[V][0]=k.read_shift(2);k[k.l];)A[V][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return A}function S(k,q){var A=Ae(5+k.length);A.write_shift(2,14e3),A.write_shift(2,q);for(var I=0;I<k.length;++I){var V=k.charCodeAt(I);A[A.l++]=V>127?95:V}return A[A.l++]=0,A}var z={0:{n:"BOF",f:Dr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:P},222:{n:"SHEETNAMELP",f:F},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:T},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:P},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:N},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function gU(e){var t={},r=e.match(js),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=rt(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=hb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var pU=function(){var e=ox("t"),t=ox("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:jt(l[1])},c=i.match(t);return c&&(o.s=gU(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(o){return o.v})}}(),vU=function(){var t=/(\r\n|\n)/g;function r(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),bU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,yU=/<(?:\w+:)?r>/,wU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Lb(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=jt(Rt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Rt(e),r&&(a.h=jb(a.t))):e.match(yU)&&(a.r=Rt(e),a.t=jt(Rt((e.replace(wU,"").match(bU)||[]).join("").replace(js,""))),r&&(a.h=vU(pU(a.r)))),a):{t:""}}var EU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,_U=/<(?:\w+:)?(?:si|sstItem)>/g,jU=/<\/(?:\w+:)?(?:si|sstItem)>/;function NU(e,t){var r=[],a="";if(!e)return r;var n=e.match(EU);if(n){a=n[2].replace(_U,"").split(jU);for(var i=0;i!=a.length;++i){var l=Lb(a[i].trim(),t);l!=null&&(r[r.length]=l)}n=rt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var CU=/^\s|\s$|[\t\n\r]/;function g3(e,t){if(!t.bookSST)return"";var r=[jr];r[r.length]=Pe("sst",null,{xmlns:ko[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(CU)&&(i+=' xml:space="preserve"'),i+=">"+Ft(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function AU(e){return[e.read_shift(4),e.read_shift(4)]}function kU(e,t){var r=[],a=!1;return vi(e,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function DU(e,t){return t||(t=Ae(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var SU=UP;function BU(e){var t=Ws();Be(t,159,DU(e));for(var r=0;r<e.length;++r)Be(t,19,SU(e[r]));return Be(t,160),t.end()}function p3(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function ni(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function FU(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ni(e,4),t.U=ni(e,4),t.W=ni(e,4),t}function TU(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function MU(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(TU(e));return t}function RU(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function OU(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ni(e,4),t.U=ni(e,4),t.W=ni(e,4),t}function PU(e){var t=OU(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function v3(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function b3(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function LU(e){var t=ni(e);switch(t.Minor){case 2:return[t.Minor,IU(e)];case 3:return[t.Minor,UU()];case 4:return[t.Minor,$U(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function IU(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=v3(e,r),n=b3(e,e.length-e.l);return{t:"Std",h:a,v:n}}function UU(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $U(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(js,function(i){var l=rt(i);switch(Rn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){a[o]=l[o]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function zU(e,t){var r={},a=r.EncryptionVersionInfo=ni(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=v3(e,n),t-=n,r.EncryptionVerifier=b3(e,t),r}function qU(e){var t={},r=t.EncryptionVersionInfo=ni(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ib(e){var t=0,r,a=p3(e),n=a.length+1,i,l,o,c,d;for(r=sl(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)l=r[i],o=t&16384?1:0,c=t<<1&32767,d=o|c,t=d^l;return t^52811}var y3=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,o){return a(l^o)},i=function(l){for(var o=t[l.length-1],c=104,d=l.length-1;d>=0;--d)for(var x=l[d],u=0;u!=7;++u)x&64&&(o^=r[c]),x*=2,--c;return o};return function(l){for(var o=p3(l),c=i(o),d=o.length,x=sl(16),u=0;u!=16;++u)x[u]=0;var f,h,p;for((d&1)===1&&(f=c>>8,x[d]=n(e[0],f),--d,f=c&255,h=o[o.length-1],x[d]=n(h,f));d>0;)--d,f=c>>8,x[d]=n(o[d],f),--d,f=c&255,x[d]=n(o[d],f);for(d=15,p=15-o.length;p>0;)f=c>>8,x[d]=n(e[p],f),--d,--p,f=c&255,x[d]=n(o[d],f),--d,--p;return x}}(),VU=function(e,t,r,a,n){n||(n=t),a||(a=y3(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=a[r],l=(l>>5|l<<3)&255,n[i]=l,++r;return[n,r,a]},HU=function(e){var t=0,r=y3(e);return function(a){var n=VU("",a,t,r);return t=n[1],n[0]}};function WU(e,t,r,a){var n={key:Dr(e),verificationBytes:Dr(e)};return r.password&&(n.verifier=Ib(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=HU(r.password)),n}function GU(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=qU(e):a.Data=zU(e,t),a}function YU(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?GU(e,t-2,a):WU(e,r.biff>=8?t:t-2,r,a),a}var w3=function(){function e(n,i){switch(i.type){case"base64":return t(ca(n),i);case"binary":return t(n,i);case"buffer":return t(xt&&Buffer.isBuffer(n)?n.toString("binary"):hl(n),i);case"array":return t(fo(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var l=i||{},o=l.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(x,u){Array.isArray(o)&&(o[u]=[]);for(var f=/\\\w+\b/g,h=0,p,g=-1;p=f.exec(x);){switch(p[0]){case"\\cell":var y=x.slice(h,f.lastIndex-p[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[u][g]=v:o[et({r:u,c:g})]=v}break}h=f.lastIndex}g>d.e.c&&(d.e.c=g)}),o["!ref"]=lt(d),o}function r(n,i){return ml(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],l=Nt(n["!ref"]),o,c=Array.isArray(n),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var x=l.s.c;x<=l.e.c;++x)i.push("\\cellx"+(x+1));for(i.push("\\pard\\intbl"),x=l.s.c;x<=l.e.c;++x){var u=et({r:d,c:x});o=c?(n[d]||[])[x]:n[u],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(ui(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function XU(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ux(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function KU(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),i=Math.min(t,r,a),l=n-i;if(l===0)return[0,0,t];var o=0,c=0,d=n+i;switch(c=l/(d>1?2-d:d),n){case t:o=((r-a)/l+6)%6;break;case r:o=(a-t)/l+2;break;case a:o=(t-r)/l+4;break}return[o/6,c,d/2]}function QU(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),i=a-n/2,l=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=n*o,l[0]+=n,l[1]+=c;break;case 1:c=n*(2-o),l[0]+=c,l[1]+=n;break;case 2:c=n*(o-2),l[1]+=n,l[2]+=c;break;case 3:c=n*(4-o),l[1]+=c,l[2]+=n;break;case 4:c=n*(o-4),l[2]+=n,l[0]+=c;break;case 5:c=n*(6-o),l[2]+=c,l[0]+=n;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function nh(e,t){if(t===0)return e;var r=KU(XU(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ux(QU(r))}var E3=6,JU=15,ZU=1,gs=E3;function fx(e){return Math.floor((e+Math.round(128/gs)/256)*gs)}function hx(e){return Math.floor((e-5)/gs*100+.5)/100}function ih(e){return Math.round((e*gs+5)/gs*256)/256}function _g(e){return ih(hx(fx(e)))}function Ub(e){var t=Math.abs(e-_g(e)),r=gs;if(t>.005)for(gs=ZU;gs<JU;++gs)Math.abs(e-_g(e))<=t&&(t=Math.abs(e-_g(e)),r=gs);gs=r}function al(e){e.width?(e.wpx=fx(e.width),e.wch=hx(e.wpx),e.MDW=gs):e.wpx?(e.wch=hx(e.wpx),e.width=ih(e.wch),e.MDW=gs):typeof e.wch=="number"&&(e.width=ih(e.wch),e.wpx=fx(e.width),e.MDW=gs),e.customWidth&&delete e.customWidth}var e$=96,_3=e$;function mx(e){return e*96/_3}function Xc(e){return e*_3/96}var t$={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function r$(e,t,r,a){t.Borders=[];var n={},i=!1;(e[0].match(js)||[]).forEach(function(l){var o=rt(l);switch(Rn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=$t(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=$t(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function s$(e,t,r,a){t.Fills=[];var n={},i=!1;(e[0].match(js)||[]).forEach(function(l){var o=rt(l);switch(Rn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function a$(e,t,r,a){t.Fonts=[];var n={},i=!1;(e[0].match(js)||[]).forEach(function(l){var o=rt(l);switch(Rn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Rt(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?$t(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?$t(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?$t(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?$t(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?$t(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?$t(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?$t(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=hb[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=$t(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=Xl[n.color.index];n.color.index==81&&(c=Xl[1]),c||(c=Xl[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=nh(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function n$(e,t,r){t.NumberFmt=[];for(var a=hr(Ze),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Ze[a[n]];var i=e[0].match(js);if(i)for(n=0;n<i.length;++n){var l=rt(i[n]);switch(Rn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=jt(Rt(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}ai(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function i$(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Pe("numFmt",null,{numFmtId:a,formatCode:Ft(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Ou=["numFmtId","fillId","fontId","borderId","xfId"],Pu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function l$(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(js)||[]).forEach(function(i){var l=rt(i),o=0;switch(Rn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],o=0;o<Ou.length;++o)a[Ou[o]]&&(a[Ou[o]]=parseInt(a[Ou[o]],10));for(o=0;o<Pu.length;++o)a[Pu[o]]&&(a[Pu[o]]=$t(a[Pu[o]]));if(t.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[o]){a.numFmtId=o;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=$t(l.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function o$(e){var t=[];return t[t.length]=Pe("cellXfs",null),e.forEach(function(r){t[t.length]=Pe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var c$=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,d){var x={};if(!o)return x;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(t))&&n$(u,x,d),(u=o.match(n))&&a$(u,x,c,d),(u=o.match(a))&&s$(u,x,c,d),(u=o.match(i))&&r$(u,x,c,d),(u=o.match(r))&&l$(u,x,d),x}}();function j3(e,t){var r=[jr,Pe("styleSheet",null,{xmlns:ko[0],"xmlns:vt":Lr.vt})],a;return e.SSF&&(a=i$(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=o$(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function d$(e,t){var r=e.read_shift(2),a=Es(e);return[r,a]}function x$(e,t,r){r||(r=Ae(6+4*t.length)),r.write_shift(2,e),Qr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function u$(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=GP(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=WP(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Es(e),a}function f$(e,t){t||(t=Ae(25+4*32)),t.write_shift(2,e.sz*20),YP(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),rh(e.color,t);var a=0;return a=2,t.write_shift(1,a),Qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var h$=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jg,m$=_s;function q4(e,t){t||(t=Ae(4*3+8*7+16*1)),jg||(jg=rm(h$));var r=jg[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(rh({auto:1},t),rh({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function g$(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function N3(e,t,r){r||(r=Ae(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function P0(e,t){return t||(t=Ae(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var p$=_s;function v$(e,t){return t||(t=Ae(51)),t.write_shift(1,0),P0(null,t),P0(null,t),P0(null,t),P0(null,t),P0(null,t),t.length>t.l?t.slice(0,t.l):t}function b$(e,t){return t||(t=Ae(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),th(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function y$(e,t,r){var a=Ae(2052);return a.write_shift(4,e),th(t,a),th(r,a),a.length>a.l?a.slice(0,a.l):a}function w$(e,t,r){var a={};a.NumberFmt=[];for(var n in Ze)a.NumberFmt[n]=Ze[n];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return vi(e,function(c,d,x){switch(x){case 44:a.NumberFmt[c[0]]=c[1],ai(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=nh(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(x),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(x);else if(d.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),a}function E$(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(Be(e,615,rn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Be(e,44,x$(n,t[n]))}),Be(e,616))}}function _$(e){var t=1;Be(e,611,rn(t)),Be(e,43,f$({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(e,612)}function j$(e){var t=2;Be(e,603,rn(t)),Be(e,45,q4({patternType:"none"})),Be(e,45,q4({patternType:"gray125"})),Be(e,604)}function N$(e){var t=1;Be(e,613,rn(t)),Be(e,46,v$()),Be(e,614)}function C$(e){var t=1;Be(e,626,rn(t)),Be(e,47,N3({numFmtId:0},65535)),Be(e,627)}function A$(e,t){Be(e,617,rn(t.length)),t.forEach(function(r){Be(e,47,N3(r,0))}),Be(e,618)}function k$(e){var t=1;Be(e,619,rn(t)),Be(e,48,b$({xfId:0,name:"Normal"})),Be(e,620)}function D$(e){var t=0;Be(e,505,rn(t)),Be(e,506)}function S$(e){var t=0;Be(e,508,y$(t,"TableStyleMedium9","PivotStyleMedium4")),Be(e,509)}function B$(e,t){var r=Ws();return Be(r,278),E$(r,e.SSF),_$(r),j$(r),N$(r),C$(r),A$(r,t.cellXfs),k$(r),D$(r),S$(r),Be(r,279),r.end()}var F$=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function T$(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(js)||[]).forEach(function(n){var i=rt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[F$.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function M$(){}function R$(){}var O$=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,P$=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,L$=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function I$(e,t,r){t.themeElements={};var a;[["clrScheme",O$,T$],["fontScheme",P$,M$],["fmtScheme",L$,R$]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var U$=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function C3(e,t){(!e||e.length===0)&&(e=$b());var r,a={};if(!(r=e.match(U$)))throw new Error("themeElements not found in theme");return I$(r[0],a,t),a.raw=e,a}function $b(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[jr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $$(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var l;try{l=vj(i,{type:"array"})}catch{return}var o=aa(l,"theme/theme/theme1.xml",!0);if(o)return C3(o,r)}}function z$(e){return e.read_shift(4)}function q$(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=V$(e,4);break;case 2:t.xclrValue=n3(e);break;case 3:t.xclrValue=z$(e);break;case 4:e.l+=4;break}return e.l+=8,t}function V$(e,t){return _s(e,t)}function H$(e,t){return _s(e,t)}function W$(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=q$(e);break;case 6:a[1]=H$(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function G$(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(W$(e,r-e.l));return{ixfe:a,ext:i}}function Y$(e,t){t.forEach(function(r){switch(r[0]){}})}function X$(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Es(e)}}function K$(e){var t=Ae(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Qr(e.name,t),t.slice(0,t.l)}function Q$(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function J$(e){var t=Ae(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Z$(e,t){var r=Ae(8+2*t.length);return r.write_shift(4,e),Qr(t,r),r.slice(0,r.l)}function ez(e){return e.l+=4,e.read_shift(4)!=0}function tz(e,t){var r=Ae(8);return r.write_shift(4,e),r.write_shift(4,1),r}function rz(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],l=!1,o=2;return vi(e,function(c,d,x){switch(x){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?a.Cell.push({type:a.Types[u[0]-1].name,index:u[1]}):o==0&&a.Value.push({type:a.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(x),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),a}function sz(){var e=Ws();return Be(e,332),Be(e,334,rn(1)),Be(e,335,K$({name:"XLDAPR",version:12e4,flags:3496657072})),Be(e,336),Be(e,339,Z$(1,"XLDAPR")),Be(e,52),Be(e,35,rn(514)),Be(e,4096,rn(0)),Be(e,4097,Ea(1)),Be(e,36),Be(e,53),Be(e,340),Be(e,337,tz(1)),Be(e,51,J$([[1,0]])),Be(e,338),Be(e,333),e.end()}function az(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,l;return e.replace(js,function(o){var c=rt(o);switch(Rn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(l=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function A3(){var e=[jr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function nz(e){var t=[];if(!e)return t;var r=1;return(e.match(js)||[]).forEach(function(a){var n=rt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function iz(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=et(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function lz(e,t,r){var a=[];return vi(e,function(i,l,o){switch(o){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function oz(e,t,r,a){if(!e)return e;var n=a||{},i=!1;vi(e,function(o,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function cz(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var uc=1024;function k3(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Pe("xml",null,{"xmlns:v":ea.v,"xmlns:o":ea.o,"xmlns:x":ea.x,"xmlns:mv":ea.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];uc<e*1e3;)uc+=1e3;return t.forEach(function(i){var l=lr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Pe("v:fill",c,o),x={on:"t",obscured:"t"};++uc,n=n.concat(["<v:shape"+cx({id:"_x0000_s"+uc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Pe("v:shadow",null,x),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",os("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),os("x:AutoFill","False"),os("x:Row",String(l.r)),os("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function V4(e,t,r,a){var n=Array.isArray(e),i;t.forEach(function(l){var o=lr(l.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[l.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[l.ref]=i;var c=Nt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var d=lt(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var x={a:l.author,t:l.t,r:l.r,T:r};l.h&&(x.h=l.h);for(var u=i.c.length-1;u>=0;--u){if(!r&&i.c[u].T)return;r&&!i.c[u].T&&i.c.splice(u,1)}if(r&&a){for(u=0;u<a.length;++u)if(x.a==a[u].id){x.a=a[u].name||x.a;break}}i.c.push(x)})}function dz(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=rt(o[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},x=lr(c.ref);if(!(t.sheetRows&&t.sheetRows<=x.r)){var u=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!u&&!!u[1]&&Lb(u[1])||{r:"",t:"",h:""};d.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),d.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=f.h),a.push(d)}}}}),a}function D3(e){var t=[jr,Pe("comments",null,{xmlns:ko[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Ft(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(Ft(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(os("t",Ft(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;t.push(os("t",Ft(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function xz(e,t){var r=[],a=!1,n={},i=0;return e.replace(js,function(o,c){var d=rt(o);switch(Rn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),r}function uz(e,t,r){var a=[jr,Pe("ThreadedComments",null,{xmlns:Lr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(Pe("threadedComment",os("text",l.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function fz(e,t){var r=[],a=!1;return e.replace(js,function(i){var l=rt(i);switch(Rn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function hz(e){var t=[jr,Pe("personList",null,{xmlns:Lr.TCMNT,"xmlns:x":ko[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function mz(e){var t={};t.iauthor=e.read_shift(4);var r=Fo(e);return t.rfx=r.s,t.ref=et(r.s),e.l+=16,t}function gz(e,t){return t==null&&(t=Ae(36)),t.write_shift(4,e[1].iauthor),v0(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var pz=Es;function vz(e){return Qr(e.slice(0,54))}function bz(e,t){var r=[],a=[],n={},i=!1;return vi(e,function(o,c,d){switch(d){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function yz(e){var t=Ws(),r=[];return Be(t,628),Be(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Be(t,632,vz(n.a)))})}),Be(t,631),Be(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:lr(a[0]),e:lr(a[0])};Be(t,635,gz([i,n])),n.t&&n.t.length>0&&Be(t,637,zP(n)),Be(t,636),delete n.iauthor})}),Be(t,634),Be(t,629),t.end()}var wz="application/vnd.ms-office.vbaProject";function Ez(e){var t=Xe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Xe.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Xe.write(t)}function _z(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Xe.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var S3=["xlsb","xlsm","xlam","biff8","xla"];function jz(){return{"!type":"dialog"}}function Nz(){return{"!type":"dialog"}}function Cz(){return{"!type":"macro"}}function Az(){return{"!type":"macro"}}var kc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,x=l.length>0?parseInt(l,10)|0:0;return o?x+=t.c:--x,c?d+=t.r:--d,n+(o?"":"$")+ir(x)+(c?"":"$")+_r(d)}return function(n,i){return t=i,n.replace(e,r)}}(),zb=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qb=function(){return function(t,r){return t.replace(zb,function(a,n,i,l,o,c){var d=Db(l)-(i?0:r.c),x=kb(c)-(o?0:r.r),u=x==0?"":o?x+1:"["+x+"]",f=d==0?"":i?d+1:"["+d+"]";return n+"R"+u+"C"+f})}}();function B3(e,t){return e.replace(zb,function(r,a,n,i,l,o){return a+(n=="$"?n+i:ir(Db(i)+t.c))+(l=="$"?l+o:_r(kb(o)+t.r))})}function kz(e,t,r){var a=Ys(t),n=a.s,i=lr(r),l={r:i.r-n.r,c:i.c-n.c};return B3(e,l)}function Dz(e){return e.length!=1}function H4(e){return e.replace(/_xlfn\./g,"")}function Cr(e){e.l+=1}function nl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function F3(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return T3(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),l=nl(e),o=nl(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function T3(e){var t=nl(e),r=nl(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Sz(e,t,r){if(r.biff<8)return T3(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=nl(e),l=nl(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function M3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Bz(e);var a=e.read_shift(r&&r.biff==12?4:2),n=nl(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function Bz(e){var t=nl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Fz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Tz(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return Mz(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function Mz(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function Rz(e,t,r){var a=(e[e.l++]&96)>>5,n=F3(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function Oz(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=F3(e,i,r);return[a,n,l]}function Pz(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Lz(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function Iz(e,t,r){var a=(e[e.l++]&96)>>5,n=Sz(e,t-1,r);return[a,n]}function Uz(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function W4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function $z(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function zz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function qz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Vz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Hz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function R3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Wz(e){return e.read_shift(2),R3(e)}function Gz(e){return e.read_shift(2),R3(e)}function Yz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=M3(e,0,r);return[a,n]}function Xz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=Tz(e,0,r);return[a,n]}function Kz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=M3(e,0,r);return[a,n,i]}function Qz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[eV[n],L3[n],a]}function Jz(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Zz(e);return[n,(i[0]===0?L3:Zq)[i[1]]]}function Zz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function eq(e,t,r){e.l+=r&&r.biff==2?3:4}function tq(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function rq(e){return e.l++,bi[e.read_shift(1)]}function sq(e){return e.l++,e.read_shift(2)}function aq(e){return e.l++,e.read_shift(1)!==0}function nq(e){return e.l++,ps(e)}function iq(e,t,r){return e.l++,Hx(e,t-1,r)}function lq(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=bi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ps(e);break;case 2:r[1]=To(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function oq(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?Fo:nm)(e));return n}function cq(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=lq(e,r.biff);return l}function dq(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function xq(e,t,r){if(r.biff==5)return uq(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function uq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function fq(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function hq(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function mq(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function gq(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var pq=_s,vq=_s,bq=_s;function Gx(e,t,r){return e.l+=2,[Fz(e)]}function Vb(e){return e.l+=6,[]}var yq=Gx,wq=Vb,Eq=Vb,_q=Gx;function O3(e){return e.l+=2,[Dr(e),e.read_shift(2)&1]}var jq=Gx,Nq=O3,Cq=Vb,Aq=Gx,kq=Gx,Dq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Sq(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),l=Dq[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:n,C:i}}function Bq(e){return e.l+=2,[e.read_shift(4)]}function Fq(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Tq(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Mq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Rq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Oq(e){return e.l+=4,[0,0]}var G4={1:{n:"PtgExp",f:tq},2:{n:"PtgTbl",f:bq},3:{n:"PtgAdd",f:Cr},4:{n:"PtgSub",f:Cr},5:{n:"PtgMul",f:Cr},6:{n:"PtgDiv",f:Cr},7:{n:"PtgPower",f:Cr},8:{n:"PtgConcat",f:Cr},9:{n:"PtgLt",f:Cr},10:{n:"PtgLe",f:Cr},11:{n:"PtgEq",f:Cr},12:{n:"PtgGe",f:Cr},13:{n:"PtgGt",f:Cr},14:{n:"PtgNe",f:Cr},15:{n:"PtgIsect",f:Cr},16:{n:"PtgUnion",f:Cr},17:{n:"PtgRange",f:Cr},18:{n:"PtgUplus",f:Cr},19:{n:"PtgUminus",f:Cr},20:{n:"PtgPercent",f:Cr},21:{n:"PtgParen",f:Cr},22:{n:"PtgMissArg",f:Cr},23:{n:"PtgStr",f:iq},26:{n:"PtgSheet",f:Fq},27:{n:"PtgEndSheet",f:Tq},28:{n:"PtgErr",f:rq},29:{n:"PtgBool",f:aq},30:{n:"PtgInt",f:sq},31:{n:"PtgNum",f:nq},32:{n:"PtgArray",f:Uz},33:{n:"PtgFunc",f:Qz},34:{n:"PtgFuncVar",f:Jz},35:{n:"PtgName",f:dq},36:{n:"PtgRef",f:Yz},37:{n:"PtgArea",f:Rz},38:{n:"PtgMemArea",f:fq},39:{n:"PtgMemErr",f:pq},40:{n:"PtgMemNoMem",f:vq},41:{n:"PtgMemFunc",f:hq},42:{n:"PtgRefErr",f:mq},43:{n:"PtgAreaErr",f:Pz},44:{n:"PtgRefN",f:Xz},45:{n:"PtgAreaN",f:Iz},46:{n:"PtgMemAreaN",f:Mq},47:{n:"PtgMemNoMemN",f:Rq},57:{n:"PtgNameX",f:xq},58:{n:"PtgRef3d",f:Kz},59:{n:"PtgArea3d",f:Oz},60:{n:"PtgRefErr3d",f:gq},61:{n:"PtgAreaErr3d",f:Lz},255:{}},Pq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Lq={1:{n:"PtgElfLel",f:O3},2:{n:"PtgElfRw",f:Aq},3:{n:"PtgElfCol",f:yq},6:{n:"PtgElfRwV",f:kq},7:{n:"PtgElfColV",f:_q},10:{n:"PtgElfRadical",f:jq},11:{n:"PtgElfRadicalS",f:Cq},13:{n:"PtgElfColS",f:wq},15:{n:"PtgElfColSV",f:Eq},16:{n:"PtgElfRadicalLel",f:Nq},25:{n:"PtgList",f:Sq},29:{n:"PtgSxName",f:Bq},255:{}},Iq={0:{n:"PtgAttrNoop",f:Oq},1:{n:"PtgAttrSemi",f:Hz},2:{n:"PtgAttrIf",f:qz},4:{n:"PtgAttrChoose",f:$z},8:{n:"PtgAttrGoto",f:zz},16:{n:"PtgAttrSum",f:eq},32:{n:"PtgAttrBaxcel",f:W4},33:{n:"PtgAttrBaxcel",f:W4},64:{n:"PtgAttrSpace",f:Wz},65:{n:"PtgAttrSpaceSemi",f:Gz},128:{n:"PtgAttrIfError",f:Vz},255:{}};function Yx(e,t,r,a){if(a.biff<8)return _s(e,t);for(var n=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=cq(e,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=oq(e,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&i.push(_s(e,t)),i}function Xx(e,t,r){for(var a=e.l+t,n,i,l=[];a!=e.l;)t=a-e.l,i=e[e.l],n=G4[i]||G4[Pq[i]],(i===24||i===25)&&(n=(i===24?Lq:Iq)[e[e.l+1]]),!n||!n.f?_s(e,t):l.push([n.n,n.f(e,t,r)]);return l}function Uq(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var $q={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zq(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function P3(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Y4(e,t,r){var a=P3(e,t,r);return a=="#REF"?a:zq(a,r)}function ms(e,t,r,a,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],c,d,x,u=0,f=0,h,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",v=0,w=e[0].length;v<w;++v){var m=e[0][v];switch(m[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=xr(" ",e[0][g][1][1]);break;case 1:y=xr("\r",e[0][g][1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}d=d+y,g=-1}o.push(d+$q[m[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=yd(m[1][1],l,n),o.push(wd(x,i));break;case"PtgRefN":x=r?yd(m[1][1],r,n):m[1][1],o.push(wd(x,i));break;case"PtgRef3d":u=m[1][1],x=yd(m[1][2],l,n),p=Y4(a,u,n),o.push(p+"!"+wd(x,i));break;case"PtgFunc":case"PtgFuncVar":var b=m[1][0],_=m[1][1];b||(b=0),b&=127;var C=b==0?[]:o.slice(-b);o.length-=b,_==="User"&&(_=C.shift()),o.push(_+"("+C.join(",")+")");break;case"PtgBool":o.push(m[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(m[1]);break;case"PtgNum":o.push(String(m[1]));break;case"PtgStr":o.push('"'+m[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(m[1]);break;case"PtgAreaN":h=_4(m[1][1],r?{s:r}:l,n),o.push(yg(h,n));break;case"PtgArea":h=_4(m[1][1],l,n),o.push(yg(h,n));break;case"PtgArea3d":u=m[1][1],h=m[1][2],p=Y4(a,u,n),o.push(p+"!"+yg(h,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=m[1][2];var j=(a.names||[])[f-1]||(a[0]||[])[f],D=j?j.Name:"SH33TJSNAME"+String(f);D&&D.slice(0,6)=="_xlfn."&&!n.xlfn&&(D=D.slice(6)),o.push(D);break;case"PtgNameX":var R=m[1][1];f=m[1][2];var M;if(n.biff<=5)R<0&&(R=-R),a[R]&&(M=a[R][f]);else{var O="";if(((a[R]||[])[0]||[])[0]==14849||(((a[R]||[])[0]||[])[0]==1025?a[R][f]&&a[R][f].itab>0&&(O=a.SheetNames[a[R][f].itab-1]+"!"):O=a.SheetNames[f-1]+"!"),a[R]&&a[R][f])O+=a[R][f].Name;else if(a[0]&&a[0][f])O+=a[0][f].Name;else{var B=(P3(a,R,n)||"").split(";;");B[f-1]?O=B[f-1]:O+="SH33TJSERRX"}o.push(O);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var L="(",U=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:L=xr(" ",e[0][g][1][1])+L;break;case 3:L=xr("\r",e[0][g][1][1])+L;break;case 4:U=xr(" ",e[0][g][1][1])+U;break;case 5:U=xr("\r",e[0][g][1][1])+U;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(L+o.pop()+U);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":x={c:m[1][1],r:m[1][0]};var P={c:r.c,r:r.r};if(a.sharedf[et(x)]){var F=a.sharedf[et(x)];o.push(ms(F,l,P,a,n))}else{var N=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(x.c<d[0].s.c||x.c>d[0].e.c)&&!(x.r<d[0].s.r||x.r>d[0].e.r)){o.push(ms(d[1],l,P,a,n)),N=!0;break}N||o.push(m[1])}break;case"PtgArray":o.push("{"+Uq(m[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+m[1].idx+"[#"+m[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(m));default:throw new Error("Unrecognized Formula Token: "+String(m))}var T=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&g>=0&&T.indexOf(e[0][v][0])==-1){m=e[0][g];var S=!0;switch(m[1][0]){case 4:S=!1;case 0:y=xr(" ",m[1][1]);break;case 5:S=!1;case 1:y=xr("\r",m[1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+m[1][0])}o.push((S?y:"")+o.pop()+(S?"":y)),g=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function qq(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],_s(e,t-2)];var o=Xx(e,l,r);return t!==l+n&&(i=Yx(e,t-l-n,o,r)),e.l=a,[o,i]}function Vq(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],_s(e,t-2)];var o=Xx(e,l,r);return t!==l+n&&(i=Yx(e,t-l-n,o,r)),e.l=a,[o,i]}function Hq(e,t,r,a){var n=e.l+t,i=Xx(e,a,r),l;return n!==e.l&&(l=Yx(e,n-e.l,i,r)),[i,l]}function Wq(e,t,r){var a=e.l+t,n,i=e.read_shift(2),l=Xx(e,i,r);return i==65535?[[],_s(e,t-2)]:(t!==i+2&&(n=Yx(e,a-i-2,l,r)),[l,n])}function Gq(e){var t;if(ti(e,e.l+6)!==65535)return[ps(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Yq(e){if(e==null){var t=Ae(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ho(e);return ho(0)}function Ng(e,t,r){var a=e.l+t,n=On(e);r.biff==2&&++e.l;var i=Gq(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Vq(e,a-e.l,r);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function Xq(e,t,r,a,n){var i=go(t,r,n),l=Yq(e.v),o=Ae(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=Ae(e.bf.length),x=0;x<e.bf.length;++x)d[x]=e.bf[x];var u=Xr([i,l,o,d]);return u}function im(e,t,r){var a=e.read_shift(4),n=Xx(e,a,r),i=e.read_shift(4),l=i>0?Yx(e,i,n,r):null;return[n,l]}var Kq=im,lm=im,Qq=im,Jq=im,Zq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function X4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function tV(e){var t="of:="+e.replace(zb,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Cg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function rV(e){return e.replace(/\./,"!")}var _d={},Dc={},jd=typeof Map<"u";function Hb(e,t,r){var a=0,n=e.length;if(r){if(jd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=jd?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(jd?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function om(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(gs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=hx(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=ih(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Jl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function gl(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){ai(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function I3(e,t,r,a,n,i){try{a.cellNF&&(e.z=Ze[t])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ht(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Ze[t]==null&&ai(ZO[t]||"General",t),e.t==="e")e.w=e.w||bi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lx(e.v);else if(e.t==="d"){var l=$r(e.v);(l|0)===l?e.w=l.toString(10):e.w=lx(l)}else{if(e.v===void 0)return"";e.w=uo(e.v,Dc)}else e.t==="d"?e.w=Ua(t,$r(e.v),Dc):e.w=Ua(t,e.v,Dc)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=nh(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=nh(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function sV(e,t,r){if(e&&e["!ref"]){var a=Nt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function aV(e,t){var r=Nt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=lt(r))}var nV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,iV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,lV=/<(?:\w:)?hyperlink [^>]*>/mg,oV=/"(\w*:\w*)"/,cV=/<(?:\w:)?col\b[^>]*[\/]?>/g,dV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xV=/<(?:\w:)?pageMargins[^>]*\/>/g,U3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,uV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,fV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function hV(e,t,r,a,n,i,l){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",x="",u=e.match(iV);u?(d=e.slice(0,u.index),x=e.slice(u.index+u[0].length)):d=x=e;var f=d.match(U3);f?Wb(f[0],o,n,r):(f=d.match(uV))&&gV(f[0],f[1]||"",o,n,r);var h=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=d.slice(h,h+50).match(oV);p&&aV(o,p[1])}var g=d.match(fV);g&&g[1]&&DV(g[1],n);var y=[];if(t.cellStyles){var v=d.match(cV);v&&jV(y,v)}u&&FV(u[1],o,t,c,i,l);var w=x.match(dV);w&&(o["!autofilter"]=CV(w[0]));var m=[],b=x.match(nV);if(b)for(h=0;h!=b.length;++h)m[h]=Nt(b[h].slice(b[h].indexOf('"')+1));var _=x.match(lV);_&&wV(o,_,a);var C=x.match(xV);if(C&&(o["!margins"]=EV(rt(C[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=lt(c)),t.sheetRows>0&&o["!ref"]){var j=Nt(o["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>c.e.r&&(j.e.r=c.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>c.e.c&&(j.e.c=c.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),o["!fullref"]=o["!ref"],o["!ref"]=lt(j))}return y.length>0&&(o["!cols"]=y),m.length>0&&(o["!merges"]=m),o}function mV(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+lt(e[r])+'"/>';return t+"</mergeCells>"}function Wb(e,t,r,a){var n=rt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=jt(Rt(n.codeName)))}function gV(e,t,r,a,n){Wb(e.slice(0,e.indexOf(">")),r,a,n)}function pV(e,t,r,a,n){var i=!1,l={},o=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,l.codeName=yn(Ft(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+Pe("outlinePr",null,d)}!i&&!o||(n[n.length]=Pe("sheetPr",o,l))}var vV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],bV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yV(e){var t={sheet:1};return vV.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),bV.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Ib(e.password).toString(16).toUpperCase()),Pe("sheetProtection",null,t)}function wV(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var i=rt(Rt(t[n]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+jt(i.location))):(i.Target="#"+jt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Nt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var d=o.s.c;d<=o.e.c;++d){var x=et({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=i)}}}function EV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function _V(e){return Jl(e),Pe("pageMargins",null,e)}function jV(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=rt(t[a],!0);n.hidden&&(n.hidden=$t(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Ub(n.width)),al(n);i<=l;)e[i++]=Wt(n)}}function NV(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Pe("col",null,om(n,a)));return r[r.length]="</cols>",r.join("")}function CV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function AV(e,t,r,a){var n=typeof e.ref=="string"?e.ref:lt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Ys(n);l.s.r==l.e.r&&(l.e.r=Ys(t["!ref"]).e.r,n=lt(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Pe("autoFilter",null,{ref:n})}var kV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function DV(e,t){t.Views||(t.Views=[{}]),(e.match(kV)||[]).forEach(function(r,a){var n=rt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),$t(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function SV(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,n),{})}function BV(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=bi[e.v];break;case"d":a&&a.cellDates?n=Ht(e.v,-1).toISOString():(e=Wt(e),e.t="n",n=""+(e.v=$r(Ht(e.v)))),typeof e.z>"u"&&(e.z=Ze[14]);break;default:n=e.v;break}var o=os("v",Ft(n)),c={r:t},d=gl(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=os("v",""+Hb(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Pe("f",Ft(e.f),x)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Pe("c",o,c)}var FV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=ox("v"),l=ox("f");return function(c,d,x,u,f,h){for(var p=0,g="",y=[],v=[],w=0,m=0,b=0,_="",C,j,D=0,R=0,M,O,B=0,L=0,U=Array.isArray(h.CellXf),P,F=[],N=[],T=Array.isArray(d),S=[],z={},W=!1,k=!!x.sheetStubs,q=c.split(t),A=0,I=q.length;A!=I;++A){g=q[A].trim();var V=g.length;if(V!==0){var H=0;e:for(p=0;p<V;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(x&&x.cellStyles){if(j=rt(g.slice(H,p),!0),D=j.r!=null?parseInt(j.r,10):D+1,R=-1,x.sheetRows&&x.sheetRows<D)continue;z={},W=!1,j.ht&&(W=!0,z.hpt=parseFloat(j.ht),z.hpx=Xc(z.hpt)),j.hidden=="1"&&(W=!0,z.hidden=!0),j.outlineLevel!=null&&(W=!0,z.level=+j.outlineLevel),W&&(S[D-1]=z)}break;case"<":H=p;break}if(H>=p)break;if(j=rt(g.slice(H,p),!0),D=j.r!=null?parseInt(j.r,10):D+1,R=-1,!(x.sheetRows&&x.sheetRows<D)){u.s.r>D-1&&(u.s.r=D-1),u.e.r<D-1&&(u.e.r=D-1),x&&x.cellStyles&&(z={},W=!1,j.ht&&(W=!0,z.hpt=parseFloat(j.ht),z.hpx=Xc(z.hpt)),j.hidden=="1"&&(W=!0,z.hidden=!0),j.outlineLevel!=null&&(W=!0,z.level=+j.outlineLevel),W&&(S[D-1]=z)),y=g.slice(p).split(e);for(var Y=0;Y!=y.length&&y[Y].trim().charAt(0)=="<";++Y);for(y=y.slice(Y),p=0;p!=y.length;++p)if(g=y[p].trim(),g.length!==0){if(v=g.match(r),w=p,m=0,b=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(w=0,_=v[1],m=0;m!=_.length&&!((b=_.charCodeAt(m)-64)<1||b>26);++m)w=26*w+b;--w,R=w}else++R;for(m=0;m!=g.length&&g.charCodeAt(m)!==62;++m);if(++m,j=rt(g.slice(0,m),!0),j.r||(j.r=et({r:D-1,c:R})),_=g.slice(m),C={t:""},(v=_.match(i))!=null&&v[1]!==""&&(C.v=jt(v[1])),x.cellFormula){if((v=_.match(l))!=null&&v[1]!==""){if(C.f=jt(Rt(v[1])).replace(/\r\n/g,`
`),x.xlfn||(C.f=H4(C.f)),v[0].indexOf('t="array"')>-1)C.F=(_.match(n)||[])[1],C.F.indexOf(":")>-1&&F.push([Nt(C.F),C.F]);else if(v[0].indexOf('t="shared"')>-1){O=rt(v[0]);var Q=jt(Rt(v[1]));x.xlfn||(Q=H4(Q)),N[parseInt(O.si,10)]=[O,Q,j.r]}}else(v=_.match(/<f[^>]*\/>/))&&(O=rt(v[0]),N[O.si]&&(C.f=kz(N[O.si][1],N[O.si][2],j.r)));var te=lr(j.r);for(m=0;m<F.length;++m)te.r>=F[m][0].s.r&&te.r<=F[m][0].e.r&&te.c>=F[m][0].s.c&&te.c<=F[m][0].e.c&&(C.F=F[m][1])}if(j.t==null&&C.v===void 0)if(C.f||C.F)C.v=0,C.t="n";else if(k)C.t="z";else continue;else C.t=j.t||"n";switch(u.s.c>R&&(u.s.c=R),u.e.c<R&&(u.e.c=R),C.t){case"n":if(C.v==""||C.v==null){if(!k)continue;C.t="z"}else C.v=parseFloat(C.v);break;case"s":if(typeof C.v>"u"){if(!k)continue;C.t="z"}else M=_d[parseInt(C.v,10)],C.v=M.t,C.r=M.r,x.cellHTML&&(C.h=M.h);break;case"str":C.t="s",C.v=C.v!=null?Rt(C.v):"",x.cellHTML&&(C.h=jb(C.v));break;case"inlineStr":v=_.match(a),C.t="s",v!=null&&(M=Lb(v[1]))?(C.v=M.t,x.cellHTML&&(C.h=M.h)):C.v="";break;case"b":C.v=$t(C.v);break;case"d":x.cellDates?C.v=Ht(C.v,1):(C.v=$r(Ht(C.v,1)),C.t="n");break;case"e":(!x||x.cellText!==!1)&&(C.w=C.v),C.v=zj[C.v];break}if(B=L=0,P=null,U&&j.s!==void 0&&(P=h.CellXf[j.s],P!=null&&(P.numFmtId!=null&&(B=P.numFmtId),x.cellStyles&&P.fillId!=null&&(L=P.fillId))),I3(C,B,L,x,f,h),x.cellDates&&U&&C.t=="n"&&m0(Ze[B])&&(C.t="d",C.v=am(C.v)),j.cm&&x.xlmeta){var re=(x.xlmeta.Cell||[])[+j.cm-1];re&&re.type=="XLDAPR"&&(C.D=!0)}if(T){var X=lr(j.r);d[X.r]||(d[X.r]=[]),d[X.r][X.c]=C}else d[j.r]=C}}}}S.length>0&&(d["!rows"]=S)}}();function TV(e,t,r,a){var n=[],i=[],l=Nt(e["!ref"]),o="",c,d="",x=[],u=0,f=0,h=e["!rows"],p=Array.isArray(e),g={r:d},y,v=-1;for(f=l.s.c;f<=l.e.c;++f)x[f]=ir(f);for(u=l.s.r;u<=l.e.r;++u){for(i=[],d=_r(u),f=l.s.c;f<=l.e.c;++f){c=x[f]+d;var w=p?(e[u]||[])[f]:e[c];w!==void 0&&(o=BV(w,c,e,t))!=null&&i.push(o)}(i.length>0||h&&h[u])&&(g={r:d},h&&h[u]&&(y=h[u],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=mx(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),n[n.length]=Pe("row",i.join(""),g))}if(h)for(;u<h.length;++u)h&&h[u]&&(g={r:u+1},y=h[u],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=mx(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level),n[n.length]=Pe("row","",g));return n.join("")}function $3(e,t,r,a){var n=[jr,Pe("worksheet",null,{xmlns:ko[0],"xmlns:r":Lr.r})],i=r.SheetNames[e],l=0,o="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",x=Nt(d);if(x.e.c>16383||x.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),d=lt(x)}a||(a={}),c["!comments"]=[];var u=[];pV(c,r,e,t,n),n[n.length]=Pe("dimension",null,{ref:d}),n[n.length]=SV(c,t,e,r),t.sheetFormat&&(n[n.length]=Pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=NV(c,c["!cols"])),n[l=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=TV(c,t),o.length>0&&(n[n.length]=o)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),c["!protect"]&&(n[n.length]=yV(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=AV(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=mV(c["!merges"]));var f=-1,h,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(p=Bt(a,-1,Ft(g[1].Target).replace(/#.*$/,""),ft.HLINK),h["r:id"]="rId"+p),(f=g[1].Target.indexOf("#"))>-1&&(h.location=Ft(g[1].Target.slice(f+1))),g[1].Tooltip&&(h.tooltip=Ft(g[1].Tooltip)),n[n.length]=Pe("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=_V(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=os("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:d}))),u.length>0&&(p=Bt(a,-1,"../drawings/drawing"+(e+1)+".xml",ft.DRAW),n[n.length]=Pe("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=u),c["!comments"].length>0&&(p=Bt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ft.VML),n[n.length]=Pe("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function MV(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function RV(e,t,r){var a=Ae(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=mx(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var d={r:e,c:0},x=0;x<16;++x)if(!(t.s.c>x+1<<10||t.e.c<x<<10)){for(var u=-1,f=-1,h=x<<10;h<x+1<<10;++h){d.c=h;var p=Array.isArray(r)?(r[d.r]||[])[d.c]:r[et(d)];p&&(u<0&&(u=h),f=h)}u<0||(++o,a.write_shift(4,u),a.write_shift(4,f))}var g=a.l;return a.l=c,a.write_shift(4,o),a.l=g,a.length>a.l?a.slice(0,a.l):a}function OV(e,t,r,a){var n=RV(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&Be(e,0,n)}var PV=Fo,LV=v0;function IV(){}function UV(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=qP(e),r}function $V(e,t,r){r==null&&(r=Ae(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return rh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Pj(e,r),r.slice(0,r.l)}function zV(e){var t=$a(e);return[t]}function qV(e,t,r){return r==null&&(r=Ae(8)),Do(t,r)}function VV(e){var t=So(e);return[t]}function HV(e,t,r){return r==null&&(r=Ae(4)),Bo(t,r)}function WV(e){var t=$a(e),r=e.read_shift(1);return[t,r,"b"]}function GV(e,t,r){return r==null&&(r=Ae(9)),Do(t,r),r.write_shift(1,e.v?1:0),r}function YV(e){var t=So(e),r=e.read_shift(1);return[t,r,"b"]}function XV(e,t,r){return r==null&&(r=Ae(5)),Bo(t,r),r.write_shift(1,e.v?1:0),r}function KV(e){var t=$a(e),r=e.read_shift(1);return[t,r,"e"]}function QV(e,t,r){return r==null&&(r=Ae(9)),Do(t,r),r.write_shift(1,e.v),r}function JV(e){var t=So(e),r=e.read_shift(1);return[t,r,"e"]}function ZV(e,t,r){return r==null&&(r=Ae(8)),Bo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function eH(e){var t=$a(e),r=e.read_shift(4);return[t,r,"s"]}function tH(e,t,r){return r==null&&(r=Ae(12)),Do(t,r),r.write_shift(4,t.v),r}function rH(e){var t=So(e),r=e.read_shift(4);return[t,r,"s"]}function sH(e,t,r){return r==null&&(r=Ae(8)),Bo(t,r),r.write_shift(4,t.v),r}function aH(e){var t=$a(e),r=ps(e);return[t,r,"n"]}function nH(e,t,r){return r==null&&(r=Ae(16)),Do(t,r),ho(e.v,r),r}function z3(e){var t=So(e),r=ps(e);return[t,r,"n"]}function iH(e,t,r){return r==null&&(r=Ae(12)),Bo(t,r),ho(e.v,r),r}function lH(e){var t=$a(e),r=Tb(e);return[t,r,"n"]}function oH(e,t,r){return r==null&&(r=Ae(12)),Do(t,r),Lj(e.v,r),r}function cH(e){var t=So(e),r=Tb(e);return[t,r,"n"]}function dH(e,t,r){return r==null&&(r=Ae(8)),Bo(t,r),Lj(e.v,r),r}function xH(e){var t=$a(e),r=Sb(e);return[t,r,"is"]}function uH(e){var t=$a(e),r=Es(e);return[t,r,"str"]}function fH(e,t,r){return r==null&&(r=Ae(12+4*e.v.length)),Do(t,r),Qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hH(e){var t=So(e),r=Es(e);return[t,r,"str"]}function mH(e,t,r){return r==null&&(r=Ae(8+4*e.v.length)),Bo(t,r),Qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function gH(e,t,r){var a=e.l+t,n=$a(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"b"];if(r.cellFormula){e.l+=2;var o=lm(e,a-e.l,r);l[3]=ms(o,null,n,r.supbooks,r)}else e.l=a;return l}function pH(e,t,r){var a=e.l+t,n=$a(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"e"];if(r.cellFormula){e.l+=2;var o=lm(e,a-e.l,r);l[3]=ms(o,null,n,r.supbooks,r)}else e.l=a;return l}function vH(e,t,r){var a=e.l+t,n=$a(e);n.r=r["!row"];var i=ps(e),l=[n,i,"n"];if(r.cellFormula){e.l+=2;var o=lm(e,a-e.l,r);l[3]=ms(o,null,n,r.supbooks,r)}else e.l=a;return l}function bH(e,t,r){var a=e.l+t,n=$a(e);n.r=r["!row"];var i=Es(e),l=[n,i,"str"];if(r.cellFormula){e.l+=2;var o=lm(e,a-e.l,r);l[3]=ms(o,null,n,r.supbooks,r)}else e.l=a;return l}var yH=Fo,wH=v0;function EH(e,t){return t==null&&(t=Ae(4)),t.write_shift(4,e),t}function _H(e,t){var r=e.l+t,a=Fo(e),n=Bb(e),i=Es(e),l=Es(e),o=Es(e);e.l=r;var c={rfx:a,relId:n,loc:i,display:o};return l&&(c.Tooltip=l),c}function jH(e,t){var r=Ae(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));v0({s:lr(e[0]),e:lr(e[0])},r),Fb("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Qr(n||"",r),Qr(e[1].Tooltip||"",r),Qr("",r),r.slice(0,r.l)}function NH(){}function CH(e,t,r){var a=e.l+t,n=Ij(e),i=e.read_shift(1),l=[n];if(l[2]=i,r.cellFormula){var o=Kq(e,a-e.l,r);l[1]=o}else e.l=a;return l}function AH(e,t,r){var a=e.l+t,n=Fo(e),i=[n];if(r.cellFormula){var l=Jq(e,a-e.l,r);i[1]=l,e.l=a}else e.l=a;return i}function kH(e,t,r){r==null&&(r=Ae(18));var a=om(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var q3=["left","right","top","bottom","header","footer"];function DH(e){var t={};return q3.forEach(function(r){t[r]=ps(e)}),t}function SH(e,t){return t==null&&(t=Ae(6*8)),Jl(e),q3.forEach(function(r){ho(e[r],t)}),t}function BH(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function FH(e,t,r){r==null&&(r=Ae(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function TH(e){var t=Ae(24);return t.write_shift(4,4),t.write_shift(4,1),v0(e,t),t}function MH(e,t){return t==null&&(t=Ae(16*4+2)),t.write_shift(2,e.password?Ib(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function RH(){}function OH(){}function PH(e,t,r,a,n,i,l){if(!e)return e;var o=t||{};a||(a={"!id":{}});var c=o.dense?[]:{},d,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,f=!1,h,p,g,y,v,w,m,b,_,C=[];o.biff=12,o["!row"]=0;var j=0,D=!1,R=[],M={},O=o.supbooks||n.supbooks||[[]];if(O.sharedf=M,O.arrayf=R,O.SheetNames=n.SheetNames||n.Sheets.map(function(T){return T.name}),!o.supbooks&&(o.supbooks=O,n.Names))for(var B=0;B<n.Names.length;++B)O[0][B+1]=n.Names[B];var L=[],U=[],P=!1;gx[16]={n:"BrtShortReal",f:z3};var F;if(vi(e,function(S,z,W){if(!f)switch(W){case 148:d=S;break;case 0:h=S,o.sheetRows&&o.sheetRows<=h.r&&(f=!0),b=_r(y=h.r),o["!row"]=h.r,(S.hidden||S.hpt||S.level!=null)&&(S.hpt&&(S.hpx=Xc(S.hpt)),U[S.r]=S);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:S[2]},S[2]){case"n":p.v=S[1];break;case"s":m=_d[S[1]],p.v=m.t,p.r=m.r;break;case"b":p.v=!!S[1];break;case"e":p.v=S[1],o.cellText!==!1&&(p.w=bi[p.v]);break;case"str":p.t="s",p.v=S[1];break;case"is":p.t="s",p.v=S[1].t;break}if((g=l.CellXf[S[0].iStyleRef])&&I3(p,g.numFmtId,null,o,i,l),v=S[0].c==-1?v+1:S[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=p):c[ir(v)+b]=p,o.cellFormula){for(D=!1,j=0;j<R.length;++j){var k=R[j];h.r>=k[0].s.r&&h.r<=k[0].e.r&&v>=k[0].s.c&&v<=k[0].e.c&&(p.F=lt(k[0]),D=!0)}!D&&S.length>3&&(p.f=S[3])}if(x.s.r>h.r&&(x.s.r=h.r),x.s.c>v&&(x.s.c=v),x.e.r<h.r&&(x.e.r=h.r),x.e.c<v&&(x.e.c=v),o.cellDates&&g&&p.t=="n"&&m0(Ze[g.numFmtId])){var q=Pl(p.v);q&&(p.t="d",p.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}F&&(F.type=="XLDAPR"&&(p.D=!0),F=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;p={t:"z",v:void 0},v=S[0].c==-1?v+1:S[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=p):c[ir(v)+b]=p,x.s.r>h.r&&(x.s.r=h.r),x.s.c>v&&(x.s.c=v),x.e.r<h.r&&(x.e.r=h.r),x.e.c<v&&(x.e.c=v),F&&(F.type=="XLDAPR"&&(p.D=!0),F=void 0);break;case 176:C.push(S);break;case 49:F=((o.xlmeta||{}).Cell||[])[S-1];break;case 494:var A=a["!id"][S.relId];for(A?(S.Target=A.Target,S.loc&&(S.Target+="#"+S.loc),S.Rel=A):S.relId==""&&(S.Target="#"+S.loc),y=S.rfx.s.r;y<=S.rfx.e.r;++y)for(v=S.rfx.s.c;v<=S.rfx.e.c;++v)o.dense?(c[y]||(c[y]=[]),c[y][v]||(c[y][v]={t:"z",v:void 0}),c[y][v].l=S):(w=et({c:v,r:y}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=S);break;case 426:if(!o.cellFormula)break;R.push(S),_=o.dense?c[y][v]:c[ir(v)+b],_.f=ms(S[1],x,{r:h.r,c:v},O,o),_.F=lt(S[0]);break;case 427:if(!o.cellFormula)break;M[et(S[0].s)]=S[1],_=o.dense?c[y][v]:c[ir(v)+b],_.f=ms(S[1],x,{r:h.r,c:v},O,o);break;case 60:if(!o.cellStyles)break;for(;S.e>=S.s;)L[S.e--]={width:S.w/256,hidden:!!(S.flags&1),level:S.level},P||(P=!0,Ub(S.w/256)),al(L[S.e+1]);break;case 161:c["!autofilter"]={ref:lt(S)};break;case 476:c["!margins"]=S;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),S.name&&(n.Sheets[r].CodeName=S.name),(S.above||S.left)&&(c["!outline"]={above:S.above,left:S.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),S.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!z.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(x.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=lt(d||x)),o.sheetRows&&c["!ref"]){var N=Nt(c["!ref"]);o.sheetRows<=+N.e.r&&(N.e.r=o.sheetRows-1,N.e.r>x.e.r&&(N.e.r=x.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>x.e.c&&(N.e.c=x.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),c["!fullref"]=c["!ref"],c["!ref"]=lt(N))}return C.length>0&&(c["!merges"]=C),L.length>0&&(c["!cols"]=L),U.length>0&&(c["!rows"]=U),c}function LH(e,t,r,a,n,i,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Wt(t),t.z=t.z||Ze[14],t.v=$r(Ht(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:a};switch(c.s=gl(n.cellXfs,t,n),t.l&&i["!links"].push([et(c),t.l]),t.c&&i["!comments"].push([et(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=Hb(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,l?Be(e,18,sH(t,c)):Be(e,7,tH(t,c))):(c.t="str",l?Be(e,17,mH(t,c)):Be(e,6,fH(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Be(e,13,dH(t,c)):Be(e,2,oH(t,c)):l?Be(e,16,iH(t,c)):Be(e,5,nH(t,c)),!0;case"b":return c.t="b",l?Be(e,15,XV(t,c)):Be(e,4,GV(t,c)),!0;case"e":return c.t="e",l?Be(e,14,ZV(t,c)):Be(e,3,QV(t,c)),!0}return l?Be(e,12,HV(t,c)):Be(e,1,qV(t,c)),!0}function IH(e,t,r,a){var n=Nt(t["!ref"]||"A1"),i,l="",o=[];Be(e,145);var c=Array.isArray(t),d=n.e.r;t["!rows"]&&(d=Math.max(n.e.r,t["!rows"].length-1));for(var x=n.s.r;x<=d;++x){l=_r(x),OV(e,t,n,x);var u=!1;if(x<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){x===n.s.r&&(o[f]=ir(f)),i=o[f]+l;var h=c?(t[x]||[])[f]:t[i];if(!h){u=!1;continue}u=LH(e,h,x,f,a,t,u)}}Be(e,146)}function UH(e,t){!t||!t["!merges"]||(Be(e,177,EH(t["!merges"].length)),t["!merges"].forEach(function(r){Be(e,176,wH(r))}),Be(e,178))}function $H(e,t){!t||!t["!cols"]||(Be(e,390),t["!cols"].forEach(function(r,a){r&&Be(e,60,kH(a,r))}),Be(e,391))}function zH(e,t){!t||!t["!ref"]||(Be(e,648),Be(e,649,TH(Nt(t["!ref"]))),Be(e,650))}function qH(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Bt(r,-1,a[1].Target.replace(/#.*$/,""),ft.HLINK);Be(e,494,jH(a,n))}}),delete t["!links"]}function VH(e,t,r,a){if(t["!comments"].length>0){var n=Bt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ft.VML);Be(e,551,Fb("rId"+n)),t["!legacy"]=n}}function HH(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:lt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Ys(i);o.s.r==o.e.r&&(o.e.r=Ys(t["!ref"]).e.r,i=lt(o));for(var c=0;c<l.length;++c){var d=l[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),Be(e,161,v0(Nt(i))),Be(e,162)}}function WH(e,t,r){Be(e,133),Be(e,137,FH(t,r)),Be(e,138),Be(e,134)}function GH(e,t){t["!protect"]&&Be(e,535,MH(t["!protect"]))}function YH(e,t,r,a){var n=Ws(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Nt(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Be(n,129),(r.vbaraw||l["!outline"])&&Be(n,147,$V(o,l["!outline"])),Be(n,148,LV(c)),WH(n,l,r.Workbook),$H(n,l),IH(n,l,e,t),GH(n,l),HH(n,l,r,e),UH(n,l),qH(n,l,a),l["!margins"]&&Be(n,476,SH(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&zH(n,l),VH(n,l,e,a),Be(n,130),n.end()}function XH(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=jt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,n,a]}function KH(e,t,r,a,n,i){var l=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,d="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var f=XH(u);x.s.r=x.s.c=0,x.e.c=o,d=ir(o),f[0].forEach(function(h,p){l[d+_r(p)]={t:"n",v:h,z:f[1]},c=p}),x.e.r<c&&(x.e.r=c),++o}),o>0&&(l["!ref"]=lt(x)),l}function QH(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(U3);return o&&Wb(o[0],i,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function JH(e,t){e.l+=10;var r=Es(e);return{name:r}}function ZH(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return vi(e,function(c,d,x){switch(x){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Gb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eW=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tW=[],rW=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function K4(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var i=t[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=$t(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Q4(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=$t(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function V3(e){Q4(e.WBProps,Gb),Q4(e.CalcPr,rW),K4(e.WBView,eW),K4(e.Sheets,tW),Dc.date1904=$t(e.WBProps.date1904)}function sW(e){return!e.Workbook||!e.Workbook.WBProps?"false":$t(e.Workbook.WBProps.date1904)?"true":"false"}var aW="][*?/\\".split("");function H3(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return aW.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function nW(e,t,r){e.forEach(function(a,n){H3(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[n]&&t[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function iW(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];nW(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)sV(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var lW=/<\w+:workbook/;function oW(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},l=0;if(e.replace(js,function(c,d){var x=rt(c);switch(Rn(x[0])){case"<?xml":break;case"<workbook":c.match(lW)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=x[n];break;case"</workbook>":break;case"<fileVersion":delete x[0],r.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Gb.forEach(function(u){if(x[u[0]]!=null)switch(u[2]){case"bool":r.WBProps[u[0]]=$t(x[u[0]]);break;case"int":r.WBProps[u[0]]=parseInt(x[u[0]],10);break;default:r.WBProps[u[0]]=x[u[0]]}}),x.codeName&&(r.WBProps.CodeName=Rt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],r.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=jt(Rt(x.name)),delete x[0],r.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Rt(x.name),x.comment&&(i.Comment=x.comment),x.localSheetId&&(i.Sheet=+x.localSheetId),$t(x.hidden||"0")&&(i.Hidden=!0),l=d+c.length;break;case"</definedName>":i.Ref=jt(Rt(e.slice(l,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete x[0],r.CalcPr=x;break;case"<calcPr/>":delete x[0],r.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return c}),ko.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return V3(r),r}function W3(e){var t=[jr];t[t.length]=Pe("workbook",null,{xmlns:ko[0],"xmlns:r":Lr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Gb.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Pe("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:Ft(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Pe("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Pe("definedName",Ft(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function cW(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=v1(e),r.name=Es(e),r}function dW(e,t){return t||(t=Ae(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Fb(e.strRelID,t),Qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function xW(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Es(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function uW(e,t){t||(t=Ae(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Pj(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fW(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function hW(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=VP(e),l=Qq(e,0,r),o=Bb(e);e.l=a;var c={Name:i,Ptg:l};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function mW(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],gx[16]={n:"BrtFRTArchID$",f:fW},vi(e,function(c,d,x){switch(x){case 156:l.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=ms(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([x,c]):l[0]=[x,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(x),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(x),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},t),V3(r),r.Names=i,r.supbooks=l,r}function gW(e,t){Be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Be(e,156,dW(n))}Be(e,144)}function pW(e,t){t||(t=Ae(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Qr("SheetJS",t),Qr(Xf.version,t),Qr(Xf.version,t),Qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function vW(e,t){t||(t=Ae(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function bW(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(Be(e,135),Be(e,158,vW(n)),Be(e,136))}}function yW(e,t){var r=Ws();return Be(r,131),Be(r,128,pW()),Be(r,153,uW(e.Workbook&&e.Workbook.WBProps||null)),bW(r,e),gW(r,e),Be(r,132),r.end()}function wW(e,t,r){return t.slice(-4)===".bin"?mW(e,r):oW(e,r)}function EW(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?PH(e,a,r,n,i,l,o):hV(e,a,r,n,i,l,o)}function _W(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?ZH(e,a,r,n,i):QH(e,a,r,n,i)}function jW(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?Cz():Az()}function NW(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?jz():Nz()}function CW(e,t,r,a){return t.slice(-4)===".bin"?w$(e,r,a):c$(e,r,a)}function AW(e,t,r){return C3(e,r)}function kW(e,t,r){return t.slice(-4)===".bin"?kU(e,r):NU(e,r)}function DW(e,t,r){return t.slice(-4)===".bin"?bz(e,r):dz(e,r)}function SW(e,t,r){return t.slice(-4)===".bin"?lz(e):nz(e)}function BW(e,t,r,a){return r.slice(-4)===".bin"?oz(e,t,r,a):void 0}function FW(e,t,r){return t.slice(-4)===".bin"?rz(e,t,r):az(e,t,r)}function TW(e,t,r){return(t.slice(-4)===".bin"?yW:W3)(e)}function MW(e,t,r,a,n){return(t.slice(-4)===".bin"?YH:$3)(e,r,a,n)}function RW(e,t,r){return(t.slice(-4)===".bin"?B$:j3)(e,r)}function OW(e,t,r){return(t.slice(-4)===".bin"?BU:g3)(e,r)}function PW(e,t,r){return(t.slice(-4)===".bin"?yz:D3)(e)}function LW(e){return(e.slice(-4)===".bin"?sz:A3)()}var G3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Y3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qa(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(G3),i,l,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(Y3),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),a[o]=i[2].slice(1,i[2].length-1));return a}function IW(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(G3),n,i,l,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(Y3),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),r[l]=n[2].slice(1,n[2].length-1));return r}var Nd;function UW(e,t){var r=Nd[e]||jt(e);return r==="General"?uo(t):Ua(r,t)}function $W(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=$t(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ht(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[jt(t)]=n}function zW(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||bi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lx(e.v):e.w=uo(e.v):e.w=UW(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Nd[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&m0(a)){var n=Pl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function qW(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=t$[a.Pattern]||a.Pattern)}e[t.ID]=t}function VW(e,t,r,a,n,i,l,o,c,d){var x="General",u=a.StyleID,f={};d=d||{};var h=[],p=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&l&&(u=l.StyleID);i[u]!==void 0&&(i[u].nf&&(x=i[u].nf),i[u].Interior&&h.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=$t(e);break;case"String":a.t="s",a.r=h4(jt(e)),a.v=e.indexOf("<")>-1?jt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Ht(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=jt(e):a.v<60&&(a.v=a.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=zj[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=h4(t||e));break}if(zW(a,x,d),d.cellFormula!==!1)if(a.Formula){var g=jt(a.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),a.f=kc(g,n),delete a.Formula,a.ArrayRange=="RC"?a.F=kc("RC:RC",n):a.ArrayRange&&(a.F=kc(a.ArrayRange,n),c.push([Nt(a.F),a.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(a.F=c[p][1]);d.cellStyles&&(h.forEach(function(y){!f.patternType&&y.patternType&&(f.patternType=y.patternType)}),a.s=f),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function HW(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ag(e,t){var r=t||{};g0();var a=X0(Nb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Rt(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=Wt(r);return l.type="string",Yc.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(fe){n.indexOf("<"+fe)>=0&&(i=!0)}),i)return SG(a,r);Nd={"General Number":"General","General Date":Ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ze[15],"Short Date":Ze[14],"Long Time":Ze[19],"Medium Time":Ze[18],"Short Time":Ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ze[2],Standard:Ze[4],Percent:Ze[10],Scientific:Ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],d,x={},u=[],f=r.dense?[]:{},h="",p={},g={},y=qa('<Data ss:Type="String">'),v=0,w=0,m=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},C={},j="",D=0,R=[],M={},O={},B=0,L=[],U=[],P={},F=[],N,T=!1,S=[],z=[],W={},k=0,q=0,A={Sheets:[],WBProps:{date1904:!1}},I={};dx.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var V="";o=dx.exec(a);)switch(o[3]=(V=o[3]).toLowerCase()){case"data":if(V=="data"){if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?VW(a.slice(v,o.index),j,y,c[c.length-1][0]=="comment"?P:p,{c:w,r:m},_,F[w],g,S,r):(j="",y=qa(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(U.length>0&&(p.c=U),(!r.sheetRows||r.sheetRows>m)&&p.v!==void 0&&(r.dense?(f[m]||(f[m]=[]),f[m][w]=p):f[ir(w)+_r(m)]=p),p.HRef&&(p.l={Target:jt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(k=w+(parseInt(p.MergeAcross,10)|0),q=m+(parseInt(p.MergeDown,10)|0),R.push({s:{c:w,r:m},e:{c:k,r:q}})),!r.sheetStubs)p.MergeAcross?w=k+1:++w;else if(p.MergeAcross||p.MergeDown){for(var H=w;H<=k;++H)for(var Y=m;Y<=q;++Y)(H>w||Y>m)&&(r.dense?(f[Y]||(f[Y]=[]),f[Y][H]={t:"z"}):f[ir(H)+_r(Y)]={t:"z"});w=k+1}else++w;else p=IW(o[0]),p.Index&&(w=+p.Index-1),w<b.s.c&&(b.s.c=w),w>b.e.c&&(b.e.c=w),o[0].slice(-2)==="/>"&&++w,U=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(m<b.s.r&&(b.s.r=m),m>b.e.r&&(b.e.r=m),o[0].slice(-2)==="/>"&&(g=qa(o[0]),g.Index&&(m=+g.Index-1)),w=0,++m):(g=qa(o[0]),g.Index&&(m=+g.Index-1),W={},(g.AutoFitHeight=="0"||g.Height)&&(W.hpx=parseInt(g.Height,10),W.hpt=mx(W.hpx),z[m]=W),g.Hidden=="1"&&(W.hidden=!0,z[m]=W));break;case"worksheet":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));u.push(h),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(f["!ref"]=lt(b),r.sheetRows&&r.sheetRows<=b.e.r&&(f["!fullref"]=f["!ref"],b.e.r=r.sheetRows-1,f["!ref"]=lt(b))),R.length&&(f["!merges"]=R),F.length>0&&(f["!cols"]=F),z.length>0&&(f["!rows"]=z),x[h]=f}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=w=0,c.push([o[3],!1]),d=qa(o[0]),h=jt(d.Name),f=r.dense?[]:{},R=[],S=[],z=[],I={name:h,Hidden:0},A.Sheets.push(I);break;case"table":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),F=[],T=!1}break;case"style":o[1]==="/"?qW(_,C,r):C=qa(o[0]);break;case"numberformat":C.nf=jt(qa(o[0]).Format||"General"),Nd[C.nf]&&(C.nf=Nd[C.nf]);for(var Q=0;Q!=392&&Ze[Q]!=C.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Ze[Q]==null){ai(C.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(N=qa(o[0]),N.Hidden&&(N.hidden=!0,delete N.Hidden),N.Width&&(N.wpx=parseInt(N.Width,10)),!T&&N.wpx>10){T=!0,gs=E3;for(var te=0;te<F.length;++te)F[te]&&al(F[te])}T&&al(N),F[N.Index-1||F.length]=N;for(var re=0;re<+N.Span;++re)F[F.length]=Wt(N);break;case"namedrange":if(o[1]==="/")break;A.Names||(A.Names=[]);var X=rt(o[0]),je={Name:X.Name,Ref:kc(X.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(je.Sheet=A.Sheets.length-1),A.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?j+=a.slice(D,o.index):D=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;C.Interior=qa(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?mL(M,V,a.slice(B,o.index)):B=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));HW(P),U.push(P)}else c.push([o[3],!1]),d=qa(o[0]),P={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var J=qa(o[0]);f["!autofilter"]={ref:kc(J.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return r8(a,r);var ue=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ue=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ue=!1}break;case"excelworkbook":switch(o[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ue=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ue=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(B,o.index)){case"SheetHidden":I.Hidden=1;break;case"SheetVeryHidden":I.Hidden=2;break}else B=o.index+o[0].length;break;case"header":f["!margins"]||Jl(f["!margins"]={},"xlml"),isNaN(+rt(o[0]).Margin)||(f["!margins"].header=+rt(o[0]).Margin);break;case"footer":f["!margins"]||Jl(f["!margins"]={},"xlml"),isNaN(+rt(o[0]).Margin)||(f["!margins"].footer=+rt(o[0]).Margin);break;case"pagemargins":var de=rt(o[0]);f["!margins"]||Jl(f["!margins"]={},"xlml"),isNaN(+de.Top)||(f["!margins"].top=+de.Top),isNaN(+de.Left)||(f["!margins"].left=+de.Left),isNaN(+de.Right)||(f["!margins"].right=+de.Right),isNaN(+de.Bottom)||(f["!margins"].bottom=+de.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ue=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ue=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ue=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ue=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ue=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ue=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ue=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ue=!1}break;case"smarttags":break;default:ue=!1;break}if(ue||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$W(O,V,L,a.slice(B,o.index)):(L=o,B=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ce={};return!r.bookSheets&&!r.bookProps&&(ce.Sheets=x),ce.SheetNames=u,ce.Workbook=A,ce.SSF=Wt(Ze),ce.Props=M,ce.Custprops=O,ce}function N1(e,t){switch(Xb(t=t||{}),t.type||"base64"){case"base64":return Ag(ca(e),t);case"binary":case"buffer":case"file":return Ag(e,t);case"array":return Ag(hl(e),t)}}function WW(e,t){var r=[];return e.Props&&r.push(gL(e.Props,t)),e.Custprops&&r.push(pL(e.Props,e.Custprops)),r.join("")}function GW(){return""}function YW(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(Pe("NumberFormat",null,{"ss:Format":Ft(Ze[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(Pe("Style",i.join(""),l))}),Pe("Styles",r.join(""))}function X3(e){return Pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+qb(e.Ref,{r:0,c:0})})}function XW(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(X3(n)))}return Pe("Names",r.join(""))}function KW(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],l=0;l<n.length;++l){var o=n[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(X3(o)))}return i.join("")}function QW(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Pe("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Pe("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(os("ProtectContents","True")),e["!protect"].objects&&n.push(os("ProtectObjects","True")),e["!protect"].scenarios&&n.push(os("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(os("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(os("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Pe("WorksheetOptions",n.join(""),{xmlns:ea.x})}function JW(e){return e.map(function(t){var r=bP(t.t||""),a=Pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",a,{"ss:Author":t.a})}).join("")}function ZW(e,t,r,a,n,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ft(qb(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=lr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ft(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ft(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],x=0;x!=d.length;++x)d[x].s.c!=l.c||d[x].s.r!=l.r||(d[x].e.c>d[x].s.c&&(o["ss:MergeAcross"]=d[x].e.c-d[x].s.c),d[x].e.r>d[x].s.r&&(o["ss:MergeDown"]=d[x].e.r-d[x].s.r));var u="",f="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",f=String(e.v);break;case"b":u="Boolean",f=e.v?"1":"0";break;case"e":u="Error",f=bi[e.v];break;case"d":u="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ze[14]);break;case"s":u="String",f=vP(e.v||"");break}var h=gl(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=l.c+1;var p=e.v!=null?f:"",g=e.t=="z"?"":'<Data ss:Type="'+u+'">'+p+"</Data>";return(e.c||[]).length>0&&(g+=JW(e.c)),Pe("Cell",g,o)}function eG(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Xc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tG(e,t,r,a){if(!e["!ref"])return"";var n=Nt(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,v){al(y);var w=!!y.width,m=om(v,y),b={"ss:Index":v+1};w&&(b["ss:Width"]=fx(m.width)),y.hidden&&(b["ss:Hidden"]="1"),o.push(Pe("Column",null,b))});for(var c=Array.isArray(e),d=n.s.r;d<=n.e.r;++d){for(var x=[eG(d,(e["!rows"]||[])[d])],u=n.s.c;u<=n.e.c;++u){var f=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>u)&&!(i[l].s.r>d)&&!(i[l].e.c<u)&&!(i[l].e.r<d)){(i[l].s.c!=u||i[l].s.r!=d)&&(f=!0);break}if(!f){var h={r:d,c:u},p=et(h),g=c?(e[d]||[])[u]:e[p];x.push(ZW(g,p,e,t,r,a,h))}}x.push("</Row>"),x.length>2&&o.push(x.join(""))}return o.join("")}function rG(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],l=i?KW(i,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?tG(i,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(QW(i,t,e,r)),a.join("")}function sG(e,t){t||(t={}),e.SSF||(e.SSF=Wt(Ze)),e.SSF&&(g0(),tm(e.SSF),t.revssf=sm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gl(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(WW(e,t)),r.push(GW()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Pe("Worksheet",rG(a,t,e),{"ss:Name":Ft(e.SheetNames[a])}));return r[2]=YW(e,t),r[3]=XW(e),jr+Pe("Workbook",r.join(""),{xmlns:ea.ss,"xmlns:o":ea.o,"xmlns:x":ea.x,"xmlns:ss":ea.ss,"xmlns:dt":ea.dt,"xmlns:html":ea.html})}function aG(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=XP(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=KP(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nG=[60,1084,2066,2165,2175];function iG(e,t,r,a,n){var i=a,l=[],o=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),r.l+=i;for(var c=ti(r,r.l),d=C1[c],x=0;d!=null&&nG.indexOf(c)>-1;)i=ti(r,r.l+2),x=r.l+4,c==2066?x+=4:(c==2165||c==2175)&&(x+=12),o=r.slice(x,r.l+4+i),l.push(o),r.l+=4+i,d=C1[c=ti(r,r.l)];var u=Xr(l);is(u,0);var f=0;u.lens=[];for(var h=0;h<l.length;++h)u.lens.push(f),f+=l[h].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,n)}function xn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ze[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||bi[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lx(e.v):e.w=uo(e.v):e.w=Ua(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&m0(Ze[a]||String(a))){var n=Pl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Lu(e,t,r){return{v:e,ixfe:t,t:r}}function lG(e,t){var r={opts:{}},a={},n=t.dense?[]:{},i={},l={},o=null,c=[],d="",x={},u,f="",h,p,g,y,v={},w=[],m,b,_=[],C=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},R=function(Ue){return Ue<8?Xl[Ue]:Ue<64&&C[Ue-8]||Xl[Ue]},M=function(Ue,He,pt){var Je=He.XF.data;if(!(!Je||!Je.patternType||!pt||!pt.cellStyles)){He.s={},He.s.patternType=Je.patternType;var Jt;(Jt=ux(R(Je.icvFore)))&&(He.s.fgColor={rgb:Jt}),(Jt=ux(R(Je.icvBack)))&&(He.s.bgColor={rgb:Jt})}},O=function(Ue,He,pt){if(!(W>1)&&!(pt.sheetRows&&Ue.r>=pt.sheetRows)){if(pt.cellStyles&&He.XF&&He.XF.data&&M(Ue,He,pt),delete He.ixfe,delete He.XF,u=Ue,f=et(Ue),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<l.s.r&&(l.s.r=Ue.r),Ue.c<l.s.c&&(l.s.c=Ue.c),Ue.r+1>l.e.r&&(l.e.r=Ue.r+1),Ue.c+1>l.e.c&&(l.e.c=Ue.c+1),pt.cellFormula&&He.f){for(var Je=0;Je<w.length;++Je)if(!(w[Je][0].s.c>Ue.c||w[Je][0].s.r>Ue.r)&&!(w[Je][0].e.c<Ue.c||w[Je][0].e.r<Ue.r)){He.F=lt(w[Je][0]),(w[Je][0].s.c!=Ue.c||w[Je][0].s.r!=Ue.r)&&delete He.f,He.f&&(He.f=""+ms(w[Je][1],l,Ue,S,B));break}}pt.dense?(n[Ue.r]||(n[Ue.r]=[]),n[Ue.r][Ue.c]=He):n[f]=He}},B={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(B.password=t.password);var L,U=[],P=[],F=[],N=[],T=!1,S=[];S.SheetNames=B.snames,S.sharedf=B.sharedf,S.arrayf=B.arrayf,S.names=[],S.XTI=[];var z=0,W=0,k=0,q=[],A=[],I;B.codepage=1200,Qa(1200);for(var V=!1;e.l<e.length-1;){var H=e.l,Y=e.read_shift(2);if(Y===0&&z===10)break;var Q=e.l===e.length?0:e.read_shift(2),te=C1[Y];if(te&&te.f){if(t.bookSheets&&z===133&&Y!==133)break;if(z=Y,te.r===2||te.r==12){var re=e.read_shift(2);if(Q-=2,!B.enc&&re!==Y&&((re&255)<<8|re>>8)!==Y)throw new Error("rt mismatch: "+re+"!="+Y);te.r==12&&(e.l+=10,Q-=10)}var X={};if(Y===10?X=te.f(e,Q,B):X=iG(Y,te,e,Q,B),W==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(Y){case 34:r.opts.Date1904=j.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=X,!t.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=X;break;case 66:var je=Number(X);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}Qa(B.codepage=je),V=!0;break;case 317:B.rrtabid=X;break;case 25:B.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:B.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(n["!type"]="dialog"),X.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),X.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:_.push(X);break;case 430:S.push([X]),S[S.length-1].XTI=[];break;case 35:case 547:S[S.length-1].push(X);break;case 24:case 536:I={Name:X.Name,Ref:ms(X.rgce,l,null,S,B)},X.itab>0&&(I.Sheet=X.itab-1),S.names.push(I),S[0]||(S[0]=[],S[0].XTI=[]),S[S.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(A[X.itab-1]={ref:lt(X.rgce[0][0][1][2])});break;case 22:B.ExternCount=X;break;case 23:S.length==0&&(S[0]=[],S[0].XTI=[]),S[S.length-1].XTI=S[S.length-1].XTI.concat(X),S.XTI=S.XTI.concat(X);break;case 2196:if(B.biff<8)break;I!=null&&(I.Comment=X[1]);break;case 18:n["!protect"]=X;break;case 19:X!==0&&B.WTF&&console.error("Password verifier: "+X);break;case 133:i[X.pos]=X,B.snames.push(X.name);break;case 10:{if(--W)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=lt(l),t.sheetRows&&t.sheetRows<=l.e.r){var J=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=lt(l),l.e.r=J}l.e.r++,l.e.c++}U.length>0&&(n["!merges"]=U),P.length>0&&(n["!objects"]=P),F.length>0&&(n["!cols"]=F),N.length>0&&(n["!rows"]=N),j.Sheets.push(D)}d===""?x=n:a[d]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),B.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(B.biff=5,V=!0,Qa(B.codepage=28591)),B.biff==8&&X.BIFFVer==0&&X.dt==16&&(B.biff=2),W++)break;if(n=t.dense?[]:{},B.biff<8&&!V&&(V=!0,Qa(B.codepage=t.codepage||1252)),B.biff<5||X.BIFFVer==0&&X.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ue={pos:e.l-Q,name:d};i[ue.pos]=ue,B.snames.push(d)}else d=(i[H]||{name:""}).name;X.dt==32&&(n["!type"]="chart"),X.dt==64&&(n["!type"]="macro"),U=[],P=[],B.arrayf=w=[],F=[],N=[],T=!1,D={Hidden:(i[H]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[X.r]||[])[X.c]:n[et({c:X.c,r:X.r})])&&++X.c,m={ixfe:X.ixfe,XF:_[X.ixfe]||{},v:X.val,t:"n"},k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:X.c,r:X.r},m,t);break;case 5:case 517:m={ixfe:X.ixfe,XF:_[X.ixfe],v:X.val,t:X.t},k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:X.c,r:X.r},m,t);break;case 638:m={ixfe:X.ixfe,XF:_[X.ixfe],v:X.rknum,t:"n"},k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:X.c,r:X.r},m,t);break;case 189:for(var de=X.c;de<=X.C;++de){var ce=X.rkrec[de-X.c][0];m={ixfe:ce,XF:_[ce],v:X.rkrec[de-X.c][1],t:"n"},k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:de,r:X.r},m,t)}break;case 6:case 518:case 1030:{if(X.val=="String"){o=X;break}if(m=Lu(X.val,X.cell.ixfe,X.tt),m.XF=_[m.ixfe],t.cellFormula){var fe=X.formula;if(fe&&fe[0]&&fe[0][0]&&fe[0][0][0]=="PtgExp"){var pe=fe[0][0][1][0],Ne=fe[0][0][1][1],ne=et({r:pe,c:Ne});v[ne]?m.f=""+ms(X.formula,l,X.cell,S,B):m.F=((t.dense?(n[pe]||[])[Ne]:n[ne])||{}).F}else m.f=""+ms(X.formula,l,X.cell,S,B)}k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O(X.cell,m,t),o=X}break;case 7:case 519:if(o)o.val=X,m=Lu(X,o.cell.ixfe,"s"),m.XF=_[m.ixfe],t.cellFormula&&(m.f=""+ms(o.formula,l,o.cell,S,B)),k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O(o.cell,m,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(X);var _e=et(X[0].s);if(h=t.dense?(n[X[0].s.r]||[])[X[0].s.c]:n[_e],t.cellFormula&&h){if(!o||!_e||!h)break;h.f=""+ms(X[1],l,X[0],S,B),h.F=lt(X[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;v[et(o.cell)]=X[0],h=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[et(o.cell)],(h||{}).f=""+ms(X[0],l,u,S,B)}}break;case 253:m=Lu(c[X.isst].t,X.ixfe,"s"),c[X.isst].h&&(m.h=c[X.isst].h),m.XF=_[m.ixfe],k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:X.c,r:X.r},m,t);break;case 513:t.sheetStubs&&(m={ixfe:X.ixfe,XF:_[X.ixfe],t:"z"},k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:X.c,r:X.r},m,t));break;case 190:if(t.sheetStubs)for(var Te=X.c;Te<=X.C;++Te){var Me=X.ixfe[Te-X.c];m={ixfe:Me,XF:_[Me],t:"z"},k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:Te,r:X.r},m,t)}break;case 214:case 516:case 4:m=Lu(X.val,X.ixfe,"s"),m.XF=_[m.ixfe],k>0&&(m.z=q[m.ixfe>>8&63]),xn(m,t,r.opts.Date1904),O({c:X.c,r:X.r},m,t);break;case 0:case 512:W===1&&(l=X);break;case 252:c=X;break;case 1054:if(B.biff==4){q[k++]=X[1];for(var ye=0;ye<k+163&&Ze[ye]!=X[1];++ye);ye>=163&&ai(X[1],k+163)}else ai(X[1],X[0]);break;case 30:{q[k++]=X;for(var Re=0;Re<k+163&&Ze[Re]!=X;++Re);Re>=163&&ai(X,k+163)}break;case 229:U=U.concat(X);break;case 93:P[X.cmo[0]]=B.lastobj=X;break;case 438:B.lastobj.TxO=X;break;case 127:B.lastobj.ImData=X;break;case 440:for(y=X[0].s.r;y<=X[0].e.r;++y)for(g=X[0].s.c;g<=X[0].e.c;++g)h=t.dense?(n[y]||[])[g]:n[et({c:g,r:y})],h&&(h.l=X[1]);break;case 2048:for(y=X[0].s.r;y<=X[0].e.r;++y)for(g=X[0].s.c;g<=X[0].e.c;++g)h=t.dense?(n[y]||[])[g]:n[et({c:g,r:y})],h&&h.l&&(h.l.Tooltip=X[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;h=t.dense?(n[X[0].r]||[])[X[0].c]:n[et(X[0])];var De=P[X[2]];h||(t.dense?(n[X[0].r]||(n[X[0].r]=[]),h=n[X[0].r][X[0].c]={t:"z"}):h=n[et(X[0])]={t:"z"},l.e.r=Math.max(l.e.r,X[0].r),l.s.r=Math.min(l.s.r,X[0].r),l.e.c=Math.max(l.e.c,X[0].c),l.s.c=Math.min(l.s.c,X[0].c)),h.c||(h.c=[]),p={a:X[1],t:De.TxO.t},h.c.push(p)}break;case 2173:Y$(_[X.ixfe],X.ext);break;case 125:{if(!B.cellStyles)break;for(;X.e>=X.s;)F[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},T||(T=!0,Ub(X.w/256)),al(F[X.e+1])}break;case 520:{var Ce={};X.level!=null&&(N[X.r]=Ce,Ce.level=X.level),X.hidden&&(N[X.r]=Ce,Ce.hidden=!0),X.hpt&&(N[X.r]=Ce,Ce.hpt=X.hpt,Ce.hpx=Xc(X.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Jl(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Y]]=X;break;case 161:n["!margins"]||Jl(n["!margins"]={}),n["!margins"].header=X.header,n["!margins"].footer=X.footer;break;case 574:X.RTL&&(j.Views[0].RTL=!0);break;case 146:C=X;break;case 2198:L=X;break;case 140:b=X;break;case 442:d?D.CodeName=X||D.name:j.WBProps.CodeName=X||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+Y.toString(16)),e.l+=Q}return r.SheetNames=hr(i).sort(function(Ye,Ue){return Number(Ye)-Number(Ue)}).map(function(Ye){return i[Ye].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&x["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=x)):r.Preamble=x,r.Sheets&&A.forEach(function(Ye,Ue){r.Sheets[r.SheetNames[Ue]]["!autofilter"]=Ye}),r.Strings=c,r.SSF=Wt(Ze),B.enc&&(r.Encryption=B.enc),L&&(r.Themes=L),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),S.names.length>0&&(j.Names=S.names),r.Workbook=j,r}var Cd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oG(e,t,r){var a=Xe.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=F4(a,b1,Cd.DSI);for(var i in n)t[i]=n[i]}catch(d){if(r.WTF)throw d}var l=Xe.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=F4(l,y1,Cd.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(Yj(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function cG(e,t){var r=[],a=[],n=[],i=0,l,o=o4(b1,"n"),c=o4(y1,"n");if(e.Props)for(l=hr(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=hr(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Custprops[l[i]]]);var d=[];for(i=0;i<n.length;++i)t3.indexOf(n[i][0])>-1||Gj.indexOf(n[i][0])>-1||n[i][1]!=null&&d.push(n[i]);a.length&&Xe.utils.cfb_add(t,"/SummaryInformation",T4(a,Cd.SI,c,y1)),(r.length||d.length)&&Xe.utils.cfb_add(t,"/DocumentSummaryInformation",T4(r,Cd.DSI,o,b1,d.length?d:null,Cd.UDI))}function K3(e,t){t||(t={}),Xb(t),gb(),t.codepage&&mb(t.codepage);var r,a;if(e.FullPaths){if(Xe.find(e,"/encryption"))throw new Error("File is password-protected");r=Xe.find(e,"!CompObj"),a=Xe.find(e,"/Workbook")||Xe.find(e,"/Book")}else{switch(t.type){case"base64":e=sa(ca(e));break;case"binary":e=sa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}is(e,0),a={content:e}}var n,i;if(r&&aG(r),t.bookProps&&!t.bookSheets)n={};else{var l=xt?"buffer":"array";if(a&&a.content)n=lG(a.content,t);else if((i=Xe.find(e,"PerfectOffice_MAIN"))&&i.content)n=Ql.to_workbook(i.content,(t.type=l,t));else if((i=Xe.find(e,"NativeContent_MAIN"))&&i.content)n=Ql.to_workbook(i.content,(t.type=l,t));else throw(i=Xe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Xe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Ez(e))}var o={};return e.FullPaths&&oG(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}function dG(e,t){var r=t||{},a=Xe.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Xe.utils.cfb_add(a,n,Q3(e,r)),r.biff==8&&(e.Props||e.Custprops)&&cG(e,a),r.biff==8&&e.vbaraw&&_z(a,Xe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var gx={0:{f:MV},1:{f:zV},2:{f:lH},3:{f:KV},4:{f:WV},5:{f:aH},6:{f:uH},7:{f:eH},8:{f:bH},9:{f:vH},10:{f:gH},11:{f:pH},12:{f:VV},13:{f:cH},14:{f:JV},15:{f:YV},16:{f:z3},17:{f:hH},18:{f:rH},19:{f:Sb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:hW},40:{},42:{},43:{f:u$},44:{f:d$},45:{f:m$},46:{f:p$},47:{f:g$},48:{},49:{f:PP},50:{},51:{f:Q$},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:u3},62:{f:xH},63:{f:iz},64:{f:RH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_s,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:UV},148:{f:PV,p:16},151:{f:NH},152:{},153:{f:xW},154:{},155:{},156:{f:cW},157:{},158:{},159:{T:1,f:AU},160:{T:-1},161:{T:1,f:Fo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:X$},336:{T:-1},337:{f:ez,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:v1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:x3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:CH},427:{f:AH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:IV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_H},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:v1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pz},633:{T:1},634:{T:-1},635:{T:1,f:mz},636:{T:-1},637:{f:$P},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:JH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},C1={6:{f:Ng},10:{f:_i},12:{f:Dr},13:{f:Dr},14:{f:vr},15:{f:vr},16:{f:ps},17:{f:vr},18:{f:vr},19:{f:Dr},20:{f:I4},21:{f:I4},23:{f:x3},24:{f:$4},25:{f:vr},26:{},27:{},28:{f:OI},29:{},34:{f:vr},35:{f:U4},38:{f:ps},39:{f:ps},40:{f:ps},41:{f:ps},42:{f:vr},43:{f:vr},47:{f:YU},49:{f:cI},51:{f:Dr},60:{},61:{f:aI},64:{f:vr},65:{f:oI},66:{f:Dr},77:{},80:{},81:{},82:{},85:{f:Dr},89:{},90:{},91:{},92:{f:GL},93:{f:II},94:{},95:{f:vr},96:{},97:{},99:{f:vr},125:{f:u3},128:{f:jI},129:{f:XL},130:{f:Dr},131:{f:vr},132:{f:vr},133:{f:KL},134:{},140:{f:GI},141:{f:Dr},144:{},146:{f:KI},151:{},152:{},153:{},154:{},155:{},156:{f:Dr},157:{},158:{},160:{f:sU},161:{f:ZI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:yI},190:{f:wI},193:{f:_i},197:{},198:{},199:{},200:{},201:{},202:{f:vr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Dr},220:{},221:{f:vr},222:{},224:{f:_I},225:{f:WL},226:{f:_i},227:{},229:{f:PI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:JL},253:{f:xI},255:{f:eI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:r3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vr},353:{f:_i},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:DI},431:{f:vr},432:{},433:{},434:{},437:{},438:{f:zI},439:{f:vr},440:{f:qI},441:{},442:{f:Wx},443:{},444:{f:Dr},445:{},446:{},448:{f:_i},449:{f:sI,r:2},450:{f:_i},512:{f:O4},513:{f:rU},515:{f:AI},516:{f:fI},517:{f:L4},519:{f:aU},520:{f:tI},523:{},545:{f:z4},549:{f:R4},566:{},574:{f:iI},638:{f:bI},659:{},1048:{},1054:{f:mI},1084:{},1212:{f:TI},2048:{f:HI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ru},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_i},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:QI,r:12},2173:{f:G$,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:FI,r:12},2197:{},2198:{f:$$,r:12},2199:{},2200:{},2201:{},2202:{f:MI,r:12},2203:{f:_i},2204:{},2205:{},2206:{},2207:{},2211:{f:rI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Dr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:XI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:O4},1:{},2:{f:cU},3:{f:lU},4:{f:iU},5:{f:L4},7:{f:xU},8:{},9:{f:Ru},11:{},22:{f:Dr},30:{f:pI},31:{},32:{},33:{f:z4},36:{},37:{f:R4},50:{f:uU},62:{},52:{},67:{},68:{f:Dr},69:{},86:{},126:{},127:{f:nU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:fU},223:{},234:{},354:{},421:{},518:{f:Ng},521:{f:Ru},536:{f:$4},547:{f:U4},561:{},579:{},1030:{f:Ng},1033:{f:Ru},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Le(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&Ab(r)&&e.push(r)}}function xG(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Le(e,t,r,n);var i=t;if(!isNaN(i)){for(var l=r.parts||[],o=0,c=0,d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;var x=e.next(4);for(x.write_shift(2,i),x.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<n;){for(x=e.next(4),x.write_shift(2,60),d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;x.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Kx(e,t,r){return e||(e=Ae(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function uG(e,t,r,a){var n=Ae(9);return Kx(n,e,t),s3(r,a||"b",n),n}function fG(e,t,r){var a=Ae(8+2*r.length);return Kx(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function hG(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?$r(Ht(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Le(e,2,dU(r,a,n)):Le(e,3,oU(r,a,n));return;case"b":case"e":Le(e,5,uG(r,a,t.v,t.t));return;case"s":case"str":Le(e,4,fG(r,a,(t.v||"").slice(0,255)));return}Le(e,1,Kx(null,r,a))}function mG(e,t,r,a){var n=Array.isArray(t),i=Nt(t["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=lt(i)}for(var d=i.s.r;d<=i.e.r;++d){o=_r(d);for(var x=i.s.c;x<=i.e.c;++x){d===i.s.r&&(c[x]=ir(x)),l=c[x]+o;var u=n?(t[d]||[])[x]:t[l];u&&hG(e,u,d,x)}}}function gG(e,t){for(var r=t||{},a=Ws(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Le(a,r.biff==4?1033:r.biff==3?521:9,Pb(e,16,r)),mG(a,e.Sheets[e.SheetNames[n]],n,r),Le(a,10),a.end()}function pG(e,t,r){Le(e,49,dI({sz:12,name:"Arial"},r))}function vG(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Le(e,1054,gI(n,t[n],r))})}function bG(e,t){var r=Ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Le(e,2151,r),r=Ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),o3(Nt(t["!ref"]||"A1"),r),r.write_shift(4,4),Le(e,2152,r)}function yG(e,t){for(var r=0;r<16;++r)Le(e,224,P4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Le(e,224,P4(a,0,t))})}function wG(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Le(e,440,VI(a)),a[1].Tooltip&&Le(e,2048,WI(a))}delete t["!links"]}function EG(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Le(e,125,JI(om(n,a),n))})}}function _G(e,t,r,a,n){var i=16+gl(n.cellXfs,t,n);if(t.v==null&&!t.bf){Le(e,513,go(r,a,i));return}if(t.bf)Le(e,6,Xq(t,r,a,n,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?$r(Ht(t.v)):t.v;Le(e,515,kI(r,a,l,i));break;case"b":case"e":Le(e,517,CI(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var o=Hb(n.Strings,t.v,n.revStrings);Le(e,253,uI(r,a,o,i))}else Le(e,516,hI(r,a,(t.v||"").slice(0,255),i,n));break;default:Le(e,513,go(r,a,i))}}function jG(e,t,r){var a=Ws(),n=r.SheetNames[e],i=r.Sheets[n]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,x,u="",f=[],h=Nt(i["!ref"]||"A1"),p=d?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}Le(a,2057,Pb(r,16,t)),Le(a,13,Ea(1)),Le(a,12,Ea(100)),Le(a,15,Ds(!0)),Le(a,17,Ds(!1)),Le(a,16,ho(.001)),Le(a,95,Ds(!0)),Le(a,42,Ds(!1)),Le(a,43,Ds(!1)),Le(a,130,Ea(1)),Le(a,128,NI()),Le(a,131,Ds(!1)),Le(a,132,Ds(!1)),d&&EG(a,i["!cols"]),Le(a,512,vI(h,t)),d&&(i["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){u=_r(g);for(var y=h.s.c;y<=h.e.c;++y){g===h.s.r&&(f[y]=ir(y)),x=f[y]+u;var v=c?(i[g]||[])[y]:i[x];v&&(_G(a,v,g,y,t),d&&v.l&&i["!links"].push([x,v.l]))}}var w=o.CodeName||o.name||n;return d&&Le(a,574,lI((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&Le(a,229,LI(i["!merges"])),d&&wG(a,i),Le(a,442,a3(w)),d&&bG(a,i),Le(a,10),a.end()}function NG(e,t,r){var a=Ws(),n=(e||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=r.biff==8,c=r.biff==5;if(Le(a,2057,Pb(e,5,r)),r.bookType=="xla"&&Le(a,135),Le(a,225,o?Ea(1200):null),Le(a,193,CL(2)),c&&Le(a,191),c&&Le(a,192),Le(a,226),Le(a,92,YL("SheetJS",r)),Le(a,66,Ea(o?1200:1252)),o&&Le(a,353,Ea(0)),o&&Le(a,448),Le(a,317,tU(e.SheetNames.length)),o&&e.vbaraw&&Le(a,211),o&&e.vbaraw){var d=l.CodeName||"ThisWorkbook";Le(a,442,a3(d))}Le(a,156,Ea(17)),Le(a,25,Ds(!1)),Le(a,18,Ds(!1)),Le(a,19,Ea(0)),o&&Le(a,431,Ds(!1)),o&&Le(a,444,Ea(0)),Le(a,61,nI()),Le(a,64,Ds(!1)),Le(a,141,Ea(0)),Le(a,34,Ds(sW(e)=="true")),Le(a,14,Ds(!0)),o&&Le(a,439,Ds(!1)),Le(a,218,Ea(0)),pG(a,e,r),vG(a,e.SSF,r),yG(a,r),o&&Le(a,352,Ds(!1));var x=a.end(),u=Ws();o&&Le(u,140,YI()),o&&r.Strings&&xG(u,252,ZL(r.Strings)),Le(u,10);var f=u.end(),h=Ws(),p=0,g=0;for(g=0;g<e.SheetNames.length;++g)p+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=x.length+p+f.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};Le(h,133,QL({pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var w=h.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var m=[];return x.length&&m.push(x),w.length&&m.push(w),f.length&&m.push(f),Xr(m)}function CG(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Wt(Ze)),e&&e.SSF&&(g0(),tm(e.SSF),r.revssf=sm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Kb(r),r.cellXfs=[],gl(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=jG(n,r,e);return a.unshift(NG(e,a,r)),Xr(a)}function Q3(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Ys(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return CG(e,t);case 4:case 3:case 2:return gG(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function J4(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=n.index,o=i&&i.index||e.length,c=dP(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,x=0,u=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<c.length;++l){var g=c[l].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}x=0;continue}if(!(y!="<td"&&y!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var w=v[o].trim();if(w.match(/<t[dh]/i)){for(var m=w,b=0;m.charAt(0)=="<"&&(b=m.indexOf(">"))>-1;)m=m.slice(b+1);for(var _=0;_<p.length;++_){var C=p[_];C.s.c==x&&C.s.r<d&&d<=C.e.r&&(x=C.e.c+1,_=-1)}var j=rt(w.slice(0,w.indexOf(">")));f=j.colspan?+j.colspan:1,((u=+j.rowspan)>1||f>1)&&p.push({s:{r:d,c:x},e:{r:d+(u||1)-1,c:x+f-1}});var D=j.t||j["data-t"]||"";if(!m.length){x+=f;continue}if(m=wj(m),h.s.r>d&&(h.s.r=d),h.e.r<d&&(h.e.r=d),h.s.c>x&&(h.s.c=x),h.e.c<x&&(h.e.c=x),!m.length){x+=f;continue}var R={t:"s",v:m};r.raw||!m.trim().length||D=="s"||(m==="TRUE"?R={t:"b",v:!0}:m==="FALSE"?R={t:"b",v:!1}:isNaN(tn(m))?isNaN(Gc(m).getDate())||(R={t:"d",v:Ht(m)},r.cellDates||(R={t:"n",v:$r(R.v)}),R.z=r.dateNF||Ze[14]):R={t:"n",v:tn(m)}),r.dense?(a[d]||(a[d]=[]),a[d][x]=R):a[et({r:d,c:x})]=R,x+=f}}}}return a["!ref"]=lt(h),p.length&&(a["!merges"]=p),a}function AG(e,t,r,a){for(var n=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>l)&&!(n[d].e.r<r||n[d].e.c<l)){if(n[d].s.r<r||n[d].s.c<l){o=-1;break}o=n[d].e.r-n[d].s.r+1,c=n[d].e.c-n[d].s.c+1;break}if(!(o<0)){var x=et({r,c:l}),u=a.dense?(e[r]||[])[l]:e[x],f=u&&u.v!=null&&(u.h||jb(u.w||(ui(u),u.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),a.editable?f='<span contenteditable="true">'+f+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+u.l.Target+'">'+f+"</a>")),h.id=(a.id||"sjs")+"-"+x,i.push(Pe("td",f,h))}}var p="<tr>";return p+i.join("")+"</tr>"}var kG='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',DG="</body></html>";function SG(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ml(J4(r[0],t),t);var a=Zb();return r.forEach(function(n,i){ey(a,J4(n,t),"Sheet"+(i+1))}),a}function BG(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function J3(e,t){var r=t||{},a=r.header!=null?r.header:kG,n=r.footer!=null?r.footer:DG,i=[a],l=Ys(e["!ref"]);r.dense=Array.isArray(e),i.push(BG(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(AG(e,l,o,r));return i.push("</table>"+n),i.join("")}function Z3(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?lr(a.origin):a.origin;n=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var x=Ys(e["!ref"]);d.s.r=Math.min(d.s.r,x.s.r),d.s.c=Math.min(d.s.c,x.s.c),d.e.r=Math.max(d.e.r,x.e.r),d.e.c=Math.max(d.e.c,x.e.c),n==-1&&(d.e.r=n=x.e.r+1)}var u=[],f=0,h=e["!rows"]||(e["!rows"]=[]),p=0,g=0,y=0,v=0,w=0,m=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&g<c;++p){var b=o[p];if(Z4(b)){if(a.display)continue;h[g]={hidden:!0}}var _=b.children;for(y=v=0;y<_.length;++y){var C=_[y];if(!(a.display&&Z4(C))){var j=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):wj(C.innerHTML),D=C.getAttribute("data-z")||C.getAttribute("z");for(f=0;f<u.length;++f){var R=u[f];R.s.c==v+i&&R.s.r<g+n&&g+n<=R.e.r&&(v=R.e.c+1-i,f=-1)}m=+C.getAttribute("colspan")||1,((w=+C.getAttribute("rowspan")||1)>1||m>1)&&u.push({s:{r:g+n,c:v+i},e:{r:g+n+(w||1)-1,c:v+i+(m||1)-1}});var M={t:"s",v:j},O=C.getAttribute("data-t")||C.getAttribute("t")||"";j!=null&&(j.length==0?M.t=O||"z":a.raw||j.trim().length==0||O=="s"||(j==="TRUE"?M={t:"b",v:!0}:j==="FALSE"?M={t:"b",v:!1}:isNaN(tn(j))?isNaN(Gc(j).getDate())||(M={t:"d",v:Ht(j)},a.cellDates||(M={t:"n",v:$r(M.v)}),M.z=a.dateNF||Ze[14]):M={t:"n",v:tn(j)})),M.z===void 0&&D!=null&&(M.z=D);var B="",L=C.getElementsByTagName("A");if(L&&L.length)for(var U=0;U<L.length&&!(L[U].hasAttribute("href")&&(B=L[U].getAttribute("href"),B.charAt(0)!="#"));++U);B&&B.charAt(0)!="#"&&(M.l={Target:B}),a.dense?(e[g+n]||(e[g+n]=[]),e[g+n][v+i]=M):e[et({c:v+i,r:g+n})]=M,d.e.c<v+i&&(d.e.c=v+i),v+=m}}++g}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),d.e.r=Math.max(d.e.r,g-1+n),e["!ref"]=lt(d),g>=c&&(e["!fullref"]=lt((d.e.r=o.length-p+g-1+n,d))),e}function eN(e,t){var r=t||{},a=r.dense?[]:{};return Z3(a,e,t)}function FG(e,t){return ml(eN(e,t),t)}function Z4(e){var t="",r=TG(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function TG(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function MG(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(t.replace(/<[^>]*>/g,""));return[r]}var e8={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tN(e,t){var r=t||{},a=Nb(e),n=[],i,l,o={name:""},c="",d=0,x,u,f={},h=[],p=r.dense?[]:{},g,y,v={value:""},w="",m=0,b=[],_=-1,C=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,R={},M=[],O={},B=0,L=0,U=[],P=1,F=1,N=[],T={Names:[]},S={},z=["",""],W=[],k={},q="",A=0,I=!1,V=!1,H=0;for(dx.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=dx.exec(a);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?p["!ref"]=lt(j):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(p["!fullref"]=p["!ref"],j.e.r=r.sheetRows-1,p["!ref"]=lt(j)),M.length&&(p["!merges"]=M),U.length&&(p["!rows"]=U),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),h.push(x.name),f[x.name]=p,V=!1):g[0].charAt(g[0].length-2)!=="/"&&(x=rt(g[0],!1),_=C=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,p=r.dense?[]:{},M=[],U=[],V=!0);break;case"table-row-group":g[1]==="/"?--D:++D;break;case"table-row":case"":if(g[1]==="/"){_+=P,P=1;break}if(u=rt(g[0],!1),u.?_=u.-1:_==-1&&(_=0),P=+u["number-rows-repeated"]||1,P<10)for(H=0;H<P;++H)D>0&&(U[_+H]={level:D});C=-1;break;case"covered-table-cell":g[1]!=="/"&&++C,r.sheetStubs&&(r.dense?(p[_]||(p[_]=[]),p[_][C]={t:"z"}):p[et({r:_,c:C})]={t:"z"}),w="",b=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++C,v=rt(g[0],!1),F=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=X4(jt(v.formula))),(v.||v["value-type"])=="string"&&(y.t="s",y.v=jt(v["string-value"]||""),r.dense?(p[_]||(p[_]=[]),p[_][C]=y):p[et({r:_,c:C})]=y),C+=F-1;else if(g[1]!=="/"){++C,w="",m=0,b=[],F=1;var Y=P?_+P-1:_;if(C>j.e.c&&(j.e.c=C),C<j.s.c&&(j.s.c=C),_<j.s.r&&(j.s.r=_),Y>j.e.r&&(j.e.r=Y),v=rt(g[0],!1),W=[],k={},y={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=jt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(B=parseInt(v["number-matrix-rows-spanned"],10)||0,L=parseInt(v["number-matrix-columns-spanned"],10)||0,O={s:{r:_,c:C},e:{r:_+B-1,c:C+L-1}},y.F=lt(O),N.push([O,y.F])),v.formula)y.f=X4(v.formula);else for(H=0;H<N.length;++H)_>=N[H][0].s.r&&_<=N[H][0].e.r&&C>=N[H][0].s.c&&C<=N[H][0].e.c&&(y.F=N[H][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(B=parseInt(v["number-rows-spanned"],10)||0,L=parseInt(v["number-columns-spanned"],10)||0,O={s:{r:_,c:C},e:{r:_+B-1,c:C+L-1}},M.push(O)),v["number-columns-repeated"]&&(F=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=$t(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=Ht(v["date-value"]),r.cellDates||(y.t="n",y.v=$r(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=lP(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=am(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(w=jt(v["string-value"]),b=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(I=!1,y.t==="s"&&(y.v=w||"",b.length&&(y.R=b),I=m==0),S.Target&&(y.l=S),W.length>0&&(y.c=W,W=[]),w&&r.cellText!==!1&&(y.w=w),I&&(y.t="z",delete y.v),(!I||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var Q=0;Q<P;++Q){if(F=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[_+Q]||(p[_+Q]=[]),p[_+Q][C]=Q==0?y:Wt(y);--F>0;)p[_+Q][C+F]=Wt(y);else for(p[et({r:_+Q,c:C})]=y;--F>0;)p[et({r:_+Q,c:C+F})]=Wt(y);j.e.c<=C&&(j.e.c=C)}F=parseInt(v["number-columns-repeated"]||"1",10),C+=F-1,F=0,y={},w="",b=[]}S={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i;k.t=w,b.length&&(k.R=b),k.a=q,W.push(k)}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);q="",A=0,w="",m=0,b=[];break;case"creator":g[1]==="/"?q=a.slice(A,g.index):A=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);w="",m=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(R[o.name]=c,(i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=rt(g[0],!1),n.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=rt(g[0],!1),c+=e8[g[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=rt(g[0],!1),c+=e8[g[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,g.index);break}else d=g.index+g[0].length;break;case"named-range":l=rt(g[0],!1),z=Cg(l["cell-range-address"]);var te={Name:l.name,Ref:z[0]+"!"+z[1]};V&&(te.Sheet=h.length),T.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var re=MG(a.slice(m,g.index));w=(w.length>0?w+`
`:"")+re[0]}else rt(g[0],!1),m=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{z=Cg(rt(g[0])["target-range-address"]),f[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(S=rt(g[0],!1),!S.href)break;S.Target=jt(S.href),delete S.href,S.Target.charAt(0)=="#"&&S.Target.indexOf(".")>-1?(z=Cg(S.Target.slice(1)),S.Target="#"+z[0]+"!"+z[1]):S.Target.match(/^\.\.[\\\/]/)&&(S.Target=S.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var X={Sheets:f,SheetNames:h,Workbook:T};return r.bookSheets&&delete X.Sheets,X}function t8(e,t){t=t||{},ya(e,"META-INF/manifest.xml")&&lL(kr(e,"META-INF/manifest.xml"),t);var r=aa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=tN(Rt(r),t);return ya(e,"meta.xml")&&(a.Props=Hj(kr(e,"meta.xml"))),a}function r8(e,t){return tN(e,t)}var RG=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+cx({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return jr+t}}(),s8=function(){var e=function(i){return Ft(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,o){var c=[];c.push('      <table:table table:name="'+Ft(l.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,x=0,u=Ys(i["!ref"]||"A1"),f=i["!merges"]||[],h=0,p=Array.isArray(i);if(i["!cols"])for(x=0;x<=u.e.c;++x)c.push("        <table:table-column"+(i["!cols"][x]?' table:style-name="co'+i["!cols"][x].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(d=0;d<u.s.r;++d)g=y[d]?' table:style-name="ro'+y[d].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;d<=u.e.r;++d){for(g=y[d]?' table:style-name="ro'+y[d].ods+'"':"",c.push("        <table:table-row"+g+`>
`),x=0;x<u.s.c;++x)c.push(t);for(;x<=u.e.c;++x){var v=!1,w={},m="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>x)&&!(f[h].s.r>d)&&!(f[h].e.c<x)&&!(f[h].e.r<d)){(f[h].s.c!=x||f[h].s.r!=d)&&(v=!0),w["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,w["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(v){c.push(r);continue}var b=et({r:d,c:x}),_=p?(i[d]||[])[x]:i[b];if(_&&_.f&&(w["table:formula"]=Ft(tV(_.f)),_.F&&_.F.slice(0,b.length)==b)){var C=Ys(_.F);w["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,w["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(!_){c.push(t);continue}switch(_.t){case"b":m=_.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=_.v?"true":"false";break;case"n":m=_.w||String(_.v||0),w["office:value-type"]="float",w["office:value"]=_.v||0;break;case"s":case"str":m=_.v==null?"":_.v,w["office:value-type"]="string";break;case"d":m=_.w||Ht(_.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Ht(_.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var j=e(m);if(_.l&&_.l.Target){var D=_.l.Target;D=D.charAt(0)=="#"?"#"+rV(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),j=Pe("text:a",j,{"xlink:href":D.replace(/&/g,"&amp;")})}c.push("          "+Pe("table:table-cell",Pe("text:p",j,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var x=0;x<d["!cols"].length;++x)if(d["!cols"][x]){var u=d["!cols"][x];if(u.width==null&&u.wpx==null&&u.wch==null)continue;al(u),u.ods=o;var f=d["!cols"][x].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var x=0;x<d["!rows"].length;++x)if(d["!rows"][x]){d["!rows"][x].ods=c;var u=d["!rows"][x].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[jr],d=cx({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=cx({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+x+`>
`),c.push(Vj().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),n(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=l.SheetNames.length;++u)c.push(a(l.Sheets[l.SheetNames[u]],l,u));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function rN(e,t){if(t.bookType=="fods")return s8(e,t);var r=wb(),a="",n=[],i=[];return a="mimetype",ct(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",ct(r,a,s8(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",ct(r,a,RG(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",ct(r,a,jr+Vj()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",ct(r,a,dL(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",ct(r,a,oL(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function po(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function A1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Rt(hl(e))}function OG(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):sa(yn(e))}function PG(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function il(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function a8(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function LG(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function IG(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function px(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Dt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ct(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=px(e,r),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=px(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var d={data:o,type:i};t[n]==null?t[n]=[d]:t[n].push(d)}return t}function ss(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Dt(a*8+n.type)),n.type==2&&t.push(Dt(n.data.length)),t.push(n.data))})}),il(t)}function Yb(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function pa(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=px(e,a),i=Ct(e.slice(a[0],a[0]+n));a[0]+=n;var l={id:fr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Ct(o.data),d=fr(c[3][0].data);l.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(l.merge=fr(i[3][0].data)>>>0>0),r.push(l)}return r}function qo(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Dt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Dt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:Dt(l.data.length)}],a[2].push({data:ss(l.meta),type:2})});var i=ss(a);t.push(Dt(i.length)),t.push(i),n.forEach(function(l){return t.push(l)})}),il(t)}function UG(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=px(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[il(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(n.push(n[0].slice(-c)),d-=c;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-c,-c+d))}}var x=il(n);if(x.length!=a)throw new Error("Unexpected length: ".concat(x.length," != ").concat(a));return x}function va(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(UG(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return il(t)}function Vo(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Dt(a),l=i.length;t.push(i),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return il(t)}function $G(e,t,r,a){var n=po(e),i=n.getUint32(4,!0),l=(a>1?12:8)+a8(i&(a>1?3470:398))*4,o=-1,c=-1,d=NaN,x=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=a8(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(l,!0),l+=4),i&32&&(d=n.getFloat64(l,!0),l+=8),i&64&&(x.setTime(x.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:d};break;case 3:u={t:"s",v:t[c]};break;case 5:u={t:"d",v:x};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:r[o]};else if(c>-1)u={t:"s",v:t[c]};else if(!isNaN(d))u={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function zG(e,t,r){var a=po(e),n=a.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,d=NaN,x=new Date(2001,0,1);n&1&&(c=LG(e,i),i+=16),n&2&&(d=a.getFloat64(i,!0),i+=8),n&4&&(x.setTime(x.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(l=a.getUint32(i,!0),i+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:t[o]};break;case 5:u={t:"d",v:x};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(l>-1)u={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return u}function kg(e,t){var r=new Uint8Array(32),a=po(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,IG(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function Dg(e,t){var r=new Uint8Array(32),a=po(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function qG(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return $G(e,t,r,e[0]);case 5:return zG(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function hs(e){var t=Ct(e);return px(t[1][0].data)}function n8(e,t){var r=Ct(t.data),a=fr(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(l){var o=Ct(l.data),c=fr(o[1][0].data)>>>0;switch(a){case 1:i[c]=A1(o[3][0].data);break;case 8:{var d=e[hs(o[9][0].data)][0],x=Ct(d.data),u=e[hs(x[1][0].data)][0],f=fr(u.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=Ct(u.data);i[c]=h[3].map(function(p){return A1(p.data)}).join("")}break}}),i}function VG(e,t){var r,a,n,i,l,o,c,d,x,u,f,h,p,g,y=Ct(e),v=fr(y[1][0].data)>>>0,w=fr(y[2][0].data)>>>0,m=((a=(r=y[8])==null?void 0:r[0])==null?void 0:a.data)&&fr(y[8][0].data)>0||!1,b,_;if((i=(n=y[7])==null?void 0:n[0])!=null&&i.data&&t!=0)b=(o=(l=y[7])==null?void 0:l[0])==null?void 0:o.data,_=(d=(c=y[6])==null?void 0:c[0])==null?void 0:d.data;else if((u=(x=y[4])==null?void 0:x[0])!=null&&u.data&&t!=1)b=(h=(f=y[4])==null?void 0:f[0])==null?void 0:h.data,_=(g=(p=y[3])==null?void 0:p[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var C=m?4:1,j=po(b),D=[],R=0;R<b.length/2;++R){var M=j.getUint16(R*2,!0);M<65535&&D.push([R,M])}if(D.length!=w)throw"Expected ".concat(w," cells, found ").concat(D.length);var O=[];for(R=0;R<D.length-1;++R)O[D[R][0]]=_.subarray(D[R][1]*C,D[R+1][1]*C);return D.length>=1&&(O[D[D.length-1][0]]=_.subarray(D[D.length-1][1]*C)),{R:v,cells:O}}function HG(e,t){var r,a=Ct(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?fr(a[7][0].data)>>>0>0?1:0:-1,i=Yb(a[5],function(l){return VG(l,n)});return{nrows:fr(a[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,d){if(l[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));l[o.R][d]=c}),l},[])}}function WG(e,t,r){var a,n=Ct(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(fr(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(fr(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=lt(i);var l=Ct(n[4][0].data),o=n8(e,e[hs(l[4][0].data)][0]),c=(a=l[17])!=null&&a[0]?n8(e,e[hs(l[17][0].data)][0]):[],d=Ct(l[3][0].data),x=0;d[1].forEach(function(u){var f=Ct(u.data),h=e[hs(f[2][0].data)][0],p=fr(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var g=HG(e,h);g.data.forEach(function(y,v){y.forEach(function(w,m){var b=et({r:x+v,c:m}),_=qG(w,o,c);_&&(r[b]=_)})}),x+=g.nrows})}function GG(e,t){var r=Ct(t.data),a={"!ref":"A1"},n=e[hs(r[2][0].data)],i=fr(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return WG(e,n[0],a),a}function YG(e,t){var r,a=Ct(t.data),n={name:(r=a[1])!=null&&r[0]?A1(a[1][0].data):"",sheets:[]},i=Yb(a[2],hs);return i.forEach(function(l){e[l].forEach(function(o){var c=fr(o.meta[1][0].data);c==6e3&&n.sheets.push(GG(e,o))})}),n}function XG(e,t){var r=Zb(),a=Ct(t.data),n=Yb(a[1],hs);if(n.forEach(function(i){e[i].forEach(function(l){var o=fr(l.meta[1][0].data);if(o==2){var c=YG(e,l);c.sheets.forEach(function(d,x){ey(r,d,x==0?c.name:c.name+"_"+x,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sg(e){var t,r,a,n,i={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=va(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var x;try{x=pa(d)}catch(u){return console.log("## "+(u.message||u))}x.forEach(function(u){i[u.id]=u.messages,l.push(u.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(c){i[c].forEach(function(d){var x=fr(d.meta[1][0].data)>>>0;if(x==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return XG(i,o)}function KG(e,t,r){var a,n,i,l;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&fr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=po(e[7][0].data),x=0,u=[],f=po(e[4][0].data),h=0,p=[],g=0;g<t.length;++g){if(t[g]==null){d.setUint16(g*2,65535,!0),f.setUint16(g*2,65535);continue}d.setUint16(g*2,x,!0),f.setUint16(g*2,h,!0);var y,v;switch(typeof t[g]){case"string":y=kg({t:"s",v:t[g]},r),v=Dg({t:"s",v:t[g]},r);break;case"number":y=kg({t:"n",v:t[g]},r),v=Dg({t:"n",v:t[g]},r);break;case"boolean":y=kg({t:"b",v:t[g]},r),v=Dg({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}u.push(y),x+=y.length,p.push(v),h+=v.length,++c}for(e[2][0].data=Dt(c);g<e[7][0].data.length/2;++g)d.setUint16(g*2,65535,!0),f.setUint16(g*2,65535,!0);return e[6][0].data=il(u),e[3][0].data=il(p),c}function QG(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ys(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(lt(a)));var i=ch(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(q){return q.forEach(function(A){typeof A=="string"&&l.push(A)})});var o={},c=[],d=Xe.read(t.numbers,{type:"base64"});d.FileIndex.map(function(q,A){return[q,d.FullPaths[A]]}).forEach(function(q){var A=q[0],I=q[1];if(A.type==2&&A.name.match(/\.iwa/)){var V=A.content,H=va(V),Y=pa(H);Y.forEach(function(Q){c.push(Q.id),o[Q.id]={deps:[],location:I,type:fr(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(q,A){return q-A});var x=c.filter(function(q){return q>1}).map(function(q){return[q,Dt(q)]});d.FileIndex.map(function(q,A){return[q,d.FullPaths[A]]}).forEach(function(q){var A=q[0];if(q[1],!!A.name.match(/\.iwa/)){var I=pa(va(A.content));I.forEach(function(V){V.messages.forEach(function(H){x.forEach(function(Y){V.messages.some(function(Q){return fr(Q.meta[1][0].data)!=11006&&PG(Q.data,Y[1])})&&o[Y[0]].deps.push(V.id)})})})}});for(var u=Xe.find(d,o[1].location),f=pa(va(u.content)),h,p=0;p<f.length;++p){var g=f[p];g.id==1&&(h=g)}var y=hs(Ct(h.messages[0].data)[1][0].data);for(u=Xe.find(d,o[y].location),f=pa(va(u.content)),p=0;p<f.length;++p)g=f[p],g.id==y&&(h=g);for(y=hs(Ct(h.messages[0].data)[2][0].data),u=Xe.find(d,o[y].location),f=pa(va(u.content)),p=0;p<f.length;++p)g=f[p],g.id==y&&(h=g);for(y=hs(Ct(h.messages[0].data)[2][0].data),u=Xe.find(d,o[y].location),f=pa(va(u.content)),p=0;p<f.length;++p)g=f[p],g.id==y&&(h=g);var v=Ct(h.messages[0].data);{v[6][0].data=Dt(a.e.r+1),v[7][0].data=Dt(a.e.c+1);var w=hs(v[46][0].data),m=Xe.find(d,o[w].location),b=pa(va(m.content));{for(var _=0;_<b.length&&b[_].id!=w;++_);if(b[_].id!=w)throw"Bad ColumnRowUIDMapArchive";var C=Ct(b[_].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var j=0;j<=a.e.c;++j){var D=[];D[1]=D[2]=[{type:0,data:Dt(j+420690)}],C[1].push({type:2,data:ss(D)}),C[2].push({type:0,data:Dt(j)}),C[3].push({type:0,data:Dt(j)})}C[4]=[],C[5]=[],C[6]=[];for(var R=0;R<=a.e.r;++R)D=[],D[1]=D[2]=[{type:0,data:Dt(R+726270)}],C[4].push({type:2,data:ss(D)}),C[5].push({type:0,data:Dt(R)}),C[6].push({type:0,data:Dt(R)});b[_].messages[0].data=ss(C)}m.content=Vo(qo(b)),m.size=m.content.length,delete v[46];var M=Ct(v[4][0].data);{M[7][0].data=Dt(a.e.r+1);var O=Ct(M[1][0].data),B=hs(O[2][0].data);m=Xe.find(d,o[B].location),b=pa(va(m.content));{if(b[0].id!=B)throw"Bad HeaderStorageBucket";var L=Ct(b[0].messages[0].data);for(R=0;R<i.length;++R){var U=Ct(L[2][0].data);U[1][0].data=Dt(R),U[4][0].data=Dt(i[R].length),L[2][R]={type:L[2][0].type,data:ss(U)}}b[0].messages[0].data=ss(L)}m.content=Vo(qo(b)),m.size=m.content.length;var P=hs(M[2][0].data);m=Xe.find(d,o[P].location),b=pa(va(m.content));{if(b[0].id!=P)throw"Bad HeaderStorageBucket";for(L=Ct(b[0].messages[0].data),j=0;j<=a.e.c;++j)U=Ct(L[2][0].data),U[1][0].data=Dt(j),U[4][0].data=Dt(a.e.r+1),L[2][j]={type:L[2][0].type,data:ss(U)};b[0].messages[0].data=ss(L)}m.content=Vo(qo(b)),m.size=m.content.length;var F=hs(M[4][0].data);(function(){for(var q=Xe.find(d,o[F].location),A=pa(va(q.content)),I,V=0;V<A.length;++V){var H=A[V];H.id==F&&(I=H)}var Y=Ct(I.messages[0].data);{Y[3]=[];var Q=[];l.forEach(function(X,je){Q[1]=[{type:0,data:Dt(je)}],Q[2]=[{type:0,data:Dt(1)}],Q[3]=[{type:2,data:OG(X)}],Y[3].push({type:2,data:ss(Q)})})}I.messages[0].data=ss(Y);var te=qo(A),re=Vo(te);q.content=re,q.size=q.content.length})();var N=Ct(M[3][0].data);{var T=N[1][0];delete N[2];var S=Ct(T.data);{var z=hs(S[2][0].data);(function(){for(var q=Xe.find(d,o[z].location),A=pa(va(q.content)),I,V=0;V<A.length;++V){var H=A[V];H.id==z&&(I=H)}var Y=Ct(I.messages[0].data);{delete Y[6],delete N[7];var Q=new Uint8Array(Y[5][0].data);Y[5]=[];for(var te=0,re=0;re<=a.e.r;++re){var X=Ct(Q);te+=KG(X,i[re],l),X[1][0].data=Dt(re),Y[5].push({data:ss(X),type:2})}Y[1]=[{type:0,data:Dt(a.e.c+1)}],Y[2]=[{type:0,data:Dt(a.e.r+1)}],Y[3]=[{type:0,data:Dt(te)}],Y[4]=[{type:0,data:Dt(a.e.r+1)}]}I.messages[0].data=ss(Y);var je=qo(A),J=Vo(je);q.content=J,q.size=q.content.length})()}T.data=ss(S)}M[3][0].data=ss(N)}v[4][0].data=ss(M)}h.messages[0].data=ss(v);var W=qo(f),k=Vo(W);return u.content=k,u.size=u.content.length,d}function sN(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Xb(e){sN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Kb(e){sN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function JG(e){return ft.WS.indexOf(e)>-1?"sheet":e==ft.CS?"chart":e==ft.DS?"dialog":e==ft.MS?"macro":e&&e.length?e:"sheet"}function ZG(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,JG(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function eY(e,t,r,a,n,i,l,o,c,d,x,u){try{i[a]=Ed(aa(e,r,!0),t);var f=kr(e,t),h;switch(o){case"sheet":h=EW(f,t,n,c,i[a],d,x,u);break;case"chart":if(h=_W(f,t,n,c,i[a],d,x,u),!h||!h["!drawel"])break;var p=Q0(h["!drawel"].Target,t),g=xx(p),y=cz(aa(e,p,!0),Ed(aa(e,g,!0),p)),v=Q0(y,p),w=xx(v);h=KH(aa(e,v,!0),v,c,Ed(aa(e,w,!0),v),d,h);break;case"macro":h=jW(f,t,n,c,i[a],d,x,u);break;case"dialog":h=NW(f,t,n,c,i[a],d,x,u);break;default:throw new Error("Unrecognized sheet type "+o)}l[a]=h;var m=[];i&&i[a]&&hr(i[a]).forEach(function(b){var _="";if(i[a][b].Type==ft.CMNT){_=Q0(i[a][b].Target,t);var C=DW(kr(e,_,!0),_,c);if(!C||!C.length)return;V4(h,C,!1)}i[a][b].Type==ft.TCMNT&&(_=Q0(i[a][b].Target,t),m=m.concat(xz(kr(e,_,!0),c)))}),m&&m.length&&V4(h,m,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function ha(e){return e.charAt(0)=="/"?e.slice(1):e}function tY(e,t){if(g0(),t=t||{},Xb(t),ya(e,"META-INF/manifest.xml")||ya(e,"objectdata.xml"))return t8(e,t);if(ya(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sg<"u"){if(e.FileIndex)return Sg(e);var r=Xe.utils.cfb_new();return x4(e).forEach(function(U){ct(r,U,uP(e,U))}),Sg(r)}throw new Error("Unsupported NUMBERS file")}if(!ya(e,"[Content_Types].xml"))throw ya(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ya(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=x4(e),n=nL(aa(e,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",kr(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!kr(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(_d=[],n.sst)try{_d=kW(kr(e,ha(n.sst)),n.sst,t)}catch(U){if(t.WTF)throw U}t.cellStyles&&n.themes.length&&(c=AW(aa(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(d=CW(kr(e,ha(n.style)),n.style,c,t))}n.links.map(function(U){try{var P=Ed(aa(e,xx(ha(U))),U);return BW(kr(e,ha(U)),P,U,t)}catch{}});var x=wW(kr(e,ha(n.workbooks[0])),n.workbooks[0],t),u={},f="";n.coreprops.length&&(f=kr(e,ha(n.coreprops[0]),!0),f&&(u=Hj(f)),n.extprops.length!==0&&(f=kr(e,ha(n.extprops[0]),!0),f&&uL(f,u,t)));var h={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(f=aa(e,ha(n.custprops[0]),!0),f&&(h=hL(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(x.Sheets?l=x.Sheets.map(function(P){return P.name}):u.Worksheets&&u.SheetNames.length>0&&(l=u.SheetNames),t.bookProps&&(p.Props=u,p.Custprops=h),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var g={};t.bookDeps&&n.calcchain&&(g=SW(kr(e,ha(n.calcchain)),n.calcchain));var y=0,v={},w,m;{var b=x.Sheets;u.Worksheets=b.length,u.SheetNames=[];for(var _=0;_!=b.length;++_)u.SheetNames[_]=b[_].name}var C=i?"bin":"xml",j=n.workbooks[0].lastIndexOf("/"),D=(n.workbooks[0].slice(0,j+1)+"_rels/"+n.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");ya(e,D)||(D="xl/_rels/workbook."+C+".rels");var R=Ed(aa(e,D,!0),D.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=FW(kr(e,ha(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=fz(kr(e,ha(n.people[0])),t)),R&&(R=ZG(R,x.Sheets));var M=kr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=u.Worksheets;++y){var O="sheet";if(R&&R[y]?(w="xl/"+R[y][1].replace(/[\/]?xl\//,""),ya(e,w)||(w=R[y][1]),ya(e,w)||(w=D.replace(/_rels\/.*$/,"")+R[y][1]),O=R[y][2]):(w="xl/worksheets/sheet"+(y+1-M)+"."+C,w=w.replace(/sheet0\./,"sheet.")),m=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(u.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var B=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==y&&(B=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==u.SheetNames[y].toLowerCase()&&(B=1);if(!B)continue e}}eY(e,w,m,u.SheetNames[y],y,v,l,O,t,x,c,d)}return p={Directory:n,Workbook:x,Props:u,Custprops:h,Deps:g,Sheets:l,SheetNames:u.SheetNames,Strings:_d,Styles:d,Themes:c,SSF:Wt(Ze)},t&&t.bookFiles&&(e.files?(p.keys=a,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(U,P){U=U.replace(/^Root Entry[\/]/,""),p.keys.push(U),p.files[U]=e.FileIndex[P]}))),t&&t.bookVBA&&(n.vba.length>0?p.vbaraw=kr(e,ha(n.vba[0]),!0):n.defaults&&n.defaults.bin===wz&&(p.vbaraw=kr(e,"xl/vbaProject.bin",!0))),p}function rY(e,t){var r=t||{},a="Workbook",n=Xe.find(e,a);try{if(a="/!DataSpaces/Version",n=Xe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(FU(n.content),a="/!DataSpaces/DataSpaceMap",n=Xe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=MU(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Xe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=RU(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Xe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);PU(n.content)}catch{}if(a="/EncryptionInfo",n=Xe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=LU(n.content);if(a="/EncryptedPackage",n=Xe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function sY(e,t){return t.bookType=="ods"?rN(e,t):t.bookType=="numbers"?QG(e,t):t.bookType=="xlsb"?aY(e,t):nY(e,t)}function aY(e,t){uc=1024,e&&!e.SSF&&(e.SSF=Wt(Ze)),e&&e.SSF&&(g0(),tm(e.SSF),t.revssf=sm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=S3.indexOf(t.bookType)>-1,n=Rb();Kb(t=t||{});var i=wb(),l="",o=0;if(t.cellXfs=[],gl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ct(i,l,Wj(e.Props,t)),n.coreprops.push(l),Bt(t.rels,2,l,ft.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,ct(i,l,Xj(e.Props)),n.extprops.push(l),Bt(t.rels,3,l,ft.EXT_PROPS),e.Custprops!==e.Props&&hr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ct(i,l,Kj(e.Custprops)),n.custprops.push(l),Bt(t.rels,4,l,ft.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var x={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],f=(u||{})["!type"]||"sheet";switch(f){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ct(i,l,MW(o-1,l,t,e,x)),n.sheets.push(l),Bt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ft.WS[0])}if(u){var h=u["!comments"],p=!1,g="";h&&h.length>0&&(g="xl/comments"+o+"."+r,ct(i,g,PW(h,g)),n.comments.push(g),Bt(x,-1,"../comments"+o+"."+r,ft.CMNT),p=!0),u["!legacy"]&&p&&ct(i,"xl/drawings/vmlDrawing"+o+".vml",k3(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}x["!id"].rId1&&ct(i,xx(l),Ac(x))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ct(i,l,OW(t.Strings,l,t)),n.strs.push(l),Bt(t.wbrels,-1,"sharedStrings."+r,ft.SST)),l="xl/workbook."+r,ct(i,l,TW(e,l)),n.workbooks.push(l),Bt(t.rels,1,l,ft.WB),l="xl/theme/theme1.xml",ct(i,l,$b(e.Themes,t)),n.themes.push(l),Bt(t.wbrels,-1,"theme/theme1.xml",ft.THEME),l="xl/styles."+r,ct(i,l,RW(e,l,t)),n.styles.push(l),Bt(t.wbrels,-1,"styles."+r,ft.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",ct(i,l,e.vbaraw),n.vba.push(l),Bt(t.wbrels,-1,"vbaProject.bin",ft.VBA)),l="xl/metadata."+r,ct(i,l,LW(l)),n.metadata.push(l),Bt(t.wbrels,-1,"metadata."+r,ft.XLMETA),ct(i,"[Content_Types].xml",qj(n,t)),ct(i,"_rels/.rels",Ac(t.rels)),ct(i,"xl/_rels/workbook."+r+".rels",Ac(t.wbrels)),delete t.revssf,delete t.ssf,i}function nY(e,t){uc=1024,e&&!e.SSF&&(e.SSF=Wt(Ze)),e&&e.SSF&&(g0(),tm(e.SSF),t.revssf=sm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=S3.indexOf(t.bookType)>-1,n=Rb();Kb(t=t||{});var i=wb(),l="",o=0;if(t.cellXfs=[],gl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ct(i,l,Wj(e.Props,t)),n.coreprops.push(l),Bt(t.rels,2,l,ft.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,ct(i,l,Xj(e.Props)),n.extprops.push(l),Bt(t.rels,3,l,ft.EXT_PROPS),e.Custprops!==e.Props&&hr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ct(i,l,Kj(e.Custprops)),n.custprops.push(l),Bt(t.rels,4,l,ft.CUST_PROPS));var x=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ct(i,l,$3(o-1,t,e,u)),n.sheets.push(l),Bt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ft.WS[0])}if(f){var p=f["!comments"],g=!1,y="";if(p&&p.length>0){var v=!1;p.forEach(function(w){w[1].forEach(function(m){m.T==!0&&(v=!0)})}),v&&(y="xl/threadedComments/threadedComment"+o+"."+r,ct(i,y,uz(p,x,t)),n.threadedcomments.push(y),Bt(u,-1,"../threadedComments/threadedComment"+o+"."+r,ft.TCMNT)),y="xl/comments"+o+"."+r,ct(i,y,D3(p)),n.comments.push(y),Bt(u,-1,"../comments"+o+"."+r,ft.CMNT),g=!0}f["!legacy"]&&g&&ct(i,"xl/drawings/vmlDrawing"+o+".vml",k3(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&ct(i,xx(l),Ac(u))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ct(i,l,g3(t.Strings,t)),n.strs.push(l),Bt(t.wbrels,-1,"sharedStrings."+r,ft.SST)),l="xl/workbook."+r,ct(i,l,W3(e)),n.workbooks.push(l),Bt(t.rels,1,l,ft.WB),l="xl/theme/theme1.xml",ct(i,l,$b(e.Themes,t)),n.themes.push(l),Bt(t.wbrels,-1,"theme/theme1.xml",ft.THEME),l="xl/styles."+r,ct(i,l,j3(e,t)),n.styles.push(l),Bt(t.wbrels,-1,"styles."+r,ft.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",ct(i,l,e.vbaraw),n.vba.push(l),Bt(t.wbrels,-1,"vbaProject.bin",ft.VBA)),l="xl/metadata."+r,ct(i,l,A3()),n.metadata.push(l),Bt(t.wbrels,-1,"metadata."+r,ft.XLMETA),x.length>1&&(l="xl/persons/person.xml",ct(i,l,hz(x)),n.people.push(l),Bt(t.wbrels,-1,"persons/person.xml",ft.PEOPLE)),ct(i,"[Content_Types].xml",qj(n,t)),ct(i,"_rels/.rels",Ac(t.rels)),ct(i,"xl/_rels/workbook."+r+".rels",Ac(t.wbrels)),delete t.revssf,delete t.ssf,i}function Qb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ca(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function iY(e,t){return Xe.find(e,"EncryptedPackage")?rY(e,t):K3(e,t)}function lY(e,t){var r,a=e,n=t||{};return n.type||(n.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r=vj(a,n),tY(r,n)}function aN(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return N1(e.slice(r),t);default:break e}return Yc.to_workbook(e,t)}function oY(e,t){var r="",a=Qb(e,t);switch(t.type){case"base64":r=ca(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=fo(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Rt(r)),t.type="binary",aN(r,t)}function cY(e,t){var r=e;return t.type=="base64"&&(r=ca(r)),r=nx.utils.decode(1200,r.slice(2),"str"),t.type="binary",aN(r,t)}function dY(e){return e.match(/[^\x00-\x7F]/)?yn(e):e}function Bg(e,t,r,a){return a?(r.type="string",Yc.to_workbook(e,r)):Yc.to_workbook(t,r)}function lh(e,t){gb();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return lh(new Uint8Array(e),(r=Wt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Dc={},r.dateNF&&(Dc.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",a=aP(e),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=dY(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=Wt(r),r.type="array",lh(pb(a),r)}switch((n=Qb(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return iY(Xe.read(a,r),r);break;case 9:if(n[1]<=8)return K3(a,r);break;case 60:return N1(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return mU(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return h3.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?lY(a,r):Bg(e,a,r,i);case 239:return n[3]===60?N1(a,r):Bg(e,a,r,i);case 255:if(n[1]===254)return cY(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Ql.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Ql.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return j1.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return w3.to_workbook(a,r);break;case 10:case 13:case 32:return oY(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return hU.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?j1.to_workbook(a,r):Bg(e,a,r,i)}function nN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return qx(t.file,Xe.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Xe.write(e,t)}function xY(e,t){var r=Wt(t||{}),a=sY(e,r);return uY(a,r)}function uY(e,t){var r={},a=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Xe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(em(n))}return t.password&&typeof encrypt_agile<"u"?nN(encrypt_agile(n,t.password),t):t.type==="file"?qx(t.file,n):t.type=="string"?Rt(n):n}function fY(e,t){var r=t||{},a=dG(e,r);return nN(a,r)}function fn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return ix(yn(a));case"binary":return yn(a);case"string":return e;case"file":return qx(t.file,a,"utf8");case"buffer":return xt?pi(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):fn(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hY(e,t){switch(t.type){case"base64":return ix(e);case"binary":return e;case"string":return e;case"file":return qx(t.file,e,"binary");case"buffer":return xt?pi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Iu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?ix(r):t.type=="string"?Rt(r):r;case"file":return qx(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function oh(e,t){gb(),iW(e);var r=Wt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=oh(e,r);return r.type="array",em(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fn(sG(e,r),r);case"slk":case"sylk":return fn(f3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return fn(J3(e.Sheets[e.SheetNames[n]],r),r);case"txt":return hY(iN(e.Sheets[e.SheetNames[n]],r),r);case"csv":return fn(Jb(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return fn(h3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Iu(j1.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return fn(Yc.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return fn(w3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return fn(m3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return fn(rN(e,r),r);case"wk1":return Iu(Ql.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Iu(Ql.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Iu(Q3(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fY(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xY(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mY(e,t,r,a,n,i,l,o){var c=_r(r),d=o.defval,x=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!l||e[r])for(var h=t.s.c;h<=t.e.c;++h){var p=l?e[r][h]:e[a[h]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;i[h]!=null&&(f[i[h]]=d);continue}var g=p.v;switch(p.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[h]!=null){if(g==null)if(p.t=="e"&&g===null)f[i[h]]=null;else if(d!==void 0)f[i[h]]=d;else if(x&&g===null)f[i[h]]=null;else continue;else f[i[h]]=x&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?g:ui(p,g,o);g!=null&&(u=!1)}}return{row:f,isempty:u}}function ch(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},x=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof x){case"string":c=Nt(x);break;case"number":c=Nt(e["!ref"]),c.s.r=x;break;default:c=x}a>0&&(n=0);var u=_r(c.s.r),f=[],h=[],p=0,g=0,y=Array.isArray(e),v=c.s.r,w=0,m={};y&&!e[v]&&(e[v]=[]);var b=d.skipHidden&&e["!cols"]||[],_=d.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(b[w]||{}).hidden)switch(f[w]=ir(w),r=y?e[v][w]:e[f[w]+u],a){case 1:i[w]=w-c.s.c;break;case 2:i[w]=f[w];break;case 3:i[w]=d.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=ui(r,null,d),g=m[l]||0,!g)m[l]=1;else{do o=l+"_"+g++;while(m[o]);m[l]=g,m[o]=1}i[w]=o}for(v=c.s.r+n;v<=c.e.r;++v)if(!(_[v]||{}).hidden){var C=mY(e,c,v,f,a,i,y,d);(C.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(h[p++]=C.row)}return h.length=p,h}var i8=/"/g;function gY(e,t,r,a,n,i,l,o){for(var c=!0,d=[],x="",u=_r(r),f=t.s.c;f<=t.e.c;++f)if(a[f]){var h=o.dense?(e[r]||[])[f]:e[a[f]+u];if(h==null)x="";else if(h.v!=null){c=!1,x=""+(o.rawNumbers&&h.t=="n"?h.v:ui(h,null,o));for(var p=0,g=0;p!==x.length;++p)if((g=x.charCodeAt(p))===n||g===i||g===34||o.forceQuotes){x='"'+x.replace(i8,'""')+'"';break}x=="ID"&&(x='"ID"')}else h.f!=null&&!h.F?(c=!1,x="="+h.f,x.indexOf(",")>=0&&(x='"'+x.replace(i8,'""')+'"')):x="";d.push(x)}return o.blankrows===!1&&c?null:d.join(l)}function Jb(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Nt(e["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),x="",u=[];a.dense=Array.isArray(e);for(var f=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(f[p]||{}).hidden||(u[p]=ir(p));for(var g=0,y=n.s.r;y<=n.e.r;++y)(h[y]||{}).hidden||(x=gY(e,n,y,u,l,c,i,a),x!=null&&(a.strip&&(x=x.replace(d,"")),(x||a.blankrows!==!1)&&r.push((g++?o:"")+x)));return delete a.dense,r.join("")}function iN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Jb(e,t);return r}function pY(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Nt(e["!ref"]),i="",l=[],o,c=[],d=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)l[o]=ir(o);for(var x=n.s.r;x<=n.e.r;++x)for(i=_r(x),o=n.s.c;o<=n.e.c;++o)if(t=l[o]+i,r=d?(e[x]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function lN(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},l=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?lr(a.origin):a.origin;l=c.r,o=c.c}var d,x={s:{c:0,r:0},e:{c:o,r:l+t.length-1+n}};if(i["!ref"]){var u=Nt(i["!ref"]);x.e.c=Math.max(x.e.c,u.e.c),x.e.r=Math.max(x.e.r,u.e.r),l==-1&&(l=u.e.r+1,x.e.r=l+t.length-1+n)}else l==-1&&(l=0,x.e.r=t.length-1+n);var f=a.header||[],h=0;t.forEach(function(g,y){hr(g).forEach(function(v){(h=f.indexOf(v))==-1&&(f[h=f.length]=v);var w=g[v],m="z",b="",_=et({c:o+h,r:l+y+n});d=vx(i,_),w&&typeof w=="object"&&!(w instanceof Date)?i[_]=w:(typeof w=="number"?m="n":typeof w=="boolean"?m="b":typeof w=="string"?m="s":w instanceof Date?(m="d",a.cellDates||(m="n",w=$r(w)),b=a.dateNF||Ze[14]):w===null&&a.nullError&&(m="e",w=0),d?(d.t=m,d.v=w,delete d.w,delete d.R,b&&(d.z=b)):i[_]=d={t:m,v:w},b&&(d.z=b))})}),x.e.c=Math.max(x.e.c,o+f.length-1);var p=_r(l);if(n)for(h=0;h<f.length;++h)i[ir(h+o)+p]={t:"s",v:f[h]};return i["!ref"]=lt(x),i}function vY(e,t){return lN(null,e,t)}function vx(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=lr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vx(e,et(t)):vx(e,et({r:t,c:r||0}))}function bY(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Zb(){return{SheetNames:[],Sheets:{}}}function ey(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(H3(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yY(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=bY(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function wY(e,t){return e.z=t,e}function oN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function EY(e,t,r){return oN(e,"#"+t,r)}function _Y(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function jY(e,t,r,a){for(var n=typeof t!="string"?t:Nt(t),i=typeof t=="string"?t:lt(t),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var c=vx(e,l,o);c.t="n",c.F=i,delete c.v,l==n.s.r&&o==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var qr={encode_col:ir,encode_row:_r,encode_cell:et,encode_range:lt,decode_col:Db,decode_row:kb,split_cell:OP,decode_cell:lr,decode_range:Ys,format_cell:ui,sheet_add_aoa:Oj,sheet_add_json:lN,sheet_add_dom:Z3,aoa_to_sheet:p0,json_to_sheet:vY,table_to_sheet:eN,table_to_book:FG,sheet_to_csv:Jb,sheet_to_txt:iN,sheet_to_json:ch,sheet_to_html:J3,sheet_to_formulae:pY,sheet_to_row_object_array:ch,sheet_get_cell:vx,book_new:Zb,book_append_sheet:ey,book_set_sheet_visibility:yY,cell_set_number_format:wY,cell_set_hyperlink:oN,cell_set_internal_link:EY,cell_add_comment:_Y,sheet_set_array_formula:jY,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function on(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function vo(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const cN=6048e5,NY=864e5;let CY={};function cm(){return CY}function bo(e,t){var o,c,d,x;const r=cm(),a=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((x=(d=r.locale)==null?void 0:d.options)==null?void 0:x.weekStartsOn)??0,n=on(e),i=n.getDay(),l=(i<a?7:0)+i-a;return n.setDate(n.getDate()-l),n.setHours(0,0,0,0),n}function dh(e){return bo(e,{weekStartsOn:1})}function dN(e){const t=on(e),r=t.getFullYear(),a=vo(e,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const n=dh(a),i=vo(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const l=dh(i);return t.getTime()>=n.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function l8(e){const t=on(e);return t.setHours(0,0,0,0),t}function o8(e){const t=on(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function AY(e,t){const r=l8(e),a=l8(t),n=+r-o8(r),i=+a-o8(a);return Math.round((n-i)/NY)}function kY(e){const t=dN(e),r=vo(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),dh(r)}function DY(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function SY(e){if(!DY(e)&&typeof e!="number")return!1;const t=on(e);return!isNaN(Number(t))}function BY(e){const t=on(e),r=vo(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const FY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},TY=(e,t,r)=>{let a;const n=FY[e];return typeof n=="string"?a=n:t===1?a=n.one:a=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function Sc(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const MY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},RY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},OY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},PY={date:Sc({formats:MY,defaultWidth:"full"}),time:Sc({formats:RY,defaultWidth:"full"}),dateTime:Sc({formats:OY,defaultWidth:"full"})},LY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},IY=(e,t,r,a)=>LY[e];function vn(e){return(t,r)=>{const a=r!=null&&r.context?String(r.context):"standalone";let n;if(a==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;n=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[o]||e.values[l]}const i=e.argumentCallback?e.argumentCallback(t):t;return n[i]}}const UY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},$Y={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},zY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},qY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},VY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},HY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},WY=(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},GY={ordinalNumber:WY,era:vn({values:UY,defaultWidth:"wide"}),quarter:vn({values:$Y,defaultWidth:"wide",argumentCallback:e=>e-1}),month:vn({values:zY,defaultWidth:"wide"}),day:vn({values:qY,defaultWidth:"wide"}),dayPeriod:vn({values:VY,defaultWidth:"wide",formattingValues:HY,defaultFormattingWidth:"wide"})};function bn(e){return(t,r={})=>{const a=r.width,n=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(n);if(!i)return null;const l=i[0],o=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?XY(o,u=>u.test(l)):YY(o,u=>u.test(l));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const x=t.slice(l.length);return{value:d,rest:x}}}function YY(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function XY(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function xN(e){return(t,r={})=>{const a=t.match(e.matchPattern);if(!a)return null;const n=a[0],i=t.match(e.parsePattern);if(!i)return null;let l=e.valueCallback?e.valueCallback(i[0]):i[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(n.length);return{value:l,rest:o}}}const KY=/^(\d+)(th|st|nd|rd)?/i,QY=/\d+/i,JY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ZY={any:[/^b/i,/^(a|c)/i]},eX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},tX={any:[/1/i,/2/i,/3/i,/4/i]},rX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},sX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},aX={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},nX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},iX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},lX={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},oX={ordinalNumber:xN({matchPattern:KY,parsePattern:QY,valueCallback:e=>parseInt(e,10)}),era:bn({matchPatterns:JY,defaultMatchWidth:"wide",parsePatterns:ZY,defaultParseWidth:"any"}),quarter:bn({matchPatterns:eX,defaultMatchWidth:"wide",parsePatterns:tX,defaultParseWidth:"any",valueCallback:e=>e+1}),month:bn({matchPatterns:rX,defaultMatchWidth:"wide",parsePatterns:sX,defaultParseWidth:"any"}),day:bn({matchPatterns:aX,defaultMatchWidth:"wide",parsePatterns:nX,defaultParseWidth:"any"}),dayPeriod:bn({matchPatterns:iX,defaultMatchWidth:"any",parsePatterns:lX,defaultParseWidth:"any"})},cX={code:"en-US",formatDistance:TY,formatLong:PY,formatRelative:IY,localize:GY,match:oX,options:{weekStartsOn:0,firstWeekContainsDate:1}};function dX(e){const t=on(e);return AY(t,BY(t))+1}function xX(e){const t=on(e),r=+dh(t)-+kY(t);return Math.round(r/cN)+1}function uN(e,t){var x,u,f,h;const r=on(e),a=r.getFullYear(),n=cm(),i=(t==null?void 0:t.firstWeekContainsDate)??((u=(x=t==null?void 0:t.locale)==null?void 0:x.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,l=vo(e,0);l.setFullYear(a+1,0,i),l.setHours(0,0,0,0);const o=bo(l,t),c=vo(e,0);c.setFullYear(a,0,i),c.setHours(0,0,0,0);const d=bo(c,t);return r.getTime()>=o.getTime()?a+1:r.getTime()>=d.getTime()?a:a-1}function uX(e,t){var o,c,d,x;const r=cm(),a=(t==null?void 0:t.firstWeekContainsDate)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((x=(d=r.locale)==null?void 0:d.options)==null?void 0:x.firstWeekContainsDate)??1,n=uN(e,t),i=vo(e,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),bo(i,t)}function fX(e,t){const r=on(e),a=+bo(r,t)-+uX(r,t);return Math.round(a/cN)+1}function St(e,t){const r=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return r+a}const ji={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return St(t==="yy"?a%100:a,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):St(r+1,2)},d(e,t){return St(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return St(e.getHours()%12||12,t.length)},H(e,t){return St(e.getHours(),t.length)},m(e,t){return St(e.getMinutes(),t.length)},s(e,t){return St(e.getSeconds(),t.length)},S(e,t){const r=t.length,a=e.getMilliseconds(),n=Math.trunc(a*Math.pow(10,r-3));return St(n,t.length)}},Ho={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},c8={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const a=e.getFullYear(),n=a>0?a:1-a;return r.ordinalNumber(n,{unit:"year"})}return ji.y(e,t)},Y:function(e,t,r,a){const n=uN(e,a),i=n>0?n:1-n;if(t==="YY"){const l=i%100;return St(l,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):St(i,t.length)},R:function(e,t){const r=dN(e);return St(r,t.length)},u:function(e,t){const r=e.getFullYear();return St(r,t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return St(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return St(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return ji.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return St(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const n=fX(e,a);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):St(n,t.length)},I:function(e,t,r){const a=xX(e);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):St(a,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ji.d(e,t)},D:function(e,t,r){const a=dX(e);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):St(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const n=e.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return St(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const n=e.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return St(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),n=a===0?7:a;switch(t){case"i":return String(n);case"ii":return St(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let n;switch(a===12?n=Ho.noon:a===0?n=Ho.midnight:n=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let n;switch(a>=17?n=Ho.evening:a>=12?n=Ho.afternoon:a>=4?n=Ho.morning:n=Ho.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return ji.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ji.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):St(a,t.length)},k:function(e,t,r){let a=e.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):St(a,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ji.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ji.s(e,t)},S:function(e,t){return ji.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return x8(a);case"XXXX":case"XX":return Dl(a);case"XXXXX":case"XXX":default:return Dl(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return x8(a);case"xxxx":case"xx":return Dl(a);case"xxxxx":case"xxx":default:return Dl(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+d8(a,":");case"OOOO":default:return"GMT"+Dl(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+d8(a,":");case"zzzz":default:return"GMT"+Dl(a,":")}},t:function(e,t,r){const a=Math.trunc(e.getTime()/1e3);return St(a,t.length)},T:function(e,t,r){const a=e.getTime();return St(a,t.length)}};function d8(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=Math.trunc(a/60),i=a%60;return i===0?r+String(n):r+String(n)+t+St(i,2)}function x8(e,t){return e%60===0?(e>0?"-":"+")+St(Math.abs(e)/60,2):Dl(e,t)}function Dl(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=St(Math.trunc(a/60),2),i=St(a%60,2);return r+n+t+i}const u8=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},fN=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},hX=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return u8(e,t);let i;switch(a){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",u8(a,t)).replace("{{time}}",fN(n,t))},mX={p:fN,P:hX},gX=/^D+$/,pX=/^Y+$/,vX=["D","DD","YY","YYYY"];function bX(e){return gX.test(e)}function yX(e){return pX.test(e)}function wX(e,t,r){const a=EX(e,t,r);if(console.warn(a),vX.includes(e))throw new RangeError(a)}function EX(e,t,r){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const _X=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,jX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,NX=/^'([^]*?)'?$/,CX=/''/g,AX=/[a-zA-Z]/;function k1(e,t,r){var x,u,f,h,p,g,y,v;const a=cm(),n=(r==null?void 0:r.locale)??a.locale??cX,i=(r==null?void 0:r.firstWeekContainsDate)??((u=(x=r==null?void 0:r.locale)==null?void 0:x.options)==null?void 0:u.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(f=a.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((g=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??a.weekStartsOn??((v=(y=a.locale)==null?void 0:y.options)==null?void 0:v.weekStartsOn)??0,o=on(e);if(!SY(o))throw new RangeError("Invalid time value");let c=t.match(jX).map(w=>{const m=w[0];if(m==="p"||m==="P"){const b=mX[m];return b(w,n.formatLong)}return w}).join("").match(_X).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const m=w[0];if(m==="'")return{isToken:!1,value:kX(w)};if(c8[m])return{isToken:!0,value:w};if(m.match(AX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:w}});n.localize.preprocessor&&(c=n.localize.preprocessor(o,c));const d={firstWeekContainsDate:i,weekStartsOn:l,locale:n};return c.map(w=>{if(!w.isToken)return w.value;const m=w.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&yX(m)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&bX(m))&&wX(m,t,String(e));const b=c8[m[0]];return b(o,m,n.localize,d)}).join("")}function kX(e){const t=e.match(NX);return t?t[1].replace(CX,"'"):e}function f8(e,t,r){const a=bo(e,r),n=bo(t,r);return+a==+n}function L0(e,t){if(e.one!==void 0&&t===1)return e.one;const r=t%10,a=t%100;return r===1&&a!==11?e.singularNominative.replace("{{count}}",String(t)):r>=2&&r<=4&&(a<10||a>20)?e.singularGenitive.replace("{{count}}",String(t)):e.pluralGenitive.replace("{{count}}",String(t))}function As(e){return(t,r)=>r!=null&&r.addSuffix?r.comparison&&r.comparison>0?e.future?L0(e.future,t):" "+L0(e.regular,t):e.past?L0(e.past,t):L0(e.regular,t)+" ":L0(e.regular,t)}const DX={lessThanXSeconds:As({regular:{one:" ",singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{one:",   ",singularNominative:",   {{count}} ",singularGenitive:",   {{count}} ",pluralGenitive:",   {{count}} "}}),xSeconds:As({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "},past:{singularNominative:"{{count}}  ",singularGenitive:"{{count}}  ",pluralGenitive:"{{count}}  "},future:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "}}),halfAMinute:(e,t)=>t!=null&&t.addSuffix?t.comparison&&t.comparison>0?" ":" ":"",lessThanXMinutes:As({regular:{one:" ",singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{one:",   ",singularNominative:",   {{count}} ",singularGenitive:",   {{count}} ",pluralGenitive:",   {{count}} "}}),xMinutes:As({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "},past:{singularNominative:"{{count}}  ",singularGenitive:"{{count}}  ",pluralGenitive:"{{count}}  "},future:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "}}),aboutXHours:As({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xHours:As({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),xDays:As({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),aboutXWeeks:As({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xWeeks:As({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),aboutXMonths:As({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xMonths:As({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),aboutXYears:As({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xYears:As({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),overXYears:As({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:",   {{count}} ",singularGenitive:",   {{count}} ",pluralGenitive:",   {{count}} "}}),almostXYears:As({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}})},SX=(e,t,r)=>DX[e](t,r),BX={full:"EEEE, d MMMM y '.'",long:"d MMMM y '.'",medium:"d MMM y '.'",short:"dd.MM.y"},FX={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},TX={any:"{{date}}, {{time}}"},MX={date:Sc({formats:BX,defaultWidth:"full"}),time:Sc({formats:FX,defaultWidth:"full"}),dateTime:Sc({formats:TX,defaultWidth:"any"})},ty=["","","","","","",""];function RX(e){const t=ty[e];switch(e){case 0:return"'  "+t+" ' p";case 1:case 2:case 4:return"'  "+t+" ' p";case 3:case 5:case 6:return"'  "+t+" ' p"}}function h8(e){const t=ty[e];return e===2?"' "+t+" ' p":"' "+t+" ' p"}function OX(e){const t=ty[e];switch(e){case 0:return"'  "+t+" ' p";case 1:case 2:case 4:return"'  "+t+" ' p";case 3:case 5:case 6:return"'  "+t+" ' p"}}const PX={lastWeek:(e,t,r)=>{const a=e.getDay();return f8(e,t,r)?h8(a):RX(a)},yesterday:"' ' p",today:"' ' p",tomorrow:"' ' p",nextWeek:(e,t,r)=>{const a=e.getDay();return f8(e,t,r)?h8(a):OX(a)},other:"P"},LX=(e,t,r,a)=>{const n=PX[e];return typeof n=="function"?n(t,r,a):n},IX={narrow:[" ..",".."],abbreviated:[" . .",". ."],wide:["  "," "]},UX={narrow:["1","2","3","4"],abbreviated:["1- .","2- .","3- .","4- ."],wide:["1- ","2- ","3- ","4- "]},$X={narrow:["","","","","","","","","","","",""],abbreviated:[".",".","",".","","","",".",".",".",".","."],wide:["","","","","","","","","","","",""]},zX={narrow:["","","","","","","","","","","",""],abbreviated:[".",".",".",".","",".",".",".",".",".",".","."],wide:["","","","","","","","","","","",""]},qX={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},VX={narrow:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},abbreviated:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},HX={narrow:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},abbreviated:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},WX=(e,t)=>{const r=Number(e),a=t==null?void 0:t.unit;let n;return a==="date"?n="-":a==="week"||a==="minute"||a==="second"?n="-":n="-",r+n},GX={ordinalNumber:WX,era:vn({values:IX,defaultWidth:"wide"}),quarter:vn({values:UX,defaultWidth:"wide",argumentCallback:e=>e-1}),month:vn({values:$X,defaultWidth:"wide",formattingValues:zX,defaultFormattingWidth:"wide"}),day:vn({values:qX,defaultWidth:"wide"}),dayPeriod:vn({values:VX,defaultWidth:"any",formattingValues:HX,defaultFormattingWidth:"wide"})},YX=/^(\d+)(-?(||||||||||))?/i,XX=/\d+/i,KX={narrow:/^(( )?\.?\s?\.?)/i,abbreviated:/^(( )?\.?\s?\.?)/i,wide:/^(  | | )/i},QX={any:[/^/i,/^/i]},JX={narrow:/^[1234]/i,abbreviated:/^[1234](-?[]??)? .?/i,wide:/^[1234](-?[]??)? /i},ZX={any:[/1/i,/2/i,/3/i,/4/i]},eK={narrow:/^[]/i,abbreviated:/^(||?||[]|[]?|[]?||?||?|)\.?/i,wide:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[]|[])/i},tK={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i]},rK={narrow:/^[]/i,short:/^(|||||||||||)\.?/i,abbreviated:/^(||||||||||||).?/i,wide:/^([]|?|?|[]|?|[]|[])/i},sK={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^[]/i,/^[]/i,/^/i,/^/i,/^/i,/^[]/i,/^[]/i]},aK={narrow:/^([]|\.?|\.?|[]|||\.?|[])/i,abbreviated:/^([]|\.?|\.?|[]|||\.?|[])/i,wide:/^([]|||[]|||?|[])/i},nK={any:{am:/^/i,pm:/^/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^[]/i,evening:/^/i,night:/^/i}},iK={ordinalNumber:xN({matchPattern:YX,parsePattern:XX,valueCallback:e=>parseInt(e,10)}),era:bn({matchPatterns:KX,defaultMatchWidth:"wide",parsePatterns:QX,defaultParseWidth:"any"}),quarter:bn({matchPatterns:JX,defaultMatchWidth:"wide",parsePatterns:ZX,defaultParseWidth:"any",valueCallback:e=>e+1}),month:bn({matchPatterns:eK,defaultMatchWidth:"wide",parsePatterns:tK,defaultParseWidth:"any"}),day:bn({matchPatterns:rK,defaultMatchWidth:"wide",parsePatterns:sK,defaultParseWidth:"any"}),dayPeriod:bn({matchPatterns:aK,defaultMatchWidth:"wide",parsePatterns:nK,defaultParseWidth:"any"})},hN={code:"ru",formatDistance:SX,formatLong:MX,formatRelative:LX,localize:GX,match:iK,options:{weekStartsOn:1,firstWeekContainsDate:1}};var mN={exports:{}};(function(e,t){(function(r,a){e.exports=a()})(Os,function(){var r=1e3,a=6e4,n=36e5,i="millisecond",l="second",o="minute",c="hour",d="day",x="week",u="month",f="quarter",h="year",p="date",g="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(U){var P=["th","st","nd","rd"],F=U%100;return"["+U+(P[(F-20)%10]||P[F]||P[0])+"]"}},m=function(U,P,F){var N=String(U);return!N||N.length>=P?U:""+Array(P+1-N.length).join(F)+U},b={s:m,z:function(U){var P=-U.utcOffset(),F=Math.abs(P),N=Math.floor(F/60),T=F%60;return(P<=0?"+":"-")+m(N,2,"0")+":"+m(T,2,"0")},m:function U(P,F){if(P.date()<F.date())return-U(F,P);var N=12*(F.year()-P.year())+(F.month()-P.month()),T=P.clone().add(N,u),S=F-T<0,z=P.clone().add(N+(S?-1:1),u);return+(-(N+(F-T)/(S?T-z:z-T))||0)},a:function(U){return U<0?Math.ceil(U)||0:Math.floor(U)},p:function(U){return{M:u,y:h,w:x,d,D:p,h:c,m:o,s:l,ms:i,Q:f}[U]||String(U||"").toLowerCase().replace(/s$/,"")},u:function(U){return U===void 0}},_="en",C={};C[_]=w;var j="$isDayjsObject",D=function(U){return U instanceof B||!(!U||!U[j])},R=function U(P,F,N){var T;if(!P)return _;if(typeof P=="string"){var S=P.toLowerCase();C[S]&&(T=S),F&&(C[S]=F,T=S);var z=P.split("-");if(!T&&z.length>1)return U(z[0])}else{var W=P.name;C[W]=P,T=W}return!N&&T&&(_=T),T||!N&&_},M=function(U,P){if(D(U))return U.clone();var F=typeof P=="object"?P:{};return F.date=U,F.args=arguments,new B(F)},O=b;O.l=R,O.i=D,O.w=function(U,P){return M(U,{locale:P.$L,utc:P.$u,x:P.$x,$offset:P.$offset})};var B=function(){function U(F){this.$L=R(F.locale,null,!0),this.parse(F),this.$x=this.$x||F.x||{},this[j]=!0}var P=U.prototype;return P.parse=function(F){this.$d=function(N){var T=N.date,S=N.utc;if(T===null)return new Date(NaN);if(O.u(T))return new Date;if(T instanceof Date)return new Date(T);if(typeof T=="string"&&!/Z$/i.test(T)){var z=T.match(y);if(z){var W=z[2]-1||0,k=(z[7]||"0").substring(0,3);return S?new Date(Date.UTC(z[1],W,z[3]||1,z[4]||0,z[5]||0,z[6]||0,k)):new Date(z[1],W,z[3]||1,z[4]||0,z[5]||0,z[6]||0,k)}}return new Date(T)}(F),this.init()},P.init=function(){var F=this.$d;this.$y=F.getFullYear(),this.$M=F.getMonth(),this.$D=F.getDate(),this.$W=F.getDay(),this.$H=F.getHours(),this.$m=F.getMinutes(),this.$s=F.getSeconds(),this.$ms=F.getMilliseconds()},P.$utils=function(){return O},P.isValid=function(){return this.$d.toString()!==g},P.isSame=function(F,N){var T=M(F);return this.startOf(N)<=T&&T<=this.endOf(N)},P.isAfter=function(F,N){return M(F)<this.startOf(N)},P.isBefore=function(F,N){return this.endOf(N)<M(F)},P.$g=function(F,N,T){return O.u(F)?this[N]:this.set(T,F)},P.unix=function(){return Math.floor(this.valueOf()/1e3)},P.valueOf=function(){return this.$d.getTime()},P.startOf=function(F,N){var T=this,S=!!O.u(N)||N,z=O.p(F),W=function(Q,te){var re=O.w(T.$u?Date.UTC(T.$y,te,Q):new Date(T.$y,te,Q),T);return S?re:re.endOf(d)},k=function(Q,te){return O.w(T.toDate()[Q].apply(T.toDate("s"),(S?[0,0,0,0]:[23,59,59,999]).slice(te)),T)},q=this.$W,A=this.$M,I=this.$D,V="set"+(this.$u?"UTC":"");switch(z){case h:return S?W(1,0):W(31,11);case u:return S?W(1,A):W(0,A+1);case x:var H=this.$locale().weekStart||0,Y=(q<H?q+7:q)-H;return W(S?I-Y:I+(6-Y),A);case d:case p:return k(V+"Hours",0);case c:return k(V+"Minutes",1);case o:return k(V+"Seconds",2);case l:return k(V+"Milliseconds",3);default:return this.clone()}},P.endOf=function(F){return this.startOf(F,!1)},P.$set=function(F,N){var T,S=O.p(F),z="set"+(this.$u?"UTC":""),W=(T={},T[d]=z+"Date",T[p]=z+"Date",T[u]=z+"Month",T[h]=z+"FullYear",T[c]=z+"Hours",T[o]=z+"Minutes",T[l]=z+"Seconds",T[i]=z+"Milliseconds",T)[S],k=S===d?this.$D+(N-this.$W):N;if(S===u||S===h){var q=this.clone().set(p,1);q.$d[W](k),q.init(),this.$d=q.set(p,Math.min(this.$D,q.daysInMonth())).$d}else W&&this.$d[W](k);return this.init(),this},P.set=function(F,N){return this.clone().$set(F,N)},P.get=function(F){return this[O.p(F)]()},P.add=function(F,N){var T,S=this;F=Number(F);var z=O.p(N),W=function(A){var I=M(S);return O.w(I.date(I.date()+Math.round(A*F)),S)};if(z===u)return this.set(u,this.$M+F);if(z===h)return this.set(h,this.$y+F);if(z===d)return W(1);if(z===x)return W(7);var k=(T={},T[o]=a,T[c]=n,T[l]=r,T)[z]||1,q=this.$d.getTime()+F*k;return O.w(q,this)},P.subtract=function(F,N){return this.add(-1*F,N)},P.format=function(F){var N=this,T=this.$locale();if(!this.isValid())return T.invalidDate||g;var S=F||"YYYY-MM-DDTHH:mm:ssZ",z=O.z(this),W=this.$H,k=this.$m,q=this.$M,A=T.weekdays,I=T.months,V=T.meridiem,H=function(te,re,X,je){return te&&(te[re]||te(N,S))||X[re].slice(0,je)},Y=function(te){return O.s(W%12||12,te,"0")},Q=V||function(te,re,X){var je=te<12?"AM":"PM";return X?je.toLowerCase():je};return S.replace(v,function(te,re){return re||function(X){switch(X){case"YY":return String(N.$y).slice(-2);case"YYYY":return O.s(N.$y,4,"0");case"M":return q+1;case"MM":return O.s(q+1,2,"0");case"MMM":return H(T.monthsShort,q,I,3);case"MMMM":return H(I,q);case"D":return N.$D;case"DD":return O.s(N.$D,2,"0");case"d":return String(N.$W);case"dd":return H(T.weekdaysMin,N.$W,A,2);case"ddd":return H(T.weekdaysShort,N.$W,A,3);case"dddd":return A[N.$W];case"H":return String(W);case"HH":return O.s(W,2,"0");case"h":return Y(1);case"hh":return Y(2);case"a":return Q(W,k,!0);case"A":return Q(W,k,!1);case"m":return String(k);case"mm":return O.s(k,2,"0");case"s":return String(N.$s);case"ss":return O.s(N.$s,2,"0");case"SSS":return O.s(N.$ms,3,"0");case"Z":return z}return null}(te)||z.replace(":","")})},P.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},P.diff=function(F,N,T){var S,z=this,W=O.p(N),k=M(F),q=(k.utcOffset()-this.utcOffset())*a,A=this-k,I=function(){return O.m(z,k)};switch(W){case h:S=I()/12;break;case u:S=I();break;case f:S=I()/3;break;case x:S=(A-q)/6048e5;break;case d:S=(A-q)/864e5;break;case c:S=A/n;break;case o:S=A/a;break;case l:S=A/r;break;default:S=A}return T?S:O.a(S)},P.daysInMonth=function(){return this.endOf(u).$D},P.$locale=function(){return C[this.$L]},P.locale=function(F,N){if(!F)return this.$L;var T=this.clone(),S=R(F,N,!0);return S&&(T.$L=S),T},P.clone=function(){return O.w(this.$d,this)},P.toDate=function(){return new Date(this.valueOf())},P.toJSON=function(){return this.isValid()?this.toISOString():null},P.toISOString=function(){return this.$d.toISOString()},P.toString=function(){return this.$d.toUTCString()},U}(),L=B.prototype;return M.prototype=L,[["$ms",i],["$s",l],["$m",o],["$H",c],["$W",d],["$M",u],["$y",h],["$D",p]].forEach(function(U){L[U[1]]=function(P){return this.$g(P,U[0],U[1])}}),M.extend=function(U,P){return U.$i||(U(P,B,M),U.$i=!0),M},M.locale=R,M.isDayjs=D,M.unix=function(U){return M(1e3*U)},M.en=C[_],M.Ls=C,M.p={},M})})(mN);var gN=mN.exports;const Aa=iv(gN);var lK={exports:{}};(function(e,t){(function(r,a){e.exports=a(gN)})(Os,function(r){function a(p){return p&&typeof p=="object"&&"default"in p?p:{default:p}}var n=a(r),i="___________".split("_"),l="___________".split("_"),o="._._._.____._._._._.".split("_"),c="._.__.____._._._._.".split("_"),d=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function x(p,g,y){var v,w;return y==="m"?g?"":"":p+" "+(v=+p,w={mm:g?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"}[y].split("_"),v%10==1&&v%100!=11?w[0]:v%10>=2&&v%10<=4&&(v%100<10||v%100>=20)?w[1]:w[2])}var u=function(p,g){return d.test(g)?i[p.month()]:l[p.month()]};u.s=l,u.f=i;var f=function(p,g){return d.test(g)?o[p.month()]:c[p.month()]};f.s=c,f.f=o;var h={name:"ru",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:u,monthsShort:f,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},relativeTime:{future:" %s",past:"%s ",s:" ",m:x,mm:x,h:"",hh:x,d:"",dd:x,M:"",MM:x,y:"",yy:x},ordinal:function(p){return p},meridiem:function(p){return p<4?"":p<12?"":p<17?"":""}};return n.default.locale(h,null,!0),h})})(lK);const ry=E.createContext({});function sy(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const ay=typeof window<"u",pN=ay?E.useLayoutEffect:E.useEffect,dm=E.createContext(null);function ny(e,t){e.indexOf(t)===-1&&e.push(t)}function iy(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const fi=(e,t,r)=>r>t?t:r<e?e:r;let ly=()=>{};const hi={},vN=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function bN(e){return typeof e=="object"&&e!==null}const yN=e=>/^0[^.\s]+$/u.test(e);function oy(e){let t;return()=>(t===void 0&&(t=e()),t)}const Ma=e=>e,oK=(e,t)=>r=>t(e(r)),Qx=(...e)=>e.reduce(oK),bx=(e,t,r)=>{const a=t-e;return a===0?1:(r-e)/a};class cy{constructor(){this.subscriptions=[]}add(t){return ny(this.subscriptions,t),()=>iy(this.subscriptions,t)}notify(t,r,a){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,a);else for(let i=0;i<n;i++){const l=this.subscriptions[i];l&&l(t,r,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const jn=e=>e*1e3,Nn=e=>e/1e3;function wN(e,t){return t?e*(1e3/t):0}const EN=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,cK=1e-7,dK=12;function xK(e,t,r,a,n){let i,l,o=0;do l=t+(r-t)/2,i=EN(l,a,n)-e,i>0?r=l:t=l;while(Math.abs(i)>cK&&++o<dK);return l}function Jx(e,t,r,a){if(e===t&&r===a)return Ma;const n=i=>xK(i,0,1,e,r);return i=>i===0||i===1?i:EN(n(i),t,a)}const _N=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,jN=e=>t=>1-e(1-t),NN=Jx(.33,1.53,.69,.99),dy=jN(NN),CN=_N(dy),AN=e=>(e*=2)<1?.5*dy(e):.5*(2-Math.pow(2,-10*(e-1))),xy=e=>1-Math.sin(Math.acos(e)),kN=jN(xy),DN=_N(xy),uK=Jx(.42,0,1,1),fK=Jx(0,0,.58,1),SN=Jx(.42,0,.58,1),hK=e=>Array.isArray(e)&&typeof e[0]!="number",BN=e=>Array.isArray(e)&&typeof e[0]=="number",mK={linear:Ma,easeIn:uK,easeInOut:SN,easeOut:fK,circIn:xy,circInOut:DN,circOut:kN,backIn:dy,backInOut:CN,backOut:NN,anticipate:AN},gK=e=>typeof e=="string",m8=e=>{if(BN(e)){ly(e.length===4);const[t,r,a,n]=e;return Jx(t,r,a,n)}else if(gK(e))return mK[e];return e},Uu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function pK(e,t){let r=new Set,a=new Set,n=!1,i=!1;const l=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(x){l.has(x)&&(d.schedule(x),e()),x(o)}const d={schedule:(x,u=!1,f=!1)=>{const p=f&&n?r:a;return u&&l.add(x),p.has(x)||p.add(x),x},cancel:x=>{a.delete(x),l.delete(x)},process:x=>{if(o=x,n){i=!0;return}n=!0,[r,a]=[a,r],r.forEach(c),r.clear(),n=!1,i&&(i=!1,d.process(x))}};return d}const vK=40;function FN(e,t){let r=!1,a=!0;const n={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,l=Uu.reduce((m,b)=>(m[b]=pK(i),m),{}),{setup:o,read:c,resolveKeyframes:d,preUpdate:x,update:u,preRender:f,render:h,postRender:p}=l,g=()=>{const m=hi.useManualTiming?n.timestamp:performance.now();r=!1,hi.useManualTiming||(n.delta=a?1e3/60:Math.max(Math.min(m-n.timestamp,vK),1)),n.timestamp=m,n.isProcessing=!0,o.process(n),c.process(n),d.process(n),x.process(n),u.process(n),f.process(n),h.process(n),p.process(n),n.isProcessing=!1,r&&t&&(a=!1,e(g))},y=()=>{r=!0,a=!0,n.isProcessing||e(g)};return{schedule:Uu.reduce((m,b)=>{const _=l[b];return m[b]=(C,j=!1,D=!1)=>(r||y(),_.schedule(C,j,D)),m},{}),cancel:m=>{for(let b=0;b<Uu.length;b++)l[Uu[b]].cancel(m)},state:n,steps:l}}const{schedule:Kt,cancel:ll,state:as,steps:Fg}=FN(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ma,!0);let uf;function bK(){uf=void 0}const Hs={now:()=>(uf===void 0&&Hs.set(as.isProcessing||hi.useManualTiming?as.timestamp:performance.now()),uf),set:e=>{uf=e,queueMicrotask(bK)}},TN=e=>t=>typeof t=="string"&&t.startsWith(e),uy=TN("--"),yK=TN("var(--"),fy=e=>yK(e)?wK.test(e.split("/*")[0].trim()):!1,wK=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,b0={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},yx={...b0,transform:e=>fi(0,1,e)},$u={...b0,default:1},Ad=e=>Math.round(e*1e5)/1e5,hy=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function EK(e){return e==null}const _K=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,my=(e,t)=>r=>!!(typeof r=="string"&&_K.test(r)&&r.startsWith(e)||t&&!EK(r)&&Object.prototype.hasOwnProperty.call(r,t)),MN=(e,t,r)=>a=>{if(typeof a!="string")return a;const[n,i,l,o]=a.match(hy);return{[e]:parseFloat(n),[t]:parseFloat(i),[r]:parseFloat(l),alpha:o!==void 0?parseFloat(o):1}},jK=e=>fi(0,255,e),Tg={...b0,transform:e=>Math.round(jK(e))},Ll={test:my("rgb","red"),parse:MN("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:a=1})=>"rgba("+Tg.transform(e)+", "+Tg.transform(t)+", "+Tg.transform(r)+", "+Ad(yx.transform(a))+")"};function NK(e){let t="",r="",a="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,a+=a,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:n?parseInt(n,16)/255:1}}const D1={test:my("#"),parse:NK,transform:Ll.transform},Zx=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ai=Zx("deg"),Cn=Zx("%"),tt=Zx("px"),CK=Zx("vh"),AK=Zx("vw"),g8={...Cn,parse:e=>Cn.parse(e)/100,transform:e=>Cn.transform(e*100)},fc={test:my("hsl","hue"),parse:MN("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:a=1})=>"hsla("+Math.round(e)+", "+Cn.transform(Ad(t))+", "+Cn.transform(Ad(r))+", "+Ad(yx.transform(a))+")"},Sr={test:e=>Ll.test(e)||D1.test(e)||fc.test(e),parse:e=>Ll.test(e)?Ll.parse(e):fc.test(e)?fc.parse(e):D1.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ll.transform(e):fc.transform(e),getAnimatableNone:e=>{const t=Sr.parse(e);return t.alpha=0,Sr.transform(t)}},kK=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function DK(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(hy))==null?void 0:t.length)||0)+(((r=e.match(kK))==null?void 0:r.length)||0)>0}const RN="number",ON="color",SK="var",BK="var(",p8="${}",FK=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function wx(e){const t=e.toString(),r=[],a={color:[],number:[],var:[]},n=[];let i=0;const o=t.replace(FK,c=>(Sr.test(c)?(a.color.push(i),n.push(ON),r.push(Sr.parse(c))):c.startsWith(BK)?(a.var.push(i),n.push(SK),r.push(c)):(a.number.push(i),n.push(RN),r.push(parseFloat(c))),++i,p8)).split(p8);return{values:r,split:o,indexes:a,types:n}}function PN(e){return wx(e).values}function LN(e){const{split:t,types:r}=wx(e),a=t.length;return n=>{let i="";for(let l=0;l<a;l++)if(i+=t[l],n[l]!==void 0){const o=r[l];o===RN?i+=Ad(n[l]):o===ON?i+=Sr.transform(n[l]):i+=n[l]}return i}}const TK=e=>typeof e=="number"?0:Sr.test(e)?Sr.getAnimatableNone(e):e;function MK(e){const t=PN(e);return LN(e)(t.map(TK))}const ol={test:DK,parse:PN,createTransformer:LN,getAnimatableNone:MK};function Mg(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function RK({hue:e,saturation:t,lightness:r,alpha:a}){e/=360,t/=100,r/=100;let n=0,i=0,l=0;if(!t)n=i=l=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;n=Mg(c,o,e+1/3),i=Mg(c,o,e),l=Mg(c,o,e-1/3)}return{red:Math.round(n*255),green:Math.round(i*255),blue:Math.round(l*255),alpha:a}}function xh(e,t){return r=>r>0?t:e}const tr=(e,t,r)=>e+(t-e)*r,Rg=(e,t,r)=>{const a=e*e,n=r*(t*t-a)+a;return n<0?0:Math.sqrt(n)},OK=[D1,Ll,fc],PK=e=>OK.find(t=>t.test(e));function v8(e){const t=PK(e);if(!t)return!1;let r=t.parse(e);return t===fc&&(r=RK(r)),r}const b8=(e,t)=>{const r=v8(e),a=v8(t);if(!r||!a)return xh(e,t);const n={...r};return i=>(n.red=Rg(r.red,a.red,i),n.green=Rg(r.green,a.green,i),n.blue=Rg(r.blue,a.blue,i),n.alpha=tr(r.alpha,a.alpha,i),Ll.transform(n))},S1=new Set(["none","hidden"]);function LK(e,t){return S1.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function IK(e,t){return r=>tr(e,t,r)}function gy(e){return typeof e=="number"?IK:typeof e=="string"?fy(e)?xh:Sr.test(e)?b8:zK:Array.isArray(e)?IN:typeof e=="object"?Sr.test(e)?b8:UK:xh}function IN(e,t){const r=[...e],a=r.length,n=e.map((i,l)=>gy(i)(i,t[l]));return i=>{for(let l=0;l<a;l++)r[l]=n[l](i);return r}}function UK(e,t){const r={...e,...t},a={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(a[n]=gy(e[n])(e[n],t[n]));return n=>{for(const i in a)r[i]=a[i](n);return r}}function $K(e,t){const r=[],a={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const i=t.types[n],l=e.indexes[i][a[i]],o=e.values[l]??0;r[n]=o,a[i]++}return r}const zK=(e,t)=>{const r=ol.createTransformer(t),a=wx(e),n=wx(t);return a.indexes.var.length===n.indexes.var.length&&a.indexes.color.length===n.indexes.color.length&&a.indexes.number.length>=n.indexes.number.length?S1.has(e)&&!n.values.length||S1.has(t)&&!a.values.length?LK(e,t):Qx(IN($K(a,n),n.values),r):xh(e,t)};function UN(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?tr(e,t,r):gy(e)(e,t)}const qK=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Kt.update(t,r),stop:()=>ll(t),now:()=>as.isProcessing?as.timestamp:Hs.now()}},$N=(e,t,r=10)=>{let a="";const n=Math.max(Math.round(t/r),2);for(let i=0;i<n;i++)a+=Math.round(e(i/(n-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},uh=2e4;function py(e){let t=0;const r=50;let a=e.next(t);for(;!a.done&&t<uh;)t+=r,a=e.next(t);return t>=uh?1/0:t}function VK(e,t=100,r){const a=r({...e,keyframes:[0,t]}),n=Math.min(py(a),uh);return{type:"keyframes",ease:i=>a.next(n*i).value/t,duration:Nn(n)}}const HK=5;function zN(e,t,r){const a=Math.max(t-HK,0);return wN(r-e(a),t-a)}const dr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Og=.001;function WK({duration:e=dr.duration,bounce:t=dr.bounce,velocity:r=dr.velocity,mass:a=dr.mass}){let n,i,l=1-t;l=fi(dr.minDamping,dr.maxDamping,l),e=fi(dr.minDuration,dr.maxDuration,Nn(e)),l<1?(n=d=>{const x=d*l,u=x*e,f=x-r,h=B1(d,l),p=Math.exp(-u);return Og-f/h*p},i=d=>{const u=d*l*e,f=u*r+r,h=Math.pow(l,2)*Math.pow(d,2)*e,p=Math.exp(-u),g=B1(Math.pow(d,2),l);return(-n(d)+Og>0?-1:1)*((f-h)*p)/g}):(n=d=>{const x=Math.exp(-d*e),u=(d-r)*e+1;return-Og+x*u},i=d=>{const x=Math.exp(-d*e),u=(r-d)*(e*e);return x*u});const o=5/e,c=YK(n,i,o);if(e=jn(e),isNaN(c))return{stiffness:dr.stiffness,damping:dr.damping,duration:e};{const d=Math.pow(c,2)*a;return{stiffness:d,damping:l*2*Math.sqrt(a*d),duration:e}}}const GK=12;function YK(e,t,r){let a=r;for(let n=1;n<GK;n++)a=a-e(a)/t(a);return a}function B1(e,t){return e*Math.sqrt(1-t*t)}const XK=["duration","bounce"],KK=["stiffness","damping","mass"];function y8(e,t){return t.some(r=>e[r]!==void 0)}function QK(e){let t={velocity:dr.velocity,stiffness:dr.stiffness,damping:dr.damping,mass:dr.mass,isResolvedFromDuration:!1,...e};if(!y8(e,KK)&&y8(e,XK))if(e.visualDuration){const r=e.visualDuration,a=2*Math.PI/(r*1.2),n=a*a,i=2*fi(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:dr.mass,stiffness:n,damping:i}}else{const r=WK(e);t={...t,...r,mass:dr.mass},t.isResolvedFromDuration=!0}return t}function fh(e=dr.visualDuration,t=dr.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:n}=r;const i=r.keyframes[0],l=r.keyframes[r.keyframes.length-1],o={done:!1,value:i},{stiffness:c,damping:d,mass:x,duration:u,velocity:f,isResolvedFromDuration:h}=QK({...r,velocity:-Nn(r.velocity||0)}),p=f||0,g=d/(2*Math.sqrt(c*x)),y=l-i,v=Nn(Math.sqrt(c/x)),w=Math.abs(y)<5;a||(a=w?dr.restSpeed.granular:dr.restSpeed.default),n||(n=w?dr.restDelta.granular:dr.restDelta.default);let m;if(g<1){const _=B1(v,g);m=C=>{const j=Math.exp(-g*v*C);return l-j*((p+g*v*y)/_*Math.sin(_*C)+y*Math.cos(_*C))}}else if(g===1)m=_=>l-Math.exp(-v*_)*(y+(p+v*y)*_);else{const _=v*Math.sqrt(g*g-1);m=C=>{const j=Math.exp(-g*v*C),D=Math.min(_*C,300);return l-j*((p+g*v*y)*Math.sinh(D)+_*y*Math.cosh(D))/_}}const b={calculatedDuration:h&&u||null,next:_=>{const C=m(_);if(h)o.done=_>=u;else{let j=_===0?p:0;g<1&&(j=_===0?jn(p):zN(m,_,C));const D=Math.abs(j)<=a,R=Math.abs(l-C)<=n;o.done=D&&R}return o.value=o.done?l:C,o},toString:()=>{const _=Math.min(py(b),uh),C=$N(j=>b.next(_*j).value,_,30);return _+"ms "+C},toTransition:()=>{}};return b}fh.applyToOptions=e=>{const t=VK(e,100,fh);return e.ease=t.ease,e.duration=jn(t.duration),e.type="keyframes",e};function F1({keyframes:e,velocity:t=0,power:r=.8,timeConstant:a=325,bounceDamping:n=10,bounceStiffness:i=500,modifyTarget:l,min:o,max:c,restDelta:d=.5,restSpeed:x}){const u=e[0],f={done:!1,value:u},h=D=>o!==void 0&&D<o||c!==void 0&&D>c,p=D=>o===void 0?c:c===void 0||Math.abs(o-D)<Math.abs(c-D)?o:c;let g=r*t;const y=u+g,v=l===void 0?y:l(y);v!==y&&(g=v-u);const w=D=>-g*Math.exp(-D/a),m=D=>v+w(D),b=D=>{const R=w(D),M=m(D);f.done=Math.abs(R)<=d,f.value=f.done?v:M};let _,C;const j=D=>{h(f.value)&&(_=D,C=fh({keyframes:[f.value,p(f.value)],velocity:zN(m,D,f.value),damping:n,stiffness:i,restDelta:d,restSpeed:x}))};return j(0),{calculatedDuration:null,next:D=>{let R=!1;return!C&&_===void 0&&(R=!0,b(D),j(D)),_!==void 0&&D>=_?C.next(D-_):(!R&&b(D),f)}}}function JK(e,t,r){const a=[],n=r||hi.mix||UN,i=e.length-1;for(let l=0;l<i;l++){let o=n(e[l],e[l+1]);if(t){const c=Array.isArray(t)?t[l]||Ma:t;o=Qx(c,o)}a.push(o)}return a}function ZK(e,t,{clamp:r=!0,ease:a,mixer:n}={}){const i=e.length;if(ly(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const l=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=JK(t,a,n),c=o.length,d=x=>{if(l&&x<e[0])return t[0];let u=0;if(c>1)for(;u<e.length-2&&!(x<e[u+1]);u++);const f=bx(e[u],e[u+1],x);return o[u](f)};return r?x=>d(fi(e[0],e[i-1],x)):d}function eQ(e,t){const r=e[e.length-1];for(let a=1;a<=t;a++){const n=bx(0,t,a);e.push(tr(r,1,n))}}function tQ(e){const t=[0];return eQ(t,e.length-1),t}function rQ(e,t){return e.map(r=>r*t)}function sQ(e,t){return e.map(()=>t||SN).splice(0,e.length-1)}function kd({duration:e=300,keyframes:t,times:r,ease:a="easeInOut"}){const n=hK(a)?a.map(m8):m8(a),i={done:!1,value:t[0]},l=rQ(r&&r.length===t.length?r:tQ(t),e),o=ZK(l,t,{ease:Array.isArray(n)?n:sQ(t,n)});return{calculatedDuration:e,next:c=>(i.value=o(c),i.done=c>=e,i)}}const aQ=e=>e!==null;function vy(e,{repeat:t,repeatType:r="loop"},a,n=1){const i=e.filter(aQ),o=n<0||t&&r!=="loop"&&t%2===1?0:i.length-1;return!o||a===void 0?i[o]:a}const nQ={decay:F1,inertia:F1,tween:kd,keyframes:kd,spring:fh};function qN(e){typeof e.type=="string"&&(e.type=nQ[e.type])}class by{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const iQ=e=>e/100;class yy extends by{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,n;const{motionValue:r}=this.options;r&&r.updatedAt!==Hs.now()&&this.tick(Hs.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(a=this.options).onStop)==null||n.call(a))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;qN(t);const{type:r=kd,repeat:a=0,repeatDelay:n=0,repeatType:i,velocity:l=0}=t;let{keyframes:o}=t;const c=r||kd;c!==kd&&typeof o[0]!="number"&&(this.mixKeyframes=Qx(iQ,UN(o[0],o[1])),o=[0,100]);const d=c({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-l})),d.calculatedDuration===null&&(d.calculatedDuration=py(d));const{calculatedDuration:x}=d;this.calculatedDuration=x,this.resolvedDuration=x+n,this.totalDuration=this.resolvedDuration*(a+1)-n,this.generator=d}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:a,totalDuration:n,mixKeyframes:i,mirroredGenerator:l,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return a.next(0);const{delay:d=0,keyframes:x,repeat:u,repeatType:f,repeatDelay:h,type:p,onUpdate:g,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const v=this.currentTime-d*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?v<0:v>n;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let m=this.currentTime,b=a;if(u){const D=Math.min(this.currentTime,n)/o;let R=Math.floor(D),M=D%1;!M&&D>=1&&(M=1),M===1&&R--,R=Math.min(R,u+1),!!(R%2)&&(f==="reverse"?(M=1-M,h&&(M-=h/o)):f==="mirror"&&(b=l)),m=fi(0,1,M)*o}const _=w?{done:!1,value:x[0]}:b.next(m);i&&(_.value=i(_.value));let{done:C}=_;!w&&c!==null&&(C=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const j=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return j&&p!==F1&&(_.value=vy(x,this.options,y,this.speed)),g&&g(_.value),j&&this.finish(),_}then(t,r){return this.finished.then(t,r)}get duration(){return Nn(this.calculatedDuration)}get time(){return Nn(this.currentTime)}set time(t){var r;t=jn(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Hs.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Nn(this.currentTime))}play(){var n,i;if(this.isStopped)return;const{driver:t=qK,startTime:r}=this.options;this.driver||(this.driver=t(l=>this.tick(l))),(i=(n=this.options).onPlay)==null||i.call(n);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=r??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Hs.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function lQ(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Il=e=>e*180/Math.PI,T1=e=>{const t=Il(Math.atan2(e[1],e[0]));return M1(t)},oQ={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:T1,rotateZ:T1,skewX:e=>Il(Math.atan(e[1])),skewY:e=>Il(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},M1=e=>(e=e%360,e<0&&(e+=360),e),w8=T1,E8=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),_8=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),cQ={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:E8,scaleY:_8,scale:e=>(E8(e)+_8(e))/2,rotateX:e=>M1(Il(Math.atan2(e[6],e[5]))),rotateY:e=>M1(Il(Math.atan2(-e[2],e[0]))),rotateZ:w8,rotate:w8,skewX:e=>Il(Math.atan(e[4])),skewY:e=>Il(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function R1(e){return e.includes("scale")?1:0}function O1(e,t){if(!e||e==="none")return R1(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,n;if(r)a=cQ,n=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=oQ,n=o}if(!n)return R1(t);const i=a[t],l=n[1].split(",").map(xQ);return typeof i=="function"?i(l):l[i]}const dQ=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return O1(r,t)};function xQ(e){return parseFloat(e.trim())}const y0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],w0=new Set(y0),j8=e=>e===b0||e===tt,uQ=new Set(["x","y","z"]),fQ=y0.filter(e=>!uQ.has(e));function hQ(e){const t=[];return fQ.forEach(r=>{const a=e.getValue(r);a!==void 0&&(t.push([r,a.get()]),a.set(r.startsWith("scale")?1:0))}),t}const Zl={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>O1(t,"x"),y:(e,{transform:t})=>O1(t,"y")};Zl.translateX=Zl.x;Zl.translateY=Zl.y;const eo=new Set;let P1=!1,L1=!1,I1=!1;function VN(){if(L1){const e=Array.from(eo).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),r=new Map;t.forEach(a=>{const n=hQ(a);n.length&&(r.set(a,n),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const n=r.get(a);n&&n.forEach(([i,l])=>{var o;(o=a.getValue(i))==null||o.set(l)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}L1=!1,P1=!1,eo.forEach(e=>e.complete(I1)),eo.clear()}function HN(){eo.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(L1=!0)})}function mQ(){I1=!0,HN(),VN(),I1=!1}class wy{constructor(t,r,a,n,i,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=a,this.motionValue=n,this.element=i,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(eo.add(this),P1||(P1=!0,Kt.read(HN),Kt.resolveKeyframes(VN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:a,motionValue:n}=this;if(t[0]===null){const i=n==null?void 0:n.get(),l=t[t.length-1];if(i!==void 0)t[0]=i;else if(a&&r){const o=a.readValue(r,l);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=l),n&&i===void 0&&n.set(t[0])}lQ(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),eo.delete(this)}cancel(){this.state==="scheduled"&&(eo.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const gQ=e=>e.startsWith("--");function pQ(e,t,r){gQ(t)?e.style.setProperty(t,r):e.style[t]=r}const vQ=oy(()=>window.ScrollTimeline!==void 0),bQ={};function yQ(e,t){const r=oy(e);return()=>bQ[t]??r()}const WN=yQ(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),J0=([e,t,r,a])=>`cubic-bezier(${e}, ${t}, ${r}, ${a})`,N8={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:J0([0,.65,.55,1]),circOut:J0([.55,0,1,.45]),backIn:J0([.31,.01,.66,-.59]),backOut:J0([.33,1.53,.69,.99])};function GN(e,t){if(e)return typeof e=="function"?WN()?$N(e,t):"ease-out":BN(e)?J0(e):Array.isArray(e)?e.map(r=>GN(r,t)||N8.easeOut):N8[e]}function wQ(e,t,r,{delay:a=0,duration:n=300,repeat:i=0,repeatType:l="loop",ease:o="easeOut",times:c}={},d=void 0){const x={[t]:r};c&&(x.offset=c);const u=GN(o,n);Array.isArray(u)&&(x.easing=u);const f={delay:a,duration:n,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:l==="reverse"?"alternate":"normal"};return d&&(f.pseudoElement=d),e.animate(x,f)}function YN(e){return typeof e=="function"&&"applyToOptions"in e}function EQ({type:e,...t}){return YN(e)&&WN()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class _Q extends by{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:a,keyframes:n,pseudoElement:i,allowFlatten:l=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!i,this.allowFlatten=l,this.options=t,ly(typeof t.type!="string");const d=EQ(t);this.animation=wQ(r,a,n,d,i),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const x=vy(n,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(x):pQ(r,a,x),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,a;const t=((a=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:a.call(r).duration)||0;return Nn(Number(t))}get time(){return Nn(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=jn(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&vQ()?(this.animation.timeline=t,Ma):r(this)}}const XN={anticipate:AN,backInOut:CN,circInOut:DN};function jQ(e){return e in XN}function NQ(e){typeof e.ease=="string"&&jQ(e.ease)&&(e.ease=XN[e.ease])}const C8=10;class CQ extends _Q{constructor(t){NQ(t),qN(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:a,onComplete:n,element:i,...l}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new yy({...l,autoplay:!1}),c=jn(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-C8).value,o.sample(c).value,C8),o.stop()}}const A8=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ol.test(e)||e==="0")&&!e.startsWith("url("));function AQ(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function kQ(e,t,r,a){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],l=A8(n,t),o=A8(i,t);return!l||!o?!1:AQ(e)||(r==="spring"||YN(r))&&a}function U1(e){e.duration=0,e.type}const DQ=new Set(["opacity","clipPath","filter","transform"]),SQ=oy(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function BQ(e){var x;const{motionValue:t,name:r,repeatDelay:a,repeatType:n,damping:i,type:l}=e;if(!(((x=t==null?void 0:t.owner)==null?void 0:x.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=t.owner.getProps();return SQ()&&r&&DQ.has(r)&&(r!=="transform"||!d)&&!c&&!a&&n!=="mirror"&&i!==0&&l!=="inertia"}const FQ=40;class TQ extends by{constructor({autoplay:t=!0,delay:r=0,type:a="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:l="loop",keyframes:o,name:c,motionValue:d,element:x,...u}){var p;super(),this.stop=()=>{var g,y;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(y=this.keyframeResolver)==null||y.cancel()},this.createdAt=Hs.now();const f={autoplay:t,delay:r,type:a,repeat:n,repeatDelay:i,repeatType:l,name:c,motionValue:d,element:x,...u},h=(x==null?void 0:x.KeyframeResolver)||wy;this.keyframeResolver=new h(o,(g,y,v)=>this.onKeyframesResolved(g,y,f,!v),c,d,x),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,r,a,n){this.keyframeResolver=void 0;const{name:i,type:l,velocity:o,delay:c,isHandoff:d,onUpdate:x}=a;this.resolvedAt=Hs.now(),kQ(t,i,l,o)||((hi.instantAnimations||!c)&&(x==null||x(vy(t,a,r))),t[0]=t[t.length-1],U1(a),a.repeat=0);const f={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>FQ?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...a,keyframes:t},h=!d&&BQ(f)?new CQ({...f,element:f.motionValue.owner.current}):new yy(f);h.finished.then(()=>this.notifyFinished()).catch(Ma),this.pendingTimeline&&(this.stopTimeline=h.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=h}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),mQ()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const MQ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function RQ(e){const t=MQ.exec(e);if(!t)return[,];const[,r,a,n]=t;return[`--${r??a}`,n]}function KN(e,t,r=1){const[a,n]=RQ(e);if(!a)return;const i=window.getComputedStyle(t).getPropertyValue(a);if(i){const l=i.trim();return vN(l)?parseFloat(l):l}return fy(n)?KN(n,t,r+1):n}function Ey(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const QN=new Set(["width","height","top","left","right","bottom",...y0]),OQ={test:e=>e==="auto",parse:e=>e},JN=e=>t=>t.test(e),ZN=[b0,tt,Cn,Ai,AK,CK,OQ],k8=e=>ZN.find(JN(e));function PQ(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||yN(e):!0}const LQ=new Set(["brightness","contrast","saturate","opacity"]);function IQ(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=r.match(hy)||[];if(!a)return e;const n=r.replace(a,"");let i=LQ.has(t)?1:0;return a!==r&&(i*=100),t+"("+i+n+")"}const UQ=/\b([a-z-]*)\(.*?\)/gu,$1={...ol,getAnimatableNone:e=>{const t=e.match(UQ);return t?t.map(IQ).join(" "):e}},D8={...b0,transform:Math.round},$Q={rotate:Ai,rotateX:Ai,rotateY:Ai,rotateZ:Ai,scale:$u,scaleX:$u,scaleY:$u,scaleZ:$u,skew:Ai,skewX:Ai,skewY:Ai,distance:tt,translateX:tt,translateY:tt,translateZ:tt,x:tt,y:tt,z:tt,perspective:tt,transformPerspective:tt,opacity:yx,originX:g8,originY:g8,originZ:tt},_y={borderWidth:tt,borderTopWidth:tt,borderRightWidth:tt,borderBottomWidth:tt,borderLeftWidth:tt,borderRadius:tt,radius:tt,borderTopLeftRadius:tt,borderTopRightRadius:tt,borderBottomRightRadius:tt,borderBottomLeftRadius:tt,width:tt,maxWidth:tt,height:tt,maxHeight:tt,top:tt,right:tt,bottom:tt,left:tt,padding:tt,paddingTop:tt,paddingRight:tt,paddingBottom:tt,paddingLeft:tt,margin:tt,marginTop:tt,marginRight:tt,marginBottom:tt,marginLeft:tt,backgroundPositionX:tt,backgroundPositionY:tt,...$Q,zIndex:D8,fillOpacity:yx,strokeOpacity:yx,numOctaves:D8},zQ={..._y,color:Sr,backgroundColor:Sr,outlineColor:Sr,fill:Sr,stroke:Sr,borderColor:Sr,borderTopColor:Sr,borderRightColor:Sr,borderBottomColor:Sr,borderLeftColor:Sr,filter:$1,WebkitFilter:$1},eC=e=>zQ[e];function tC(e,t){let r=eC(e);return r!==$1&&(r=ol),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const qQ=new Set(["auto","none","0"]);function VQ(e,t,r){let a=0,n;for(;a<e.length&&!n;){const i=e[a];typeof i=="string"&&!qQ.has(i)&&wx(i).values.length&&(n=e[a]),a++}if(n&&r)for(const i of t)e[i]=tC(r,n)}class HQ extends wy{constructor(t,r,a,n,i){super(t,r,a,n,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:a}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let d=t[c];if(typeof d=="string"&&(d=d.trim(),fy(d))){const x=KN(d,r.current);x!==void 0&&(t[c]=x),c===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!QN.has(a)||t.length!==2)return;const[n,i]=t,l=k8(n),o=k8(i);if(l!==o)if(j8(l)&&j8(o))for(let c=0;c<t.length;c++){const d=t[c];typeof d=="string"&&(t[c]=parseFloat(d))}else Zl[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,a=[];for(let n=0;n<t.length;n++)(t[n]===null||PQ(t[n]))&&a.push(n);a.length&&VQ(t,a,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Zl[a](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(a,n).jump(n,!1)}measureEndState(){var o;const{element:t,name:r,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const i=a.length-1,l=a[i];a[i]=Zl[r](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([c,d])=>{t.getValue(c).set(d)}),this.resolveNoneKeyframes()}}function WQ(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const n=(r==null?void 0:r[e])??a.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}const rC=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function sC(e){return bN(e)&&"offsetHeight"in e}const S8=30,GQ=e=>!isNaN(parseFloat(e));class YQ{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var i;const n=Hs.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Hs.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=GQ(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new cy);const a=this.events[t].add(r);return t==="change"?()=>{a(),Kt.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,a){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Hs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>S8)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,S8);return wN(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Kc(e,t){return new YQ(e,t)}const{schedule:jy}=FN(queueMicrotask,!1),Ha={x:!1,y:!1};function aC(){return Ha.x||Ha.y}function XQ(e){return e==="x"||e==="y"?Ha[e]?null:(Ha[e]=!0,()=>{Ha[e]=!1}):Ha.x||Ha.y?null:(Ha.x=Ha.y=!0,()=>{Ha.x=Ha.y=!1})}function nC(e,t){const r=WQ(e),a=new AbortController,n={passive:!0,...t,signal:a.signal};return[r,n,()=>a.abort()]}function B8(e){return!(e.pointerType==="touch"||aC())}function KQ(e,t,r={}){const[a,n,i]=nC(e,r),l=o=>{if(!B8(o))return;const{target:c}=o,d=t(c,o);if(typeof d!="function"||!c)return;const x=u=>{B8(u)&&(d(u),c.removeEventListener("pointerleave",x))};c.addEventListener("pointerleave",x,n)};return a.forEach(o=>{o.addEventListener("pointerenter",l,n)}),i}const iC=(e,t)=>t?e===t?!0:iC(e,t.parentElement):!1,Ny=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,QQ=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function JQ(e){return QQ.has(e.tagName)||e.tabIndex!==-1}const ff=new WeakSet;function F8(e){return t=>{t.key==="Enter"&&e(t)}}function Pg(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const ZQ=(e,t)=>{const r=e.currentTarget;if(!r)return;const a=F8(()=>{if(ff.has(r))return;Pg(r,"down");const n=F8(()=>{Pg(r,"up")}),i=()=>Pg(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",i,t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)};function T8(e){return Ny(e)&&!aC()}function eJ(e,t,r={}){const[a,n,i]=nC(e,r),l=o=>{const c=o.currentTarget;if(!T8(o))return;ff.add(c);const d=t(c,o),x=(h,p)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",f),ff.has(c)&&ff.delete(c),T8(h)&&typeof d=="function"&&d(h,{success:p})},u=h=>{x(h,c===window||c===document||r.useGlobalTarget||iC(c,h.target))},f=h=>{x(h,!1)};window.addEventListener("pointerup",u,n),window.addEventListener("pointercancel",f,n)};return a.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",l,n),sC(o)&&(o.addEventListener("focus",d=>ZQ(d,n)),!JQ(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function lC(e){return bN(e)&&"ownerSVGElement"in e}function tJ(e){return lC(e)&&e.tagName==="svg"}const ws=e=>!!(e&&e.getVelocity),rJ=[...ZN,Sr,ol],sJ=e=>rJ.find(JN(e)),Cy=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class aJ extends E.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const a=r.offsetParent,n=sC(a)&&a.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=n-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function nJ({children:e,isPresent:t,anchorX:r,root:a}){const n=E.useId(),i=E.useRef(null),l=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=E.useContext(Cy);return E.useInsertionEffect(()=>{const{width:c,height:d,top:x,left:u,right:f}=l.current;if(t||!i.current||!c||!d)return;const h=r==="left"?`left: ${u}`:`right: ${f}`;i.current.dataset.motionPopId=n;const p=document.createElement("style");o&&(p.nonce=o);const g=a??document.head;return g.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${h}px !important;
            top: ${x}px !important;
          }
        `),()=>{g.contains(p)&&g.removeChild(p)}},[t]),s.jsx(aJ,{isPresent:t,childRef:i,sizeRef:l,children:E.cloneElement(e,{ref:i})})}const iJ=({children:e,initial:t,isPresent:r,onExitComplete:a,custom:n,presenceAffectsLayout:i,mode:l,anchorX:o,root:c})=>{const d=sy(lJ),x=E.useId();let u=!0,f=E.useMemo(()=>(u=!1,{id:x,initial:t,isPresent:r,custom:n,onExitComplete:h=>{d.set(h,!0);for(const p of d.values())if(!p)return;a&&a()},register:h=>(d.set(h,!1),()=>d.delete(h))}),[r,d,a]);return i&&u&&(f={...f}),E.useMemo(()=>{d.forEach((h,p)=>d.set(p,!1))},[r]),E.useEffect(()=>{!r&&!d.size&&a&&a()},[r]),l==="popLayout"&&(e=s.jsx(nJ,{isPresent:r,anchorX:o,root:c,children:e})),s.jsx(dm.Provider,{value:f,children:e})};function lJ(){return new Map}function oC(e=!0){const t=E.useContext(dm);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:a,register:n}=t,i=E.useId();E.useEffect(()=>{if(e)return n(i)},[e]);const l=E.useCallback(()=>e&&a&&a(i),[i,a,e]);return!r&&a?[!1,l]:[!0]}const zu=e=>e.key||"";function M8(e){const t=[];return E.Children.forEach(e,r=>{E.isValidElement(r)&&t.push(r)}),t}const oJ=({children:e,custom:t,initial:r=!0,onExitComplete:a,presenceAffectsLayout:n=!0,mode:i="sync",propagate:l=!1,anchorX:o="left",root:c})=>{const[d,x]=oC(l),u=E.useMemo(()=>M8(e),[e]),f=l&&!d?[]:u.map(zu),h=E.useRef(!0),p=E.useRef(u),g=sy(()=>new Map),[y,v]=E.useState(u),[w,m]=E.useState(u);pN(()=>{h.current=!1,p.current=u;for(let C=0;C<w.length;C++){const j=zu(w[C]);f.includes(j)?g.delete(j):g.get(j)!==!0&&g.set(j,!1)}},[w,f.length,f.join("-")]);const b=[];if(u!==y){let C=[...u];for(let j=0;j<w.length;j++){const D=w[j],R=zu(D);f.includes(R)||(C.splice(j,0,D),b.push(D))}return i==="wait"&&b.length&&(C=b),m(M8(C)),v(u),null}const{forceRender:_}=E.useContext(ry);return s.jsx(s.Fragment,{children:w.map(C=>{const j=zu(C),D=l&&!d?!1:u===w||f.includes(j),R=()=>{if(g.has(j))g.set(j,!0);else return;let M=!0;g.forEach(O=>{O||(M=!1)}),M&&(_==null||_(),m(p.current),l&&(x==null||x()),a&&a())};return s.jsx(iJ,{isPresent:D,initial:!h.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:i,root:c,onExitComplete:D?void 0:R,anchorX:o,children:C},j)})})},cC=E.createContext({strict:!1}),R8={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Qc={};for(const e in R8)Qc[e]={isEnabled:t=>R8[e].some(r=>!!t[r])};function cJ(e){for(const t in e)Qc[t]={...Qc[t],...e[t]}}const dJ=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hh(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||dJ.has(e)}let dC=e=>!hh(e);function xJ(e){typeof e=="function"&&(dC=t=>t.startsWith("on")?!hh(t):e(t))}try{xJ(require("@emotion/is-prop-valid").default)}catch{}function uJ(e,t,r){const a={};for(const n in e)n==="values"&&typeof e.values=="object"||(dC(n)||r===!0&&hh(n)||!t&&!hh(n)||e.draggable&&n.startsWith("onDrag"))&&(a[n]=e[n]);return a}const xm=E.createContext({});function um(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Ex(e){return typeof e=="string"||Array.isArray(e)}const Ay=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ky=["initial",...Ay];function fm(e){return um(e.animate)||ky.some(t=>Ex(e[t]))}function xC(e){return!!(fm(e)||e.variants)}function fJ(e,t){if(fm(e)){const{initial:r,animate:a}=e;return{initial:r===!1||Ex(r)?r:void 0,animate:Ex(a)?a:void 0}}return e.inherit!==!1?t:{}}function hJ(e){const{initial:t,animate:r}=fJ(e,E.useContext(xm));return E.useMemo(()=>({initial:t,animate:r}),[O8(t),O8(r)])}function O8(e){return Array.isArray(e)?e.join(" "):e}const _x={};function mJ(e){for(const t in e)_x[t]=e[t],uy(t)&&(_x[t].isCSSVariable=!0)}function uC(e,{layout:t,layoutId:r}){return w0.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!_x[e]||e==="opacity")}const gJ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},pJ=y0.length;function vJ(e,t,r){let a="",n=!0;for(let i=0;i<pJ;i++){const l=y0[i],o=e[l];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(l.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const d=rC(o,_y[l]);if(!c){n=!1;const x=gJ[l]||l;a+=`${x}(${d}) `}r&&(t[l]=d)}}return a=a.trim(),r?a=r(t,n?"":a):n&&(a="none"),a}function Dy(e,t,r){const{style:a,vars:n,transformOrigin:i}=e;let l=!1,o=!1;for(const c in t){const d=t[c];if(w0.has(c)){l=!0;continue}else if(uy(c)){n[c]=d;continue}else{const x=rC(d,_y[c]);c.startsWith("origin")?(o=!0,i[c]=x):a[c]=x}}if(t.transform||(l||r?a.transform=vJ(t,e.transform,r):a.transform&&(a.transform="none")),o){const{originX:c="50%",originY:d="50%",originZ:x=0}=i;a.transformOrigin=`${c} ${d} ${x}`}}const Sy=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function fC(e,t,r){for(const a in t)!ws(t[a])&&!uC(a,r)&&(e[a]=t[a])}function bJ({transformTemplate:e},t){return E.useMemo(()=>{const r=Sy();return Dy(r,t,e),Object.assign({},r.vars,r.style)},[t])}function yJ(e,t){const r=e.style||{},a={};return fC(a,r,e),Object.assign(a,bJ(e,t)),a}function wJ(e,t){const r={},a=yJ(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=a,r}const EJ={offset:"stroke-dashoffset",array:"stroke-dasharray"},_J={offset:"strokeDashoffset",array:"strokeDasharray"};function jJ(e,t,r=1,a=0,n=!0){e.pathLength=1;const i=n?EJ:_J;e[i.offset]=tt.transform(-a);const l=tt.transform(t),o=tt.transform(r);e[i.array]=`${l} ${o}`}function hC(e,{attrX:t,attrY:r,attrScale:a,pathLength:n,pathSpacing:i=1,pathOffset:l=0,...o},c,d,x){if(Dy(e,o,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:u,style:f}=e;u.transform&&(f.transform=u.transform,delete u.transform),(f.transform||u.transformOrigin)&&(f.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),f.transform&&(f.transformBox=(x==null?void 0:x.transformBox)??"fill-box",delete u.transformBox),t!==void 0&&(u.x=t),r!==void 0&&(u.y=r),a!==void 0&&(u.scale=a),n!==void 0&&jJ(u,n,i,l,!1)}const mC=()=>({...Sy(),attrs:{}}),gC=e=>typeof e=="string"&&e.toLowerCase()==="svg";function NJ(e,t,r,a){const n=E.useMemo(()=>{const i=mC();return hC(i,t,gC(a),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};fC(i,e.style,e),n.style={...i,...n.style}}return n}const CJ=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function By(e){return typeof e!="string"||e.includes("-")?!1:!!(CJ.indexOf(e)>-1||/[A-Z]/u.test(e))}function AJ(e,t,r,{latestValues:a},n,i=!1){const o=(By(e)?NJ:wJ)(t,a,n,e),c=uJ(t,typeof e=="string",i),d=e!==E.Fragment?{...c,...o,ref:r}:{},{children:x}=t,u=E.useMemo(()=>ws(x)?x.get():x,[x]);return E.createElement(e,{...d,children:u})}function P8(e){const t=[{},{}];return e==null||e.values.forEach((r,a)=>{t[0][a]=r.get(),t[1][a]=r.getVelocity()}),t}function Fy(e,t,r,a){if(typeof t=="function"){const[n,i]=P8(a);t=t(r!==void 0?r:e.custom,n,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,i]=P8(a);t=t(r!==void 0?r:e.custom,n,i)}return t}function hf(e){return ws(e)?e.get():e}function kJ({scrapeMotionValuesFromProps:e,createRenderState:t},r,a,n){return{latestValues:DJ(r,a,n,e),renderState:t()}}function DJ(e,t,r,a){const n={},i=a(e,{});for(const f in i)n[f]=hf(i[f]);let{initial:l,animate:o}=e;const c=fm(e),d=xC(e);t&&d&&!c&&e.inherit!==!1&&(l===void 0&&(l=t.initial),o===void 0&&(o=t.animate));let x=r?r.initial===!1:!1;x=x||l===!1;const u=x?o:l;if(u&&typeof u!="boolean"&&!um(u)){const f=Array.isArray(u)?u:[u];for(let h=0;h<f.length;h++){const p=Fy(e,f[h]);if(p){const{transitionEnd:g,transition:y,...v}=p;for(const w in v){let m=v[w];if(Array.isArray(m)){const b=x?m.length-1:0;m=m[b]}m!==null&&(n[w]=m)}for(const w in g)n[w]=g[w]}}}return n}const pC=e=>(t,r)=>{const a=E.useContext(xm),n=E.useContext(dm),i=()=>kJ(e,t,a,n);return r?i():sy(i)};function Ty(e,t,r){var i;const{style:a}=e,n={};for(const l in a)(ws(a[l])||t.style&&ws(t.style[l])||uC(l,e)||((i=r==null?void 0:r.getValue(l))==null?void 0:i.liveStyle)!==void 0)&&(n[l]=a[l]);return n}const SJ=pC({scrapeMotionValuesFromProps:Ty,createRenderState:Sy});function vC(e,t,r){const a=Ty(e,t,r);for(const n in e)if(ws(e[n])||ws(t[n])){const i=y0.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;a[i]=e[n]}return a}const BJ=pC({scrapeMotionValuesFromProps:vC,createRenderState:mC}),FJ=Symbol.for("motionComponentSymbol");function hc(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function TJ(e,t,r){return E.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),r&&(typeof r=="function"?r(a):hc(r)&&(r.current=a))},[t])}const My=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),MJ="framerAppearId",bC="data-"+My(MJ),yC=E.createContext({});function RJ(e,t,r,a,n){var g,y;const{visualElement:i}=E.useContext(xm),l=E.useContext(cC),o=E.useContext(dm),c=E.useContext(Cy).reducedMotion,d=E.useRef(null);a=a||l.renderer,!d.current&&a&&(d.current=a(e,{visualState:t,parent:i,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const x=d.current,u=E.useContext(yC);x&&!x.projection&&n&&(x.type==="html"||x.type==="svg")&&OJ(d.current,r,n,u);const f=E.useRef(!1);E.useInsertionEffect(()=>{x&&f.current&&x.update(r,o)});const h=r[bC],p=E.useRef(!!h&&!((g=window.MotionHandoffIsComplete)!=null&&g.call(window,h))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,h)));return pN(()=>{x&&(f.current=!0,window.MotionIsMounted=!0,x.updateFeatures(),x.scheduleRenderMicrotask(),p.current&&x.animationState&&x.animationState.animateChanges())}),E.useEffect(()=>{x&&(!p.current&&x.animationState&&x.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var v;(v=window.MotionHandoffMarkAsComplete)==null||v.call(window,h)}),p.current=!1),x.enteringChildren=void 0)}),x}function OJ(e,t,r,a){const{layoutId:n,layout:i,drag:l,dragConstraints:o,layoutScroll:c,layoutRoot:d,layoutCrossfade:x}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:wC(e.parent)),e.projection.setOptions({layoutId:n,layout:i,alwaysMeasureLayout:!!l||o&&hc(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:a,crossfade:x,layoutScroll:c,layoutRoot:d})}function wC(e){if(e)return e.options.allowProjection!==!1?e.projection:wC(e.parent)}function Lg(e,{forwardMotionProps:t=!1}={},r,a){r&&cJ(r);const n=By(e)?BJ:SJ;function i(o,c){let d;const x={...E.useContext(Cy),...o,layoutId:PJ(o)},{isStatic:u}=x,f=hJ(o),h=n(o,u);if(!u&&ay){LJ();const p=IJ(x);d=p.MeasureLayout,f.visualElement=RJ(e,h,x,a,p.ProjectionNode)}return s.jsxs(xm.Provider,{value:f,children:[d&&f.visualElement?s.jsx(d,{visualElement:f.visualElement,...x}):null,AJ(e,o,TJ(h,f.visualElement,c),h,u,t)]})}i.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const l=E.forwardRef(i);return l[FJ]=e,l}function PJ({layoutId:e}){const t=E.useContext(ry).id;return t&&e!==void 0?t+"-"+e:e}function LJ(e,t){E.useContext(cC).strict}function IJ(e){const{drag:t,layout:r}=Qc;if(!t&&!r)return{};const a={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function UJ(e,t){if(typeof Proxy>"u")return Lg;const r=new Map,a=(i,l)=>Lg(i,l,e,t),n=(i,l)=>a(i,l);return new Proxy(n,{get:(i,l)=>l==="create"?a:(r.has(l)||r.set(l,Lg(l,void 0,e,t)),r.get(l))})}function EC({top:e,left:t,right:r,bottom:a}){return{x:{min:t,max:r},y:{min:e,max:a}}}function $J({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function zJ(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}function Ig(e){return e===void 0||e===1}function z1({scale:e,scaleX:t,scaleY:r}){return!Ig(e)||!Ig(t)||!Ig(r)}function Sl(e){return z1(e)||_C(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function _C(e){return L8(e.x)||L8(e.y)}function L8(e){return e&&e!=="0%"}function mh(e,t,r){const a=e-r,n=t*a;return r+n}function I8(e,t,r,a,n){return n!==void 0&&(e=mh(e,n,a)),mh(e,r,a)+t}function q1(e,t=0,r=1,a,n){e.min=I8(e.min,t,r,a,n),e.max=I8(e.max,t,r,a,n)}function jC(e,{x:t,y:r}){q1(e.x,t.translate,t.scale,t.originPoint),q1(e.y,r.translate,r.scale,r.originPoint)}const U8=.999999999999,$8=1.0000000000001;function qJ(e,t,r,a=!1){const n=r.length;if(!n)return;t.x=t.y=1;let i,l;for(let o=0;o<n;o++){i=r[o],l=i.projectionDelta;const{visualElement:c}=i.options;c&&c.props.style&&c.props.style.display==="contents"||(a&&i.options.layoutScroll&&i.scroll&&i!==i.root&&gc(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),l&&(t.x*=l.x.scale,t.y*=l.y.scale,jC(e,l)),a&&Sl(i.latestValues)&&gc(e,i.latestValues))}t.x<$8&&t.x>U8&&(t.x=1),t.y<$8&&t.y>U8&&(t.y=1)}function mc(e,t){e.min=e.min+t,e.max=e.max+t}function z8(e,t,r,a,n=.5){const i=tr(e.min,e.max,n);q1(e,t,r,i,a)}function gc(e,t){z8(e.x,t.x,t.scaleX,t.scale,t.originX),z8(e.y,t.y,t.scaleY,t.scale,t.originY)}function NC(e,t){return EC(zJ(e.getBoundingClientRect(),t))}function VJ(e,t,r){const a=NC(e,r),{scroll:n}=t;return n&&(mc(a.x,n.offset.x),mc(a.y,n.offset.y)),a}const q8=()=>({translate:0,scale:1,origin:0,originPoint:0}),pc=()=>({x:q8(),y:q8()}),V8=()=>({min:0,max:0}),br=()=>({x:V8(),y:V8()}),V1={current:null},CC={current:!1};function HJ(){if(CC.current=!0,!!ay)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>V1.current=e.matches;e.addEventListener("change",t),t()}else V1.current=!1}const WJ=new WeakMap;function GJ(e,t,r){for(const a in t){const n=t[a],i=r[a];if(ws(n))e.addValue(a,n);else if(ws(i))e.addValue(a,Kc(n,{owner:e}));else if(i!==n)if(e.hasValue(a)){const l=e.getValue(a);l.liveStyle===!0?l.jump(n):l.hasAnimated||l.set(n)}else{const l=e.getStaticValue(a);e.addValue(a,Kc(l!==void 0?l:n,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const H8=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class YJ{scrapeMotionValuesFromProps(t,r,a){return{}}constructor({parent:t,props:r,presenceContext:a,reducedMotionConfig:n,blockInitialAnimation:i,visualState:l},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=wy,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Hs.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Kt.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=l;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=d,this.parent=t,this.props=r,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=fm(r),this.isVariantNode=xC(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:x,...u}=this.scrapeMotionValuesFromProps(r,{},this);for(const f in u){const h=u[f];c[f]!==void 0&&ws(h)&&h.set(c[f])}}mount(t){var r;this.current=t,WJ.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,n)=>this.bindToMotionValue(n,a)),CC.current||HJ(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:V1.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),ll(this.notifyUpdate),ll(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const a=this.features[r];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=w0.has(t);a&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",l=>{this.latestValues[t]=l,this.props.onUpdate&&Kt.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),i&&i(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Qc){const r=Qc[t];if(!r)continue;const{isEnabled:a,Feature:n}=r;if(!this.features[t]&&n&&a(this.props)&&(this.features[t]=new n(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):br()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let a=0;a<H8.length;a++){const n=H8[a];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const i="on"+n,l=t[i];l&&(this.propEventSubscriptions[n]=this.on(n,l))}this.prevMotionValues=GJ(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const a=this.values.get(t);r!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&r!==void 0&&(a=Kc(r===null?void 0:r,{owner:this}),this.addValue(t,a)),a}readValue(t,r){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(vN(a)||yN(a))?a=parseFloat(a):!sJ(a)&&ol.test(r)&&(a=tC(t,r)),this.setBaseTarget(t,ws(a)?a.get():a)),ws(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var i;const{initial:r}=this.props;let a;if(typeof r=="string"||typeof r=="object"){const l=Fy(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);l&&(a=l[t])}if(r&&a!==void 0)return a;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!ws(n)?n:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new cy),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){jy.render(this.render)}}class AC extends YJ{constructor(){super(...arguments),this.KeyframeResolver=HQ}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:a}){delete r[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ws(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function kC(e,{style:t,vars:r},a,n){const i=e.style;let l;for(l in t)i[l]=t[l];n==null||n.applyProjectionStyles(i,a);for(l in r)i.setProperty(l,r[l])}function XJ(e){return window.getComputedStyle(e)}class KJ extends AC{constructor(){super(...arguments),this.type="html",this.renderInstance=kC}readValueFromInstance(t,r){var a;if(w0.has(r))return(a=this.projection)!=null&&a.isProjecting?R1(r):dQ(t,r);{const n=XJ(t),i=(uy(r)?n.getPropertyValue(r):n[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return NC(t,r)}build(t,r,a){Dy(t,r,a.transformTemplate)}scrapeMotionValuesFromProps(t,r,a){return Ty(t,r,a)}}const DC=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function QJ(e,t,r,a){kC(e,t,void 0,a);for(const n in t.attrs)e.setAttribute(DC.has(n)?n:My(n),t.attrs[n])}class JJ extends AC{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=br}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(w0.has(r)){const a=eC(r);return a&&a.default||0}return r=DC.has(r)?r:My(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,a){return vC(t,r,a)}build(t,r,a){hC(t,r,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(t,r,a,n){QJ(t,r,a,n)}mount(t){this.isSVGTag=gC(t.tagName),super.mount(t)}}const ZJ=(e,t)=>By(e)?new JJ(t):new KJ(t,{allowProjection:e!==E.Fragment});function Bc(e,t,r){const a=e.getProps();return Fy(a,t,r!==void 0?r:a.custom,e)}const H1=e=>Array.isArray(e);function eZ(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Kc(r))}function tZ(e){return H1(e)?e[e.length-1]||0:e}function rZ(e,t){const r=Bc(e,t);let{transitionEnd:a={},transition:n={},...i}=r||{};i={...i,...a};for(const l in i){const o=tZ(i[l]);eZ(e,l,o)}}function sZ(e){return!!(ws(e)&&e.add)}function W1(e,t){const r=e.getValue("willChange");if(sZ(r))return r.add(t);if(!r&&hi.WillChange){const a=new hi.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function SC(e){return e.props[bC]}const aZ=e=>e!==null;function nZ(e,{repeat:t,repeatType:r="loop"},a){const n=e.filter(aZ),i=t&&r!=="loop"&&t%2===1?0:n.length-1;return n[i]}const iZ={type:"spring",stiffness:500,damping:25,restSpeed:10},lZ=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),oZ={type:"keyframes",duration:.8},cZ={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},dZ=(e,{keyframes:t})=>t.length>2?oZ:w0.has(e)?e.startsWith("scale")?lZ(t[1]):iZ:cZ;function xZ({when:e,delay:t,delayChildren:r,staggerChildren:a,staggerDirection:n,repeat:i,repeatType:l,repeatDelay:o,from:c,elapsed:d,...x}){return!!Object.keys(x).length}const Ry=(e,t,r,a={},n,i)=>l=>{const o=Ey(a,e)||{},c=o.delay||a.delay||0;let{elapsed:d=0}=a;d=d-jn(c);const x={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-d,onUpdate:f=>{t.set(f),o.onUpdate&&o.onUpdate(f)},onComplete:()=>{l(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:n};xZ(o)||Object.assign(x,dZ(e,x)),x.duration&&(x.duration=jn(x.duration)),x.repeatDelay&&(x.repeatDelay=jn(x.repeatDelay)),x.from!==void 0&&(x.keyframes[0]=x.from);let u=!1;if((x.type===!1||x.duration===0&&!x.repeatDelay)&&(U1(x),x.delay===0&&(u=!0)),(hi.instantAnimations||hi.skipAnimations)&&(u=!0,U1(x),x.delay=0),x.allowFlatten=!o.type&&!o.ease,u&&!i&&t.get()!==void 0){const f=nZ(x.keyframes,o);if(f!==void 0){Kt.update(()=>{x.onUpdate(f),x.onComplete()});return}}return o.isSync?new yy(x):new TQ(x)};function uZ({protectedKeys:e,needsAnimating:t},r){const a=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,a}function BC(e,t,{delay:r=0,transitionOverride:a,type:n}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:l,...o}=t;a&&(i=a);const c=[],d=n&&e.animationState&&e.animationState.getState()[n];for(const x in o){const u=e.getValue(x,e.latestValues[x]??null),f=o[x];if(f===void 0||d&&uZ(d,x))continue;const h={delay:r,...Ey(i||{},x)},p=u.get();if(p!==void 0&&!u.isAnimating&&!Array.isArray(f)&&f===p&&!h.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const v=SC(e);if(v){const w=window.MotionHandoffAnimation(v,x,Kt);w!==null&&(h.startTime=w,g=!0)}}W1(e,x),u.start(Ry(x,u,f,e.shouldReduceMotion&&QN.has(x)?{type:!1}:h,e,g));const y=u.animation;y&&c.push(y)}return l&&Promise.all(c).then(()=>{Kt.update(()=>{l&&rZ(e,l)})}),c}function FC(e,t,r,a=0,n=1){const i=Array.from(e).sort((d,x)=>d.sortNodePosition(x)).indexOf(t),l=e.size,o=(l-1)*a;return typeof r=="function"?r(i,l):n===1?i*a:o-i*a}function G1(e,t,r={}){var c;const a=Bc(e,t,r.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(n=r.transitionOverride);const i=a?()=>Promise.all(BC(e,a,r)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?(d=0)=>{const{delayChildren:x=0,staggerChildren:u,staggerDirection:f}=n;return fZ(e,t,d,x,u,f,r)}:()=>Promise.resolve(),{when:o}=n;if(o){const[d,x]=o==="beforeChildren"?[i,l]:[l,i];return d().then(()=>x())}else return Promise.all([i(),l(r.delay)])}function fZ(e,t,r=0,a=0,n=0,i=1,l){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(G1(c,t,{...l,delay:r+(typeof a=="function"?0:a)+FC(e.variantChildren,c,a,n,i)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function hZ(e,t,r={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const n=t.map(i=>G1(e,i,r));a=Promise.all(n)}else if(typeof t=="string")a=G1(e,t,r);else{const n=typeof t=="function"?Bc(e,t,r.custom):t;a=Promise.all(BC(e,n,r))}return a.then(()=>{e.notify("AnimationComplete",t)})}function TC(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}const mZ=ky.length;function MC(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?MC(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<mZ;r++){const a=ky[r],n=e.props[a];(Ex(n)||n===!1)&&(t[a]=n)}return t}const gZ=[...Ay].reverse(),pZ=Ay.length;function vZ(e){return t=>Promise.all(t.map(({animation:r,options:a})=>hZ(e,r,a)))}function bZ(e){let t=vZ(e),r=W8(),a=!0;const n=c=>(d,x)=>{var f;const u=Bc(e,x,c==="exit"?(f=e.presenceContext)==null?void 0:f.custom:void 0);if(u){const{transition:h,transitionEnd:p,...g}=u;d={...d,...g,...p}}return d};function i(c){t=c(e)}function l(c){const{props:d}=e,x=MC(e.parent)||{},u=[],f=new Set;let h={},p=1/0;for(let y=0;y<pZ;y++){const v=gZ[y],w=r[v],m=d[v]!==void 0?d[v]:x[v],b=Ex(m),_=v===c?w.isActive:null;_===!1&&(p=y);let C=m===x[v]&&m!==d[v]&&b;if(C&&a&&e.manuallyAnimateOnMount&&(C=!1),w.protectedKeys={...h},!w.isActive&&_===null||!m&&!w.prevProp||um(m)||typeof m=="boolean")continue;const j=yZ(w.prevProp,m);let D=j||v===c&&w.isActive&&!C&&b||y>p&&b,R=!1;const M=Array.isArray(m)?m:[m];let O=M.reduce(n(v),{});_===!1&&(O={});const{prevResolvedValues:B={}}=w,L={...B,...O},U=N=>{D=!0,f.has(N)&&(R=!0,f.delete(N)),w.needsAnimating[N]=!0;const T=e.getValue(N);T&&(T.liveStyle=!1)};for(const N in L){const T=O[N],S=B[N];if(h.hasOwnProperty(N))continue;let z=!1;H1(T)&&H1(S)?z=!TC(T,S):z=T!==S,z?T!=null?U(N):f.add(N):T!==void 0&&f.has(N)?U(N):w.protectedKeys[N]=!0}w.prevProp=m,w.prevResolvedValues=O,w.isActive&&(h={...h,...O}),a&&e.blockInitialAnimation&&(D=!1);const P=C&&j;D&&(!P||R)&&u.push(...M.map(N=>{const T={type:v};if(typeof N=="string"&&a&&!P&&e.manuallyAnimateOnMount&&e.parent){const{parent:S}=e,z=Bc(S,N);if(S.enteringChildren&&z){const{delayChildren:W}=z.transition||{};T.delay=FC(S.enteringChildren,e,W)}}return{animation:N,options:T}}))}if(f.size){const y={};if(typeof d.initial!="boolean"){const v=Bc(e,Array.isArray(d.initial)?d.initial[0]:d.initial);v&&v.transition&&(y.transition=v.transition)}f.forEach(v=>{const w=e.getBaseTarget(v),m=e.getValue(v);m&&(m.liveStyle=!0),y[v]=w??null}),u.push({animation:y})}let g=!!u.length;return a&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(g=!1),a=!1,g?t(u):Promise.resolve()}function o(c,d){var u;if(r[c].isActive===d)return Promise.resolve();(u=e.variantChildren)==null||u.forEach(f=>{var h;return(h=f.animationState)==null?void 0:h.setActive(c,d)}),r[c].isActive=d;const x=l(c);for(const f in r)r[f].protectedKeys={};return x}return{animateChanges:l,setActive:o,setAnimateFunction:i,getState:()=>r,reset:()=>{r=W8(),a=!0}}}function yZ(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!TC(t,e):!1}function _l(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function W8(){return{animate:_l(!0),whileInView:_l(),whileHover:_l(),whileTap:_l(),whileDrag:_l(),whileFocus:_l(),exit:_l()}}class pl{constructor(t){this.isMounted=!1,this.node=t}update(){}}class wZ extends pl{constructor(t){super(t),t.animationState||(t.animationState=bZ(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();um(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let EZ=0;class _Z extends pl{constructor(){super(...arguments),this.id=EZ++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const jZ={animation:{Feature:wZ},exit:{Feature:_Z}};function jx(e,t,r,a={passive:!0}){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}function eu(e){return{point:{x:e.pageX,y:e.pageY}}}const NZ=e=>t=>Ny(t)&&e(t,eu(t));function Dd(e,t,r,a){return jx(e,t,NZ(r),a)}const RC=1e-4,CZ=1-RC,AZ=1+RC,OC=.01,kZ=0-OC,DZ=0+OC;function Fs(e){return e.max-e.min}function SZ(e,t,r){return Math.abs(e-t)<=r}function G8(e,t,r,a=.5){e.origin=a,e.originPoint=tr(t.min,t.max,e.origin),e.scale=Fs(r)/Fs(t),e.translate=tr(r.min,r.max,e.origin)-e.originPoint,(e.scale>=CZ&&e.scale<=AZ||isNaN(e.scale))&&(e.scale=1),(e.translate>=kZ&&e.translate<=DZ||isNaN(e.translate))&&(e.translate=0)}function Sd(e,t,r,a){G8(e.x,t.x,r.x,a?a.originX:void 0),G8(e.y,t.y,r.y,a?a.originY:void 0)}function Y8(e,t,r){e.min=r.min+t.min,e.max=e.min+Fs(t)}function BZ(e,t,r){Y8(e.x,t.x,r.x),Y8(e.y,t.y,r.y)}function X8(e,t,r){e.min=t.min-r.min,e.max=e.min+Fs(t)}function Bd(e,t,r){X8(e.x,t.x,r.x),X8(e.y,t.y,r.y)}function ba(e){return[e("x"),e("y")]}const PC=({current:e})=>e?e.ownerDocument.defaultView:null,K8=(e,t)=>Math.abs(e-t);function FZ(e,t){const r=K8(e.x,t.x),a=K8(e.y,t.y);return Math.sqrt(r**2+a**2)}class LC{constructor(t,r,{transformPagePoint:a,contextWindow:n=window,dragSnapToOrigin:i=!1,distanceThreshold:l=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=$g(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=FZ(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!h&&!p)return;const{point:g}=f,{timestamp:y}=as;this.history.push({...g,timestamp:y});const{onStart:v,onMove:w}=this.handlers;h||(v&&v(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Ug(h,this.transformPagePoint),Kt.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=$g(f.type==="pointercancel"?this.lastMoveEventInfo:Ug(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(f,v),g&&g(f,v)},!Ny(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=a,this.distanceThreshold=l,this.contextWindow=n||window;const o=eu(t),c=Ug(o,this.transformPagePoint),{point:d}=c,{timestamp:x}=as;this.history=[{...d,timestamp:x}];const{onSessionStart:u}=r;u&&u(t,$g(c,this.history)),this.removeListeners=Qx(Dd(this.contextWindow,"pointermove",this.handlePointerMove),Dd(this.contextWindow,"pointerup",this.handlePointerUp),Dd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ll(this.updatePoint)}}function Ug(e,t){return t?{point:t(e.point)}:e}function Q8(e,t){return{x:e.x-t.x,y:e.y-t.y}}function $g({point:e},t){return{point:e,delta:Q8(e,IC(t)),offset:Q8(e,TZ(t)),velocity:MZ(t,.1)}}function TZ(e){return e[0]}function IC(e){return e[e.length-1]}function MZ(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null;const n=IC(e);for(;r>=0&&(a=e[r],!(n.timestamp-a.timestamp>jn(t)));)r--;if(!a)return{x:0,y:0};const i=Nn(n.timestamp-a.timestamp);if(i===0)return{x:0,y:0};const l={x:(n.x-a.x)/i,y:(n.y-a.y)/i};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function RZ(e,{min:t,max:r},a){return t!==void 0&&e<t?e=a?tr(t,e,a.min):Math.max(e,t):r!==void 0&&e>r&&(e=a?tr(r,e,a.max):Math.min(e,r)),e}function J8(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function OZ(e,{top:t,left:r,bottom:a,right:n}){return{x:J8(e.x,r,n),y:J8(e.y,t,a)}}function Z8(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}function PZ(e,t){return{x:Z8(e.x,t.x),y:Z8(e.y,t.y)}}function LZ(e,t){let r=.5;const a=Fs(e),n=Fs(t);return n>a?r=bx(t.min,t.max-a,e.min):a>n&&(r=bx(e.min,e.max-n,t.min)),fi(0,1,r)}function IZ(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Y1=.35;function UZ(e=Y1){return e===!1?e=0:e===!0&&(e=Y1),{x:e5(e,"left","right"),y:e5(e,"top","bottom")}}function e5(e,t,r){return{min:t5(e,t),max:t5(e,r)}}function t5(e,t){return typeof e=="number"?e:e[t]||0}const $Z=new WeakMap;class zZ{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=br(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:a}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(eu(u).point)},l=(u,f)=>{const{drag:h,dragPropagation:p,onDragStart:g}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=XQ(h),!this.openDragLock))return;this.latestPointerEvent=u,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ba(v=>{let w=this.getAxisMotionValue(v).get()||0;if(Cn.test(w)){const{projection:m}=this.visualElement;if(m&&m.layout){const b=m.layout.layoutBox[v];b&&(w=Fs(b)*(parseFloat(w)/100))}}this.originPoint[v]=w}),g&&Kt.postRender(()=>g(u,f)),W1(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},o=(u,f)=>{this.latestPointerEvent=u,this.latestPanInfo=f;const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:g,onDrag:y}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=f;if(p&&this.currentDirection===null){this.currentDirection=qZ(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),y&&y(u,f)},c=(u,f)=>{this.latestPointerEvent=u,this.latestPanInfo=f,this.stop(u,f),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>ba(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)==null?void 0:f.play())}),{dragSnapToOrigin:x}=this.getProps();this.panSession=new LC(t,{onSessionStart:i,onStart:l,onMove:o,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:x,distanceThreshold:a,contextWindow:PC(this.visualElement)})}stop(t,r){const a=t||this.latestPointerEvent,n=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!n||!a)return;const{velocity:l}=n;this.startAnimation(l);const{onDragEnd:o}=this.getProps();o&&Kt.postRender(()=>o(a,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,a){const{drag:n}=this.getProps();if(!a||!qu(t,n,this.currentDirection))return;const i=this.getAxisMotionValue(t);let l=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(l=RZ(l,this.constraints[t],this.elastic[t])),i.set(l)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:r}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,n=this.constraints;t&&hc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=OZ(a.layoutBox,t):this.constraints=!1,this.elastic=UZ(r),n!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&ba(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=IZ(a.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!hc(t))return!1;const a=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const i=VJ(a,n.root,this.visualElement.getTransformPagePoint());let l=PZ(n.layout.layoutBox,i);if(r){const o=r($J(l));this.hasMutatedConstraints=!!o,o&&(l=EC(o))}return l}startAnimation(t){const{drag:r,dragMomentum:a,dragElastic:n,dragTransition:i,dragSnapToOrigin:l,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},d=ba(x=>{if(!qu(x,r,this.currentDirection))return;let u=c&&c[x]||{};l&&(u={min:0,max:0});const f=n?200:1e6,h=n?40:1e7,p={type:"inertia",velocity:a?t[x]:0,bounceStiffness:f,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...u};return this.startAxisValueAnimation(x,p)});return Promise.all(d).then(o)}startAxisValueAnimation(t,r){const a=this.getAxisMotionValue(t);return W1(this.visualElement,t),a.start(Ry(t,a,0,r,this.visualElement,!1))}stopAnimation(){ba(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ba(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),n=a[r];return n||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){ba(r=>{const{drag:a}=this.getProps();if(!qu(r,a,this.currentDirection))return;const{projection:n}=this.visualElement,i=this.getAxisMotionValue(r);if(n&&n.layout){const{min:l,max:o}=n.layout.layoutBox[r];i.set(t[r]-tr(l,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:a}=this.visualElement;if(!hc(r)||!a||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};ba(l=>{const o=this.getAxisMotionValue(l);if(o&&this.constraints!==!1){const c=o.get();n[l]=LZ({min:c,max:c},this.constraints[l])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),ba(l=>{if(!qu(l,t,null))return;const o=this.getAxisMotionValue(l),{min:c,max:d}=this.constraints[l];o.set(tr(c,d,n[l]))})}addListeners(){if(!this.visualElement.current)return;$Z.set(this.visualElement,this);const t=this.visualElement.current,r=Dd(t,"pointerdown",c=>{const{drag:d,dragListener:x=!0}=this.getProps();d&&x&&this.start(c)}),a=()=>{const{dragConstraints:c}=this.getProps();hc(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",a);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Kt.read(a);const l=jx(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(ba(x=>{const u=this.getAxisMotionValue(x);u&&(this.originPoint[x]+=c[x].translate,u.set(u.get()+c[x].translate))}),this.visualElement.render())});return()=>{l(),r(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:a=!1,dragPropagation:n=!1,dragConstraints:i=!1,dragElastic:l=Y1,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:a,dragPropagation:n,dragConstraints:i,dragElastic:l,dragMomentum:o}}}function qu(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function qZ(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class VZ extends pl{constructor(t){super(t),this.removeGroupControls=Ma,this.removeListeners=Ma,this.controls=new zZ(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ma}unmount(){this.removeGroupControls(),this.removeListeners()}}const r5=e=>(t,r)=>{e&&Kt.postRender(()=>e(t,r))};class HZ extends pl{constructor(){super(...arguments),this.removePointerDownListener=Ma}onPointerDown(t){this.session=new LC(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:PC(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:a,onPanEnd:n}=this.node.getProps();return{onSessionStart:r5(t),onStart:r5(r),onMove:a,onEnd:(i,l)=>{delete this.session,n&&Kt.postRender(()=>n(i,l))}}}mount(){this.removePointerDownListener=Dd(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const mf={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function s5(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const I0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(tt.test(e))e=parseFloat(e);else return e;const r=s5(e,t.target.x),a=s5(e,t.target.y);return`${r}% ${a}%`}},WZ={correct:(e,{treeScale:t,projectionDelta:r})=>{const a=e,n=ol.parse(e);if(n.length>5)return a;const i=ol.createTransformer(e),l=typeof n[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;n[0+l]/=o,n[1+l]/=c;const d=tr(o,c,.5);return typeof n[2+l]=="number"&&(n[2+l]/=d),typeof n[3+l]=="number"&&(n[3+l]/=d),i(n)}};let zg=!1;class GZ extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a,layoutId:n}=this.props,{projection:i}=t;mJ(YZ),i&&(r.group&&r.group.add(i),a&&a.register&&n&&a.register(i),zg&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),mf.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:a,drag:n,isPresent:i}=this.props,{projection:l}=a;return l&&(l.isPresent=i,zg=!0,n||t.layoutDependency!==r||r===void 0||t.isPresent!==i?l.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?l.promote():l.relegate()||Kt.postRender(()=>{const o=l.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),jy.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a}=this.props,{projection:n}=t;zg=!0,n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),a&&a.deregister&&a.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function UC(e){const[t,r]=oC(),a=E.useContext(ry);return s.jsx(GZ,{...e,layoutGroup:a,switchLayoutGroup:E.useContext(yC),isPresent:t,safeToRemove:r})}const YZ={borderRadius:{...I0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:I0,borderTopRightRadius:I0,borderBottomLeftRadius:I0,borderBottomRightRadius:I0,boxShadow:WZ};function XZ(e,t,r){const a=ws(e)?e:Kc(e);return a.start(Ry("",a,t,r)),a.animation}const KZ=(e,t)=>e.depth-t.depth;class QZ{constructor(){this.children=[],this.isDirty=!1}add(t){ny(this.children,t),this.isDirty=!0}remove(t){iy(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(KZ),this.isDirty=!1,this.children.forEach(t)}}function JZ(e,t){const r=Hs.now(),a=({timestamp:n})=>{const i=n-r;i>=t&&(ll(a),e(i-t))};return Kt.setup(a,!0),()=>ll(a)}const $C=["TopLeft","TopRight","BottomLeft","BottomRight"],ZZ=$C.length,a5=e=>typeof e=="string"?parseFloat(e):e,n5=e=>typeof e=="number"||tt.test(e);function eee(e,t,r,a,n,i){n?(e.opacity=tr(0,r.opacity??1,tee(a)),e.opacityExit=tr(t.opacity??1,0,ree(a))):i&&(e.opacity=tr(t.opacity??1,r.opacity??1,a));for(let l=0;l<ZZ;l++){const o=`border${$C[l]}Radius`;let c=i5(t,o),d=i5(r,o);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||n5(c)===n5(d)?(e[o]=Math.max(tr(a5(c),a5(d),a),0),(Cn.test(d)||Cn.test(c))&&(e[o]+="%")):e[o]=d}(t.rotate||r.rotate)&&(e.rotate=tr(t.rotate||0,r.rotate||0,a))}function i5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const tee=zC(0,.5,kN),ree=zC(.5,.95,Ma);function zC(e,t,r){return a=>a<e?0:a>t?1:r(bx(e,t,a))}function l5(e,t){e.min=t.min,e.max=t.max}function ma(e,t){l5(e.x,t.x),l5(e.y,t.y)}function o5(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function c5(e,t,r,a,n){return e-=t,e=mh(e,1/r,a),n!==void 0&&(e=mh(e,1/n,a)),e}function see(e,t=0,r=1,a=.5,n,i=e,l=e){if(Cn.test(t)&&(t=parseFloat(t),t=tr(l.min,l.max,t/100)-l.min),typeof t!="number")return;let o=tr(i.min,i.max,a);e===i&&(o-=t),e.min=c5(e.min,t,r,o,n),e.max=c5(e.max,t,r,o,n)}function d5(e,t,[r,a,n],i,l){see(e,t[r],t[a],t[n],t.scale,i,l)}const aee=["x","scaleX","originX"],nee=["y","scaleY","originY"];function x5(e,t,r,a){d5(e.x,t,aee,r?r.x:void 0,a?a.x:void 0),d5(e.y,t,nee,r?r.y:void 0,a?a.y:void 0)}function u5(e){return e.translate===0&&e.scale===1}function qC(e){return u5(e.x)&&u5(e.y)}function f5(e,t){return e.min===t.min&&e.max===t.max}function iee(e,t){return f5(e.x,t.x)&&f5(e.y,t.y)}function h5(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function VC(e,t){return h5(e.x,t.x)&&h5(e.y,t.y)}function m5(e){return Fs(e.x)/Fs(e.y)}function g5(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class lee{constructor(){this.members=[]}add(t){ny(this.members,t),t.scheduleRender()}remove(t){if(iy(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let a;for(let n=r;n>=0;n--){const i=this.members[n];if(i.isPresent!==!1){a=i;break}}return a?(this.promote(a),!0):!1}promote(t,r){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,r&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:a}=t;r.onExitComplete&&r.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function oee(e,t,r){let a="";const n=e.x.translate/t.x,i=e.y.translate/t.y,l=(r==null?void 0:r.z)||0;if((n||i||l)&&(a=`translate3d(${n}px, ${i}px, ${l}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:d,rotate:x,rotateX:u,rotateY:f,skewX:h,skewY:p}=r;d&&(a=`perspective(${d}px) ${a}`),x&&(a+=`rotate(${x}deg) `),u&&(a+=`rotateX(${u}deg) `),f&&(a+=`rotateY(${f}deg) `),h&&(a+=`skewX(${h}deg) `),p&&(a+=`skewY(${p}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(a+=`scale(${o}, ${c})`),a||"none"}const qg=["","X","Y","Z"],cee=1e3;let dee=0;function Vg(e,t,r,a){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),a&&(a[e]=0))}function HC(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=SC(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Kt,!(n||i))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&HC(a)}function WC({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:a,resetTransform:n}){return class{constructor(l={},o=t==null?void 0:t()){this.id=dee++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(fee),this.nodes.forEach(pee),this.nodes.forEach(vee),this.nodes.forEach(hee)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new QZ)}addEventListener(l,o){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new cy),this.eventHandlers.get(l).add(o)}notifyListeners(l,...o){const c=this.eventHandlers.get(l);c&&c.notify(...o)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=lC(l)&&!tJ(l),this.instance=l;const{layoutId:o,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let x,u=0;const f=()=>this.root.updateBlockedByResize=!1;Kt.read(()=>{u=window.innerWidth}),e(l,()=>{const h=window.innerWidth;h!==u&&(u=h,this.root.updateBlockedByResize=!0,x&&x(),x=JZ(f,250),mf.hasAnimatedSinceResize&&(mf.hasAnimatedSinceResize=!1,this.nodes.forEach(b5)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&d&&(o||c)&&this.addEventListener("didUpdate",({delta:x,hasLayoutChanged:u,hasRelativeLayoutChanged:f,layout:h})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||d.getDefaultTransition()||_ee,{onLayoutAnimationStart:g,onLayoutAnimationComplete:y}=d.getProps(),v=!this.targetLayout||!VC(this.targetLayout,h),w=!u&&f;if(this.options.layoutRoot||this.resumeFrom||w||u&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const m={...Ey(p,"layout"),onPlay:g,onComplete:y};(d.shouldReduceMotion||this.options.layoutRoot)&&(m.delay=0,m.type=!1),this.startAnimation(m),this.setAnimationOrigin(x,w)}else u||b5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=h})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ll(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(bee),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&HC(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let x=0;x<this.path.length;x++){const u=this.path[x];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(p5);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(v5);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(gee),this.nodes.forEach(xee),this.nodes.forEach(uee)):this.nodes.forEach(v5),this.clearAllSnapshots();const o=Hs.now();as.delta=fi(0,1e3/60,o-as.timestamp),as.timestamp=o,as.isProcessing=!0,Fg.update.process(as),Fg.preRender.process(as),Fg.render.process(as),as.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,jy.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(mee),this.sharedNodes.forEach(yee)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Kt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Kt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Fs(this.snapshot.measuredBox.x)&&!Fs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutCorrected=br(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(o=!1),o&&this.instance){const c=a(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!qC(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,x=d!==this.prevTransformTemplateValue;l&&this.instance&&(o||Sl(this.latestValues)||x)&&(n(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return l&&(c=this.removeTransform(c)),jee(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:l}=this.options;if(!l)return br();const o=l.measureViewportBox();if(!(((d=this.scroll)==null?void 0:d.wasRoot)||this.path.some(Nee))){const{scroll:x}=this.root;x&&(mc(o.x,x.offset.x),mc(o.y,x.offset.y))}return o}removeElementScroll(l){var c;const o=br();if(ma(o,l),(c=this.scroll)!=null&&c.wasRoot)return o;for(let d=0;d<this.path.length;d++){const x=this.path[d],{scroll:u,options:f}=x;x!==this.root&&u&&f.layoutScroll&&(u.wasRoot&&ma(o,l),mc(o.x,u.offset.x),mc(o.y,u.offset.y))}return o}applyTransform(l,o=!1){const c=br();ma(c,l);for(let d=0;d<this.path.length;d++){const x=this.path[d];!o&&x.options.layoutScroll&&x.scroll&&x!==x.root&&gc(c,{x:-x.scroll.offset.x,y:-x.scroll.offset.y}),Sl(x.latestValues)&&gc(c,x.latestValues)}return Sl(this.latestValues)&&gc(c,this.latestValues),c}removeTransform(l){const o=br();ma(o,l);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Sl(d.latestValues))continue;z1(d.latestValues)&&d.updateSnapshot();const x=br(),u=d.measurePageBox();ma(x,u),x5(o,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,x)}return Sl(this.latestValues)&&x5(o,this.latestValues),o}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==as.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var f;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(l||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:x,layoutId:u}=this.options;if(!(!this.layout||!(x||u))){if(this.resolvedRelativeTargetAt=as.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=br(),this.relativeTargetOrigin=br(),Bd(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),ma(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=br(),this.targetWithTransforms=br()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),BZ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ma(this.target,this.layout.layoutBox),jC(this.target,this.targetDelta)):ma(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=br(),this.relativeTargetOrigin=br(),Bd(this.relativeTargetOrigin,this.target,h.target),ma(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||z1(this.parent.latestValues)||_C(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const l=this.getLead(),o=!!this.resumingFrom||this!==l;let c=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===as.timestamp&&(c=!1),c)return;const{layout:d,layoutId:x}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||x))return;ma(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,f=this.treeScale.y;qJ(this.layoutCorrected,this.treeScale,this.path,o),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=br());const{target:h}=l;if(!h){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(o5(this.prevProjectionDelta.x,this.projectionDelta.x),o5(this.prevProjectionDelta.y,this.projectionDelta.y)),Sd(this.projectionDelta,this.layoutCorrected,h,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==f||!g5(this.projectionDelta.x,this.prevProjectionDelta.x)||!g5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",h))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),l){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=pc(),this.projectionDelta=pc(),this.projectionDeltaWithTransform=pc()}setAnimationOrigin(l,o=!1){const c=this.snapshot,d=c?c.latestValues:{},x={...this.latestValues},u=pc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const f=br(),h=c?c.source:void 0,p=this.layout?this.layout.source:void 0,g=h!==p,y=this.getStack(),v=!y||y.members.length<=1,w=!!(g&&!v&&this.options.crossfade===!0&&!this.path.some(Eee));this.animationProgress=0;let m;this.mixTargetDelta=b=>{const _=b/1e3;y5(u.x,l.x,_),y5(u.y,l.y,_),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Bd(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),wee(this.relativeTarget,this.relativeTargetOrigin,f,_),m&&iee(this.relativeTarget,m)&&(this.isProjectionDirty=!1),m||(m=br()),ma(m,this.relativeTarget)),g&&(this.animationValues=x,eee(x,d,this.latestValues,_,w,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){var o,c,d;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(d=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||d.stop(),this.pendingAnimation&&(ll(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Kt.update(()=>{mf.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Kc(0)),this.currentAnimation=XZ(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:x=>{this.mixTargetDelta(x),l.onUpdate&&l.onUpdate(x)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(cee),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:o,target:c,layout:d,latestValues:x}=l;if(!(!o||!c||!d)){if(this!==l&&this.layout&&d&&GC(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||br();const u=Fs(this.layout.layoutBox.x);c.x.min=l.target.x.min,c.x.max=c.x.min+u;const f=Fs(this.layout.layoutBox.y);c.y.min=l.target.y.min,c.y.max=c.y.min+f}ma(o,c),gc(o,x),Sd(this.projectionDeltaWithTransform,this.layoutCorrected,o,x)}}registerSharedNode(l,o){this.sharedNodes.has(l)||this.sharedNodes.set(l,new lee),this.sharedNodes.get(l).add(o);const d=o.options.initialPromotionConfig;o.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(o):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:o,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),l&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let o=!1;const{latestValues:c}=l;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const d={};c.z&&Vg("z",l,d,this.animationValues);for(let x=0;x<qg.length;x++)Vg(`rotate${qg[x]}`,l,d,this.animationValues),Vg(`skew${qg[x]}`,l,d,this.animationValues);l.render();for(const x in d)l.setStaticValue(x,d[x]),this.animationValues&&(this.animationValues[x]=d[x]);l.scheduleRender()}applyProjectionStyles(l,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=hf(o==null?void 0:o.pointerEvents)||"",l.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=hf(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Sl(this.latestValues)&&(l.transform=c?c({},""):"none",this.hasProjected=!1);return}l.visibility="";const x=d.animationValues||d.latestValues;this.applyTransformsToTarget();let u=oee(this.projectionDeltaWithTransform,this.treeScale,x);c&&(u=c(x,u)),l.transform=u;const{x:f,y:h}=this.projectionDelta;l.transformOrigin=`${f.origin*100}% ${h.origin*100}% 0`,d.animationValues?l.opacity=d===this?x.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:x.opacityExit:l.opacity=d===this?x.opacity!==void 0?x.opacity:"":x.opacityExit!==void 0?x.opacityExit:0;for(const p in _x){if(x[p]===void 0)continue;const{correct:g,applyTo:y,isCSSVariable:v}=_x[p],w=u==="none"?x[p]:g(x[p],d);if(y){const m=y.length;for(let b=0;b<m;b++)l[y[b]]=w}else v?this.options.visualElement.renderState.vars[p]=w:l[p]=w}this.options.layoutId&&(l.pointerEvents=d===this?hf(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var o;return(o=l.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(p5),this.root.sharedNodes.clear()}}}function xee(e){e.updateLayout()}function uee(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:n}=e.layout,{animationType:i}=e.options,l=t.source!==e.layout.source;i==="size"?ba(u=>{const f=l?t.measuredBox[u]:t.layoutBox[u],h=Fs(f);f.min=a[u].min,f.max=f.min+h}):GC(i,t.layoutBox,a)&&ba(u=>{const f=l?t.measuredBox[u]:t.layoutBox[u],h=Fs(a[u]);f.max=f.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[u].max=e.relativeTarget[u].min+h)});const o=pc();Sd(o,a,t.layoutBox);const c=pc();l?Sd(c,e.applyTransform(n,!0),t.measuredBox):Sd(c,a,t.layoutBox);const d=!qC(o);let x=!1;if(!e.resumeFrom){const u=e.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:f,layout:h}=u;if(f&&h){const p=br();Bd(p,t.layoutBox,f.layoutBox);const g=br();Bd(g,a,h.layoutBox),VC(p,g)||(x=!0),u.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=p,e.relativeParent=u)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:c,layoutDelta:o,hasLayoutChanged:d,hasRelativeLayoutChanged:x})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function fee(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function hee(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function mee(e){e.clearSnapshot()}function p5(e){e.clearMeasurements()}function v5(e){e.isLayoutDirty=!1}function gee(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function b5(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function pee(e){e.resolveTargetDelta()}function vee(e){e.calcProjection()}function bee(e){e.resetSkewAndRotation()}function yee(e){e.removeLeadSnapshot()}function y5(e,t,r){e.translate=tr(t.translate,0,r),e.scale=tr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function w5(e,t,r,a){e.min=tr(t.min,r.min,a),e.max=tr(t.max,r.max,a)}function wee(e,t,r,a){w5(e.x,t.x,r.x,a),w5(e.y,t.y,r.y,a)}function Eee(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const _ee={duration:.45,ease:[.4,0,.1,1]},E5=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),_5=E5("applewebkit/")&&!E5("chrome/")?Math.round:Ma;function j5(e){e.min=_5(e.min),e.max=_5(e.max)}function jee(e){j5(e.x),j5(e.y)}function GC(e,t,r){return e==="position"||e==="preserve-aspect"&&!SZ(m5(t),m5(r),.2)}function Nee(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const Cee=WC({attachResizeListener:(e,t)=>jx(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Hg={current:void 0},YC=WC({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Hg.current){const e=new Cee({});e.mount(window),e.setOptions({layoutScroll:!0}),Hg.current=e}return Hg.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Aee={pan:{Feature:HZ},drag:{Feature:VZ,ProjectionNode:YC,MeasureLayout:UC}};function N5(e,t,r){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,i=a[n];i&&Kt.postRender(()=>i(t,eu(t)))}class kee extends pl{mount(){const{current:t}=this.node;t&&(this.unmount=KQ(t,(r,a)=>(N5(this.node,a,"Start"),n=>N5(this.node,n,"End"))))}unmount(){}}class Dee extends pl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Qx(jx(this.node.current,"focus",()=>this.onFocus()),jx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function C5(e,t,r){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),i=a[n];i&&Kt.postRender(()=>i(t,eu(t)))}class See extends pl{mount(){const{current:t}=this.node;t&&(this.unmount=eJ(t,(r,a)=>(C5(this.node,a,"Start"),(n,{success:i})=>C5(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const X1=new WeakMap,Wg=new WeakMap,Bee=e=>{const t=X1.get(e.target);t&&t(e)},Fee=e=>{e.forEach(Bee)};function Tee({root:e,...t}){const r=e||document;Wg.has(r)||Wg.set(r,{});const a=Wg.get(r),n=JSON.stringify(t);return a[n]||(a[n]=new IntersectionObserver(Fee,{root:e,...t})),a[n]}function Mee(e,t,r){const a=Tee(t);return X1.set(e,r),a.observe(e),()=>{X1.delete(e),a.unobserve(e)}}const Ree={some:0,all:1};class Oee extends pl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:a,amount:n="some",once:i}=t,l={root:r?r.current:void 0,rootMargin:a,threshold:typeof n=="number"?n:Ree[n]},o=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:x,onViewportLeave:u}=this.node.getProps(),f=d?x:u;f&&f(c)};return Mee(this.node.current,l,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Pee(t,r))&&this.startObserver()}unmount(){}}function Pee({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Lee={inView:{Feature:Oee},tap:{Feature:See},focus:{Feature:Dee},hover:{Feature:kee}},Iee={layout:{ProjectionNode:YC,MeasureLayout:UC}},Uee={...jZ,...Lee,...Aee,...Iee},Xa=UJ(Uee,ZJ),$ee=e=>e.replace(/[^a-zA-Z0-9\-_]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"").substring(0,100),zee=async(e,t,r,a)=>{var n;try{const i=e.name.split(".").pop(),l=a||e.name,o=l.replace(/\.[^/.]+$/,""),c=$ee(o),d=`${t}/${r}/${Date.now()}-${c}.${i}`,{data:x,error:u}=await Z.storage.from("event-files").upload(d,e,{cacheControl:"3600",upsert:!1});if(u)return console.error("  :",u),{success:!1,error:u.message};const{data:f}=Z.storage.from("event-files").getPublicUrl(d),{error:h}=await Z.from("event_files").insert({event_id:t,file_name:l,file_url:f.publicUrl,file_type:r,file_size:e.size,uploaded_by:(n=(await Z.auth.getUser()).data.user)==null?void 0:n.id});return h?(console.error("   :",h),await Z.storage.from("event-files").remove([d]),{success:!1,error:h.message}):{success:!0,url:f.publicUrl,originalName:l}}catch(i){return console.error("   :",i),{success:!1,error:i instanceof Error?i.message:" "}}},XC=async e=>{try{const{data:t,error:r}=await Z.from("event_files").select("*").eq("id",e).single();if(r)return console.error("    :",r),{success:!1,error:r.message};if(!t)return{success:!1,error:"  "};const n=new URL(t.file_url).pathname.split("/").slice(-3).join("/"),{error:i}=await Z.storage.from("event-files").remove([n]);i&&console.error("    Storage:",i);const{error:l}=await Z.from("event_files").delete().eq("id",e);return l?(console.error("    :",l),{success:!1,error:l.message}):{success:!0}}catch(t){return console.error("   :",t),{success:!1,error:t instanceof Error?t.message:" "}}},qee=async(e,t)=>{try{const{error:r}=await Z.from("event_files").update({file_name:t}).eq("id",e);return r?(console.error("   :",r),{success:!1,error:r.message}):(console.log("    :",t),{success:!0})}catch(r){return console.error("    :",r),{success:!1,error:r instanceof Error?r.message:" "}}},KC=async e=>{try{const{data:t,error:r}=await Z.from("event_files").select("*").eq("event_id",e).order("created_at",{ascending:!1});return r?(console.error("    :",r),[]):(t||[]).map(n=>({id:n.id,name:n.file_name,type:n.file_type,url:n.file_url,size:n.file_size,created_at:n.created_at}))}catch(t){return console.error("   :",t),[]}},Vee=async(e,t,r)=>{try{const{data:a,error:n}=await Z.from("notification_tasks").insert({assigned_to:e,title:" ",description:`  "${t}"`,type:"event",priority:"medium",metadata:{event_id:r,event_title:t}}).select().single();if(n)throw n;return a}catch(a){throw console.error("    :",a),a}},Hee=async(e,t,r,a="medium")=>{try{const{data:n,error:i}=await Z.from("notification_tasks").insert({assigned_to:e,title:t,description:r,type:"system",priority:a}).select().single();if(i)throw i;return n}catch(n){throw console.error("   :",n),n}},QC=async(e,t,r,a="general",n="medium")=>{try{const{data:i,error:l}=await Z.from("users").select("id").eq("role",e).eq("is_active",!0);if(l)throw l;if(!i||i.length===0)return console.log(`     ${e}`),[];const o=i.map(x=>({assigned_to:x.id,title:t,description:r,type:a,priority:n})),{data:c,error:d}=await Z.from("notification_tasks").insert(o).select();if(d)throw d;return c}catch(i){throw console.error("    :",i),i}};function JC({isOpen:e,onClose:t,onSuccess:r,editingEvent:a,defaultEventType:n}){var we,ke,be,Ee;const{user:i,userProfile:l}=st(),[o,c]=E.useState({title:"",description:"",event_type_id:"",start_date:"",end_date:"",location:"",meeting_link:"",points:0,max_participants:"",status:"draft"}),[d,x]=E.useState([]),[u,f]=E.useState(null),[h,p]=E.useState(""),[g,y]=E.useState({isOpen:!1,file:null}),[v,w]=E.useState([]),[m,b]=E.useState(null),[_,C]=E.useState(null),[j,D]=E.useState(!1),[R,M]=E.useState(!1),[O,B]=E.useState(!1),[L,U]=E.useState({}),[P,F]=E.useState(1),[N,T]=E.useState([]),[S,z]=E.useState([]),[W,k]=E.useState(""),[q,A]=E.useState([]),[I,V]=E.useState(!1),[H,Y]=E.useState([]),[Q,te]=E.useState([]),[re,X]=E.useState([]),[je,J]=E.useState(!1),[ue,de]=E.useState([]),[ce,fe]=E.useState({talentCategory:null,groupName:"",expertEmails:[],experts:[]}),[pe,Ne]=E.useState(null),ne=wt.useRef(null),_e=wt.useRef(null);console.log("CreateEventModal:   eventType:",_,"eventTypes:",v),console.log("CreateEventModal: isOpen:",e,"defaultEventType:",n,"editingEvent:",a),E.useEffect(()=>{ye()},[]),E.useEffect(()=>{if(e&&n&&!a&&v.length>0&&(console.log("    :",n),n==="exam")){C("exam");const G=v.find(ae=>ae.name==="exam_talent_reserve"||ae.name_ru==="  ");console.log("    defaultEventType:",G),G?(console.log(" formData    event_type_id:",G.id),c(ae=>({...ae,title:"  ",description:"     ",event_type_id:G.id,status:"draft",points:0})),fe({talentCategory:null,groupName:"",expertEmails:[],experts:[]}),console.log("formData   ")):console.log("     eventTypes")}},[e,n,a,v]),E.useEffect(()=>{e||(C(null),c({title:"",description:"",event_type_id:"",start_date:"",end_date:"",location:"",meeting_link:"",points:0,max_participants:"",status:"draft"}),fe({talentCategory:null,groupName:"",expertEmails:[],experts:[]}))},[e]),E.useEffect(()=>{(async()=>{var ae,xe;if(a){if(console.log(" :",a),c({title:a.title||"",description:a.description||"",event_type_id:a.event_type_id||"",start_date:a.start_date?new Date(a.start_date).toISOString().slice(0,16):"",end_date:a.end_date?new Date(a.end_date).toISOString().slice(0,16):"",location:a.location||"",meeting_link:a.meeting_link||"",points:a.points||0,max_participants:((ae=a.max_participants)==null?void 0:ae.toString())||"",status:a.status||"draft"}),(l==null?void 0:l.role)==="trainer"&&a.event_types){const he=a.event_types.name,me=a.event_types.is_online;console.log("  :",{typeName:he,isOnline:me,eventType:a.event_types}),he==="online_training"||he==="in_person_training"&&me===!0?C("online"):(he==="offline_training"||he==="in_person_training"&&me===!1)&&C("offline")}if(((xe=a.event_types)==null?void 0:xe.name)==="exam_talent_reserve"&&(console.log("   :",a),C("exam"),fe({talentCategory:a.talent_category?{id:a.talent_category.id,name_ru:a.talent_category.name_ru,color:a.talent_category.color}:null,groupName:a.group_name||"",expertEmails:a.expert_emails||[],experts:a.expert_emails?a.expert_emails.map((he,me)=>({id:`expert-${me}`,fullName:` ${me+1}`,position:"",email:he})):[]})),console.log("    ..."),console.log("editingEvent.event_participants:",a.event_participants),a.event_participants&&a.event_participants.length>0){const he=a.event_participants.map(me=>{var ge,ve,Ie;return{id:me.user_id,full_name:((ge=me.users)==null?void 0:ge.full_name)||"",email:((ve=me.users)==null?void 0:ve.email)||"",sap_number:((Ie=me.users)==null?void 0:Ie.sap_number)||"",position:"",territory:""}});console.log("  :",he),z(he),he.length>0&&await De(he)}else console.log("     "),z([]);console.log("   :",a.id),await Ce(a.id)}else c({title:"",description:"",event_type_id:"",start_date:"",end_date:"",location:"",meeting_link:"",points:0,max_participants:"",status:"draft"}),z([]),x([]);e&&(Te(),Me(),F(1),Y([]),de([]),J(!1),ye(),Re()),U({})})()},[a,e]);const Te=async()=>{try{const{data:G,error:ae}=await Z.from("positions").select("*").order("name");if(ae)throw ae;te(G||[])}catch(G){console.error("  :",G)}},Me=async()=>{try{const{data:G,error:ae}=await Z.from("territories").select("*").order("name");if(ae)throw ae;X(G||[])}catch(G){console.error("  :",G)}},ye=async()=>{try{console.log("   ...");const{data:G,error:ae}=await Z.from("event_types").select("*").order("name_ru");if(ae)throw console.error("    :",ae),ae;w(G||[]),console.log("   :",G);const xe=G==null?void 0:G.find(he=>he.name==="exam_talent_reserve"||he.name_ru==="  ");if(console.log("    :",xe),(l==null?void 0:l.role)==="trainer"){const he=G==null?void 0:G.filter(ge=>ge.name==="online_training"||ge.name_ru==="-"||ge.name==="in_person_training"&&ge.is_online===!0),me=G==null?void 0:G.filter(ge=>ge.name==="offline_training"||ge.name_ru===" "||ge.name==="in_person_training"&&ge.is_online===!1);console.log("  :",he),console.log("  :",me)}}catch(G){console.error("   :",G)}},Re=async()=>{try{const{data:G,error:ae}=await Z.from("users").select(`
          id, 
          full_name, 
          email, 
          sap_number, 
          phone, 
          position:position_id(name), 
          territory:territory_id(name)
        `).eq("is_active",!0).order("full_name");if(ae)throw ae;T(G||[])}catch(G){console.error("  :",G)}},De=async G=>{try{console.log("   :",G);const ae=G.map(Ie=>Ie.id);console.log("ID :",ae);const{data:xe,error:he}=await Z.from("users").select("id, position:position_id(name)").in("id",ae);console.log(" :",xe,":",he);const{data:me,error:ge}=await Z.from("users").select("id, territory:territory_id(name)").in("id",ae);console.log(" :",me,":",ge);const ve=G.map(Ie=>{const ze=xe==null?void 0:xe.find($e=>$e.id===Ie.id),qe=me==null?void 0:me.find($e=>$e.id===Ie.id);return{...Ie,position:(ze==null?void 0:ze.position)||{name:""},territory:(qe==null?void 0:qe.territory)||{name:""}}});console.log(" :",ve),z(ve)}catch(ae){console.error("   :",ae)}},Ce=async G=>{try{console.log("    :",G);const xe=(await KC(G)).map(he=>({id:he.id,name:he.name,type:he.type,file:null,url:he.url,size:he.size}));console.log("  :",xe),x(xe)}catch(ae){console.error("   :",ae)}};E.useEffect(()=>{if(o.event_type_id){const G=v.find(ae=>ae.id===o.event_type_id);b(G||null)}else b(null)},[o.event_type_id,v]),E.useEffect(()=>{function G(ae){_e.current&&!_e.current.contains(ae.target)&&V(!1)}return document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[]),E.useEffect(()=>{function G(ae){const xe=ae.target,he=xe.closest("[data-calendar-button]"),me=xe.closest("[data-calendar-dropdown]"),ge=xe.closest("[data-time-button]"),ve=xe.closest("[data-time-dropdown]");R&&!he&&!me&&M(!1),O&&!ge&&!ve&&B(!1)}if(R||O)return document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[R,O]),E.useEffect(()=>{if(W.length<2){A([]),V(!1);return}const G=N.filter(ae=>ae.full_name.toLowerCase().includes(W.toLowerCase())||ae.email&&ae.email.toLowerCase().includes(W.toLowerCase())||ae.sap_number&&ae.sap_number.toLowerCase().includes(W.toLowerCase())).slice(0,10);A(G),V(!0)},[W,N]);const Ye=G=>{S.some(ae=>ae.id===G.id)||(z([...S,{...G,position:G.position||{name:""},territory:G.territory||{name:""}}]),k(""),V(!1))},Ue=G=>{z(ae=>ae.filter((xe,he)=>he!==G))},He=async G=>{var ge;const ae=(ge=G.target.files)==null?void 0:ge[0];if(!ae)return;const xe=10*1024*1024;if(ae.size>xe){Y([`  .  : 10MB.  : ${(ae.size/1024/1024).toFixed(1)}MB`]),ne.current&&(ne.current.value="");return}const he=[".xlsx",".xls"],me=ae.name.toLowerCase().substring(ae.name.lastIndexOf("."));if(!he.includes(me)){Y(["  .  .xlsx  .xls"]),ne.current&&(ne.current.value="");return}try{Y([]);const ve=await pt(ae);if(ve.length===0){Y(["     "]);return}de(ve),J(!0),await za(ve)}catch(ve){console.error("   Excel :",ve instanceof Error?ve.message:" "),Y([ve instanceof Error?ve.message:"   "])}finally{ne.current&&(ne.current.value="")}},pt=G=>new Promise((ae,xe)=>{const he=new FileReader;he.onload=async me=>{var ge;try{const ve=new Uint8Array((ge=me.target)==null?void 0:ge.result),Ie=lh(ve,{type:"array"}),ze=Ie.Sheets[Ie.SheetNames[0]];if(Je(ze)){console.log("  ,   ");const Oe=Jt(ze);ae(Oe);return}let $e=0,We=[];for(let Oe=0;Oe<15;Oe++){const Pt=qr.sheet_to_json(ze,{range:Oe,header:1});if(Pt.length>0){const Yt=Pt[0];if(Yt&&Yt.some(rs=>typeof rs=="string"&&(rs.toLowerCase().includes("")||rs.toLowerCase().includes("")||rs.toLowerCase().includes("full name")||rs.toLowerCase().includes("")))){$e=Oe,We=qr.sheet_to_json(ze,{range:Oe+1});break}}}if(We.length===0&&(We=qr.sheet_to_json(ze,{range:12})),We.length===0)throw new Error("   . ,    .");const Ke=We[0],Ge=or(Ke),ht=We.map((Oe,Pt)=>{const Yt=vt(Oe,Ge.fullName)||"",rs=vt(Oe,Ge.sapNumber)||"",o7=vt(Oe,Ge.position)||"",c7=vt(Oe,Ge.territory)||"",d7=vt(Oe,Ge.experience)||0,x7=vt(Oe,Ge.phone)||"",iu=vt(Oe,Ge.email)||"";let C0=null;return Yt.trim()?!iu.trim()&&!rs.trim()?C0="   Email,  SAP ":iu&&!Is(iu)&&(C0="  Email"):C0=" ",{full_name:Yt.trim(),sap_number:rs.trim()||null,position:{name:o7.trim()},territory:{name:c7.trim()},work_experience_days:parseInt(d7.toString())||0,phone:x7.trim(),email:iu.trim()||null,error:C0,status:C0?"error":"new"}});ae(ht)}catch{xe(new Error("   . ,    ."))}},he.onerror=()=>{xe(new Error("  ."))},he.readAsArrayBuffer(G)}),Je=G=>{try{for(let ae=0;ae<15;ae++){const xe=[];for(let me=0;me<15;me++){const ge=qr.encode_cell({r:ae,c:me}),ve=G[ge],Ie=ve?ve.v:"";xe.push(Ie)}const he=xe.join(" ").toLowerCase();if(he.includes(" ")||he.includes(" ")||he.includes(" ")||he.includes("sap id")||he.includes("  ")||he.includes(" ")||he.includes(" ")||he.includes(" ")||he.includes(" "))return!0}return!1}catch{return!1}},Jt=G=>{const ae=qr.decode_range(G["!ref"]),xe=[];for(let he=12;he<=ae.e.r;he++){const me=[];for(let ge=0;ge<=ae.e.c;ge++){const ve=qr.encode_cell({r:he,c:ge}),Ie=G[ve],ze=Ie?Ie.v:"";me.push(ze)}if(me[0]&&!isNaN(me[0])&&me[1]&&typeof me[1]=="string"&&me[1].length>5){const ge=me[1]||"",ve=me[2]||"",Ie=me[3]||"",ze=me[4]||"",qe=me[5]||0,$e=me[7]||"",We=me[8]||"";let Ke=null;ge.trim()?ve.toString().trim()||(Ke=" SAP "):Ke=" ";const Ge=Ke?null:`${ve}@sns.ru`;xe.push({full_name:ge.trim(),sap_number:ve.toString().trim(),position:{name:Ie.trim()},territory:{name:ze.trim()},work_experience_days:parseInt(qe.toString())||0,phone:$e.toString().trim(),email:Ge,approval_status:We.toString().trim(),error:Ke,is_tp:!0,import_status:Ke?"error":"new"})}}return xe},or=G=>{const ae=Object.keys(G),xe={};return ae.forEach(he=>{const me=G[he];if(typeof me=="string"){const ge=me.toLowerCase();ge.includes("")||ge.includes("")||ge.includes("full name")||ge.includes("")?xe.fullName=he:ge.includes("sap")||ge.includes("")||ge.includes("")?xe.sapNumber=he:ge.includes("")||ge.includes("position")||ge.includes("")?xe.position=he:ge.includes("")||ge.includes("")||ge.includes("territory")||ge.includes("")?xe.territory=he:ge.includes("")||ge.includes("experience")||ge.includes("")?xe.experience=he:ge.includes("")||ge.includes("phone")||ge.includes("")?xe.phone=he:(ge.includes("email")||ge.includes("")||ge.includes("e-mail"))&&(xe.email=he)}}),xe.fullName||(xe.fullName="__EMPTY_1"),xe.sapNumber||(xe.sapNumber="__EMPTY_2"),xe.position||(xe.position="__EMPTY_3"),xe.territory||(xe.territory="__EMPTY_4"),xe.experience||(xe.experience="__EMPTY_5"),xe.phone||(xe.phone="__EMPTY_7"),xe.email||(xe.email="__EMPTY_8"),xe},vt=(G,ae)=>(ae.startsWith("__EMPTY_"),G[ae]),Is=G=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(G),zr=async(G,ae)=>{let xe=0;try{let he=null;if(ae.territory){const ve=typeof ae.territory=="string"?ae.territory:ae.territory.name||ae.territory.region||"";if(ve){const Ie=re.find(ze=>ze.name.toLowerCase()===ve.toLowerCase()||ze.region&&ze.region.toLowerCase()===ve.toLowerCase());Ie&&(he=Ie.id)}}let me=null;if(ae.position){const ve=typeof ae.position=="string"?ae.position:ae.position.name||"";if(ve){let Ie=Q.find(ze=>ze.name.toLowerCase()===ve.toLowerCase());Ie||ve.toLowerCase().includes(" ")&&(Ie=Q.find(qe=>qe.name.toLowerCase().includes(" "))),Ie&&(me=Ie.id)}}const ge={};if(me&&(ge.position_id=me,xe++),he&&(ge.territory_id=he,xe++),ae.phone&&(ge.phone=ae.phone,xe++),ae.work_experience_days&&(ge.work_experience_days=ae.work_experience_days,xe++),Object.keys(ge).length>0){const{error:ve}=await Z.from("users").update(ge).eq("id",G);return ve?(console.error("   :",ve),!1):(console.log(`    ${ae.full_name} (${xe} ):`,ge),xe>0)}return!0}catch(he){return console.error("    :",he),!1}},za=async G=>{const ae=G.filter(xe=>xe.sap_number&&!xe.error).map(xe=>xe.sap_number);if(ae.length===0){Ne({existing:[],new:ae,total:0});return}try{const{data:xe,error:he}=await Z.from("users").select("sap_number").in("sap_number",ae).not("sap_number","is",null);if(he){console.error("  SAP :",he);return}const me=(xe==null?void 0:xe.map(ve=>ve.sap_number))||[],ge=ae.filter(ve=>!me.includes(ve));Ne({existing:me,new:ge,total:ae.length}),console.log("  SAP :",{total:ae.length,existing:me.length,new:ge.length,existingSap:me,newSap:ge})}catch(xe){console.error("  SAP :",xe)}},Mo=()=>{const G=ue.filter(ae=>!ae.error);z(ae=>[...ae,...G]),J(!1)},N0=()=>{const G=qr.book_new(),ae=[["","SAP ","","","  ()","","","Email"],["  ","12345","","","365","","+7900123456","ivanov@example.com"],["  ","67890","","-","180","","+7900987654","petrov@example.com"],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""]],xe=qr.aoa_to_sheet(ae);xe["!cols"]=[{width:25},{width:12},{width:20},{width:20},{width:18},{width:5},{width:15},{width:25}],qr.book_append_sheet(G,xe,"");const he=oh(G,{bookType:"xlsx",type:"array"}),me=new Blob([he],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ge=URL.createObjectURL(me),ve=document.createElement("a");ve.href=ge,ve.download="__.xlsx",document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),URL.revokeObjectURL(ge)},Nr=()=>{const G=qr.book_new(),ae=[["","","","","    ","","","","","","","","",""],["","","","","","","","","","","","","",""],["    30  120 ,    ","","","","","","","","","","","","",""],["","  ","","  ","","","","","","","","","",""],["","","","-","","","","","","","","","",""],["","","","01.01.2025","","","","","","","","","",""],[""," ",""," 09:00  13:00","","","","","","","","","",""],[""," ","","ZOOM,  ","","","","","","","","","",""],["","","","","","","","","","",""," ","SAP ID","  ()","   SAP"],["    30  120 ,      ","","","","","      ","","","","","","","",""],[" ","  ()","SAP ID","   SAP"," ","     .   .   ( )","        ","","","","","","","",""],["","","","","","","   ",". ","   (,  , )","","","","","",""],["1","  ","50161090"," ","-","129","","79017801500","","","","","","",""],["2","  ","50161250"," ","-","114","","79017801500","","","","","","",""],["3","  ","50161418","  ","-","100","","79017801500","","","","","","",""],["","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","",""]],xe=qr.aoa_to_sheet(ae);xe["!cols"]=[{width:8},{width:30},{width:12},{width:25},{width:20},{width:35},{width:40},{width:8},{width:15},{width:40},{width:8},{width:8},{width:8},{width:15},{width:12},{width:30}],qr.book_append_sheet(G,xe," ");const he=oh(G,{bookType:"xlsx",type:"array"}),me=new Blob([he],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ge=URL.createObjectURL(me),ve=document.createElement("a");ve.href=ge,ve.download="__.xlsx",document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),URL.revokeObjectURL(ge)};if(!e)return null;const mr=()=>{const G={};return console.log("validateForm:  "),console.log("formData.event_type_id:",o.event_type_id),console.log("eventType:",_),!o.event_type_id&&!(n==="exam"&&_==="exam")&&(G.event_type_id="  ",console.log("validateForm:  -    ")),o.title.trim()||(G.title=" "),o.start_date||(G.start_date="  "),o.end_date&&o.start_date&&new Date(o.end_date)<new Date(o.start_date)&&(G.end_date="       "),o.max_participants&&parseInt(o.max_participants)<1&&(G.max_participants="     0"),_==="exam"&&(console.log("validateForm:  "),console.log("examData.talentCategory:",ce.talentCategory),console.log("examData.groupName:",ce.groupName),console.log("examData.experts:",ce.experts),ce.talentCategory||(G.talentCategory="  ",console.log("validateForm:  -    ")),ce.groupName.trim()||(G.groupName="  ",console.log("validateForm:  -    ")),ce.experts.length===0&&(G.expertEmails="    ",console.log("validateForm:  -   "))),P===2&&S.length===0&&(G.participants="     "),U(G),console.log("validateForm:  :",Object.keys(G).length===0),console.log("validateForm: :",G),Object.keys(G).length===0},ts=G=>{if(G.preventDefault(),console.log("nextStep:  ..."),console.log("formData:",o),console.log("eventType:",_),console.log("examData:",ce),n==="exam"&&_==="exam"&&!o.event_type_id){console.log("nextStep:  event_type_id  ");const ae=v.find(xe=>xe.name==="exam_talent_reserve"||xe.name_ru==="  ");ae&&(c(xe=>({...xe,event_type_id:ae.id})),console.log("nextStep: event_type_id :",ae.id))}if(!mr()){console.log("nextStep:   , :",L);return}console.log("nextStep:  ,    2"),F(2)},xa=()=>{F(1)},xs=async G=>{if(G.preventDefault(),!!mr()){D(!0),console.log(`   . : ${S.length}`),console.log(" :",S.map(ae=>({name:ae.full_name,id:ae.id,email:ae.email,sap:ae.sap_number})));try{const ae={title:o.title.trim(),description:o.description.trim()||null,event_type_id:o.event_type_id,start_date:o.start_date,end_date:o.end_date||null,location:o.location.trim()||null,meeting_link:o.meeting_link.trim()||null,points:parseInt(o.points.toString())||0,max_participants:o.max_participants?parseInt(o.max_participants):null,status:o.status,..._==="exam"&&ce.talentCategory&&{talent_category_id:ce.talentCategory.id,group_name:ce.groupName,expert_emails:ce.expertEmails},creator_id:i==null?void 0:i.id,updated_at:new Date().toISOString()};let xe;if(a){const{error:he}=await Z.from("events").update(ae).eq("id",a.id);if(he)throw he;if(xe=a.id,_==="exam"&&ce.experts&&ce.experts.length>0)for(const me of ce.experts)try{const ge=await xc(me.email,me.fullName,"expert","123456",{sap_number:"",territory_id:(l==null?void 0:l.territory_id)||null,position_id:null,work_experience_days:0});ge.success||console.error(`     ${me.fullName}:`,ge.message)}catch(ge){console.error(`     ${me.fullName}:`,ge)}if(S.length>0){console.log(`      (ID: ${a.id})`);const{data:me,error:ge}=await Z.from("event_participants").select("user_id").eq("event_id",a.id);if(ge)throw console.error("    :",ge),ge;console.log("  :",me);const ve=(me==null?void 0:me.map(qe=>qe.user_id))||[],Ie=S.map(qe=>qe.id).filter(qe=>qe&&!ve.includes(qe));console.log("  ID:",ve),console.log("  ID:",Ie),console.log("  :",S.map(qe=>({name:qe.full_name,id:qe.id,email:qe.email,sap:qe.sap_number,hasId:!!qe.id}))),console.log(`  ${S.length}    `);for(const qe of S)qe.id&&(console.log(`    : ${qe.full_name}`),await zr(qe.id,qe));const ze=S.filter(qe=>!qe.id);if(console.log(`   ID ( ): ${ze.length}`),ze.length>0){console.log("    ...");const qe=[];for(const $e of ze){console.log(`  : ${$e.full_name} (Email: ${$e.email}, SAP: ${$e.sap_number})`),console.log("   :",{full_name:$e.full_name,email:$e.email,sap_number:$e.sap_number,territory:$e.territory,position:$e.position,phone:$e.phone,work_experience_days:$e.work_experience_days});let We=null;if($e.email){console.log(`    email: ${$e.email}`);const{data:Ke}=await Z.from("users").select("id").eq("email",$e.email).maybeSingle();Ke&&(We=Ke,console.log(`    email: ${$e.email} (ID: ${Ke.id})`))}if(!We&&$e.sap_number){console.log(`    SAP: ${$e.sap_number}`);const{data:Ke}=await Z.from("users").select("id").eq("sap_number",$e.sap_number).maybeSingle();Ke&&(We=Ke,console.log(`    SAP: ${$e.sap_number} (ID: ${Ke.id})`))}if(We){qe.push({event_id:a.id,user_id:We.id,attended:!1}),console.log(`   : ${$e.full_name} (ID: ${We.id})`),await zr(We.id,$e);continue}console.log(`   : ${$e.full_name}`);try{let Ke=null;if($e.territory){const Oe=typeof $e.territory=="string"?$e.territory:$e.territory.name||$e.territory.region||"";if(console.log(`  : "${Oe}" (: ${typeof $e.territory})`),Oe){let Pt=re.find(Yt=>Yt.name.toLowerCase()===Oe.toLowerCase()||Yt.region&&Yt.region.toLowerCase()===Oe.toLowerCase());if(!Pt){const Yt=Oe.toLowerCase();Pt=re.find(rs=>rs.name.toLowerCase().includes(Yt)||rs.region&&rs.region.toLowerCase().includes(Yt)||Yt.includes(rs.name.toLowerCase())||rs.region&&Yt.includes(rs.region.toLowerCase())),Pt&&console.log(`   : "${Pt.name}"  "${Oe}"`)}Pt?(Ke=Pt.id,console.log(`  : "${Pt.name}" (ID: ${Ke})`)):(console.log(`   : "${Oe}"`),console.log("  :",re.map(Yt=>({name:Yt.name,region:Yt.region}))))}else console.log("      :",$e.territory)}let Ge=null;if($e.position){const Oe=typeof $e.position=="string"?$e.position:$e.position.name||"";if(console.log(`  : "${Oe}" (: ${typeof $e.position})`),Oe){let Pt=Q.find(Yt=>Yt.name.toLowerCase()===Oe.toLowerCase());Pt||Oe.toLowerCase().includes(" ")&&(Pt=Q.find(rs=>rs.name.toLowerCase().includes(" ")),Pt&&console.log(`   : "${Pt.name}"  "${Oe}"`)),Pt?(Ge=Pt.id,console.log(`  : "${Pt.name}" (ID: ${Ge})`)):(console.log(`   : "${Oe}"`),console.log("  :",Q.map(Yt=>Yt.name)))}else console.log("      :",$e.position)}const ht=await xc($e.email||"",$e.full_name,"employee","123456",{sap_number:$e.sap_number||null,phone:$e.phone||null,territory_id:Ke,position_id:Ge,work_experience_days:$e.work_experience_days||0});ht.success&&ht.user?(qe.push({event_id:a.id,user_id:ht.user.id,attended:!1}),console.log(`   : ${$e.full_name} (ID: ${ht.user.id})`)):(console.error("   :",ht.message),console.warn(`   ${$e.full_name}: ${ht.message}`))}catch(Ke){if(console.error("   :",Ke),typeof Ke=="object"&&Ke!==null){const Ge=Ke.message||" ";console.warn(`   ${$e.full_name}: ${Ge}`)}}}if(qe.length>0){console.log(`  ${qe.length}    `);const $e=qe.map(Oe=>Oe.user_id),{data:We,error:Ke}=await Z.from("event_participants").select("user_id").eq("event_id",a.id).in("user_id",$e);if(Ke)throw console.error("    :",Ke),Ke;const Ge=(We==null?void 0:We.map(Oe=>Oe.user_id))||[],ht=qe.filter(Oe=>!Ge.includes(Oe.user_id));if(console.log("  :",{total:qe.length,existing:Ge.length,new:ht.length,existingIds:Ge,newIds:ht.map(Oe=>Oe.user_id)}),ht.length>0)try{console.log("   :",{count:ht.length,data:ht.map(Pt=>({event_id:Pt.event_id,user_id:Pt.user_id}))});const{error:Oe}=await Z.from("event_participants").insert(ht);if(Oe)if(Oe.code==="23505")console.log("       ( )");else throw console.error("    :",Oe),console.error("  :",{code:Oe.code,message:Oe.message,details:Oe.details,hint:Oe.hint}),Oe;else console.log(`   ${ht.length}  `)}catch(Oe){if(Oe.code==="23505")console.log("       ( )");else throw Oe}else console.log("      ");Ge.length>0&&console.log(`  ${Ge.length}  (   )`)}}if(Ie.length>0){const qe=S.filter(Oe=>Oe.id&&Ie.includes(Oe.id)).map(Oe=>({event_id:a.id,user_id:Oe.id,attended:!1}));console.log("     ID:",qe);const $e=qe.map(Oe=>Oe.user_id),{data:We,error:Ke}=await Z.from("event_participants").select("user_id").eq("event_id",a.id).in("user_id",$e);if(Ke)throw console.error("    :",Ke),Ke;const Ge=(We==null?void 0:We.map(Oe=>Oe.user_id))||[],ht=qe.filter(Oe=>!Ge.includes(Oe.user_id));if(console.log("     ID:",{total:qe.length,existing:Ge.length,new:ht.length}),ht.length>0)try{const{error:Oe}=await Z.from("event_participants").insert(ht);if(Oe)if(Oe.code==="23505")console.log("       ( )");else throw console.error("      ID:",Oe),console.error("  :",{code:Oe.code,message:Oe.message,details:Oe.details,hint:Oe.hint}),Oe;else console.log(`  ${ht.length}    ID`)}catch(Oe){if(Oe.code==="23505")console.log("       ( )");else throw Oe}else console.log("     ID    ");Ge.length>0&&console.log(`  ${Ge.length}    ID (   )`)}else console.log("    ID   ")}else console.log("    ")}else{console.log("   ");const{data:he,error:me}=await Z.from("events").insert({...ae,created_at:new Date().toISOString()}).select().single();if(me)throw console.error("   :",me),me;if(xe=he.id,console.log(`    ID: ${xe}`),_==="exam"&&ce.talentCategory){console.log("   ");const{error:ge}=await Z.from("exam_configs").insert([{exam_event_id:xe,total_duration_hours:8,break_duration_minutes:30,max_participants:o.max_participants||20,evaluation_criteria:{}}]);if(ge)throw console.error("    :",ge),ge;if(console.log("   "),ce.experts&&ce.experts.length>0)for(const ve of ce.experts)try{const Ie=await xc(ve.email,ve.fullName,"expert","123456",{sap_number:"",territory_id:(l==null?void 0:l.territory_id)||null,position_id:null,work_experience_days:0});Ie.success||console.error(`     ${ve.fullName}:`,Ie.message)}catch(Ie){console.error(`     ${ve.fullName}:`,Ie)}}if(S.length>0&&he){console.log(`   ${S.length}    `);const ge=[];for(const ve of S){if(console.log(`  : ${ve.full_name} (ID: ${ve.id}, Email: ${ve.email}, SAP: ${ve.sap_number})`),ve.id){ge.push({event_id:he.id,user_id:ve.id,attended:!1}),console.log(`   : ${ve.full_name} (ID: ${ve.id})`),await zr(ve.id,ve);continue}let Ie=null;if(ve.email){console.log(`    email: ${ve.email}`);const{data:ze}=await Z.from("users").select("id").eq("email",ve.email).maybeSingle();ze&&(Ie=ze,console.log(`    email: ${ve.email} (ID: ${ze.id})`))}if(!Ie&&ve.sap_number){console.log(`    SAP: ${ve.sap_number}`);const{data:ze}=await Z.from("users").select("id").eq("sap_number",ve.sap_number).maybeSingle();ze&&(Ie=ze,console.log(`    SAP: ${ve.sap_number} (ID: ${ze.id})`))}if(Ie){ge.push({event_id:he.id,user_id:Ie.id,attended:!1}),console.log(`   : ${ve.full_name} (ID: ${Ie.id})`);continue}console.log(`   : ${ve.full_name}`);try{let ze=null;if(ve.territory){console.log(`  : ${ve.territory}`);const We=re.find(Ke=>Ke.name.toLowerCase()===ve.territory.toLowerCase()||Ke.region&&Ke.region.toLowerCase()===ve.territory.toLowerCase());We?(ze=We.id,console.log(`  : ${ve.territory} (ID: ${ze})`)):console.log(`   : ${ve.territory}`)}let qe=null;if(ve.position){console.log(`  : ${ve.position}`);const We=Q.find(Ke=>Ke.name.toLowerCase()===ve.position.toLowerCase());We?(qe=We.id,console.log(`  : ${ve.position} (ID: ${qe})`)):console.log(`   : ${ve.position}`)}const $e=await xc(ve.email||"",ve.full_name,"employee","123456",{sap_number:ve.sap_number||null,phone:ve.phone||null,territory_id:ze,position_id:qe,work_experience_days:ve.work_experience_days||0});$e.success&&$e.user?(ge.push({event_id:he.id,user_id:$e.user.id,attended:!1}),console.log(`   : ${ve.full_name} (ID: ${$e.user.id})`)):(console.error("   :",$e.message),console.warn(`   ${ve.full_name}: ${$e.message}`))}catch(ze){if(console.error("   :",ze),typeof ze=="object"&&ze!==null){const qe=ze.message||" ";console.warn(`   ${ve.full_name}: ${qe}`)}}}if(console.log(`    : ${ge.length}  ${S.length}`),ge.length>0){console.log("    event_participants:",ge);const{error:ve}=await Z.from("event_participants").insert(ge);if(ve)throw console.error("   :",ve),ve;console.log("     ")}else if(S.length>0)throw console.error("      "),new Error("     .   .")}}if(d.length>0&&xe){const he=d.filter(me=>me.file).map(async me=>{const ge=await zee(me.file,xe,me.type,me.name);return ge.success||console.error(`   ${me.name}:`,ge.error),ge});await Promise.all(he)}try{if(console.log("     "),S.length>0)for(const he of S)he.id&&await Vee(he.id,o.title,xe);await QC("trainer"," ",`   "${o.title}"`,"event","medium"),console.log("    ")}catch(he){console.error("   :",he)}r()}catch(ae){console.error("Error saving event:",ae),U({submit:"   "})}finally{D(!1)}}},gr=(G,ae)=>{c(xe=>({...xe,[G]:ae})),L[G]&&U(xe=>({...xe,[G]:""}))},Us=G=>{const xe=`${o.start_date?o.start_date.split("T")[0]:new Date().toISOString().split("T")[0]}T${G}`;c(he=>({...he,start_date:xe})),B(!1)},cn=(G,ae)=>{if(ae.size>50*1024*1024){alert("     50MB");return}if(!["application/pdf","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(ae.type)){alert("   PDF, PowerPoint, Word  Excel");return}const he={id:Date.now().toString()+Math.random().toString(36).substr(2,9),file:ae,type:G,name:ae.name};x(me=>[...me,he])},pr=async G=>{const ae=d.find(xe=>xe.id===G);if(ae!=null&&ae.url){if(confirm(" ,     ?"))try{const xe=await XC(G);xe.success?x(he=>he.filter(me=>me.id!==G)):alert("  : "+xe.error)}catch(xe){console.error("  :",xe),alert("    ")}}else x(xe=>xe.filter(he=>he.id!==G))},Qs=G=>{const ae=G.lastIndexOf(".");return ae!==-1?G.substring(ae):""},us=G=>{const ae=G.lastIndexOf(".");return ae!==-1?G.substring(0,ae):G},Ns=async(G,ae)=>{const xe=d.find(ve=>ve.id===G);if(!xe)return;const he=Qs(xe.name),me=ae+he;x(ve=>ve.map(Ie=>Ie.id===G?{...Ie,name:me}:Ie));const ge=await qee(G,me);ge.success||console.error("   :",ge.error),f(null),p("")},Ln=G=>{const ae=d.find(xe=>xe.id===G);ae&&(f(G),p(us(ae.name)))},dn=()=>{f(null),p("")},K=G=>{y({isOpen:!0,file:G})},ie=G=>{g.file&&(cn(G,g.file),y({isOpen:!1,file:null}))},ee=()=>{y({isOpen:!1,file:null})},se=(G,ae)=>{x(xe=>xe.map(he=>he.id===G?{...he,type:ae}:he))};function le({selectedDate:G,onDateSelect:ae}){Aa.locale("ru");const[xe,he]=E.useState(Aa(G||new Date)),me=xe.startOf("month"),ge=xe.endOf("month"),ve=me.startOf("week"),Ie=ge.endOf("week"),ze=Array.from({length:101},(Ge,ht)=>Aa().year()-50+ht),qe=Array.from({length:12},(Ge,ht)=>Aa().month(ht).format("MMMM")),$e=()=>{const Ge=[];let ht=ve;for(;ht.isBefore(Ie)||ht.isSame(Ie,"day");)Ge.push(ht),ht=ht.add(1,"day");return Ge},We=()=>he(xe.subtract(1,"month")),Ke=()=>he(xe.add(1,"month"));return s.jsxs("div",{className:"w-[320px] bg-gray-50/80 backdrop-blur-md rounded-2xl shadow-lg p-4 font-sans text-sm border border-white/20",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("button",{type:"button",onClick:We,className:"w-9 h-9 flex items-center justify-center rounded-full bg-white shadow-md hover:bg-gray-100 transition-colors disabled:opacity-50",children:s.jsx(Sn,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("select",{value:xe.format("MMMM"),onChange:Ge=>he(xe.month(qe.indexOf(Ge.target.value))),className:"px-3 py-1.5 border border-gray-200 rounded-lg text-sm font-semibold bg-white shadow-sm appearance-none text-center",children:qe.map(Ge=>s.jsx("option",{value:Ge,children:Ge},Ge))}),s.jsx("select",{value:xe.year(),onChange:Ge=>he(xe.year(Number(Ge.target.value))),className:"px-3 py-1.5 border border-gray-200 rounded-lg text-sm font-semibold bg-white shadow-sm appearance-none",children:ze.map(Ge=>s.jsx("option",{value:Ge,children:Ge},Ge))})]}),s.jsx("button",{type:"button",onClick:Ke,className:"w-9 h-9 flex items-center justify-center rounded-full bg-white shadow-md hover:bg-gray-100 transition-colors disabled:opacity-50",children:s.jsx(Fa,{className:"h-5 w-5 text-gray-600"})})]}),s.jsx("div",{className:"grid grid-cols-7 text-gray-500 text-center mb-2",children:["","","","","","",""].map(Ge=>s.jsx("div",{children:Ge},Ge))}),s.jsx("div",{className:"grid grid-cols-7 gap-1 text-center",children:$e().map((Ge,ht)=>{const Oe=Ge.month()===xe.month(),Pt=Aa(G).isSame(Ge,"day"),Yt=Aa().isSame(Ge,"day");return s.jsx("div",{className:`w-10 h-10 flex items-center justify-center rounded-lg cursor-pointer transition-colors 
                                ${Oe?"":"text-gray-300"} 
                                ${Pt?"bg-sns-green text-white font-bold":""} 
                                ${!Pt&&Yt?"border-2 border-sns-green":""}
                                ${Pt?"":"hover:bg-sns-green-light"}
                            `,onClick:()=>{console.log("Calendar day clicked:",Ge.format("YYYY-MM-DD")),ae(Ge.format("YYYY-MM-DD"))},children:Ge.date()},ht)})})]})}function oe({selectedTime:G,onTimeSelect:ae}){const xe=Array.from({length:24},(We,Ke)=>Ke.toString().padStart(2,"0")),he=Array.from({length:60},(We,Ke)=>Ke.toString().padStart(2,"0")),me=G||"09:00",[ge,ve]=E.useState(me.split(":")[0]),[Ie,ze]=E.useState(me.split(":")[1]);E.useEffect(()=>{const We=document.getElementById(`hour-${ge}`),Ke=document.getElementById(`minute-${Ie}`);We&&We.scrollIntoView({behavior:"smooth",block:"center"}),Ke&&Ke.scrollIntoView({behavior:"smooth",block:"center"})},[ge,Ie]);const qe=We=>{ve(We),ae(`${We}:${Ie}`)},$e=We=>{ze(We),ae(`${ge}:${We}`)};return s.jsxs("div",{className:"w-[280px] bg-gray-50/80 backdrop-blur-md rounded-2xl shadow-lg p-4 font-sans text-sm border border-white/20",children:[s.jsx("div",{className:"text-center mb-4",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:" "})}),s.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:""}),s.jsx("div",{className:"h-32 overflow-y-auto border border-gray-200 rounded-lg bg-white",children:xe.map(We=>s.jsx("div",{id:`hour-${We}`,className:`px-4 py-2 cursor-pointer hover:bg-sns-green/10 transition-colors ${ge===We?"bg-sns-green text-white font-bold":""}`,onClick:()=>qe(We),children:We},We))})]}),s.jsx("div",{className:"text-2xl font-bold text-gray-400",children:":"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:""}),s.jsx("div",{className:"h-32 overflow-y-auto border border-gray-200 rounded-lg bg-white",children:he.map(We=>s.jsx("div",{id:`minute-${We}`,className:`px-4 py-2 cursor-pointer hover:bg-sns-green/10 transition-colors ${Ie===We?"bg-sns-green text-white font-bold":""}`,onClick:()=>$e(We),children:We},We))})]})]}),s.jsx("div",{className:"mt-4 text-center",children:s.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[ge,":",Ie]})})]})}return s.jsxs("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:[s.jsxs(Xa.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl max-w-4xl w-full max-h-[95vh] flex flex-col shadow-2xl pb-safe-bottom",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-[#06A478]/5 to-emerald-50",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-[#06A478] to-emerald-600 flex items-center justify-center text-white shadow-lg",children:s.jsx(di,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a?" ":" "}),s.jsx("p",{className:"text-sm text-gray-600",children:a?"   ":"    "})]})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 bg-white hover:bg-gray-50 rounded-xl w-10 h-10 flex items-center justify-center transition-colors duration-200 shadow-sm border border-gray-200",children:s.jsx(Qe,{size:20})})]}),s.jsxs("div",{className:"px-6 py-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:" "}),s.jsxs("span",{className:"text-sm font-medium text-[#06A478]",children:[Math.min((o.title?20:0)+(o.description?20:0)+(o.start_date?20:0)+(o.location||o.meeting_link?20:0)+(S.length>0?20:0),100),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx(Xa.div,{className:"h-full bg-gradient-to-r from-[#06A478] to-emerald-500 rounded-full",initial:{width:0},animate:{width:`${Math.min((o.title?20:0)+(o.description?20:0)+(o.start_date?20:0)+(o.location||o.meeting_link?20:0)+(S.length>0?20:0),100)}%`},transition:{duration:.8,ease:"easeOut"}})})]}),s.jsxs("div",{className:"flex-grow overflow-y-auto",children:[n==="exam"&&s.jsx("div",{className:"mx-6 mt-4 mb-2 p-4 bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 border border-blue-200 rounded-xl",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ys,{className:"w-5 h-5 text-blue-600 mr-3"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-base font-semibold text-blue-800",children:"  "}),s.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"      "})]})]})}),(l==null?void 0:l.role)==="trainer"&&P===1&&!n&&s.jsxs("div",{className:"mx-6 mt-4 mb-2 p-4 bg-gray-50 border border-gray-200 rounded-xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(di,{className:"w-5 h-5 text-sns-green mr-2"}),s.jsx("h3",{className:"text-base font-semibold text-gray-800",children:" "})]}),a&&_&&s.jsx("button",{type:"button",onClick:()=>{C(null),c({...o,title:a.title||"",description:a.description||"",event_type_id:a.event_type_id||""})},className:"text-xs text-gray-500 hover:text-gray-700 underline",children:""})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsx("button",{type:"button",onClick:()=>{C("offline");const G=v.find(ae=>ae.name==="offline_training"||ae.name_ru===" "||ae.name==="in_person_training"&&ae.is_online===!1);c({...o,title:"    ",description:"                .",event_type_id:(G==null?void 0:G.id)||"",status:"published",points:100})},className:`px-4 py-4 border-2 rounded-xl text-center transition-all duration-200 ${_==="offline"?"border-[#06A478] bg-[#06A478]/5 text-[#06A478] shadow-lg":"border-gray-300 bg-white hover:border-[#06A478]/50 hover:bg-[#06A478]/5 hover:shadow-md"}`,children:s.jsxs("div",{className:"flex items-center justify-center mb-2",children:[s.jsx("div",{className:"p-2 bg-[#06A478]/10 rounded-lg mr-3",children:s.jsx(nt,{className:"w-5 h-5 text-[#06A478]"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold text-base",children:" "}),s.jsx("div",{className:"text-xs text-gray-500",children:"    "})]})]})}),s.jsx("button",{type:"button",onClick:()=>{console.log(' "  " !'),C("exam");const G=v.find(ae=>ae.name==="exam_talent_reserve"||ae.name_ru==="  ");console.log("  :",G),c({...o,title:"  ",description:"     ",event_type_id:(G==null?void 0:G.id)||"",status:"draft",points:0}),fe({talentCategory:null,groupName:"",expertEmails:[],experts:[]}),console.log(" eventType: exam, event_type_id:",G==null?void 0:G.id)},className:`px-4 py-4 border-2 rounded-xl text-center transition-all duration-200 ${_==="exam"?"border-[#06A478] bg-[#06A478]/5 text-[#06A478] shadow-lg":"border-gray-300 bg-white hover:border-[#06A478]/50 hover:bg-[#06A478]/5 hover:shadow-md"}`,children:s.jsxs("div",{className:"flex items-center justify-center mb-2",children:[s.jsx("div",{className:"p-2 bg-[#06A478]/10 rounded-lg mr-3",children:s.jsx(ys,{className:"w-5 h-5 text-[#06A478]"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold text-base",children:"  "}),s.jsx("div",{className:"text-xs text-gray-500",children:"   "})]})]})})]}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-500 mb-3 flex items-center",children:[s.jsx(wr,{className:"w-4 h-4 mr-2"}),"   ( )"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[s.jsxs("div",{className:"px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-center opacity-40 cursor-not-allowed select-none relative",children:[s.jsx("div",{className:"font-medium text-sm text-gray-400",children:"-"}),s.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-200 text-gray-600 text-xs mt-1",children:" "})]}),s.jsxs("div",{className:"px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-center opacity-40 cursor-not-allowed select-none relative",children:[s.jsx("div",{className:"font-medium text-sm text-gray-400",children:""}),s.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-200 text-gray-600 text-xs mt-1",children:" "})]}),s.jsxs("div",{className:"px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-center opacity-40 cursor-not-allowed select-none relative",children:[s.jsx("div",{className:"font-medium text-sm text-gray-400",children:""}),s.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-200 text-gray-600 text-xs mt-1",children:" "})]}),s.jsxs("div",{className:"px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-center opacity-40 cursor-not-allowed select-none relative",children:[s.jsx("div",{className:"font-medium text-sm text-gray-400",children:""}),s.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-200 text-gray-600 text-xs mt-1",children:" "})]}),s.jsxs("div",{className:"px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-center opacity-40 cursor-not-allowed select-none relative",children:[s.jsx("div",{className:"font-medium text-sm text-gray-400",children:" "}),s.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-200 text-gray-600 text-xs mt-1",children:" "})]}),s.jsxs("div",{className:"px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-center opacity-40 cursor-not-allowed select-none relative",children:[s.jsx("div",{className:"font-medium text-sm text-gray-400",children:""}),s.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-200 text-gray-600 text-xs mt-1",children:" "})]})]}),s.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"       "})]})]}),s.jsxs("form",{onSubmit:P===1?ts:xs,className:"px-6 pt-2 pb-6 space-y-6",children:[P===1&&s.jsxs("div",{className:"space-y-4",children:[(l==null?void 0:l.role)!=="trainer"&&!n&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  *"}),s.jsxs("select",{value:o.event_type_id||"",onChange:G=>{const ae=G.target.value,xe=v.find(he=>he.id===ae);console.log("  :",xe),xe&&(xe.name==="exam_talent_reserve"||xe.name_ru==="  ")?(console.log("   ,  eventType: exam"),C("exam"),c({...o,event_type_id:ae,title:"  ",description:"     ",status:"draft",points:0}),fe({talentCategory:null,groupName:"",expertEmails:[],experts:[]})):(C(null),gr("event_type_id",ae))},className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-sns-500 focus:border-transparent ${L.event_type_id?"border-red-300":"border-gray-300"}`,children:[s.jsx("option",{value:"",children:"  "}),s.jsx("option",{value:((we=v.find(G=>G.name==="offline_training"||G.name_ru===" "))==null?void 0:we.id)||"",children:" "}),s.jsx("option",{value:((ke=v.find(G=>G.name==="exam_talent_reserve"||G.name_ru==="  "))==null?void 0:ke.id)||"",children:"  "}),s.jsx("option",{disabled:!0,children:""}),v.filter(G=>G.name!=="offline_training"&&G.name!=="exam_talent_reserve"&&G.name_ru!==" "&&G.name_ru!=="  ").map(G=>s.jsxs("option",{value:"",disabled:!0,style:{color:"#9CA3AF"},children:[G.name_ru||G.name,"   "]},G.id))]}),L.event_type_id&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.event_type_id})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx(Ms,{className:"w-4 h-4 text-[#06A478] mr-2"}),"  *"]}),s.jsxs("div",{className:"flex-1 min-h-[100px] flex flex-col",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("input",{type:"text",value:o.title,onChange:G=>gr("title",G.target.value),disabled:(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam",className:`w-full px-4 py-4 border-2 rounded-xl focus:ring-4 focus:ring-[#06A478]/20 focus:border-[#06A478] transition-all duration-200 flex-1 text-gray-800 font-medium ${L.title?"border-red-400 bg-red-50":"border-gray-200 hover:border-gray-300"} ${(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam"?"bg-gradient-to-r from-blue-50 to-indigo-50 text-gray-700 cursor-not-allowed border-blue-200":"bg-white shadow-sm hover:shadow-md"}`,placeholder:(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam"?"  ":"  ",required:!0}),(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam"?s.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:s.jsx(mn,{className:"w-5 h-5 text-[#06A478]"})}):null]}),L.title&&s.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[s.jsx(AlertOctagon,{className:"w-4 h-4 mr-1"}),L.title]})]})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx(Yn,{className:"w-4 h-4 text-[#06A478] mr-2"}),""]}),s.jsx("div",{className:"flex-1 min-h-[100px] flex flex-col",children:s.jsxs("div",{className:"relative group",children:[s.jsx("textarea",{value:o.description,onChange:G=>gr("description",G.target.value),disabled:(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam",rows:3,className:`w-full px-4 py-4 border-2 rounded-xl focus:ring-4 focus:ring-[#06A478]/20 focus:border-[#06A478] transition-all duration-200 flex-1 resize-none text-gray-700 leading-relaxed ${(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam"?"bg-gradient-to-r from-blue-50 to-indigo-50 text-gray-600 cursor-not-allowed border-blue-200":"bg-white shadow-sm hover:shadow-md border-gray-200 hover:border-gray-300"}`,placeholder:(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam"?"  ":"    "}),(l==null?void 0:l.role)==="trainer"&&_!==null||_==="exam"?s.jsx("div",{className:"absolute right-3 top-3",children:s.jsx(mn,{className:"w-5 h-5 text-[#06A478]"})}):null]})})]})]}),(l==null?void 0:l.role)==="trainer"&&_!==null&&_!=="exam"&&s.jsxs("div",{className:"flex items-center p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl",children:[s.jsx(mn,{className:"w-5 h-5 text-green-600 mr-3 flex-shrink-0"}),s.jsx("p",{className:"text-sm text-green-700 font-medium",children:"        "})]}),_==="exam"&&s.jsxs("div",{className:"flex items-center p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl",children:[s.jsx(Yf,{className:"w-5 h-5 text-blue-600 mr-3 flex-shrink-0"}),s.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"           "})]}),_==="exam"&&s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-200 rounded-2xl p-6 shadow-lg",children:[s.jsxs("div",{className:"flex items-center mb-6",children:[s.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl mr-4",children:s.jsx(ys,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:"   "}),s.jsx("p",{className:"text-sm text-gray-600",children:"      "})]})]}),console.log("CreateEventModal:   , eventType:",_),s.jsx(_O,{onCategorySelect:G=>fe(ae=>({...ae,talentCategory:G})),onGroupNameChange:G=>fe(ae=>({...ae,groupName:G})),onExpertEmailsChange:G=>fe(ae=>({...ae,expertEmails:G})),onExpertsChange:G=>fe(ae=>({...ae,experts:G})),onTitleUpdate:G=>c(ae=>({...ae,title:G})),onDescriptionUpdate:G=>c(ae=>({...ae,description:G})),selectedCategory:ce.talentCategory,groupName:ce.groupName,expertEmails:ce.expertEmails,experts:ce.experts}),L.talentCategory&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:L.talentCategory}),L.groupName&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:L.groupName}),L.expertEmails&&s.jsx("p",{className:"mt-2 text-sm text-red-600",children:L.expertEmails})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"    *"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-sns-green"}),s.jsx("button",{type:"button","data-calendar-button":!0,onClick:()=>M(!R),className:`w-full flex items-center pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent text-left transition-colors duration-200 ${L.start_date?"border-red-300":"border-gray-300"}`,children:s.jsx("span",{children:o.start_date?k1(new Date(o.start_date),"dd MMMM yyyy HH:mm",{locale:hN}):" "})})]}),R&&s.jsx("div",{"data-calendar-dropdown":!0,className:"absolute z-20 mt-2 shadow-xl rounded-2xl border border-gray-200 animate-fade-in",children:s.jsx(le,{selectedDate:o.start_date?o.start_date.split("T")[0]:"",onDateSelect:G=>{console.log("onDateSelect called with:",G);const ae=o.start_date?o.start_date.split("T")[1]:"09:00",xe=`${G}T${ae}`;console.log("fullDateTime:",xe),c(he=>({...he,start_date:xe})),M(!1)}})})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(wr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-sns-green"}),s.jsx("button",{type:"button","data-time-button":!0,onClick:()=>B(!O),className:`w-full flex items-center pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent text-left transition-colors duration-200 ${L.start_date?"border-red-300":"border-gray-300"}`,children:s.jsx("span",{children:o.start_date?o.start_date.split("T")[1]:"09:00"})})]}),O&&s.jsx("div",{"data-time-dropdown":!0,className:"absolute z-20 mt-2 shadow-xl rounded-2xl border border-gray-200 animate-fade-in",children:s.jsx(oe,{selectedTime:o.start_date?o.start_date.split("T")[1]:"09:00",onTimeSelect:Us})})]})]}),L.start_date&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.start_date})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-blue-500"}),s.jsx("input",{type:"text",value:o.location,onChange:G=>gr("location",G.target.value),disabled:(l==null?void 0:l.role)==="trainer"&&_==="online",className:`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-500 focus:border-transparent ${(l==null?void 0:l.role)==="trainer"&&_==="online"?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,placeholder:(l==null?void 0:l.role)==="trainer"&&_==="online"?"ZOOM ( )":"   "})]}),(l==null?void 0:l.role)==="trainer"&&_==="online"&&s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"     -"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx(sR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"url",value:o.meeting_link,onChange:G=>gr("meeting_link",G.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-500 focus:border-transparent",placeholder:"https://zoom.us/j/..."})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  "}),s.jsxs("div",{className:"relative",children:[s.jsx(Ms,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-yellow-500"}),s.jsx("input",{type:"number",value:o.points,disabled:!0,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed",placeholder:"100",min:"0"})]}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"      "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-sns-green/50 transition-colors",children:[s.jsx("input",{type:"file",accept:".pdf,.ppt,.pptx,.doc,.docx,.xls,.xlsx",onChange:G=>{var xe;const ae=(xe=G.target.files)==null?void 0:xe[0];ae&&K(ae)},className:"hidden",id:"file-upload",multiple:!0}),s.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center gap-2",children:[s.jsx(xo,{className:"h-8 w-8 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:" "}),s.jsx("p",{className:"text-xs text-gray-500",children:"PDF, PowerPoint, Word, Excel ( 50MB )"})]})]})]}),d.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),d.map(G=>{var ae;return s.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${G.type==="presentation"?"bg-blue-50 border-blue-200 hover:border-blue-300":"bg-orange-50 border-orange-200 hover:border-orange-300"} transition-colors`,children:[s.jsx("div",{className:`p-2 rounded-lg ${G.type==="presentation"?"bg-blue-100 text-blue-600":"bg-orange-100 text-orange-600"}`,children:s.jsx(Yn,{className:"h-4 w-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[u===G.id?s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("input",{type:"text",value:h,onChange:xe=>{p(xe.target.value)},onKeyDown:async xe=>{xe.key==="Enter"?await Ns(G.id,h):xe.key==="Escape"&&dn()},onBlur:async()=>await Ns(G.id,h),className:`text-sm font-medium bg-white border rounded px-2 py-1 focus:outline-none ${G.type==="presentation"?"border-blue-200 focus:ring-1 focus:ring-blue-300 focus:border-blue-300":"border-orange-200 focus:ring-1 focus:ring-orange-300 focus:border-orange-300"}`,autoFocus:!0}),s.jsx("span",{className:"text-sm text-gray-500",children:Qs(G.name)}),s.jsx("button",{type:"button",onClick:async()=>await Ns(G.id,h),className:`p-1 transition-colors duration-200 ${G.type==="presentation"?"text-blue-600 hover:text-blue-700":"text-orange-600 hover:text-orange-700"}`,children:s.jsx(mn,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:dn,className:"text-gray-500 hover:text-gray-700 p-1 transition-colors duration-200",children:s.jsx(Qe,{className:"h-4 w-4"})})]}):s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:G.name}),s.jsx("button",{type:"button",onClick:()=>Ln(G.id),className:`p-1 transition-colors duration-200 ${G.type==="presentation"?"text-blue-600 hover:text-blue-700":"text-orange-600 hover:text-orange-700"}`,children:s.jsx(sn,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${G.type==="presentation"?"bg-blue-100 text-blue-700 border border-blue-200":"bg-orange-100 text-orange-700 border border-orange-200"}`,children:G.type==="presentation"?"":" "}),s.jsx("button",{type:"button",onClick:()=>se(G.id,G.type==="presentation"?"workbook":"presentation"),className:"text-gray-400 hover:text-gray-600 p-1 transition-colors duration-200",title:"  ",children:s.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[G.size?(G.size/1024/1024).toFixed(2):(ae=G.file)!=null&&ae.size?(G.file.size/1024/1024).toFixed(2):"0"," MB"]})]}),s.jsx("button",{type:"button",onClick:()=>pr(G.id),className:"text-gray-400 hover:text-red-600 p-1 transition-colors duration-200",title:" ",children:s.jsx(Qe,{className:"h-4 w-4"})})]},G.id)})]})]}),Object.keys(L).length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-medium text-red-800 mb-2",children:" :"}),s.jsx("ul",{className:"text-sm text-red-600 space-y-1",children:Object.entries(L).map(([G,ae])=>s.jsxs("li",{children:[" ",ae]},G))})]}),s.jsxs("div",{className:"flex justify-end items-center pt-6 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 mr-3 font-medium",children:""}),s.jsxs("button",{type:"submit",onClick:G=>{console.log(' ": " '),console.log(" step:",P),console.log("formData:",o),console.log("eventType:",_),console.log("examData:",ce)},className:"px-6 py-3 bg-[#06A478] text-white rounded-xl hover:bg-[#05976b] transition-all duration-200 font-medium flex items-center gap-2 shadow-lg",children:[s.jsx("span",{children:": "}),s.jsx(io,{className:"w-4 h-4"})]})]})]}),P===2&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[" ",S.length>0&&s.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",S.length,")"]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{ref:_e,className:"relative",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",value:W,onChange:G=>k(G.target.value),placeholder:"  , Email  SAP ...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-500 focus:border-transparent"})]}),I&&q.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white shadow-lg rounded-lg border border-gray-200 max-h-60 overflow-y-auto",children:q.map(G=>s.jsx("div",{className:"p-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-0",onClick:()=>Ye(G),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:G.full_name}),s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[G.email&&s.jsx("span",{children:G.email}),G.sap_number&&s.jsxs("span",{children:["SAP: ",G.sap_number]})]})]}),s.jsx("button",{type:"button",className:"p-1 text-sns-600 hover:bg-sns-100 rounded-lg",onClick:ae=>{ae.stopPropagation(),Ye(G)},children:s.jsx(es,{size:16})})]})},G.id))}),I&&W&&q.length===0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white shadow-lg rounded-lg border border-gray-200 p-4 text-center",children:s.jsx("p",{className:"text-gray-600",children:"  "})})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Yn,{size:20,className:"text-green-600"}),s.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"  Excel"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:N0,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center space-x-1",children:[s.jsx(Bn,{size:14}),s.jsx("span",{children:" "})]}),s.jsxs("button",{type:"button",onClick:Nr,className:"text-sm text-green-600 hover:text-green-700 flex items-center space-x-1",children:[s.jsx(Bn,{size:14}),s.jsx("span",{children:" "})]}),s.jsxs("label",{className:"px-3 py-1.5 bg-sns-500 text-white rounded-lg hover:bg-sns-600 transition-colors cursor-pointer text-sm flex items-center space-x-1",children:[s.jsx(xo,{size:14}),s.jsx("span",{className:"whitespace-nowrap",children:" "}),s.jsx("input",{type:"file",ref:ne,onChange:He,accept:".xlsx,.xls",className:"hidden"})]})]})]}),s.jsxs("div",{className:"mt-3 space-y-2",children:[s.jsxs("div",{className:"text-xs text-gray-600",children:[s.jsx("p",{className:"font-medium mb-1",children:"  :"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[s.jsx("li",{children:"     "}),s.jsxs("li",{children:[" : ",s.jsx("strong",{children:""}),"  ",s.jsx("strong",{children:"Email"}),"  ",s.jsx("strong",{children:"SAP "})]}),s.jsx("li",{children:" : .xlsx, .xls"}),s.jsx("li",{children:"  : 10MB"}),s.jsx("li",{children:"     ( )"})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Yf,{size:16,className:"text-blue-500 mt-0.5"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("p",{className:"text-xs font-medium text-blue-800",children:" "}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"           ."})]})]})})]}),H.length>0&&s.jsxs("div",{className:"mt-3 bg-red-50 border border-red-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Qe,{size:16,className:"text-red-500 mr-2"}),s.jsx("h5",{className:"text-sm font-medium text-red-800",children:" "})]}),s.jsx("ul",{className:"mt-1 text-xs text-red-700 list-disc list-inside",children:H.map((G,ae)=>s.jsx("li",{children:G},ae))})]})]}),je&&ue.length>0&&s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:[" : ",ue.length," "]}),s.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),"  : ",ue.filter(G=>!G.error).length]}),s.jsxs("span",{className:"flex items-center",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mr-1"})," : ",ue.filter(G=>G.error).length]})]}),pe&&s.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:" SAP :"}),s.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:" SAP :"}),s.jsx("span",{className:"font-medium",children:pe.total})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-green-700",children:"   :"}),s.jsx("span",{className:"font-medium text-green-700",children:pe.existing.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-orange-700",children:"   :"}),s.jsx("span",{className:"font-medium text-orange-700",children:pe.new.length})]}),pe.existing.length>0&&s.jsxs("div",{className:"mt-2 p-2 bg-green-100 border border-green-200 rounded text-xs",children:[s.jsx("div",{className:"text-green-800 font-medium mb-1",children:" SAP:"}),s.jsxs("div",{className:"text-green-700",children:[pe.existing.slice(0,3).join(", "),pe.existing.length>3&&`   ${pe.existing.length-3}`]})]}),pe.new.length>0&&s.jsxs("div",{className:"mt-2 p-2 bg-orange-100 border border-orange-200 rounded text-xs",children:[s.jsx("div",{className:"text-orange-800 font-medium mb-1",children:" SAP ( ):"}),s.jsxs("div",{className:"text-orange-700",children:[pe.new.slice(0,3).join(", "),pe.new.length>3&&`   ${pe.new.length-3}`]})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>J(!1),className:"text-sm text-gray-500 hover:text-gray-700",children:""}),s.jsxs("button",{type:"button",onClick:Mo,className:"text-sm text-sns-600 hover:text-sns-700 flex items-center space-x-1",disabled:ue.every(G=>G.error),children:[s.jsx(mn,{size:14,className:"mr-1"}),s.jsxs("span",{children:[" (",ue.filter(G=>!G.error).length,")"]})]})]})]}),s.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:" / "}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),ue.some(G=>G.is_tp)&&s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),s.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ue.map((G,ae)=>{var xe,he;return s.jsxs("tr",{className:`${G.error?"bg-red-50":"hover:bg-gray-50"} ${G.is_tp?"border-l-4 border-l-blue-500":""}`,children:[s.jsxs("td",{className:"px-3 py-2 text-sm font-medium",children:[G.full_name,G.is_tp&&s.jsx("div",{className:"text-xs text-blue-600 font-medium",children:""}),pe&&G.sap_number&&s.jsx("div",{className:`text-xs font-medium mt-1 ${pe.existing.includes(G.sap_number)?"text-green-600":"text-orange-600"}`,children:pe.existing.includes(G.sap_number)?" ":" "})]}),s.jsx("td",{className:"px-3 py-2 text-sm",children:G.is_tp?s.jsxs(s.Fragment,{children:[G.sap_number&&s.jsxs("div",{className:"text-blue-600 font-medium",children:["SAP: ",G.sap_number]}),G.phone&&s.jsxs("div",{className:"text-gray-600 text-xs",children:[": ",G.phone]}),G.email&&s.jsx("div",{className:"text-gray-400 text-xs opacity-60",children:G.email}),G.work_experience_days>0&&s.jsxs("div",{className:"text-gray-500 text-xs",children:[": ",G.work_experience_days," ."]})]}):s.jsxs(s.Fragment,{children:[G.email&&s.jsx("div",{className:"text-blue-600",children:G.email}),G.sap_number&&s.jsxs("div",{className:"text-gray-600 text-xs",children:["SAP: ",G.sap_number]}),G.phone&&s.jsxs("div",{className:"text-gray-500 text-xs",children:[": ",G.phone]}),G.work_experience_days>0&&s.jsxs("div",{className:"text-gray-500 text-xs",children:[": ",G.work_experience_days," ."]})]})}),s.jsx("td",{className:"px-3 py-2 text-sm",children:((xe=G.position)==null?void 0:xe.name)||"-"}),s.jsx("td",{className:"px-3 py-2 text-sm",children:((he=G.territory)==null?void 0:he.name)||"-"}),ue.some(me=>me.is_tp)&&s.jsx("td",{className:"px-3 py-2 text-xs",children:G.approval_status?s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${G.approval_status.toLowerCase().includes("")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:G.approval_status}):"-"}),s.jsx("td",{className:"px-3 py-2 text-xs text-center",children:G.error?s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:""}),s.jsx("span",{className:"text-xs text-red-600 mt-1 max-w-32 text-center",children:G.error})]}):s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(mn,{size:12,className:"mr-1"}),""]})})]},ae)})})]})}),s.jsxs("div",{className:"mt-3 space-y-2",children:[s.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[s.jsx(Qe,{size:14,className:"mr-1 text-amber-500"}),"     .       ."]}),ue.filter(G=>G.error).length>0&&s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ys,{size:16,className:"text-amber-500 mt-0.5"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("p",{className:"text-xs font-medium text-amber-800",children:"  :"}),s.jsxs("ul",{className:"text-xs text-amber-700 mt-1 space-y-1",children:[s.jsx("li",{children:" ,     "}),s.jsx("li",{children:"    Email "}),s.jsx("li",{children:" ,    "}),s.jsx("li",{children:"   Email,  SAP    "})]})]})]})})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:[" (",S.length,")"]}),S.length>0&&s.jsx("button",{type:"button",onClick:()=>z([]),className:"text-xs text-red-600 hover:text-red-800",children:""})]}),S.length===0?s.jsxs("div",{className:"bg-gray-50 border border-dashed border-gray-300 rounded-lg p-6 text-center",children:[s.jsx(nt,{size:24,className:"mx-auto text-gray-400 mb-2"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"  .      Excel."})]}):s.jsx("div",{className:"border border-gray-200 rounded-lg max-h-60 overflow-y-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"SAP / Email"}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase hidden md:table-cell",children:""}),s.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map((G,ae)=>{var xe;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-2 text-sm",children:G.full_name}),s.jsxs("td",{className:"px-3 py-2 text-sm",children:[G.email&&s.jsx("div",{className:"text-blue-600",children:G.email}),G.sap_number&&s.jsxs("div",{className:"text-gray-600 text-xs",children:["SAP: ",G.sap_number]})]}),s.jsx("td",{className:"px-3 py-2 text-sm hidden md:table-cell",children:((xe=G.position)==null?void 0:xe.name)||"-"}),s.jsx("td",{className:"px-3 py-2 text-sm text-center",children:s.jsx("button",{type:"button",onClick:()=>Ue(ae),className:"text-red-500 hover:text-red-700",children:s.jsx(Qe,{size:16})})})]},ae)})})]})}),L.participants&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.participants})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-6 border-t border-gray-200",children:[s.jsxs("button",{type:"button",onClick:xa,className:"px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 font-medium flex items-center gap-2",children:[s.jsx(Sn,{className:"w-4 h-4"}),""]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 font-medium",children:""}),s.jsx("button",{type:"submit",disabled:j,className:"px-6 py-3 bg-[#06A478] text-white rounded-xl hover:bg-[#05976b] transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium shadow-lg",children:j?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{className:"w-4 h-4"}),s.jsx("span",{children:a?"":""})]})})]})]})]}),L.submit&&s.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:L.submit})})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50/50",children:s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:":"})," ",(l==null?void 0:l.full_name)||(i==null?void 0:i.email)]}),s.jsxs("p",{children:[s.jsx("strong",{children:" :"})," ",new Date().toLocaleDateString("ru")]}),a&&s.jsxs("p",{children:[s.jsx("strong",{children:"ID :"})," ",a.id]})]})})})]}),g.isOpen&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsx(Xa.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md mx-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"  "}),s.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:":"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(be=g.file)==null?void 0:be.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[(Ee=g.file)!=null&&Ee.size?(g.file.size/1024/1024).toFixed(2):"0"," MB"]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("button",{type:"button",onClick:()=>ie("presentation"),className:"w-full p-4 border-2 border-blue-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors text-left",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Yn,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:""}),s.jsx("p",{className:"text-sm text-gray-500",children:",   "})]})]})}),s.jsx("button",{type:"button",onClick:()=>ie("workbook"),className:"w-full p-4 border-2 border-orange-200 rounded-lg hover:border-orange-400 hover:bg-orange-50 transition-colors text-left",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:s.jsx(Yn,{className:"h-5 w-5 text-orange-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:" "}),s.jsx("p",{className:"text-sm text-gray-500",children:", ,   "})]})]})})]}),s.jsx("div",{className:"mt-6",children:s.jsx("button",{type:"button",onClick:ee,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-300",children:""})})]})})})]})}const gh="cached_events",Wee=5*60*1e3;function Gee(e,t){try{const r=localStorage.getItem(gh);if(!r)return null;const a=JSON.parse(r),n=Date.now()-a.timestamp>Wee,i=a.userId===e&&a.userRole===t;return n||!i?(localStorage.removeItem(gh),null):(console.log("    :",a.data.length),a.data)}catch(r){return console.error("   :",r),null}}function A5(e,t,r){try{const a={data:e,timestamp:Date.now(),userId:t,userRole:r};localStorage.setItem(gh,JSON.stringify(a)),console.log("    :",e.length)}catch(a){console.error("   :",a)}}function Yee(){try{localStorage.removeItem(gh),console.log("   ")}catch(e){console.error("   :",e)}}const k5={draft:{label:"",tone:"text-slate-600 bg-slate-100",ring:"ring-slate-200",Icon:Y_},published:{label:"",tone:"text-[#0E9F6E] bg-[#0E9F6E]/10",ring:"ring-[#0E9F6E]/20",Icon:Xn},active:{label:"",tone:"text-[#0E9F6E] bg-[#0E9F6E]/10",ring:"ring-[#0E9F6E]/20",Icon:()=>s.jsx("div",{className:"h-3.5 w-3.5 rounded-full bg-[#0E9F6E]"})},ongoing:{label:"",tone:"text-sky-600 bg-sky-50",ring:"ring-sky-200",Icon:Er},completed:{label:"",tone:"text-slate-600 bg-slate-100",ring:"ring-slate-200",Icon:Pa},cancelled:{label:"",tone:"text-rose-600 bg-rose-50",ring:"ring-rose-200",Icon:ds}},Xee={training:{label:" ",icon:Q_},webinar:{label:"",icon:di},workshop:{label:"-",icon:ub},exam:{label:"",icon:Pa},other:{label:"",icon:Vs}};function Kee({event:e,animationDelay:t=0}){var _,C,j,D,R,M;const{userProfile:r}=st(),a=r==null?void 0:r.role,n=a==="expert",i=a==="administrator",l=Array.isArray(e.expert_emails)?e.expert_emails:[],o=((_=e.event_type)==null?void 0:_.name)==="exam_talent_reserve",c=n&&l.includes((r==null?void 0:r.email)||""),d=o&&(i||c);if(n&&o&&!d)return null;const x=e.start_date||e.date_time||e.created_at||"",u=E.useMemo(()=>{const O=new Date(x);return Number.isNaN(O.getTime())?null:O},[x]),f=k5[e.status]||k5.draft,{label:h,tone:p,ring:g,Icon:y}=f,v=e.type?Xee[e.type]||{label:((C=e.event_type)==null?void 0:C.name_ru)||"",icon:Vs}:{label:((j=e.event_type)==null?void 0:j.name)==="exam_talent_reserve"?"":((D=e.event_type)==null?void 0:D.name_ru)||"",icon:((R=e.event_type)==null?void 0:R.name)==="exam_talent_reserve"?Pa:Vs},w=v.icon,m=({date:O})=>{if(!O)return s.jsxs("div",{className:"rounded-2xl border border-slate-200/50 bg-slate-50/80 px-4 py-3 text-center backdrop-blur-sm",children:[s.jsx("div",{className:"text-[11px] font-medium text-slate-500",children:""}),s.jsx("div",{className:"text-sm font-semibold text-slate-600",children:" "})]});const B=O.toLocaleDateString("ru-RU",{day:"2-digit"}),L=O.toLocaleDateString("ru-RU",{month:"long"}),U=new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit",timeZone:"Europe/Moscow"}).format(O),P=L.endsWith("")?`${L.slice(0,-1)}`:L;return s.jsxs("div",{className:"relative rounded-2xl border border-[#0E9F6E]/20 bg-gradient-to-br from-[#0E9F6E]/5 to-[#0E9F6E]/10 px-4 py-3 text-center shadow-sm backdrop-blur-sm",children:[s.jsx("div",{className:"flex items-end justify-center gap-1 leading-none",children:s.jsx("span",{className:"text-2xl font-bold text-slate-900 md:text-3xl",children:B})}),s.jsx("div",{className:"mt-1 text-[12px] font-medium text-slate-600",children:P}),s.jsx("div",{className:"mt-2 text-[11px] font-semibold text-slate-700",children:U})]})},b=E.useMemo(()=>{var B;return((B=e.event_type)==null?void 0:B.name)==="exam_talent_reserve"?"animate-gradient-shift text-white ring-0 shadow-lg":{training:"bg-sky-50 text-sky-700 ring-sky-200",webinar:"bg-indigo-50 text-indigo-700 ring-indigo-200",workshop:"bg-purple-50 text-purple-700 ring-purple-200",exam:"bg-rose-50 text-rose-700 ring-rose-200",other:"bg-amber-50 text-amber-700 ring-amber-200"}[e.type||"other"]||"bg-slate-50 text-slate-700 ring-slate-200"},[(M=e.event_type)==null?void 0:M.name,e.type]);return s.jsxs("article",{className:"dashboard-card-enter group relative flex h-full min-w-[260px] flex-col overflow-hidden rounded-[26px] border border-white/40 bg-white/70 p-5 shadow-[0_28px_60px_-36px_rgba(15,23,42,0.55)] backdrop-blur-2xl transition-all duration-300 hover:-translate-y-1 hover:shadow-[0_48px_80px_-42px_rgba(15,23,42,0.45)] sm:min-w-0",style:{animationDelay:`${t}ms`},children:[s.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(14,159,110,0.08),transparent_65%)] opacity-0 transition-opacity duration-500 group-hover:opacity-100"}),s.jsxs("div",{className:"relative flex h-full flex-col",children:[s.jsxs("header",{className:"mb-4 flex flex-shrink-0 items-start justify-between gap-3",children:[s.jsxs("div",{className:"min-w-0 flex flex-col gap-3",children:[s.jsx("div",{className:"flex flex-col gap-2",children:s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[!n&&s.jsxs("span",{className:`inline-flex items-center gap-1.5 text-[10px] font-semibold ring-1 shadow-sm ${h?"rounded-full px-2 py-1":"h-7 w-7 justify-center rounded-lg p-0"} ${p} ${g}`,children:[s.jsx(y,{className:`${h?"h-3.5 w-3.5":"h-4 w-4"} ${e.status==="ongoing"&&"animate-spin"}`}),h&&s.jsx("span",{children:h})]}),s.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-lg px-3 py-1 text-[11px] font-semibold ring-1 shadow-sm ${b}`,children:[s.jsx(w,{className:"h-3.5 w-3.5"}),v.label]})]})}),s.jsx("h3",{className:"text-lg font-semibold leading-tight text-slate-900",children:e.title}),e.location&&s.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-slate-500",children:[s.jsx(nr,{className:"h-3.5 w-3.5"}),s.jsx("span",{className:"truncate",children:e.location})]})]}),s.jsx("div",{className:"w-[108px] shrink-0",children:s.jsx(m,{date:u})})]}),s.jsx("div",{className:"flex-1",children:e.description&&s.jsx("div",{className:"mb-4 rounded-[20px] border border-slate-200/50 bg-slate-50/70 p-4 backdrop-blur-sm",children:s.jsx("p",{className:"line-clamp-3 text-sm leading-relaxed text-slate-600",children:e.description})})}),s.jsx("footer",{className:"mt-auto flex-shrink-0",children:s.jsx("button",{onClick:()=>{d?window.location.href=`/expert-exam/${e.id}`:window.location.href=`/event/${e.id}`},className:`group/button relative w-full justify-center overflow-hidden rounded-2xl py-3 px-4 font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#0EA47A]/30 ${d?"bg-gradient-to-r from-[#0EA47A] via-[#06A478] to-[#059669] text-white hover:from-[#059669] hover:to-[#047857]":"bg-slate-900 text-white hover:bg-slate-800"} shadow-sm hover:shadow-lg`,title:d?"  ":" ",children:s.jsxs("span",{className:"relative z-10 inline-flex items-center justify-center gap-2 text-sm font-medium",children:[d?"  ":" ",s.jsx(io,{className:"h-4 w-4 transition-transform duration-300 group-hover/button:translate-x-0.5"})]})})})]})]})}function Qee({title:e,value:t,icon:r,tone:a}){const i={emerald:{badge:"bg-emerald-500/10 text-emerald-600",border:"border-emerald-500/15"},slate:{badge:"bg-slate-500/10 text-slate-600",border:"border-slate-500/15"},blue:{badge:"bg-sky-500/10 text-sky-600",border:"border-sky-500/15"},amber:{badge:"bg-amber-500/10 text-amber-600",border:"border-amber-500/15"}}[a];return s.jsxs("div",{className:`relative flex min-w-[150px] flex-1 items-center gap-3 overflow-hidden rounded-[22px] border ${i.border} bg-white/80 px-4 py-3 shadow-[0_24px_44px_-32px_rgba(15,23,42,0.5)] backdrop-blur-xl transition-transform duration-300 hover:-translate-y-0.5`,children:[s.jsx("div",{className:`flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl ${i.badge}`,children:r}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:e}),s.jsx("div",{className:"text-lg font-semibold text-slate-900",children:t})]})]})}function D5({message:e=" "}){return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex flex-col items-center gap-3 text-slate-500",children:[s.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-[3px] border-emerald-500 border-t-transparent"}),s.jsx("p",{className:"text-sm font-medium",children:e})]})})}function Jee({greeting:e,fullName:t,motivationalMessage:r,roleLabel:a,gradientAngle:n}){const i=E.useMemo(()=>{const l=t.split(" ");return l.length>1?l[1]:l[0]},[t]);return s.jsxs("section",{className:"relative overflow-hidden rounded-[32px] border border-white/15 px-6 py-8 text-white shadow-[0_44px_120px_-70px_rgba(8,47,35,0.8)] sm:px-10 sm:py-10",style:{background:`linear-gradient(${n}deg, rgba(11,138,103,0.95) 0%, rgba(8,115,86,0.9) 45%, rgba(6,93,70,0.95) 100%)`},children:[s.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.22),transparent_55%)]"}),s.jsx("div",{className:"absolute -top-24 right-0 h-64 w-64 rounded-full bg-emerald-300/30 blur-3xl"}),s.jsx("div",{className:"absolute bottom-0 -left-20 h-72 w-72 rounded-full bg-emerald-500/20 blur-3xl"}),s.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(120deg,rgba(255,255,255,0.08)_0%,rgba(255,255,255,0)_40%)]"}),s.jsx("div",{className:"relative flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between",children:s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/20 bg-white/10 px-3 py-1 text-xs font-medium text-white/80",children:[s.jsx($R,{className:"h-3.5 w-3.5"}),s.jsx("span",{children:" "})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h1",{className:"text-[28px] font-semibold leading-tight sm:text-[34px]",children:[e,", ",i,"!"]}),s.jsx("p",{className:"max-w-xl text-sm leading-relaxed text-white/85 sm:text-base",children:r})]}),s.jsxs("div",{className:"inline-flex flex-wrap items-center gap-2 text-xs text-white/85 sm:text-sm",children:[s.jsx(co,{className:"h-4 w-4"}),s.jsxs("span",{className:"font-medium",children:["   ",a]})]})]})})]})}function Zee(){const{user:e,userProfile:t,loading:r}=st(),[a,n]=E.useState([]),[i,l]=E.useState(!0),[o,c]=E.useState(null),[d,x]=E.useState({activeEvents:0,totalParticipants:0,completedCourses:0,averageRating:0}),[u,f]=E.useState(120),h=()=>{const m=new Date().getHours();return m<12?" ":m<18?" ":" "},p=E.useMemo(()=>{if((t==null?void 0:t.role)==="expert"){const b=["      !","     .","    .","     .","    ."];return b[Math.floor(Math.random()*b.length)]}const m=["   ?"," !","     .","     .","   ."];return m[Math.floor(Math.random()*m.length)]},[t==null?void 0:t.role]);E.useEffect(()=>{const m=window.setInterval(()=>{f(b=>(b+1)%360)},120);return()=>{window.clearInterval(m)}},[]);const g=E.useCallback(async(m=!1)=>{if(!(!(e!=null&&e.id)||!(t!=null&&t.role)))try{if(!m){const R=Gee(e.id,t.role);if(R){n(R),l(!1),c(null);return}}l(!0),c(null);const b=(t==null?void 0:t.role)&&["administrator","moderator","trainer"].includes(t.role),_=(t==null?void 0:t.role)==="expert";let C;b?C=Z.from("events").select(`
              *,
              event_type:event_types(id, name, name_ru),
              event_participants(id)
            `).order("start_date",{ascending:!1}).limit(6):_?C=Z.from("events").select(`
              *,
              event_type:event_types(id, name, name_ru),
              event_participants(id)
            `).contains("expert_emails",[t==null?void 0:t.email]).order("start_date",{ascending:!1}).limit(6):C=Z.from("events").select(`
              *,
              event_type:event_types(id, name, name_ru),
              event_participants!inner(user_id)
            `).eq("status","active").gte("start_date",new Date().toISOString()).eq("event_participants.user_id",e.id).order("start_date",{ascending:!0}).limit(6);const{data:j,error:D}=await C;if(D){console.error("Error fetching events:",D),c(`  : ${D.message}`);return}if(j){const M=j.reduce((O,B)=>(O.find(L=>L.id===B.id)||O.push(B),O),[]).map(O=>({...O,participants_count:0}));n(M),A5(M,e.id,t.role)}else n([]),A5([],e.id,t.role)}catch(b){console.error("Error fetching events:",b),c(` : ${b instanceof Error?b.message:" "}`)}finally{l(!1)}},[e==null?void 0:e.id,t==null?void 0:t.role,t==null?void 0:t.email]),y=E.useCallback(async()=>{if(e!=null&&e.id)try{const m=(t==null?void 0:t.role)&&["administrator","moderator","trainer"].includes(t.role),b=(t==null?void 0:t.role)==="expert";if(m){const{data:_}=await Z.from("events").select("id, status").eq("status","active"),{data:C}=await Z.from("event_participants").select("id");x({activeEvents:(_==null?void 0:_.length)||0,totalParticipants:(C==null?void 0:C.length)||0,completedCourses:0,averageRating:4.8})}else if(b){const{data:_}=await Z.from("events").select("id, status").contains("expert_emails",[t==null?void 0:t.email]).eq("status","active");x({activeEvents:(_==null?void 0:_.length)||0,totalParticipants:0,completedCourses:0,averageRating:0})}else{const{data:_}=await Z.from("events").select("id, status").eq("status","active").eq("event_participants.user_id",e.id);x({activeEvents:(_==null?void 0:_.length)||0,totalParticipants:0,completedCourses:0,averageRating:0})}}catch(m){console.error("Error fetching stats:",m)}},[e==null?void 0:e.id,t==null?void 0:t.role,t==null?void 0:t.email]);E.useEffect(()=>{e&&t&&(Yee(),g(),y())},[e,t,g,y]);const v=t==null?void 0:t.role,w=E.useMemo(()=>{if(!v)return[];if(v==="expert")return[{title:" ",value:d.activeEvents,icon:s.jsx(Pa,{className:"h-5 w-5"}),tone:"emerald"}];const m=[{title:" ",value:d.activeEvents,icon:s.jsx(lo,{className:"h-5 w-5"}),tone:"emerald"},{title:" ",value:d.completedCourses,icon:s.jsx(er,{className:"h-5 w-5"}),tone:"amber"}];return["administrator","moderator","trainer"].includes(v)&&m.push({title:"",value:d.totalParticipants,icon:s.jsx(nt,{className:"h-5 w-5"}),tone:"blue"},{title:" ",value:d.averageRating>0?d.averageRating.toFixed(1):"",icon:s.jsx(sx,{className:"h-5 w-5"}),tone:"slate"}),m},[v,d]);return r?s.jsx("div",{className:"flex min-h-[60vh] items-center justify-center",children:s.jsx(D5,{message:"  "})}):s.jsxs("div",{className:"relative pb-28 pb-safe-bottom md:pb-12",children:[s.jsx("div",{className:"absolute inset-x-0 -top-24 h-56 bg-[radial-gradient(circle_at_top,_rgba(14,116,144,0.22),transparent_65%)] blur-3xl"}),s.jsx("div",{className:"absolute inset-x-0 top-40 h-72 bg-[radial-gradient(circle_at_center,_rgba(6,164,120,0.12),transparent_70%)] blur-2xl"}),s.jsxs("div",{className:"relative z-10 flex flex-col gap-8",children:[s.jsx(Jee,{greeting:h(),fullName:(t==null?void 0:t.full_name)||"",motivationalMessage:p,roleLabel:t!=null&&t.role?qc[t.role]:" ",gradientAngle:u}),s.jsxs("section",{className:"space-y-3",children:[s.jsx("h2",{className:"text-base font-semibold text-slate-900 sm:text-lg",children:" "}),s.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-4",children:w.map(m=>s.jsx(Qee,{title:m.title,value:m.value,icon:m.icon,tone:m.tone},m.title))})]}),s.jsxs("section",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:" "}),s.jsxs("button",{onClick:()=>g(!0),disabled:i,className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-white/80 px-3 py-1.5 text-xs font-medium text-slate-500 transition-colors duration-200 hover:border-slate-300 hover:text-slate-700 disabled:cursor-not-allowed disabled:opacity-60",children:[s.jsx(en,{className:`h-3.5 w-3.5 ${i?"animate-spin":""}`}),""]})]}),i?s.jsx(D5,{message:" "}):o?s.jsxs("div",{className:"flex flex-col items-center gap-4 rounded-3xl border border-red-100 bg-red-50/60 px-6 py-8 text-center text-red-600",children:[s.jsx(ds,{className:"h-10 w-10"}),s.jsx("p",{className:"text-sm font-semibold",children:o}),s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[s.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center gap-2 rounded-2xl bg-red-500 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-red-600",children:[s.jsx(en,{className:"h-4 w-4"})," "]}),s.jsx("button",{onClick:()=>g(),className:"inline-flex items-center gap-2 rounded-2xl border border-red-200 px-4 py-2 text-sm font-medium text-red-600 transition hover:bg-white/60",children:"  "})]})]}):a.length===0?s.jsxs("div",{className:"flex flex-col items-center gap-4 rounded-3xl border border-slate-200/70 bg-white/70 px-6 py-12 text-center",children:[s.jsx(lo,{size:48,className:"text-slate-300"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"     "}),s.jsx("p",{className:"text-xs text-slate-500",children:"  ,      ."})]}),s.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center gap-2 rounded-2xl border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 transition hover:bg-slate-50",children:[s.jsx(en,{className:"h-4 w-4"}),""]})]}):s.jsx("div",{className:"-mx-4 flex snap-x gap-4 overflow-x-auto px-4 scrollbar-hide sm:-mx-6 sm:px-6 md:grid md:grid-cols-2 md:gap-6 md:overflow-visible md:mx-0 md:px-0 xl:grid-cols-3",children:a.map((m,b)=>s.jsx(Kee,{event:m,animationDelay:b*70},m.id))})]}),s.jsx("div",{className:"mt-8 pb-4 text-center",children:s.jsx("p",{className:"text-[10px] text-gray-400 font-mono",children:"Build dd97d01 (2025-10-20 10:35)"})})]})]})}const ZC="sns-admin-data-cache",ete=5*60*1e3,tte=e=>{try{localStorage.setItem(ZC,JSON.stringify({timestamp:Date.now(),data:e})),console.log("Admin data cached")}catch(t){console.warn("Failed to cache admin data:",t)}},rte=()=>{try{const e=localStorage.getItem(ZC);if(!e)return null;const{timestamp:t,data:r}=JSON.parse(e);return Date.now()-t>ete?(console.log("Admin data cache expired"),null):(console.log("Using cached admin data"),r)}catch(e){return console.warn("Failed to get admin data from cache:",e),null}};function eA(){const[e,t]=E.useState([]),[r,a]=E.useState([]),[n,i]=E.useState([]),[l,o]=E.useState([]),[c,d]=E.useState(null),[x,u]=E.useState(!0),[f,h]=E.useState(null),[p,g]=E.useState(!1),y=async(v=!1)=>{v&&u(!0),h(null);const w=rte();w&&(t(w.users||[]),a(w.territories||[]),i(w.branches||[]),o(w.positions||[]),d(w.statistics||null),v||u(!1));try{const[m,b,_,C]=await Promise.all([Z.from("users").select("*").order("full_name"),Z.from("territories").select("*").order("name"),Z.from("branches").select("*").order("name"),Z.from("positions").select("*").order("name")]);if(m.error)throw m.error;if(b.error)throw b.error;if(_.error)throw _.error;if(C.error)throw C.error;const j=m.data||[],D=b.data||[],R=_.data||[],M=C.data||[];t(j),a(D),i(R),o(M);const O={total_users:j.length,active_users:j.filter(B=>B.is_active).length,inactive_users:j.filter(B=>!B.is_active).length,administrators:j.filter(B=>B.role==="administrator").length,trainers:j.filter(B=>B.role==="trainer").length};d(O),tte({users:j,territories:D,branches:R,positions:M,statistics:O}),g(!0)}catch(m){console.error("Error loading admin data:",m),w||h(m instanceof Error?m.message:"  ")}finally{u(!1)}};return E.useEffect(()=>(y(),()=>{}),[]),{users:e,territories:r,branches:n,positions:l,statistics:c,loading:x,error:f,loadData:()=>y(!0)}}function ste(){const{user:e}=st();Z_();const[t,r]=E.useState(!1),[a,n]=E.useState(""),[i,l]=E.useState(null),o=(x,u)=>{n(u),l(x),setTimeout(()=>{n(""),l(null)},3e3)},c=async()=>{if(e!=null&&e.id){r(!0);try{await Hee(e.id," ","      ","medium"),o("success","  !")}catch(x){console.error("  :",x),o("error","  ")}finally{r(!1)}}},d=async()=>{r(!0);try{await QC("trainer","  ","     ","system","medium"),o("success","   !")}catch(x){console.error("  :",x),o("error","  ")}finally{r(!1)}};return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Gl,{className:"w-6 h-6 text-blue-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "})]}),s.jsx("p",{className:"text-gray-600 mb-6",children:"    .       ."}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:c,disabled:t,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[s.jsx(rl,{size:16}),t?"...":"  "]}),s.jsxs("button",{onClick:d,disabled:t,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[s.jsx(Gl,{size:16}),t?"...":"  "]})]}),a&&s.jsxs("div",{className:`mt-4 p-3 rounded-lg flex items-center gap-2 ${i==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:[i==="success"?s.jsx(at,{size:16}):s.jsx(ar,{size:16}),s.jsx("span",{className:"text-sm",children:a})]})]})}function Oy(){const{session:e}=st(),[t,r]=E.useState(!1),[a,n]=E.useState(null),i=async(v,w)=>{if(!e)throw new Error(" ");const m=`https://oaockmesooydvausfoca.supabase.co/functions/v1/${v}`;try{const b=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify(w)});if(!b.ok)throw new Error(`Edge function not available (${b.status})`);return await b.json()}catch(b){return console.log(`Edge function ${v} not available, using fallback:`,b.message),await l(w.userId,w.updates)}},l=async(v,w)=>{console.log("Using fallback method to update user");try{if(w.email)try{const{data:_,error:C}=await Z.rpc("update_user_auth",{p_user_id:v,p_email:w.email,p_full_name:w.full_name,p_role:w.role,p_is_active:w.is_active});if(!C&&_)return console.log("User updated successfully via RPC"),{user:_,message:"User updated successfully"}}catch(_){console.warn("RPC function failed, falling back to direct database update:",_)}const{data:m,error:b}=await Z.from("users").update(w).eq("id",v).select().single();if(b)throw console.error("Database error updating user:",b),new Error(`Error updating user: ${b.message}`);return m}catch(m){throw console.error("Error in updateUserFallback:",m),m}},o=async v=>{console.log("Using fallback method to delete user");try{try{const{data:m,error:b}=await Z.rpc("delete_user_with_auth",{p_user_id:v});if(!b&&m)return console.log("User deleted successfully via RPC"),{success:!0,message:"User deleted successfully"}}catch(m){console.warn("RPC function failed, falling back to direct database delete:",m)}const{error:w}=await Z.from("users").delete().eq("id",v);if(w)throw console.error("Database error deleting user:",w),new Error(`Error deleting user: ${w.message}`);try{const{data:m,error:b}=await Z.rpc("rpc_delete_auth_user",{p_user_id:v})}catch(m){console.warn("Failed to delete from auth, but user was removed from database:",m)}return{success:!0,message:"User deleted successfully from database"}}catch(w){throw console.error("Error in deleteUserFallback:",w),w}},c=async(v,w,m,b,_)=>{try{const{error:C}=await Z.from("admin_logs").insert({admin_id:e==null?void 0:e.user.id,action:v,resource_type:w,resource_id:m,old_values:b,new_values:_,success:!0});C&&console.warn("Failed to log admin action:",C)}catch(C){console.warn("Failed to log admin action:",C)}},d=async v=>{var w;r(!0),n(null);try{const m=await xc(v.email||"",v.full_name.trim(),v.role,"123456");if(m.success)return await c("create_user","users",(w=m.user)==null?void 0:w.id,null,m.user),{user:m.user,message:m.message,tempPassword:m.password||"123456",auth_created:!m.configurationRequired,fallback_used:m.configurationRequired};throw new Error(m.message||"  ")}catch(m){const b=m instanceof Error?m.message:"  ";throw n(b),new Error(b)}finally{r(!1)}},x=async v=>{r(!0),n(null);try{const{data:w,error:m}=await Z.rpc("rpc_delete_user_complete",{p_user_id:v});if(m)throw m;if(w&&w.success)return!0;throw new Error((w==null?void 0:w.message)||"  ")}catch{try{return await o(v),!0}catch(m){const b=m instanceof Error?m.message:"  ";throw n(b),m}}finally{r(!1)}},u=async v=>{r(!0),n(null);try{const w=await jO(v);if(w.success)await c("delete_user","users",v,null,null);else throw new Error(w.message||"  ")}catch(w){const m=w instanceof Error?w.message:"  ";throw n(m),new Error(m)}finally{r(!1)}},f=async(v,w)=>{r(!0),n(null);try{const{data:m}=await Z.from("users").select("*").eq("id",v).single();try{const b=await i("update-user",{userId:v,updates:w});return await c("update_user","users",v,m,w),b.user||b}catch(b){console.error("Edge function error:",b.message);const _=await l(v,w);return await c("update_user_fallback","users",v,m,w),_}}catch(m){const b=m instanceof Error?m.message:"  ";throw n(b),new Error(b)}finally{r(!1)}};return{loading:t,error:a,createUser:d,updateUser:f,deleteUser:u,bulkUpdateUsers:async(v,w)=>{r(!0),n(null);try{console.log(`Updating ${v.length} users with:`,w);for(const m of v)await f(m,w);await c("bulk_update_users","users",null,null,{userIds:v,updates:w,count:v.length})}catch(m){const b=m instanceof Error?m.message:"  ";throw n(b),new Error(b)}finally{r(!1)}},importUsers:async v=>{r(!0),n(null);try{return console.log("Simulating import of file:",v.name),await new Promise(w=>setTimeout(w,1500)),await c("import_users","users",null,null,{fileName:v.name}),{success:2,errors:[],warnings:["Users have been imported successfully. Standard password: 123456"]}}catch(w){const m=w instanceof Error?w.message:"  ";throw n(m),new Error(m)}finally{r(!1)}},resetUserPassword:async(v,w)=>{r(!0),n(null);try{const m=await NO(v,w);if(m.success)return await c("reset_password","users",v,null,{email:w}),m.password||"123456";throw new Error(m.message||"  ")}catch(m){const b=m instanceof Error?m.message:"  ";throw n(b),new Error(b)}finally{r(!1)}},deleteUserComplete:x,toggleUserStatus:async(v,w)=>{try{await f(v,{is_active:!w})}catch(m){throw console.error("   :",m),m}},logAdminAction:c}}function ate({isOpen:e,onClose:t,onCreateUser:r,onSuccess:a,branches:n,positions:i,territories:l}){const[o,c]=E.useState({email:"",sap_number:"",full_name:"",position:"",phone:"",role:"employee",subdivision:"management_company",branch_subrole:null,branch_id:null,position_id:null,territory_id:null,department:"management_company"}),[d,x]=E.useState(!1),[u,f]=E.useState(""),h=async g=>{g.preventDefault(),x(!0),f("");try{if(!o.full_name)throw new Error("    ");if(!o.email&&!o.sap_number)throw new Error("  email  SAP ");const y={email:o.email.trim()||null,sap_number:o.sap_number.trim()||null,full_name:o.full_name.trim(),position:o.position||null,phone:o.phone||null,role:o.role,subdivision:o.subdivision,branch_subrole:o.subdivision==="branches"?o.branch_subrole:null,branch_id:o.subdivision==="branches"?o.branch_id:null,position_id:o.position_id||null,territory_id:o.territory_id||null,department:o.department};try{const v=await r(y);if(v&&v.user)a(v),v.fallback_used&&console.log("    :",v),!v.auth_created&&y.email&&alert(" ,       .     ."),v.tempPassword&&alert(`  !

Email: ${y.email}
 : ${v.tempPassword}`),t(),c({email:"",sap_number:"",full_name:"",position:"",phone:"",role:"employee",subdivision:"management_company",branch_subrole:null,branch_id:null,position_id:null,territory_id:null,department:"management_company"});else throw new Error(v.message||"    ")}catch(v){console.error("Error in user creation:",v),f(v.message||"    ")}}catch(y){console.error("Error creating user:",y),f(y.message||"    ")}finally{x(!1)}},p=g=>{const{name:y,value:v}=g.target;c(w=>({...w,[y]:v===""?null:v}))};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{className:"w-6 h-6"})})]}),u&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:s.jsx("p",{className:"text-red-800 text-sm",children:u})}),s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(qt,{className:"w-4 h-4 inline mr-1"}),"  *"]}),s.jsx("input",{type:"text",name:"full_name",value:o.full_name,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(Ao,{className:"w-4 h-4 inline mr-1"}),"Email"]}),s.jsx("input",{type:"email",name:"email",value:o.email,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SAP "}),s.jsx("input",{type:"text",name:"sap_number",value:o.sap_number,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(tl,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsx("input",{type:"tel",name:"phone",value:o.phone,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(tx,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsx("input",{type:"text",name:"position",value:o.position,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(nt,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsxs("select",{name:"role",value:o.role,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"employee",children:""}),s.jsx("option",{value:"supervisor",children:""}),s.jsx("option",{value:"trainer",children:""}),s.jsx("option",{value:"expert",children:""}),s.jsx("option",{value:"moderator",children:""}),s.jsx("option",{value:"administrator",children:""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(vd,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsxs("select",{name:"subdivision",value:o.subdivision,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"management_company",children:" "}),s.jsx("option",{value:"branches",children:""})]})]}),o.subdivision==="branches"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsxs("select",{name:"branch_subrole",value:o.branch_subrole||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:" "}),s.jsx("option",{value:"sales_representative",children:" "}),s.jsx("option",{value:"supervisor",children:""}),s.jsx("option",{value:"branch_director",children:" "})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(nr,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsxs("select",{name:"branch_id",value:o.branch_id||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:" "}),n.map(g=>s.jsx("option",{value:g.id,children:g.name},g.id))]})]})]}),i.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("select",{name:"position_id",value:o.position_id||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:" "}),i.map(g=>s.jsx("option",{value:g.id,children:g.name},g.id))]})]}),l.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("select",{name:"territory_id",value:o.territory_id||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:" "}),l.map(g=>s.jsx("option",{value:g.id,children:g.name},g.id))]})]})]}),s.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded-md",children:[s.jsxs("p",{children:[s.jsx("strong",{children:":"}),"      : ",s.jsx("code",{children:"123456"})]}),s.jsx("p",{className:"text-sm text-blue-600",children:"   email,  SAP  ( )."}),s.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[s.jsx("strong",{children:":"}),"   email    .    SAP    ."]})]}),s.jsxs("div",{className:"text-sm text-blue-600 mt-4 bg-blue-50 p-3 rounded-md",children:[s.jsx("p",{className:"font-medium",children:" :"}),s.jsx("p",{children:"      ,      ,   email."}),s.jsx("p",{className:"mt-1",children:"       ,    ."})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:""}),s.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:d?"...":" "})]})]})]})}):null}function nte({isOpen:e,onClose:t,onSuccess:r}){const[a,n]=E.useState({email:"",sap_number:"",fullName:"",role:"employee",position_id:"",phone:"",territory_id:"",work_experience_days:0}),[i,l]=E.useState(!1),[o,c]=E.useState(""),[d,x]=E.useState(null),[u,f]=E.useState([]),[h,p]=E.useState([]);E.useEffect(()=>{e&&(g(),y(),n({email:"",sap_number:"",fullName:"",role:"employee",position_id:"",phone:"",territory_id:"",work_experience_days:0}),c(""),x(null))},[e]);const g=async()=>{try{const{data:m,error:b}=await Z.from("territories").select("*").order("name");if(b)throw b;f(m||[])}catch(m){console.error("  :",m)}},y=async()=>{try{const{data:m,error:b}=await Z.from("positions").select("*").order("name");if(b)throw b;p(m||[])}catch(m){console.error("  :",m)}},v=async m=>{m.preventDefault(),l(!0),c(""),x(null);try{if(!a.fullName.trim())throw new Error("    ");if(!a.email.trim()&&!a.sap_number.trim())throw new Error("  Email  SAP ");let b=a.email.trim();!b&&a.sap_number.trim()&&(b=`${a.sap_number.trim()}@sns.ru`);const _=a.sap_number.trim()||null,C=await xc(b,a.fullName,a.role,"123456",{sap_number:_,phone:a.phone.trim(),territory_id:a.territory_id||null,position_id:a.position_id||null,work_experience_days:Number(a.work_experience_days)||0});C.success?(x({type:"success",text:`${C.message}

Email: ${C.email}
: ${C.password}`}),n({email:"",sap_number:"",fullName:"",role:"employee",position_id:"",phone:"",territory_id:"",work_experience_days:0}),r(),setTimeout(()=>{t()},3e3)):x({type:C.configurationRequired?"warning":"error",text:C.message})}catch(b){console.error("  :",b),c(b.message||"    "),x({type:"error",text:b.message||"    "})}finally{l(!1)}},w=m=>{const{name:b,value:_}=m.target;n(C=>({...C,[b]:_}))};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{className:"w-6 h-6"})})]}),d&&s.jsx("div",{className:`mb-4 p-3 rounded-md ${d.type==="success"?"bg-green-50 border border-green-200 text-green-800":d.type==="warning"?"bg-yellow-50 border border-yellow-200 text-yellow-800":"bg-red-50 border border-red-200 text-red-800"}`,children:s.jsx("p",{className:"text-sm whitespace-pre-line",children:d.text})}),s.jsxs("form",{onSubmit:v,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium text-gray-800 mb-3 border-b pb-2",children:" "}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(qt,{className:"w-4 h-4 inline mr-1"}),"  *"]}),s.jsx("input",{type:"text",name:"fullName",value:a.fullName,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(tl,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(Ao,{className:"w-4 h-4 inline mr-1"}),"Email"]}),s.jsx("input",{type:"email",name:"email",value:a.email,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(rx,{className:"w-4 h-4 inline mr-1"}),"SAP "]}),s.jsx("input",{type:"text",name:"sap_number",value:a.sap_number,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-medium text-gray-800 mb-3 border-b pb-2",children:"  "}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(nt,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsxs("select",{name:"role",value:a.role,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"employee",children:""}),s.jsx("option",{value:"supervisor",children:""}),s.jsx("option",{value:"trainer",children:""}),s.jsx("option",{value:"expert",children:""}),s.jsx("option",{value:"moderator",children:""}),s.jsx("option",{value:"administrator",children:""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(tx,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsxs("select",{name:"position_id",value:a.position_id,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:" "}),h.map(m=>s.jsx("option",{value:m.id,children:m.name},m.id))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(nr,{className:"w-4 h-4 inline mr-1"}),""]}),s.jsxs("select",{name:"territory_id",value:a.territory_id,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:" "}),u.map(m=>s.jsxs("option",{value:m.id,children:[m.name," ",m.region?`(${m.region})`:""]},m.id))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(zt,{className:"w-4 h-4 inline mr-1"}),"  ( )"]}),s.jsx("input",{type:"number",name:"work_experience_days",value:a.work_experience_days,onChange:w,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-md mt-6 mb-4",children:[s.jsx("h4",{className:"font-medium text-blue-700 text-sm mb-2",children:" "}),s.jsxs("ul",{className:"list-disc pl-5 text-sm text-blue-700",children:[s.jsx("li",{children:"   Email,  SAP "}),s.jsx("li",{children:"   SAP , email     sapnumber@sns.ru"}),s.jsxs("li",{children:["    : ",s.jsx("strong",{children:"123456"})]}),s.jsx("li",{children:"     (30  = 1 , 365  = 1 )"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:""}),s.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors flex items-center",children:i?s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),s.jsx("span",{children:"..."})]}):" "})]})]})]})}):null}function ite({isOpen:e,onClose:t,user:r,positions:a,territories:n,onSuccess:i}){const{updateUser:l,loading:o}=Oy(),[c,d]=E.useState({full_name:"",email:"",sap_number:"",role:"user",position_id:"",territory_id:"",phone:"",is_active:!0,department:"management_company",work_experience_days:0,hire_date:"",is_leaving:!1}),[x,u]=E.useState(c),[f,h]=E.useState({}),[p,g]=E.useState(""),[y,v]=E.useState(""),[w,m]=E.useState(!1),[b,_]=E.useState(!1),[C,j]=E.useState(!1);E.useEffect(()=>{if(r){const N=r.work_experience_days||0;let T="";if(N>0){const z=new Date;T=new Date(z.setDate(z.getDate()-N)).toISOString().split("T")[0]}const S={full_name:r.full_name||"",email:r.email||"",sap_number:r.sap_number||"",role:r.role||"user",position_id:r.position_id||"",territory_id:r.territory_id||"",phone:r.phone||"",is_active:r.is_active!==!1,department:r.department||"management_company",work_experience_days:N,hire_date:T,is_leaving:r.is_leaving||!1};d(S),u(S),h({}),g(""),v("")}},[r]);const D=JSON.stringify(c)!==JSON.stringify(x),R=n.filter(N=>N.name.toLowerCase().includes(p.toLowerCase())||N.region&&N.region.toLowerCase().includes(p.toLowerCase())),M=a.filter(N=>N.name.toLowerCase().includes(y.toLowerCase())||N.description&&N.description.toLowerCase().includes(y.toLowerCase()));if(E.useEffect(()=>{m(p.length>0&&R.length===0),_(y.length>0&&M.length===0)},[p,y,R.length,M.length]),!e||!r)return null;const O=()=>{const N={};return c.full_name.trim()||(N.full_name=" "),c.email.trim()?/\S+@\S+\.\S+/.test(c.email)||(N.email=" email"):N.email="Email ",(!c.sap_number||!c.sap_number.trim())&&(N.sap_number="SAP  "),h(N),Object.keys(N).length===0},B=Object.keys(f).length===0&&c.full_name&&c.email&&c.sap_number,L=async N=>{if(N.preventDefault(),!O())return;const T={full_name:c.full_name,email:c.email,sap_number:c.sap_number,role:c.role,position_id:c.position_id===""?null:c.position_id,territory_id:c.territory_id===""?null:c.territory_id,phone:c.phone||null,is_active:c.is_active,department:c.department,work_experience_days:Number(c.work_experience_days)||0,is_leaving:c.is_leaving};try{await l(r.id,T),i(),t()}catch(S){h({submit:S instanceof Error?S.message:"  "})}},U=N=>{if(!N)return;const T=k1(N,"yyyy-MM-dd"),S=new Date;N.setHours(0,0,0,0),S.setHours(0,0,0,0);const z=S.getTime()-N.getTime(),W=Math.ceil(z/(1e3*60*60*24));d({...c,hire_date:T,work_experience_days:W<0?0:W}),j(!1)};function P({selectedDate:N,onDateSelect:T}){Aa.locale("ru");const[S,z]=E.useState(Aa(N||new Date)),W=S.startOf("month"),k=S.endOf("month"),q=W.startOf("week"),A=k.endOf("week"),I=Array.from({length:101},(te,re)=>Aa().year()-50+re),V=Array.from({length:12},(te,re)=>Aa().month(re).format("MMMM")),H=()=>{const te=[];let re=q;for(;re.isBefore(A)||re.isSame(A,"day");)te.push(re),re=re.add(1,"day");return te},Y=()=>z(S.subtract(1,"month")),Q=()=>z(S.add(1,"month"));return s.jsxs("div",{className:"w-[320px] bg-gray-50/80 backdrop-blur-md rounded-2xl shadow-lg p-4 font-sans text-sm border border-white/20",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("button",{type:"button",onClick:Y,className:"w-9 h-9 flex items-center justify-center rounded-full bg-white shadow-md hover:bg-gray-100 transition-colors disabled:opacity-50",children:s.jsx(Sn,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("select",{value:S.format("MMMM"),onChange:te=>z(S.month(V.indexOf(te.target.value))),className:"px-3 py-1.5 border border-gray-200 rounded-lg text-sm font-semibold bg-white shadow-sm appearance-none text-center",children:V.map(te=>s.jsx("option",{value:te,children:te},te))}),s.jsx("select",{value:S.year(),onChange:te=>z(S.year(Number(te.target.value))),className:"px-3 py-1.5 border border-gray-200 rounded-lg text-sm font-semibold bg-white shadow-sm appearance-none",children:I.map(te=>s.jsx("option",{value:te,children:te},te))})]}),s.jsx("button",{type:"button",onClick:Q,className:"w-9 h-9 flex items-center justify-center rounded-full bg-white shadow-md hover:bg-gray-100 transition-colors disabled:opacity-50",children:s.jsx(Fa,{className:"h-5 w-5 text-gray-600"})})]}),s.jsx("div",{className:"grid grid-cols-7 text-gray-500 text-center mb-2",children:["","","","","","",""].map(te=>s.jsx("div",{children:te},te))}),s.jsx("div",{className:"grid grid-cols-7 gap-1 text-center",children:H().map((te,re)=>{const X=te.month()===S.month(),je=Aa(N).isSame(te,"day"),J=Aa().isSame(te,"day");return s.jsx("div",{className:`w-10 h-10 flex items-center justify-center rounded-lg cursor-pointer transition-colors 
                                ${X?"":"text-gray-300"} 
                                ${je?"bg-sns-green text-white font-bold":""} 
                                ${!je&&J?"border-2 border-sns-green":""}
                                ${je?"":"hover:bg-sns-green-light"}
                            `,onClick:()=>T(te.format("YYYY-MM-DD")),children:te.date()},re)})})]})}const F=N=>N?N.split(" ").map(S=>S[0]).join("").substring(0,2).toUpperCase():"...";return s.jsxs("div",{children:[s.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-50"}),s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4 animate-fade-in-up",children:s.jsxs("div",{className:"bg-gray-50 rounded-2xl max-w-4xl w-full max-h-[95vh] flex flex-col shadow-2xl border border-white/10",children:[s.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-sns-green flex items-center justify-center text-white font-bold text-2xl",children:r.avatar_url?s.jsx("img",{src:r.avatar_url,alt:r.full_name,className:"w-full h-full rounded-full object-cover"}):F(r.full_name)}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:c.full_name||""}),s.jsx("p",{className:"text-base text-gray-500",children:c.email})]})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-full w-10 h-10 flex items-center justify-center transition-colors duration-200",children:s.jsx(Qe,{size:24})})]}),s.jsxs("form",{onSubmit:L,className:"flex-grow overflow-y-auto p-8 space-y-8",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[s.jsx(qt,{className:"mr-3 h-6 w-6 text-sns-green"})," "]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 border-l-2 border-sns-green-light pl-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",placeholder:"  ",value:c.full_name,onChange:N=>d({...c,full_name:N.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent transition-colors duration-200 ${f.full_name?"border-red-300":"border-gray-300"}`})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"email",placeholder:"example@sns.ru",value:c.email,onChange:N=>d({...c,email:N.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent transition-colors duration-200 ${f.email?"border-red-300":"border-gray-300"}`})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["SAP  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",placeholder:"12345678",value:c.sap_number,onChange:N=>d({...c,sap_number:N.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent transition-colors duration-200 ${f.sap_number?"border-red-300":"border-gray-300"}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(tl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"tel",placeholder:"+7 (999) 999-99-99",value:c.phone||"",onChange:N=>d({...c,phone:N.target.value}),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent transition-colors duration-200"})]})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[s.jsx(Ka,{className:"mr-3 h-6 w-6 text-sns-green"}),""]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 border-l-2 border-sns-green-light pl-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsx("select",{value:c.role,onChange:N=>d({...c,role:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",children:Object.entries(qc).map(([N,T])=>s.jsx("option",{value:N,children:T},N))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("select",{value:c.position_id||"",onChange:N=>d({...c,position_id:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"",children:" "}),M.map(N=>s.jsx("option",{value:N.id,children:N.name},N.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("select",{value:c.territory_id||"",onChange:N=>d({...c,territory_id:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"",children:" "}),R.map(N=>s.jsxs("option",{value:N.id,children:[N.name," ",N.region?`(${N.region})`:""]},N.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{type:"button",onClick:()=>j(!C),className:"w-full flex justify-between items-center px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent text-left transition-colors duration-200",children:[s.jsx("span",{children:c.hire_date?k1(new Date(c.hire_date),"dd MMMM yyyy",{locale:hN}):" "}),s.jsx(zt,{className:"h-4 w-4 text-gray-400"})]}),C&&s.jsx("div",{className:"absolute z-20 mt-2 shadow-xl rounded-2xl border border-gray-200 animate-fade-in",children:s.jsx(P,{selectedDate:c.hire_date,onDateSelect:N=>{U(new Date(N))}})})]})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" ( )"}),s.jsx("input",{type:"number",readOnly:!0,value:c.work_experience_days,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[s.jsx(co,{className:"mr-3 h-6 w-6 text-sns-green"}),"  "]}),s.jsxs("div",{className:"space-y-4 border-l-2 border-sns-green-light pl-6",children:[s.jsxs("label",{className:"flex items-center justify-between bg-white p-4 rounded-lg border border-gray-200 cursor-pointer",children:[s.jsxs("span",{className:"flex-grow",children:[s.jsx("span",{className:"text-sm font-medium text-gray-800",children:" "}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"      ."})]}),s.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:c.is_active,onChange:N=>d({...c,is_active:N.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-sns-green transition-colors"}),s.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-full transition-transform"})]})]}),s.jsxs("label",{className:"flex items-center justify-between bg-white p-4 rounded-lg border border-gray-200 cursor-pointer",children:[s.jsxs("span",{className:"flex-grow",children:[s.jsx("span",{className:"text-sm font-medium text-gray-800",children:" "}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:",     ."})]}),s.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:c.is_leaving||!1,onChange:N=>d({...c,is_leaving:N.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-yellow-400 transition-colors"}),s.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-full transition-transform"})]})]})]})]}),f.submit&&s.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg flex items-start",children:[s.jsx(an,{className:"h-5 w-5 text-red-500 mt-0.5 mr-2 flex-shrink-0"}),s.jsx("p",{className:"text-sm text-red-600 flex-1",children:f.submit})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-200 bg-white/50",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"ID:"})," ",r==null?void 0:r.id]}),s.jsxs("p",{children:[s.jsx("strong",{children:":"})," ",r!=null&&r.created_at?new Date(r.created_at).toLocaleString("ru"):""]}),s.jsxs("p",{children:[s.jsx("strong",{children:" :"})," ",r!=null&&r.last_sign_in_at?new Date(r.last_sign_in_at).toLocaleString("ru"):""]})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx(Xa.button,{whileTap:{scale:.95},type:"button",onClick:t,className:"px-5 py-2.5 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors duration-200",children:""}),s.jsx(Xa.button,{whileTap:{scale:.95},type:"submit",onClick:L,disabled:!B||!D,className:"px-5 py-2.5 text-sm font-semibold text-white bg-sns-green rounded-lg hover:bg-sns-green-dark transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:o?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(mn,{className:"h-5 w-5 mr-2"}),""]})})]})]})})]})})]})}function lte({isOpen:e,onClose:t,territories:r,onUpdate:a}){const[n,i]=E.useState({name:"",region:""}),[l,o]=E.useState(null),[c,d]=E.useState(!1),[x,u]=E.useState(null),[f,h]=E.useState("");if(E.useEffect(()=>{e||(i({name:"",region:""}),o(null),u(null),h(""))},[e]),!e)return null;const p=r.filter(b=>b.name.toLowerCase().includes(f.toLowerCase())||b.region&&b.region.toLowerCase().includes(f.toLowerCase())),g=async()=>{if(n.name.trim()){d(!0),u(null);try{const{data:b,error:_}=await Z.from("territories").insert({name:n.name.trim(),region:n.region.trim()||null}).select();if(_)throw _;i({name:"",region:""}),a()}catch(b){console.error("Error adding branch:",b),u(b.message||"   ")}finally{d(!1)}}},y=b=>{o({id:b.id,name:b.name,region:b.region||""})},v=()=>{o(null)},w=async()=>{if(!(!l||!l.name.trim())){d(!0),u(null);try{const{error:b}=await Z.from("territories").update({name:l.name.trim(),region:l.region.trim()||null}).eq("id",l.id);if(b)throw b;o(null),a()}catch(b){console.error("Error updating branch:",b),u(b.message||"   ")}finally{d(!1)}}},m=async b=>{if(confirm(" ,     ?")){d(!0),u(null);try{const{data:_,error:C}=await Z.from("users").select("id").eq("territory_id",b);if(C)throw C;if(_&&_.length>0)throw new Error(`  ,   ${_.length} .      .`);const{error:j}=await Z.from("territories").delete().eq("id",b);if(j)throw j;a()}catch(_){console.error("Error deleting branch:",_),u(_.message||"   ")}finally{d(!1)}}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:20})})]})}),x&&s.jsx("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:x})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"flex items-center text-lg font-medium text-gray-900 mb-4",children:[s.jsx(nr,{className:"mr-2 text-sns-green",size:18})," "]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx("input",{type:"text",placeholder:" ",value:n.name,onChange:b=>i({...n,name:b.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"}),s.jsx("input",{type:"text",placeholder:"",value:n.region,onChange:b=>i({...n,region:b.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"}),s.jsx("button",{onClick:g,disabled:c||!n.name.trim(),className:"bg-sns-green text-white px-4 py-2 rounded-lg hover:bg-sns-green-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(es,{size:16}),s.jsx("span",{children:""})]})})]})]}),r.length>5&&s.jsxs("div",{className:"relative",children:[s.jsx(Ia,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:" ...",value:f,onChange:b=>h(b.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:[" ",s.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:[p.length,"  ",r.length]})]}),s.jsxs("div",{className:"space-y-2",children:[p.map(b=>s.jsx("div",{className:"border border-gray-200 rounded-lg hover:border-sns-green hover:bg-gray-50",children:l&&l.id===b.id?s.jsxs("div",{className:"p-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[s.jsx("input",{type:"text",placeholder:" ",value:l.name,onChange:_=>o({...l,name:_.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"}),s.jsx("input",{type:"text",placeholder:"",value:l.region,onChange:_=>o({...l,region:_.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsxs("button",{onClick:v,className:"px-3 py-1 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors flex items-center space-x-1",children:[s.jsx(ds,{size:14}),s.jsx("span",{children:""})]}),s.jsx("button",{onClick:w,disabled:c||!l.name.trim(),className:"px-3 py-1 bg-sns-green text-white rounded-lg hover:bg-sns-green-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-1",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin mr-1"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{size:14}),s.jsx("span",{children:""})]})})]})]}):s.jsxs("div",{className:"flex items-center justify-between p-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(nr,{className:"h-4 w-4 mr-2 text-sns-green flex-shrink-0"}),s.jsx("p",{className:"font-medium text-gray-900",children:b.name})]}),b.region&&s.jsx("p",{className:"text-sm text-gray-500 mt-1 ml-6",children:b.region})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>y(b),className:"text-gray-400 hover:text-sns-green transition-colors p-1 rounded hover:bg-gray-100",title:"",children:s.jsx(sn,{size:16})}),s.jsx("button",{onClick:()=>m(b.id),disabled:c,className:"text-gray-400 hover:text-red-600 transition-colors p-1 rounded hover:bg-gray-100",title:"",children:s.jsx(Zr,{size:16})})]})]})},b.id)),p.length===0&&s.jsx("div",{className:"text-center py-8 text-gray-500",children:f?"    ":"  "})]})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-200",children:s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center",children:[s.jsx(Qe,{size:16,className:"mr-2"}),""]})})})]})})}function ote({isOpen:e,onClose:t,positions:r,onUpdate:a}){const[n,i]=E.useState({name:"",description:""}),[l,o]=E.useState(null),[c,d]=E.useState(!1),[x,u]=E.useState(null),[f,h]=E.useState("");if(E.useEffect(()=>{e||(i({name:"",description:""}),o(null),u(null),h(""))},[e]),!e)return null;const p=r.filter(b=>b.name.toLowerCase().includes(f.toLowerCase())||b.description&&b.description.toLowerCase().includes(f.toLowerCase())),g=async()=>{if(n.name.trim()){d(!0),u(null);try{const{data:b,error:_}=await Z.from("positions").insert({name:n.name.trim(),description:n.description.trim()||null}).select();if(_)throw _;i({name:"",description:""}),a()}catch(b){console.error("Error adding position:",b),u(b.message||"   ")}finally{d(!1)}}},y=b=>{o({id:b.id,name:b.name,description:b.description||""})},v=()=>{o(null)},w=async()=>{if(!(!l||!l.name.trim())){d(!0),u(null);try{const{error:b}=await Z.from("positions").update({name:l.name.trim(),description:l.description.trim()||null}).eq("id",l.id);if(b)throw b;o(null),a()}catch(b){console.error("Error updating position:",b),u(b.message||"   ")}finally{d(!1)}}},m=async b=>{if(confirm(" ,     ?")){d(!0),u(null);try{const{data:_,error:C}=await Z.from("users").select("id").eq("position_id",b);if(C)throw C;if(_&&_.length>0)throw new Error(`  ,   ${_.length} .     .`);const{error:j}=await Z.from("positions").delete().eq("id",b);if(j)throw j;a()}catch(_){console.error("Error deleting position:",_),u(_.message||"   ")}finally{d(!1)}}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:20})})]})}),x&&s.jsx("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:x})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:" "}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx("input",{type:"text",placeholder:" ",value:n.name,onChange:b=>i({...n,name:b.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"}),s.jsx("input",{type:"text",placeholder:" ()",value:n.description,onChange:b=>i({...n,description:b.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"}),s.jsx("button",{onClick:g,disabled:c||!n.name.trim(),className:"bg-sns-green text-white px-4 py-2 rounded-lg hover:bg-sns-green-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(es,{size:16}),s.jsx("span",{children:""})]})})]})]}),r.length>5&&s.jsx("div",{className:"mb-4",children:s.jsx("input",{type:"text",placeholder:" ...",value:f,onChange:b=>h(b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["  (",p.length,")"]}),s.jsxs("div",{className:"space-y-2",children:[p.map(b=>s.jsx("div",{className:"border border-gray-200 rounded-lg hover:border-sns-green hover:bg-gray-50",children:l&&l.id===b.id?s.jsxs("div",{className:"p-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[s.jsx("input",{type:"text",placeholder:" ",value:l.name,onChange:_=>o({...l,name:_.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"}),s.jsx("input",{type:"text",placeholder:" ()",value:l.description,onChange:_=>o({...l,description:_.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsxs("button",{onClick:v,className:"px-3 py-1 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors flex items-center space-x-1",children:[s.jsx(ds,{size:14}),s.jsx("span",{children:""})]}),s.jsx("button",{onClick:w,disabled:c||!l.name.trim(),className:"px-3 py-1 bg-sns-green text-white rounded-lg hover:bg-sns-green-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-1",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin mr-1"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{size:14}),s.jsx("span",{children:""})]})})]})]}):s.jsxs("div",{className:"flex items-center justify-between p-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:b.name}),b.description&&s.jsx("p",{className:"text-sm text-gray-600",children:b.description})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>y(b),className:"text-gray-400 hover:text-sns-green transition-colors p-1 rounded hover:bg-gray-100",title:"",children:s.jsx(sn,{size:16})}),s.jsx("button",{onClick:()=>m(b.id),disabled:c,className:"text-gray-400 hover:text-red-600 transition-colors p-1 rounded hover:bg-gray-100",title:"",children:s.jsx(Zr,{size:16})})]})]})},b.id)),p.length===0&&s.jsx("div",{className:"text-center py-8 text-gray-500",children:f?"    ":"  "})]})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-200",children:s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""})})})]})})}function cte({isOpen:e,onClose:t}){const[r,a]=E.useState({emailNotifications:!0,autoBackup:!0,maintenanceMode:!1,maxFileSize:10,sessionTimeout:60}),[n,i]=E.useState(!1);if(!e)return null;const l=async()=>{i(!0);try{await new Promise(o=>setTimeout(o,1e3)),t()}catch(o){console.error("Error saving settings:",o)}finally{i(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:20})})]})}),s.jsx("div",{className:"p-6 space-y-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Email "}),s.jsx("p",{className:"text-sm text-gray-500",children:"   email"})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:r.emailNotifications,onChange:o=>a({...r,emailNotifications:o.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-sns-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-sns-600"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"  "}),s.jsx("p",{className:"text-sm text-gray-500",children:"   "})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:r.autoBackup,onChange:o=>a({...r,autoBackup:o.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-sns-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-sns-600"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:" "}),s.jsx("p",{className:"text-sm text-gray-500",children:"    "})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:r.maintenanceMode,onChange:o=>a({...r,maintenanceMode:o.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"   ()"}),s.jsx("input",{type:"number",value:r.maxFileSize,onChange:o=>a({...r,maxFileSize:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",min:"1",max:"100"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"  ()"}),s.jsx("input",{type:"number",value:r.sessionTimeout,onChange:o=>a({...r,sessionTimeout:parseInt(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",min:"15",max:"480"})]})]})}),s.jsx("div",{className:"p-6 border-t border-gray-200",children:s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""}),s.jsxs("button",{onClick:l,disabled:n,className:"px-4 py-2 bg-sns-green text-white rounded-lg hover:bg-sns-green-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[s.jsx(Ps,{size:16}),s.jsx("span",{children:n?"...":""})]})]})})]})})}function dte({isOpen:e,onClose:t,onImport:r,onSuccess:a}){const[n,i]=E.useState(null),[l,o]=E.useState(!1),[c,d]=E.useState(null),[x,u]=E.useState([]),[f,h]=E.useState(!1),[p,g]=E.useState([]);if(!e)return null;const y=async j=>{var B;const D=(B=j.target.files)==null?void 0:B[0];if(!D)return;const R=10*1024*1024;if(D.size>R){g([`  .  : 10MB.  : ${(D.size/1024/1024).toFixed(1)}MB`]);return}const M=[".xlsx",".xls",".csv"],O=D.name.toLowerCase().substring(D.name.lastIndexOf("."));if(!M.includes(O)){g(["  .  .xlsx, .xls  .csv"]);return}i(D),d(null),g([]);try{const L=await v(D);u(L),h(!0)}catch(L){g([L instanceof Error?L.message:"   "])}},v=j=>new Promise((D,R)=>{const M=new FileReader;M.onload=async O=>{var B;try{const L=new Uint8Array((B=O.target)==null?void 0:B.result),U=lh(L,{type:"array"}),P=U.Sheets[U.SheetNames[0]];let F=0,N=[];for(let W=0;W<15;W++){const k=qr.sheet_to_json(P,{range:W,header:1});if(k.length>0){const q=k[0];if(q&&q.some(A=>typeof A=="string"&&(A.toLowerCase().includes("")||A.toLowerCase().includes("")||A.toLowerCase().includes("full name")||A.toLowerCase().includes("")||A.toLowerCase().includes("email")))){F=W,N=qr.sheet_to_json(P,{range:W+1});break}}}if(N.length===0&&(N=qr.sheet_to_json(P,{range:12})),N.length===0)throw new Error("   . ,    .");const T=N[0],S=w(T),z=N.map(W=>{const k=m(W,S.fullName)||"",q=m(W,S.sapNumber)||"",A=m(W,S.position)||"",I=m(W,S.territory)||"",V=m(W,S.experience)||0,H=m(W,S.phone)||"",Y=m(W,S.email)||"";let Q=null;return k.trim()?!Y.trim()&&!q.trim()?Q="   Email,  SAP ":Y&&!b(Y)&&(Q="  Email"):Q=" ",{full_name:k.trim(),sap_number:q.trim()||null,position:{name:A.trim()},territory:{name:I.trim()},work_experience_days:parseInt(V.toString())||0,phone:H.trim(),email:Y.trim()||null,error:Q,status:Q?"error":"new"}});D(z)}catch{R(new Error("   . ,    ."))}},M.onerror=()=>{R(new Error("  ."))},M.readAsArrayBuffer(j)}),w=j=>{const D=Object.keys(j),R={};return D.forEach(M=>{const O=j[M];if(typeof O=="string"){const B=O.toLowerCase();B.includes("")||B.includes("")||B.includes("full name")||B.includes("")?R.fullName=M:B.includes("sap")||B.includes("")||B.includes("")?R.sapNumber=M:B.includes("")||B.includes("position")||B.includes("")?R.position=M:B.includes("")||B.includes("territory")||B.includes("")?R.territory=M:B.includes("")||B.includes("experience")||B.includes("")?R.experience=M:B.includes("")||B.includes("phone")||B.includes("")?R.phone=M:(B.includes("email")||B.includes("")||B.includes("e-mail"))&&(R.email=M)}}),R.fullName||(R.fullName="__EMPTY_1"),R.sapNumber||(R.sapNumber="__EMPTY_2"),R.position||(R.position="__EMPTY_3"),R.territory||(R.territory="__EMPTY_4"),R.experience||(R.experience="__EMPTY_5"),R.phone||(R.phone="__EMPTY_7"),R.email||(R.email="__EMPTY_8"),R},m=(j,D)=>j[D],b=j=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(j),_=async()=>{if(n){o(!0);try{const j=await r(n);d(j),j.success>0&&setTimeout(()=>{a()},2e3)}catch(j){console.error("Import error:",j),d({success:0,errors:["   "]})}finally{o(!1)}}},C=()=>{const j=qr.book_new(),D=[["","SAP ","","","  ()","","","Email"],["  ","12345","","","365","","+7900123456","ivanov@example.com"],["  ","67890","","-","180","","+7900987654","petrov@example.com"],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""]],R=qr.aoa_to_sheet(D);R["!cols"]=[{width:25},{width:12},{width:20},{width:20},{width:18},{width:5},{width:15},{width:25}],qr.book_append_sheet(j,R,"");const M=oh(j,{bookType:"xlsx",type:"array"}),O=new Blob([M],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),B=URL.createObjectURL(O),L=document.createElement("a");L.href=B,L.download="__.xlsx",document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(B)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:20})})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[!c&&!f&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:C,className:"inline-flex items-center space-x-2 text-sns-green hover:text-sns-green-dark transition-colors",children:[s.jsx(Bn,{size:16}),s.jsx("span",{children:" "})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"     "})]}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[s.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:y,className:"hidden",id:"file-upload"}),s.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[s.jsx(Et,{size:48,className:"mx-auto text-gray-400 mb-4"}),s.jsx("p",{className:"text-sm text-gray-600",children:"      "}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:" : CSV, Excel"})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Yf,{size:16,className:"text-blue-500 mt-0.5"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("p",{className:"text-sm font-medium text-blue-800",children:" "}),s.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"           ."})]})]})}),p.length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Qe,{size:16,className:"text-red-500 mr-2"}),s.jsx("h5",{className:"text-sm font-medium text-red-800",children:" "})]}),s.jsx("ul",{className:"mt-1 text-sm text-red-700 list-disc list-inside",children:p.map((j,D)=>s.jsx("li",{children:j},D))})]})]}),f&&x.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[" : ",x.length," "]}),s.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),"  : ",x.filter(j=>!j.error).length]}),s.jsxs("span",{className:"flex items-center",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mr-1"})," : ",x.filter(j=>j.error).length]})]})]}),s.jsx("button",{onClick:()=>h(!1),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"SAP / Email"}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),s.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map((j,D)=>{var R,M;return s.jsxs("tr",{className:j.error?"bg-red-50":"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-2 text-sm font-medium",children:j.full_name}),s.jsxs("td",{className:"px-3 py-2 text-sm",children:[j.email&&s.jsx("div",{className:"text-blue-600",children:j.email}),j.sap_number&&s.jsxs("div",{className:"text-gray-600 text-xs",children:["SAP: ",j.sap_number]}),j.phone&&s.jsxs("div",{className:"text-gray-500 text-xs",children:[": ",j.phone]})]}),s.jsx("td",{className:"px-3 py-2 text-sm",children:((R=j.position)==null?void 0:R.name)||"-"}),s.jsx("td",{className:"px-3 py-2 text-sm",children:((M=j.territory)==null?void 0:M.name)||"-"}),s.jsx("td",{className:"px-3 py-2 text-xs text-center",children:j.error?s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:""}),s.jsx("span",{className:"text-xs text-red-600 mt-1 max-w-32 text-center",children:j.error})]}):s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(mn,{size:12,className:"mr-1"}),""]})})]},D)})})]})}),x.filter(j=>j.error).length>0&&s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ys,{size:16,className:"text-amber-500 mt-0.5"})}),s.jsxs("div",{className:"ml-2",children:[s.jsx("p",{className:"text-sm font-medium text-amber-800",children:"  :"}),s.jsxs("ul",{className:"text-sm text-amber-700 mt-1 space-y-1",children:[s.jsx("li",{children:" ,     "}),s.jsx("li",{children:"    Email "}),s.jsx("li",{children:" ,    "}),s.jsx("li",{children:"   Email,  SAP    "})]})]})]})})]}),c&&s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:`p-4 rounded-lg ${c.success>0?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[s.jsx("h3",{className:`font-medium ${c.success>0?"text-green-800":"text-red-800"}`,children:" "}),s.jsxs("p",{className:`text-sm mt-1 ${c.success>0?"text-green-700":"text-red-700"}`,children:[" : ",c.success," "]}),c.errors.length>0&&s.jsxs("div",{className:"mt-2",children:[s.jsx("p",{className:"text-sm text-red-700 font-medium",children:":"}),s.jsx("ul",{className:"text-sm text-red-600 mt-1 space-y-1",children:c.errors.map((j,D)=>s.jsxs("li",{children:[" ",j]},D))}),s.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["    : ",s.jsx("span",{className:"font-mono font-bold",children:"123456"})]})]})]})})]}),s.jsx("div",{className:"p-6 border-t border-gray-200",children:s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:c?"":""}),!c&&f&&s.jsxs("button",{onClick:_,disabled:l||x.every(j=>j.error),className:"px-4 py-2 bg-sns-green text-white rounded-lg hover:bg-sns-green-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[s.jsx(xo,{size:16}),s.jsx("span",{children:l?"...":` (${x.filter(j=>!j.error).length})`})]})]})})]})})}function xte({isOpen:e,onClose:t,users:r,territories:a,positions:n}){const[i,l]=E.useState("users"),[o,c]=E.useState(!1);if(!e)return null;const d=async()=>{c(!0);try{let x=[],u="",f=[];switch(i){case"users":x=r,u="users.csv",f=["","Email","SAP ","",""," "];break;case"territories":x=a,u="territories.csv",f=["",""," "];break;case"positions":x=n,u="positions.csv",f=["",""," "];break}const h=[f.join(","),...x.map(v=>{switch(i){case"users":return[v.full_name,v.email,v.sap_number||"",v.role,v.is_active?"":"",new Date(v.created_at).toLocaleDateString("ru-RU")].join(",");case"territories":return[v.name,v.region||"",new Date(v.created_at).toLocaleDateString("ru-RU")].join(",");case"positions":return[v.name,v.description||"",new Date(v.created_at).toLocaleDateString("ru-RU")].join(",");default:return""}})].join(`
`),p=new Blob([h],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a"),y=URL.createObjectURL(p);g.setAttribute("href",y),g.setAttribute("download",u),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g),t()}catch(x){console.error("Export error:",x)}finally{c(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:20})})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"    :"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",value:"users",checked:i==="users",onChange:x=>l(x.target.value),className:"h-4 w-4 text-sns-green focus:ring-sns-green border-gray-300"}),s.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:[" (",r.length,")"]})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",value:"territories",checked:i==="territories",onChange:x=>l(x.target.value),className:"h-4 w-4 text-sns-green focus:ring-sns-green border-gray-300"}),s.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:[" (",a.length,")"]})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",value:"positions",checked:i==="positions",onChange:x=>l(x.target.value),className:"h-4 w-4 text-sns-green focus:ring-sns-green border-gray-300"}),s.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:[" (",n.length,")"]})]})]})]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-gray-600",children:"     CSV,     Excel       ."})})]}),s.jsx("div",{className:"p-6 border-t border-gray-200",children:s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-300",children:""}),s.jsxs("button",{onClick:d,disabled:o,className:"px-4 py-2 bg-sns-green text-white rounded-xl hover:bg-sns-green-dark transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[s.jsx(Bn,{size:16}),s.jsx("span",{children:o?"...":""})]})]})})]})})}function ute({isOpen:e,onClose:t,user:r}){const{resetUserPassword:a}=Oy(),[n,i]=E.useState(!1),[l,o]=E.useState(!1),[c,d]=E.useState(""),[x,u]=E.useState("");if(!e||!r)return null;const f=async()=>{if(!(r!=null&&r.email)){u("   email ");return}u(""),i(!0);try{const h=await a(r.id,r.email);d(h),o(!0)}catch(h){console.error("Error resetting password:",h),u(h instanceof Error?h.message:"  ")}finally{i(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"  "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:20})})]})}),s.jsx("div",{className:"p-6 space-y-6",children:l?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(rl,{size:32,className:"text-green-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:" !"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"   ."}),c&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:" :"}),s.jsx("p",{className:"text-lg font-mono text-blue-800 bg-white px-4 py-2 rounded border border-blue-200 text-center select-all cursor-pointer",onClick:()=>{navigator.clipboard.writeText("123456"),alert("    ")},title:",   ",children:"123456"}),s.jsxs("p",{className:"text-sm text-blue-700 mt-2",children:[s.jsx("span",{className:"font-medium",children:" :"}),"        ",s.jsx("span",{className:"font-mono font-medium",children:"123456"}),".     ."]})]})]}):s.jsxs(s.Fragment,{children:[!(r!=null&&r.email)&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-red-800",children:"   email .    ."})}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Ao,{size:24,className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900",children:r.full_name}),s.jsx("p",{className:"text-sm text-gray-600",children:r.email||"Email  "})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"  :"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:'     "123456"'}),s.jsx("li",{children:"       "})]})]}),x&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-red-800",children:x})}),(r==null?void 0:r.email)&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-yellow-800",children:"!      .       ."})})]})}),!l&&s.jsx("div",{className:"p-6 border-t border-gray-200",children:s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""}),s.jsxs("button",{onClick:f,disabled:n||!(r!=null&&r.email),className:"px-4 py-2 bg-sns-green text-white rounded-lg hover:bg-sns-green-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[s.jsx(rl,{size:16}),s.jsx("span",{children:n?" ...":" "})]})]})})]})})}function fte({isOpen:e,onClose:t,templateId:r,eventTypeId:a,onSuccess:n}){const[i,l]=E.useState({name:"",description:"",event_type_id:a||"",is_default:!1}),[o,c]=E.useState([]),[d,x]=E.useState([]),[u,f]=E.useState(!0),[h,p]=E.useState(!1),[g,y]=E.useState(null),[v,w]=E.useState(!1);E.useEffect(()=>{e&&(m(),r?b(r):(l({name:"",description:"",event_type_id:a||"",is_default:!1}),c([{question:"  ",question_type:"rating",required:!0,order_num:1,isNew:!0},{question:"    ",question_type:"rating",required:!0,order_num:2,isNew:!0},{question:"  ",question_type:"rating",required:!0,order_num:3,isNew:!0},{question:"   ",question_type:"rating",required:!0,order_num:4,isNew:!0},{question:"  ",question_type:"text",required:!1,order_num:5,isNew:!0}]),f(!1)))},[e,r,a]);const m=async()=>{try{const{data:B,error:L}=await Z.from("event_types").select("id, name, name_ru").order("name_ru");if(L)throw L;x(B||[])}catch(B){console.error("Error fetching event types:",B),y("    ")}},b=async B=>{try{f(!0);const{data:L,error:U}=await Z.from("feedback_templates").select("*").eq("id",B).single();if(U)throw U;l(L);const{data:P,error:F}=await Z.from("feedback_questions").select("*").eq("template_id",B).order("order_num");if(F)throw F;c(P||[])}catch(L){console.error("Error fetching template data:",L),y("    ")}finally{f(!1)}},_=(B,L)=>{l({...i,[B]:L})},C=(B,L,U)=>{const P=[...o];P[B]={...P[B],[L]:U},c(P)},j=()=>{const B=o.length>0?Math.max(...o.map(L=>L.order_num))+1:1;c([...o,{question:"",question_type:"rating",required:!0,order_num:B,isNew:!0}])},D=B=>{c(o.filter((L,U)=>U!==B))},R=(B,L)=>{if(L==="up"&&B===0||L==="down"&&B===o.length-1)return;const U=[...o],P=L==="up"?B-1:B+1,F=U[B].order_num;U[B].order_num=U[P].order_num,U[P].order_num=F,[U[B],U[P]]=[U[P],U[B]],c(U)},M=()=>{if(!i.name.trim())return y("   "),!1;if(!i.event_type_id)return y("   "),!1;if(o.length===0)return y("    "),!1;for(let B=0;B<o.length;B++)if(!o[B].question.trim())return y(` ${B+1}    `),!1;return!0},O=async()=>{if(M()){p(!0),y(null);try{let B=i.id;if(B){const{error:P}=await Z.from("feedback_templates").update({name:i.name,description:i.description,event_type_id:i.event_type_id,is_default:i.is_default,updated_at:new Date().toISOString()}).eq("id",B);if(P)throw P}else{const{data:P,error:F}=await Z.from("feedback_templates").insert({name:i.name,description:i.description,event_type_id:i.event_type_id,is_default:i.is_default}).select().single();if(F)throw F;B=P.id}if(i.id){const{error:P}=await Z.from("feedback_questions").delete().eq("template_id",B);if(P)throw P}const L=o.map((P,F)=>({template_id:B,question:P.question,question_type:P.question_type,required:P.required,order_num:F+1})),{error:U}=await Z.from("feedback_questions").insert(L);if(U)throw U;w(!0),setTimeout(()=>{n(),t()},1500)}catch(B){console.error("Error saving feedback template:",B),y("    ")}finally{p(!1)}}};return e?s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"   ":"   "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Qe,{size:20})})]})}),u?s.jsxs("div",{className:"p-10 flex flex-col justify-center items-center",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mb-4"}),s.jsx("p",{className:"text-gray-500",children:" ..."})]}):v?s.jsxs("div",{className:"p-10 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(at,{className:"h-8 w-8 text-green-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsxs("p",{className:"text-gray-600",children:["    ",r?"":"","."]})]}):s.jsxs("div",{className:"p-6 space-y-6",children:[g&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm text-red-700",children:g})})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),s.jsx("input",{type:"text",value:i.name,onChange:B=>_("name",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:":    "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("textarea",{value:i.description,onChange:B=>_("description",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"      "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),s.jsxs("select",{value:i.event_type_id,onChange:B=>_("event_type_id",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!!a,children:[s.jsx("option",{value:"",children:"  "}),d.map(B=>s.jsx("option",{value:B.id,children:B.name_ru||B.name},B.id))]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"is_default",checked:i.is_default,onChange:B=>_("is_default",B.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"is_default",className:"ml-2 block text-sm text-gray-900",children:"      "})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[" (",o.length,")"]}),s.jsxs("button",{type:"button",onClick:j,className:"px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(es,{className:"h-4 w-4 inline mr-1"})," "]})]}),s.jsxs("div",{className:"space-y-4",children:[o.map((B,L)=>s.jsxs("div",{className:Ve("p-4 border rounded-lg",B.question_type==="rating"?"border-blue-200 bg-blue-50":"border-green-200 bg-green-50"),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx("div",{className:Ve("mt-0.5 p-1 rounded-full",B.question_type==="rating"?"bg-blue-100":"bg-green-100"),children:B.question_type==="rating"?s.jsx(Ms,{className:Ve("h-4 w-4",B.question_type==="rating"?"text-blue-600":"text-green-600")}):s.jsx(XR,{className:"h-4 w-4 text-green-600"})}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:B.question_type==="rating"?"":""})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{type:"button",onClick:()=>R(L,"up"),disabled:L===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",children:s.jsx(QT,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>R(L,"down"),disabled:L===o.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",children:s.jsx(HT,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>D(L),className:"p-1 text-red-400 hover:text-red-600",children:s.jsx(Zr,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),s.jsx("input",{type:"text",value:B.question,onChange:U=>C(L,"question",U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"  "})]}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsxs("select",{value:B.question_type,onChange:U=>C(L,"question_type",U.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"rating",children:" (1-5 )"}),s.jsx("option",{value:"text",children:" "})]})]}),s.jsx("div",{className:"flex items-end h-9",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:B.required,onChange:U=>C(L,"required",U.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700",children:" "})]})})]}),B.question_type==="rating"&&s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:":"}),s.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(U=>s.jsx(Ms,{className:"w-5 h-5 text-gray-300"},U))})]})]})]},L)),o.length===0&&s.jsxs("div",{className:"text-center py-8 border border-dashed border-gray-300 rounded-lg",children:[s.jsx(La,{className:"h-10 w-10 text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"     "}),s.jsx("button",{type:"button",onClick:j,className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"  "})]})]})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 flex justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""}),s.jsx("button",{type:"button",onClick:O,disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:h?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:" "})]})})]})]})]})}):null}function hte(){const[e,t]=E.useState([]),[r,a]=E.useState(!0),[n,i]=E.useState(null),[l,o]=E.useState(!1),[c,d]=E.useState(null),[x,u]=E.useState(null);E.useEffect(()=>{f()},[]);const f=async()=>{a(!0);try{const{data:w,error:m}=await Z.from("feedback_templates").select(`
          *,
          event_type:event_type_id(name, name_ru)
        `).order("created_at",{ascending:!1});if(m)throw m;const b=await Promise.all((w||[]).map(async _=>{const{count:C,error:j}=await Z.from("feedback_questions").select("id",{count:"exact",head:!0}).eq("template_id",_.id);return{..._,questions_count:C||0}}));t(b)}catch(w){console.error("Error fetching feedback templates:",w),i("     ")}finally{a(!1)}},h=()=>{d(null),o(!0)},p=w=>{d(w),o(!0)},g=async w=>{if(window.confirm(" ,       ?")){u(w);try{const{error:m}=await Z.from("feedback_templates").delete().eq("id",w);if(m)throw m;t(b=>b.filter(_=>_.id!==w))}catch(m){console.error("Error deleting template:",m),alert("   ")}finally{u(null)}}},y=()=>{o(!1),d(null)},v=()=>{f()};return r?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n?s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx(an,{className:"h-5 w-5 text-red-500 mr-2 flex-shrink-0"}),s.jsx("p",{className:"text-red-700",children:n})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"  "}),s.jsx("p",{className:"text-gray-600 mt-1",children:"       "})]}),s.jsxs("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[s.jsx(es,{className:"h-5 w-5 mr-2"}),s.jsx("span",{children:" "})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-medium text-gray-900 flex items-center",children:[s.jsx(La,{className:"h-5 w-5 mr-2 text-blue-600"}),"  "]})}),s.jsx("div",{children:e.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(La,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"   "}),s.jsx("p",{className:"text-gray-600 mb-6",children:"        "}),s.jsxs("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(es,{className:"h-5 w-5 inline mr-2"})," "]})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(w=>{var m,b;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name}),s.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:w.description||" "})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-medium rounded-full bg-blue-100 text-blue-800",children:((m=w.event_type)==null?void 0:m.name_ru)||((b=w.event_type)==null?void 0:b.name)||" "})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm",children:s.jsxs("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(Et,{className:"h-3.5 w-3.5 mr-1"}),w.questions_count]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm",children:w.is_default?s.jsx(mn,{className:"h-5 w-5 text-green-600 mx-auto"}):s.jsx("span",{className:"text-gray-400",children:""})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500",children:new Date(w.updated_at).toLocaleDateString("ru-RU")}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("button",{onClick:()=>alert(`    ${w.id}`),className:"text-gray-400 hover:text-blue-600 transition-colors",title:"",children:s.jsx(hM,{className:"h-5 w-5"})}),s.jsx("button",{onClick:()=>p(w.id),className:"text-gray-400 hover:text-green-600 transition-colors",title:"",children:s.jsx(sn,{className:"h-5 w-5"})}),s.jsx("button",{onClick:()=>g(w.id),disabled:!!x,className:Ve("text-gray-400 hover:text-red-600 transition-colors",x===w.id&&"opacity-50 cursor-not-allowed"),title:"",children:x===w.id?s.jsx("div",{className:"h-5 w-5 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):s.jsx(Zr,{className:"h-5 w-5"})})]})})]},w.id)})})]})})})]}),s.jsx(fte,{isOpen:l,onClose:y,templateId:c||void 0,onSuccess:v})]})}function mte({sap:e}){const[t,r]=E.useState(!1),a=async n=>{n.stopPropagation();try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),1500)}catch{}};return s.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[s.jsxs("span",{children:["SAP: ",e]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{type:"button",className:"text-gray-400 hover:text-sns-green transition-colors",title:" SAP",onClick:a,children:s.jsx(FM,{size:14})}),s.jsxs("span",{className:`
              absolute -top-8 left-1/2 -translate-x-1/2 whitespace-nowrap 
              rounded-md bg-gray-800/90 px-2 py-1 text-xs font-semibold text-white shadow-lg 
              transition-all duration-300 ease-in-out
              ${t?"opacity-100 scale-100":"opacity-0 scale-90 pointer-events-none"}
            `,children:["!",s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-x-4 border-x-transparent border-t-4 border-t-gray-800/90"})]})]})]})}function gte(){const{user:e}=st(),{users:t,branches:r,territories:a,positions:n,loading:i,error:l,loadData:o}=eA(),{createUser:c,deleteUser:d,bulkUpdateUsers:x,importUsers:u,toggleUserStatus:f,loading:h}=Oy(),[p,g]=E.useState(""),[y,v]=E.useState("all"),[w,m]=E.useState("all"),[b,_]=E.useState([]),[C,j]=E.useState(!1),[D,R]=E.useState(!1),[M,O]=E.useState(!1),[B,L]=E.useState(!1),[U,P]=E.useState(!1),[F,N]=E.useState(!1),[T,S]=E.useState(!1),[z,W]=E.useState(!1),[k,q]=E.useState(!1),[A,I]=E.useState(!1),[V,H]=E.useState(null),[Y,Q]=E.useState(null),[te,re]=E.useState(null);E.useEffect(()=>{o()},[]);const X=t.filter(ye=>{const Re=ye.full_name.toLowerCase().includes(p.toLowerCase())||ye.email&&ye.email.toLowerCase().includes(p.toLowerCase())||ye.sap_number&&ye.sap_number.includes(p),De=y==="all"||ye.role===y,Ce=w==="all"||w==="active"&&ye.is_active||w==="inactive"&&!ye.is_active;return Re&&De&&Ce}),je=async(ye,Re)=>{re(ye);try{await f(ye,Re),await o()}catch(De){console.error("Error updating user status:",De),alert("    ")}finally{re(null)}},J=async ye=>{if(confirm(" ,     ?")){re(ye);try{await d(ye),await o()}catch(Re){console.error("Error deleting user:",Re),alert("   ")}finally{re(null)}}},ue=ye=>{Q(ye),O(!0)},de=async ye=>{R(!1),await o(),ye.tempPassword&&alert(` !  : ${ye.tempPassword}`)},ce=async()=>{O(!1),Q(null),await o()},fe=ye=>{H(ye),I(!0)},pe=async ye=>{try{const Re=await u(ye);return await o(),Re}catch(Re){return console.error("Error importing users:",Re),{success:0,errors:[Re instanceof Error?Re.message:"   "],warnings:[]}}},Ne=async ye=>{if(b.length===0)return;const Re=ye==="delete"?` ,    ${b.length} ?`:` ,   ${ye==="activate"?"":""} ${b.length} ?`;if(confirm(Re))try{if(ye==="delete")for(const De of b)await d(De);else await x(b,{is_active:ye==="activate"});await o(),_([])}catch(De){console.error("Error in bulk action:",De),alert("    ")}},ne=ye=>{_(Re=>Re.includes(ye)?Re.filter(De=>De!==ye):[...Re,ye])},_e=()=>{b.length===X.length?_([]):_(X.map(ye=>ye.id))},Te=ye=>{const Re=n.find(De=>De.id===ye);return(Re==null?void 0:Re.name)||" "},Me=ye=>{const Re=a.find(De=>De.id===ye);return(Re==null?void 0:Re.name)||" "};return e?l?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-red-500 mb-4",children:s.jsx(an,{size:48,className:"mx-auto"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-600 mb-4",children:l}),s.jsx("button",{onClick:o,className:"bg-sns-green text-white px-4 py-2 rounded-lg hover:bg-sns-green-dark transition-colors",children:" "})]}):s.jsxs("div",{className:"space-y-8 pb-safe-bottom",children:[s.jsxs("div",{className:"flex justify-between items-center pb-4 border-b border-gray-200",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),s.jsx("p",{className:"text-gray-600 mt-1",children:" ,    "})]}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("button",{onClick:()=>R(!0),className:"bg-sns-green text-white px-4 py-2 rounded-lg hover:bg-sns-green-dark transition-colors flex items-center space-x-2",children:[s.jsx(ax,{size:20}),s.jsx("span",{children:" "})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-2xl p-6 shadow-lg border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:" "}),s.jsx(nt,{className:"h-6 w-6 text-blue-600"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>R(!0),className:"w-full flex items-center justify-between p-3 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors mb-2",children:[s.jsx("span",{className:"font-medium",children:" "}),s.jsx(ax,{className:"h-5 w-5"})]}),s.jsxs("button",{onClick:o,className:"w-full flex items-center justify-between p-3 bg-yellow-50 text-yellow-700 rounded-lg hover:bg-yellow-100 transition-colors mb-2",children:[s.jsx("span",{className:"font-medium",children:"  "}),s.jsx(Bn,{className:"h-5 w-5"})]}),s.jsxs("button",{onClick:()=>S(!0),className:"w-full flex items-center justify-between p-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",children:[s.jsx("span",{className:"font-medium",children:" "}),s.jsx(xo,{className:"h-5 w-5"})]}),s.jsxs("button",{onClick:()=>W(!0),className:"w-full flex items-center justify-between p-3 bg-orange-50 text-orange-700 rounded-lg hover:bg-orange-100 transition-colors",children:[s.jsx("span",{className:"font-medium",children:" "}),s.jsx(Bn,{className:"h-5 w-5"})]})]}),s.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[" : ",s.jsx("span",{className:"font-medium text-blue-600",children:t.length})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-2xl p-6 shadow-lg border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:""}),s.jsx(Ka,{className:"h-6 w-6 text-green-600"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>L(!0),className:"w-full flex items-center justify-between p-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",children:[s.jsx("span",{className:"font-medium",children:""}),s.jsx(Ka,{className:"h-5 w-5"})]}),s.jsxs("button",{onClick:()=>P(!0),className:"w-full flex items-center justify-between p-3 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors",children:[s.jsx("span",{className:"font-medium",children:""}),s.jsx(co,{className:"h-5 w-5"})]}),s.jsxs("button",{onClick:()=>q(!0),className:"w-full flex items-center justify-between p-3 bg-yellow-50 text-yellow-700 rounded-lg hover:bg-yellow-100 transition-colors",children:[s.jsx("span",{className:"font-medium",children:"  "}),s.jsx(La,{className:"h-5 w-5"})]}),s.jsxs("button",{onClick:()=>N(!0),className:"w-full flex items-center justify-between p-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx("span",{className:"font-medium",children:" "}),s.jsx(Gf,{className:"h-5 w-5"})]})]}),s.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[": ",s.jsx("span",{className:"font-medium text-green-600",children:a.length}),"  : ",s.jsx("span",{className:"font-medium text-purple-600",children:n.length})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-2xl p-6 shadow-lg border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:" "}),s.jsx(cM,{className:"h-6 w-6 text-orange-600"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:" "}),s.jsx("span",{className:"text-lg font-semibold text-green-600",children:t.filter(ye=>ye.is_active).length})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:" "}),s.jsx("span",{className:"text-lg font-semibold text-red-600",children:t.filter(ye=>!ye.is_active).length})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:""}),s.jsx("span",{className:"text-lg font-semibold text-blue-600",children:t.filter(ye=>ye.role==="administrator").length})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:""}),s.jsx("span",{className:"text-lg font-semibold text-orange-600",children:t.filter(ye=>ye.is_leaving).length})]})]})]})]}),s.jsx(ste,{}),s.jsx("div",{className:"bg-white/80 backdrop-blur rounded-2xl shadow-lg p-6 border border-gray-100",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Ia,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:" ...",value:p,onChange:ye=>g(ye.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"})]}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[s.jsxs("select",{value:y,onChange:ye=>v(ye.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"all",children:" "}),Object.entries(qc).map(([ye,Re])=>s.jsx("option",{value:ye,children:Re},ye))]}),s.jsxs("select",{value:w,onChange:ye=>m(ye.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"active",children:""}),s.jsx("option",{value:"inactive",children:""})]})]})]})}),b.length>0&&s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[" : ",b.length]}),s.jsx("button",{onClick:()=>_([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:" "})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>Ne("activate"),disabled:h,className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors",children:""}),s.jsx("button",{onClick:()=>Ne("deactivate"),disabled:h,className:"bg-yellow-600 text-white px-3 py-1 rounded text-sm hover:bg-yellow-700 transition-colors",children:""}),s.jsx("button",{onClick:()=>Ne("delete"),disabled:h,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:h?s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"..."})]}):""})]})]})}),s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-2xl shadow-lg border border-gray-100",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[" (",X.length,")"]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("button",{onClick:_e,className:"text-sm text-sns-green hover:text-sns-green-dark",children:b.length===X.length&&X.length>0?" ":" "})})]})}),i?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"w-8 h-8 border-4 border-sns-green border-t-transparent rounded-full animate-spin"})}):s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:b.length===X.length&&X.length>0,onChange:_e,className:"h-4 w-4 text-sns-green focus:ring-sns-green border-gray-300 rounded"})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X.map(ye=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("input",{type:"checkbox",checked:b.includes(ye.id),onChange:()=>ne(ye.id),className:"h-4 w-4 text-sns-green focus:ring-sns-green border-gray-300 rounded"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:ye.full_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[Te(ye.position_id)===" "&&ye.sap_number?s.jsx(mte,{sap:ye.sap_number}):ye.email||(ye.sap_number?`SAP: ${ye.sap_number}`:""),ye.is_leaving&&s.jsx("span",{className:"ml-2 text-yellow-600 font-medium",children:" "})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:Te(ye.position_id)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:Me(ye.territory_id)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.jsxs("button",{onClick:()=>je(ye.id,ye.is_active),disabled:te===ye.id,className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium transition-colors ${ye.is_active?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"} ${te===ye.id?"opacity-50 cursor-not-allowed":""}`,children:[te===ye.id?s.jsx("div",{className:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin mr-1"}):null,ye.is_active?"":""]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("button",{onClick:()=>ue(ye),disabled:te===ye.id,className:"text-gray-400 hover:text-sns-green transition-colors",title:"",children:s.jsx(sn,{size:16})}),s.jsx("button",{onClick:()=>fe(ye),disabled:te===ye.id,className:"text-gray-400 hover:text-purple-600 transition-colors",title:" ",children:s.jsx(rl,{size:16})}),s.jsx("button",{onClick:()=>J(ye.id),disabled:te===ye.id,className:"text-gray-400 hover:text-red-600 transition-colors",title:"",children:te===ye.id?s.jsx("div",{className:"w-4 h-4 border border-current border-t-transparent rounded-full animate-spin"}):s.jsx(Zr,{size:16})})]})})]},ye.id))})]}),X.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(nt,{size:48,className:"mx-auto text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500",children:"  "})]})]})]}),s.jsx(ate,{isOpen:C,onClose:()=>j(!1),onCreateUser:c,onSuccess:de,branches:r,territories:a,positions:n}),s.jsx(nte,{isOpen:D,onClose:()=>R(!1),onSuccess:()=>{o(),R(!1)}}),s.jsx(ite,{isOpen:M,onClose:()=>{O(!1),Q(null)},onSuccess:ce,user:Y,territories:a,positions:n}),k&&s.jsx(hte,{}),s.jsx(lte,{isOpen:B,onClose:()=>L(!1),territories:a,onUpdate:()=>o()}),s.jsx(ote,{isOpen:U,onClose:()=>P(!1),positions:n,onUpdate:()=>o()}),s.jsx(cte,{isOpen:F,onClose:()=>N(!1)}),s.jsx(dte,{isOpen:T,onClose:()=>S(!1),onImport:pe,onSuccess:()=>S(!1)}),s.jsx(xte,{isOpen:z,onClose:()=>W(!1),users:t,territories:a,positions:n}),s.jsx(ute,{isOpen:A,onClose:()=>{I(!1),H(null)},user:V})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-red-500 mb-4",children:s.jsx(co,{size:48,className:"mx-auto"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:"      ."})]})}var tA={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},S5=wt.createContext&&wt.createContext(tA),pte=["attr","size","title"];function vte(e,t){if(e==null)return{};var r=bte(e,t),a,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function bte(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function ph(){return ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ph.apply(this,arguments)}function B5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function vh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B5(Object(r),!0).forEach(function(a){yte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B5(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function yte(e,t,r){return t=wte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wte(e){var t=Ete(e,"string");return typeof t=="symbol"?t:t+""}function Ete(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rA(e){return e&&e.map((t,r)=>wt.createElement(t.tag,vh({key:r},t.attr),rA(t.child)))}function Py(e){return t=>wt.createElement(_te,ph({attr:vh({},e.attr)},t),rA(e.child))}function _te(e){var t=r=>{var{attr:a,size:n,title:i}=e,l=vte(e,pte),o=n||r.size||"1em",c;return r.className&&(c=r.className),e.className&&(c=(c?c+" ":"")+e.className),wt.createElement("svg",ph({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,l,{className:c,style:vh(vh({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),i&&wt.createElement("title",null,i),e.children)};return S5!==void 0?wt.createElement(S5.Consumer,null,r=>t(r)):t(tA)}function jte(e){return Py({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"},child:[]}]})(e)}function Nte(e){return Py({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"},child:[]}]})(e)}function sA(e){return Py({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5.033 14.649H.743a.74.74 0 0 1-.686-.458.74.74 0 0 1 .16-.808L3.19 10.41H1.06A1.06 1.06 0 0 1 0 9.35h3.957c.301 0 .57.18.686.458a.74.74 0 0 1-.161.808L1.51 13.59h2.464c.585 0 1.06.475 1.06 1.06zM24 11.338c0-1.14-.927-2.066-2.066-2.066-.61 0-1.158.265-1.537.686a2.061 2.061 0 0 0-1.536-.686c-1.14 0-2.066.926-2.066 2.066v3.311a1.06 1.06 0 0 0 1.06-1.06v-2.251a1.004 1.004 0 0 1 2.013 0v2.251c0 .586.474 1.06 1.06 1.06v-3.311a1.004 1.004 0 0 1 2.012 0v2.251c0 .586.475 1.06 1.06 1.06zM16.265 12a2.728 2.728 0 1 1-5.457 0 2.728 2.728 0 0 1 5.457 0zm-1.06 0a1.669 1.669 0 1 0-3.338 0 1.669 1.669 0 0 0 3.338 0zm-4.82 0a2.728 2.728 0 1 1-5.458 0 2.728 2.728 0 0 1 5.457 0zm-1.06 0a1.669 1.669 0 1 0-3.338 0 1.669 1.669 0 0 0 3.338 0z"},child:[]}]})(e)}function hm(){return{toast:E.useCallback(e=>alert(e),[])}}function aA({isOpen:e,onClose:t,attemptId:r,eventId:a}){var L,U,P;const{toast:n}=hm(),{user:i}=st(),[l,o]=E.useState(!1),[c,d]=E.useState(!1),[x,u]=E.useState([]),[f,h]=E.useState(null),[p,g]=E.useState("all"),[y,v]=E.useState(0),w=E.useRef(null);E.useEffect(()=>{e&&r&&b()},[e,r]);const m=E.useMemo(()=>{let F=x;return p==="unreviewed"&&(F=F.filter(N=>N.is_correct===void 0)),p==="correct"&&(F=F.filter(N=>N.is_correct===!0)),p==="incorrect"&&(F=F.filter(N=>N.is_correct===!1)),F},[x,p]);E.useEffect(()=>{if(!e)return;const F=N=>{if(N.key==="Escape"){t();return}if(x.length!==0){if(["j","ArrowDown"].includes(N.key)&&(N.preventDefault(),v(T=>Math.min(T+1,m.length-1))),["k","ArrowUp"].includes(N.key)&&(N.preventDefault(),v(T=>Math.max(T-1,0))),N.key==="1"){N.preventDefault();const T=m[y];T&&_(T.id,!0)}if(N.key==="2"){N.preventDefault();const T=m[y];T&&_(T.id,!1)}(N.ctrlKey||N.metaKey)&&N.key.toLowerCase()==="s"&&(N.preventDefault(),O())}};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[e,x,m,y]),E.useEffect(()=>{const F=w.current;if(!F)return;const N=F.querySelector(`[data-idx="${y}"]`);N&&N.scrollIntoView({block:"nearest",behavior:"smooth"})},[y]);async function b(){var F;o(!0);try{const{data:N,error:T}=await Z.from("user_test_attempts").select(`
          id, test_id, status, updated_at,
          user:user_id(full_name, email),
          test:tests(id, title, type, passing_score)
        `).eq("id",r).single();if(T)throw T;h(N);const S=N.test_id||((F=N.test)==null?void 0:F.id),{data:z,error:W}=await Z.from("test_questions").select('id, question, question_type, created_at, "order"').eq("test_id",S).in("question_type",["text","sequence"]).order('"order"',{ascending:!0,nullsLast:!0}).order("created_at",{ascending:!0,nullsLast:!0}).order("id",{ascending:!0});if(W)throw W;const k=(z||[]).map(Q=>Q.id),{data:q,error:A}=await Z.from("user_test_answers").select("id, question_id, text_answer").eq("attempt_id",r).in("question_id",k);if(A)throw A;const{data:I}=await Z.from("test_answer_reviews").select("question_id, is_correct").eq("attempt_id",r),V=(z||[]).map(Q=>{const te=(q||[]).find(X=>X.question_id===Q.id),re=(I||[]).find(X=>X.question_id===Q.id);return{id:(te==null?void 0:te.id)||`temp-${Q.id}`,question_id:Q.id,question:Q.question,question_type:Q.question_type,text_answer:te==null?void 0:te.text_answer,is_correct:re==null?void 0:re.is_correct}}),H=`review-draft-${r}`,Y=localStorage.getItem(H);if(Y)try{const Q=JSON.parse(Y);for(const te of V)Q[te.id]!==void 0&&(te.is_correct=Q[te.id])}catch{}u(V),v(0)}catch(N){console.error("  :",N),n(` : ${N.message}`)}finally{o(!1)}}const _=E.useCallback((F,N)=>{u(T=>{const S=T.map(W=>W.id===F?{...W,is_correct:N}:W),z={};return S.forEach(W=>{W.is_correct!==void 0&&(z[W.id]=W.is_correct)}),localStorage.setItem(`review-draft-${r}`,JSON.stringify(z)),S})},[r]),C=(F,N)=>_(F,N),j=E.useMemo(()=>x.filter(F=>F.is_correct!==void 0).length,[x]),D=E.useMemo(()=>x.filter(F=>F.is_correct===!0).length,[x]),R=E.useMemo(()=>x.filter(F=>F.is_correct===!1).length,[x]);async function M(F,N,T,S,z,W){const{error:k}=await Z.from("test_answer_reviews").delete().eq("attempt_id",F);k&&console.log("     ( ):",k);const q=N.map(I=>({attempt_id:F,question_id:I.question_id,reviewer_id:i==null?void 0:i.id,is_correct:!!I.is_correct,points_awarded:I.is_correct?1:0,review_notes:null})),{error:A}=await Z.from("test_answer_reviews").insert(q);if(A)throw A}async function O(){var N;if(x.filter(T=>T.is_correct!==void 0).length===0){n("     ");return}d(!0);try{const{data:T}=await Z.auth.getUser();if(!(T!=null&&T.user))throw new Error("  ");const S=x.filter(I=>I.is_correct===!0).length,z=x.length,W=Math.round(S/z*100),k=(N=f==null?void 0:f.test)==null?void 0:N.passing_score,q=k?W>=k:!0;await M(r,x,S,z,W,q);const{error:A}=await Z.from("user_test_attempts").update({status:"completed",score:W,passed:q,reviewed_by:T.user.id,reviewed_at:new Date().toISOString()}).eq("id",r);A&&console.log("   user_test_attempts ( ):",A),localStorage.removeItem(`review-draft-${r}`),n(`  : ${S}/${z} (${W}%)`),t()}catch(T){console.error("  :",T),n(` : ${T.message}`)}finally{d(!1)}}if(!e)return null;const B=x.length?Math.round(j/x.length*100):0;return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),s.jsxs("div",{className:"relative bg-white rounded-xl max-w-5xl w-[96vw] md:w-[90vw] max-h-[92vh] shadow-xl ring-1 ring-black/5 flex flex-col",children:[s.jsxs("div",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur border-b border-gray-100",children:[s.jsxs("div",{className:"p-3 md:p-6 flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:" "}),f&&s.jsxs("div",{className:"mt-1 md:mt-2 flex flex-wrap items-center gap-1.5 md:gap-2 text-xs md:text-sm text-gray-600",children:[s.jsxs("span",{className:"inline-flex items-center gap-1.5 bg-blue-50 px-2 py-0.5 md:px-2.5 md:py-1 rounded-full",children:[s.jsx(qt,{size:12}),s.jsx("span",{className:"font-medium truncate max-w-[30vw] md:max-w-none",children:(L=f.user)==null?void 0:L.full_name})]}),s.jsxs("span",{className:"inline-flex items-center gap-1.5 bg-gray-50 px-2 py-0.5 md:px-2.5 md:py-1 rounded-full",children:[s.jsx(Et,{size:12}),s.jsx("span",{className:"font-medium truncate max-w-[30vw] md:max-w-none",children:(U=f.test)==null?void 0:U.title})]})]})]}),s.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 text-gray-500 hover:text-gray-700 flex-shrink-0",children:s.jsx(Qe,{size:20})})]}),s.jsxs("div",{className:"px-3 md:px-6 pb-3 md:pb-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2 md:gap-3 mb-3 md:mb-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 md:p-3 text-center",children:[s.jsx("div",{className:"text-xs font-medium text-gray-500 mb-0.5 md:mb-1",children:" "}),s.jsx("div",{className:"text-sm md:text-lg font-bold text-gray-900",children:x.length-j})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-2 md:p-3 text-center",children:[s.jsx("div",{className:"text-xs font-medium text-green-600 mb-0.5 md:mb-1",children:""}),s.jsx("div",{className:"text-sm md:text-lg font-bold text-green-700",children:D})]}),s.jsxs("div",{className:"bg-red-50 rounded-lg p-2 md:p-3 text-center",children:[s.jsx("div",{className:"text-xs font-medium text-red-600 mb-0.5 md:mb-1",children:""}),s.jsx("div",{className:"text-sm md:text-lg font-bold text-red-700",children:R})]})]}),s.jsxs("div",{className:"mt-3 flex items-center gap-2 md:gap-3",children:[s.jsxs("div",{className:"text-xs md:text-sm text-gray-700",children:[" : ",s.jsxs("span",{className:"font-medium",children:[((P=f==null?void 0:f.test)==null?void 0:P.passing_score)??"","%"]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("div",{className:"flex-1 md:w-48 h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-sns-green transition-all",style:{width:`${B}%`}})}),s.jsxs("div",{className:"text-xs md:text-sm text-gray-700 whitespace-nowrap font-medium",children:[j,"/",x.length]})]})]})]})]}),s.jsx("div",{ref:w,className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-3",children:l?s.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-600",children:[s.jsx("div",{className:"w-6 h-6 border-2 border-sns-green border-t-transparent rounded-full animate-spin mr-2"}),"  ..."]}):m.length===0?s.jsxs("div",{className:"text-center py-12 text-gray-600",children:[s.jsx(Et,{className:"h-12 w-12 mx-auto text-gray-300 mb-3"}),"     "]}):m.map((F,N)=>{const T=x.findIndex(z=>z.id===F.id),S=T===y;return s.jsxs("div",{"data-idx":T,className:Ve("border rounded-xl p-4 transition-all",S?"border-sns-green ring-1 ring-sns-green/30 bg-sns-green/5":"border-gray-100 bg-white hover:bg-gray-50"),children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-sns-green text-white text-xs font-medium rounded-full",children:T+1}),s.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[" ",T+1]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[F.is_correct===!0&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-green-50 text-green-700 border border-green-200",children:[s.jsx(at,{size:12})," "]}),F.is_correct===!1&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-red-50 text-red-700 border border-red-200",children:[s.jsx(ds,{size:12})," "]}),F.is_correct===void 0&&s.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-50 text-gray-700 border border-gray-200",children:" "})]})]}),s.jsx("div",{className:"mt-3 text-gray-900 text-sm leading-relaxed font-medium whitespace-pre-wrap",children:F.question}),s.jsxs("div",{className:"mt-3 bg-gray-50 p-3 rounded-lg border border-gray-100",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:" :"}),s.jsx("p",{className:"text-gray-900 text-sm leading-relaxed whitespace-pre-wrap",children:F.text_answer||" "})]}),s.jsxs("div",{className:"mt-3 grid grid-cols-2 md:flex md:flex-wrap md:items-center gap-2",children:[s.jsxs("button",{onClick:()=>C(F.id,!0),className:Ve("flex items-center justify-center gap-2 px-3 py-2.5 md:py-2 rounded-lg text-sm font-medium transition-all",F.is_correct===!0?"bg-green-100 border-2 border-green-500 text-green-700":"bg-white border border-gray-200 text-gray-700 hover:border-green-300 hover:bg-green-50"),title:"1",children:[s.jsx(at,{size:16})," "]}),s.jsxs("button",{onClick:()=>C(F.id,!1),className:Ve("flex items-center justify-center gap-2 px-3 py-2.5 md:py-2 rounded-lg text-sm font-medium transition-all",F.is_correct===!1?"bg-red-100 border-2 border-red-500 text-red-700":"bg-white border border-gray-200 text-gray-700 hover:border-red-300 hover:bg-red-50"),title:"2",children:[s.jsx(ds,{size:16})," "]})]})]},F.id)})}),s.jsx("div",{className:"sticky bottom-0 bg-white/95 backdrop-blur border-t border-gray-100",children:s.jsx("div",{className:"p-4 md:p-6",children:s.jsxs("div",{className:"flex items-center justify-center md:justify-end gap-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2.5 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 text-sm font-medium transition-all",children:""}),s.jsx("button",{onClick:O,disabled:c||j===0,className:"px-4 py-2.5 bg-sns-green text-white rounded-lg hover:bg-sns-green-dark disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium inline-flex items-center justify-center gap-2 transition-all",title:"Ctrl/Cmd + S",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),""]}):s.jsxs(s.Fragment,{children:[s.jsx(at,{size:16})," "]})})]})})})]})]})}function Vu({type:e}){const t={entry:"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",final:"bg-blue-50 text-blue-700 ring-1 ring-blue-200",annual:"bg-purple-50 text-purple-700 ring-1 ring-purple-200",default:"bg-gray-50 text-gray-700 ring-1 ring-gray-200"},r=t[e]||t.default,a=e==="entry"?"":e==="final"?"":e==="annual"?"":e;return s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${r}`,children:a})}function U0({icon:e,title:t,description:r,children:a}){return s.jsxs("div",{className:"px-6 py-10 text-center text-gray-500",children:[s.jsx(e,{className:"h-12 w-12 mx-auto text-gray-300 mb-3"}),s.jsx("p",{className:"text-lg font-medium text-gray-900 mb-1",children:t}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:r}),a]})}function F5(){return s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"h-4 w-40 bg-gray-200 rounded animate-pulse"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"h-4 w-52 bg-gray-200 rounded animate-pulse"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"h-4 w-28 bg-gray-200 rounded animate-pulse"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse ml-auto"})})]})}function nA({eventId:e,onReviewComplete:t,onEditReview:r}){const{toast:a}=hm(),[n,i]=E.useState([]),[l,o]=E.useState([]),[c,d]=E.useState(!0),[x,u]=E.useState(!0),[f,h]=E.useState(!0),[p,g]=E.useState([]),[y,v]=E.useState(!0),[w,m]=E.useState(!1),[b,_]=E.useState(null),[C,j]=E.useState(""),[D,R]=E.useState(""),[M,O]=E.useState("all"),[B,L]=E.useState("time"),[U,P]=E.useState("desc"),[F,N]=E.useState(1),[T,S]=E.useState(10);E.useEffect(()=>{const re=setTimeout(()=>R(C.trim().toLowerCase()),250);return()=>clearTimeout(re)},[C]),E.useEffect(()=>{z(),W(),k()},[e]);async function z(){d(!0);try{let re=Z.from("user_test_attempts").select(`
          id,
          status,
          score,
          completed_at,
          created_at,
          test_id,
          user:user_id(id, full_name, email),
          test:tests(id, title, type)
        `).or("status.eq.pending_review,and(status.eq.completed,score.eq.0)").order("completed_at",{ascending:!1});e&&(re=re.eq("event_id",e));const{data:X,error:je}=await re;if(je)throw je;const J=(X||[]).filter(Ne=>Ne.test),ue=Array.from(new Set(J.map(Ne=>Ne.test.id))),{data:de,error:ce}=await Z.from("test_questions").select("id, test_id").in("test_id",ue).eq("question_type","text");if(ce)throw ce;const fe=new Map;(de||[]).forEach(Ne=>{fe.set(Ne.test_id,(fe.get(Ne.test_id)||0)+1)});const pe=J.map(Ne=>{var _e,Te,Me,ye;const ne=fe.get(Ne.test.id)||0;return ne===0?null:{attempt_id:Ne.id,user_name:((_e=Ne.user)==null?void 0:_e.full_name)||"",user_email:((Te=Ne.user)==null?void 0:Te.email)||"",test_title:((Me=Ne.test)==null?void 0:Me.title)||" ",test_type:((ye=Ne.test)==null?void 0:ye.type)||"unknown",submitted_at:Ne.completed_at||Ne.created_at||new Date().toISOString(),open_questions_count:ne}}).filter(Boolean);i(pe)}catch(re){console.error("    :",re),a(` : ${re.message}`)}finally{d(!1)}}async function W(){u(!0);try{const{data:re,error:X}=await Z.from("user_test_attempts").select(`
          id,
          score,
          reviewed_at,
          test:tests(id, title, type, passing_score),
          user:user_id(id, full_name, email),
          reviewer:reviewed_by(id, full_name)
        `).not("reviewed_at","is",null).order("reviewed_at",{ascending:!1});if(X)throw X;const je=await Promise.all((re||[]).map(async J=>{var Ne,ne,_e,Te,Me,ye;const{data:ue}=await Z.from("test_answer_reviews").select("is_correct").eq("attempt_id",J.id),de=(ue||[]).filter(Re=>Re.is_correct).length,ce=(ue==null?void 0:ue.length)||0,fe=ce>0?Math.round(de/ce*100):J.score||0,pe=fe>=(((Ne=J.test)==null?void 0:Ne.passing_score)??70);return{attempt_id:J.id,user_name:((ne=J.user)==null?void 0:ne.full_name)||"",user_email:((_e=J.user)==null?void 0:_e.email)||"",test_title:((Te=J.test)==null?void 0:Te.title)||" ",test_type:((Me=J.test)==null?void 0:Me.type)||"unknown",reviewed_at:J.reviewed_at||new Date().toISOString(),score:fe,passed:pe,correct_answers:de,total_answers:ce,reviewer_name:((ye=J.reviewer)==null?void 0:ye.full_name)||""}}));o(je)}catch(re){console.error("   :",re),a(`   : ${re.message}`)}finally{u(!1)}}async function k(){h(!0);try{if(!e){g([]);return}const{data:re,error:X}=await Z.from("user_test_attempts").select("id, test_id, status, test:tests(id, title)").eq("event_id",e).in("status",["completed","pending_review"]);if(X)throw X;if(!re||re.length===0){g([]);return}const je=re.map(pe=>pe.id),J=Array.from(new Set(re.map(pe=>pe.test_id))),{data:ue,error:de}=await Z.from("test_questions").select("id, question, question_type, test_id").in("test_id",J).in("question_type",["text","sequence"]);if(de)throw de;if(!ue||ue.length===0){g([]);return}const{data:ce}=await Z.from("test_answer_reviews").select("question_id, is_correct, attempt_id").in("attempt_id",je),fe=new Map;ue.forEach(pe=>{var ye,Re;const Ne=((Re=(ye=re.find(De=>De.test_id===pe.test_id))==null?void 0:ye.test)==null?void 0:Re.title)||" ",ne=re.filter(De=>De.test_id===pe.test_id).length,Te=(ce||[]).filter(De=>De.question_id===pe.id).filter(De=>De.is_correct).length,Me=ne>0?Math.round(Te/ne*100):0;fe.set(pe.id,{question_id:pe.id,question_text:pe.question,test_title:Ne,total_answers:ne,correct_answers:Te,correct_percentage:Me})}),g(Array.from(fe.values()))}catch(re){console.error("   :",re),a("   ")}finally{h(!1)}}function q(re){_(re),m(!0)}function A(){m(!1),_(null),z(),W(),t==null||t()}function I(re){r==null||r(re)}const V=E.useMemo(()=>{const re=n.filter(je=>{const J=M==="all"?!0:je.test_type===M,ue=D,de=ue?je.user_name.toLowerCase().includes(ue)||je.user_email.toLowerCase().includes(ue)||je.test_title.toLowerCase().includes(ue):!0;return J&&de}),X=U==="asc"?1:-1;return re.sort((je,J)=>{switch(B){case"name":return je.user_name.localeCompare(J.user_name)*X;case"title":return je.test_title.localeCompare(J.test_title)*X;case"open":return(je.open_questions_count-J.open_questions_count)*X;case"time":default:return(new Date(je.submitted_at).getTime()-new Date(J.submitted_at).getTime())*X}})},[n,M,D,B,U]),H=E.useMemo(()=>{const re=D;let X=l.filter(je=>re?je.user_name.toLowerCase().includes(re)||je.user_email.toLowerCase().includes(re)||je.test_title.toLowerCase().includes(re):!0);return X=X.sort((je,J)=>new Date(J.reviewed_at).getTime()-new Date(je.reviewed_at).getTime()),X},[l,D]),Y=Math.max(1,Math.ceil(H.length/T));E.useEffect(()=>N(1),[D,T]);const Q=E.useMemo(()=>{const re=(F-1)*T;return H.slice(re,re+T)},[H,F,T]);function te(re){const X=new Date(re);return isNaN(X.getTime())||X.getFullYear()<2020?"  ":X.toLocaleString("ru-RU")}return s.jsxs("div",{className:"space-y-6",children:[!c&&V.length===0&&s.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-gradient-to-r from-green-50 to-emerald-50 border border-green-100",children:[s.jsx("div",{className:"absolute inset-0 opacity-50",children:s.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2310b981' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='4'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`,backgroundRepeat:"repeat"}})}),s.jsx("div",{className:"relative p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(at,{className:"h-6 w-6 text-green-600"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"   "}),s.jsx("p",{className:"text-gray-600",children:"       "}),s.jsxs("div",{className:"mt-3 flex items-center gap-2 text-sm text-green-700",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"font-medium",children:"  "})]})]})]})})]}),V.length>0&&s.jsx("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100 p-4 md:p-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4 md:gap-6",children:[s.jsxs("div",{className:"relative md:flex-1",children:[s.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),s.jsx("input",{value:C,onChange:re=>j(re.target.value),placeholder:"  , email   ",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jh,{className:"h-4 w-4 text-gray-500"}),s.jsxs("select",{value:M,onChange:re=>O(re.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"entry",children:""}),s.jsx("option",{value:"final",children:""}),s.jsx("option",{value:"annual",children:""})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:":"}),s.jsxs("select",{value:B,onChange:re=>L(re.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"time",children:"  "}),s.jsx("option",{value:"name",children:" "}),s.jsx("option",{value:"title",children:"  "}),s.jsx("option",{value:"open",children:"  "})]}),s.jsxs("select",{value:U,onChange:re=>P(re.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"desc",children:" "}),s.jsx("option",{value:"asc",children:" "})]})]})]})}),V.length>0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100",children:[s.jsx("div",{className:"p-4 md:p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(wr,{className:"h-5 w-5 mr-2 text-amber-500"}),"   "]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c?"":`${V.length} ()     `})]}),!c&&s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[V.length," "]})]})}),s.jsx("div",{className:"p-4 space-y-3 md:hidden",children:c?Array.from({length:4}).map((re,X)=>s.jsxs("div",{className:"rounded-xl border border-gray-100 p-4",children:[s.jsx("div",{className:"h-4 w-52 bg-gray-200 rounded animate-pulse mb-2"}),s.jsx("div",{className:"h-3 w-80 bg-gray-200 rounded animate-pulse mb-3"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx("div",{className:"h-8 bg-gray-100 rounded"}),s.jsx("div",{className:"h-8 bg-gray-100 rounded"}),s.jsx("div",{className:"h-8 bg-gray-100 rounded"})]})]},X)):V.length===0?s.jsx(U0,{icon:at,title:"   ",description:"       "}):V.map(re=>s.jsxs("div",{className:"rounded-xl border border-gray-100 p-4 flex flex-col gap-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center shrink-0",children:s.jsx(qt,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:re.user_name}),s.jsx("div",{className:"text-xs text-gray-500",children:re.user_email}),s.jsx("div",{className:"mt-1 text-sm text-gray-800",children:re.test_title}),s.jsx("div",{className:"mt-1",children:s.jsx(Vu,{type:re.test_type})})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xs text-gray-500",children:""}),s.jsx("div",{className:"text-sm text-gray-700",children:te(re.submitted_at)})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[s.jsx(Et,{className:"h-4 w-4 mr-1"})," ",re.open_questions_count," "]}),s.jsxs("button",{onClick:()=>q(re.attempt_id),className:"inline-flex items-center px-3 py-1.5 text-sm bg-sns-green text-white rounded-lg hover:bg-sns-green-dark",children:[s.jsx(el,{className:"h-4 w-4 mr-1"}),"  "]})]})]},re.attempt_id))}),s.jsx("div",{className:"overflow-hidden hidden md:block",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c?Array.from({length:6}).map((re,X)=>s.jsx(F5,{},X)):V.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,children:s.jsx(U0,{icon:at,title:"   ",description:"       "})})}):V.map(re=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:s.jsx(qt,{className:"h-4 w-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:re.user_name}),s.jsx("div",{className:"text-xs text-gray-500",children:re.user_email})]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:re.test_title})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx(Vu,{type:re.test_type})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Et,{className:"h-4 w-4 mr-1"})," ",re.open_questions_count]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:te(re.submitted_at)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:s.jsxs("button",{onClick:()=>q(re.attempt_id),className:"inline-flex items-center px-3 py-1.5 text-sm bg-sns-green text-white rounded-lg hover:bg-sns-green-dark",children:[s.jsx(el,{className:"h-4 w-4 mr-1"}),"  "]})})]},re.attempt_id))})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100",children:[s.jsxs("button",{onClick:()=>v(re=>!re),className:"w-full p-4 md:p-6 flex items-center justify-between border-b border-gray-200 text-left",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"      "})]}),s.jsx("span",{className:"text-gray-400",children:y?s.jsx(Vc,{}):s.jsx(xi,{})})]}),y&&s.jsxs("div",{className:"p-4 md:p-6",children:[s.jsxs("div",{className:"space-y-3 md:hidden",children:[x?Array.from({length:3}).map((re,X)=>s.jsxs("div",{className:"rounded-xl border border-gray-100 p-4",children:[s.jsx("div",{className:"h-4 w-48 bg-gray-200 rounded animate-pulse mb-2"}),s.jsx("div",{className:"h-3 w-72 bg-gray-200 rounded animate-pulse mb-3"}),s.jsx("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"})]},X)):H.length===0?s.jsx(U0,{icon:Et,title:"  ",description:"   "}):Q.map(re=>s.jsxs("div",{className:"rounded-xl border border-gray-100 p-4 flex flex-col gap-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:re.user_name}),s.jsx("div",{className:"text-xs text-gray-500",children:re.user_email}),s.jsx("div",{className:"mt-1 text-sm text-gray-800",children:re.test_title}),s.jsx("div",{className:"mt-1",children:s.jsx(Vu,{type:re.test_type})})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${re.passed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[re.score,"%"]}),s.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[re.correct_answers,"/",re.total_answers]}),s.jsx("div",{className:"text-xs text-gray-500",children:te(re.reviewed_at)})]})]}),s.jsx("div",{className:"flex items-center justify-end",children:s.jsx("button",{onClick:()=>I(re.attempt_id),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:""})})]},re.attempt_id)),H.length>0&&s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 pt-2",children:[s.jsxs("span",{children:[". ",F," / ",Y]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>N(re=>Math.max(1,re-1)),disabled:F<=1,className:"px-3 py-1.5 rounded border disabled:opacity-50",children:""}),s.jsx("button",{onClick:()=>N(re=>Math.min(Y,re+1)),disabled:F>=Y,className:"px-3 py-1.5 rounded border disabled:opacity-50",children:""})]})]})]}),s.jsxs("div",{className:"hidden md:block",children:[s.jsx("div",{className:"overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x?Array.from({length:6}).map((re,X)=>s.jsx(F5,{},X)):H.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,children:s.jsx(U0,{icon:Et,title:"  ",description:"   "})})}):Q.map(re=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:re.user_name}),s.jsx("div",{className:"text-xs text-gray-500",children:re.user_email})]}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"text-sm text-gray-900",children:re.test_title})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx(Vu,{type:re.test_type})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[re.score,"%"]}),s.jsxs("div",{className:"text-xs text-gray-600",children:[re.correct_answers,"/",re.total_answers]})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:te(re.reviewed_at)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:s.jsx("button",{onClick:()=>I(re.attempt_id),className:"text-blue-600 hover:text-blue-900 text-sm font-medium",children:""})})]},re.attempt_id))})]})}),H.length>0&&s.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-100 text-sm text-gray-600",children:[s.jsxs("div",{children:[" ",Q.length,"  ",H.length]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:" :"}),s.jsx("select",{value:T,onChange:re=>S(parseInt(re.target.value)||10),className:"border border-gray-300 rounded-lg px-2 py-1 focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[10,20,50].map(re=>s.jsx("option",{value:re,children:re},re))}),s.jsxs("span",{className:"ml-3",children:[". ",F," / ",Y]}),s.jsxs("div",{className:"ml-2 flex gap-1",children:[s.jsx("button",{onClick:()=>N(re=>Math.max(1,re-1)),disabled:F<=1,className:"px-2 py-1 rounded border text-gray-700 disabled:opacity-50",children:""}),s.jsx("button",{onClick:()=>N(re=>Math.min(Y,re+1)),disabled:F>=Y,className:"px-2 py-1 rounded border text-gray-700 disabled:opacity-50",children:""})]})]})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100",children:[s.jsxs("div",{className:"px-4 md:px-6 py-4 border-b border-gray-200",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Dn,{className:"h-5 w-5 text-blue-600"}),"  "]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"  /     "})]}),s.jsx("div",{className:"p-4 md:p-6",children:f?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"ml-2 text-gray-600",children:" ..."})]}):p.length>0?s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:p.map((re,X)=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[" ",X+1]}),s.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:re.question_text}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:re.test_title})]}),s.jsxs("div",{className:"ml-4 text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[re.correct_percentage,"%"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[re.correct_answers,"/",re.total_answers]}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:""})]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${re.correct_percentage>=80?"bg-green-500":re.correct_percentage>=60?"bg-yellow-500":re.correct_percentage>=40?"bg-orange-500":"bg-red-500"}`,style:{width:`${re.correct_percentage}%`}})})]},re.question_id))}):s.jsx(U0,{icon:Dn,title:"   ",description:"     "})})]}),w&&b&&e&&s.jsx(aA,{isOpen:w,onClose:()=>{m(!1),_(null)},attemptId:b,eventId:e,onComplete:A})]})}const Cte={training:{label:" ",icon:Q_},webinar:{label:"",icon:di},workshop:{label:"-",icon:ub},exam:{label:"",icon:Pa},other:{label:"",icon:Vs}},T5={draft:{label:"",tone:"text-white bg-slate-500",ring:"ring-slate-500",dot:"bg-slate-500",Icon:Y_},published:{label:"",tone:"text-white bg-emerald-500",ring:"ring-emerald-500",dot:"bg-emerald-500",Icon:Xn},active:{label:"",tone:"text-emerald-700 bg-emerald-50",ring:"ring-emerald-200",dot:"bg-emerald-500",Icon:()=>s.jsx("div",{className:"h-3.5 w-3.5 rounded-full bg-emerald-500"})},ongoing:{label:"",tone:"text-indigo-700 bg-indigo-50",ring:"ring-indigo-200",dot:"bg-indigo-500",Icon:Er},completed:{label:"",tone:"text-white bg-blue-500",ring:"ring-blue-500",dot:"bg-blue-500",Icon:Pa},cancelled:{label:"",tone:"text-white bg-rose-500",ring:"ring-rose-500",dot:"bg-rose-500",Icon:ds}};function Hu(...e){return e.filter(Boolean).join(" ")}function Ate(e){const t=e.start_date||e.date_time||e.created_at||"",r=new Date(t);return isNaN(r.getTime())?null:r}function kte(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function Dte(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Ste(e){const t=new Date(e);return t.setHours(23,59,59,999),t}function Bte(e){if(!e)return{badge:null,now:!1};const t=new Date,r=Dte(t),a=Ste(t),n=new Date(r.getTime()+24*3600*1e3),i=e>=r&&e<=a,l=kte(e,n),o=Math.abs((e.getTime()-t.getTime())/6e4),c=i&&o<=60;return{badge:c?" ":i?"":l?"":null,now:c}}function Fte({date:e,tone:t="slate"}){if(!e)return s.jsxs("div",{className:"rounded-xl bg-slate-50 px-4 py-3 text-center ring-1 ring-slate-200",children:[s.jsx("div",{className:"text-[11px] text-slate-500",children:""}),s.jsx("div",{className:"text-sm font-semibold text-slate-700",children:" "})]});const r=e.toLocaleDateString("ru-RU",{day:"2-digit"}),a=e.toLocaleDateString("ru-RU",{month:"long"}),n=new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit"}).format(e),{badge:i,now:l}=Bte(e),o=a.endsWith("")?a.slice(0,-1)+"":a,c=t==="mint"?"from-emerald-50 to-emerald-100 ring-emerald-200":t==="ocean"?"from-sky-50 to-indigo-100 ring-sky-200":t==="lavender"?"from-indigo-50 to-fuchsia-100 ring-indigo-200":t==="sunset"?"from-amber-50 to-rose-100 ring-amber-200":t==="sand"?"from-amber-50 to-yellow-100 ring-amber-200":t==="emerald"?"from-emerald-50 to-emerald-100 ring-emerald-200":t==="rose"?"from-rose-50 to-rose-100 ring-rose-200":t==="amber"?"from-amber-50 to-amber-100 ring-amber-200":t==="indigo"?"from-indigo-50 to-indigo-100 ring-indigo-200":t==="teal"?"from-teal-50 to-teal-100 ring-teal-200":t==="purple"?"from-purple-50 to-purple-100 ring-purple-200":"from-slate-50 to-slate-100 ring-slate-200";return s.jsxs("div",{className:`rounded-2xl ring-1 px-4 py-3 bg-gradient-to-br ${c} shadow-sm text-center relative`,children:[i&&s.jsx("div",{className:`absolute -top-1 -right-1 inline-flex items-center gap-1 rounded-full px-2 py-1 text-[10px] font-semibold text-white shadow-lg
          ${l?"bg-rose-600":"bg-slate-600"}`,children:i}),s.jsx("div",{className:"flex items-end justify-center gap-1 leading-none",children:s.jsx("span",{className:"text-3xl md:text-4xl font-extrabold text-slate-900",children:r})}),s.jsx("div",{className:"mt-1 text-[14px] font-medium text-slate-500",children:o}),s.jsx("div",{className:"mt-2 text-[12px] font-semibold text-slate-900",children:n})]})}const Tte={training:"emerald",webinar:"ocean",workshop:"purple",exam:"rose",other:"amber"},Mte={draft:"slate",published:"mint",active:"mint",ongoing:"lavender",completed:"ocean",cancelled:"sunset"};function Rte(e){return Mte[e.status]??(e.type?Tte[e.type]:"slate")}function Ote(e){return{ocean:"ir-ocean",mint:"ir-mint",lavender:"ir-lavender",sunset:"ir-sunset",sand:"ir-sand",slate:"ir-slate",emerald:"ir-emerald",rose:"ir-rose",amber:"ir-amber",indigo:"ir-indigo",teal:"ir-teal",purple:"ir-purple"}[e]}function Pte(e,t){let r=e;return(!r||r==="other")&&(t!=null&&t.name_ru)&&(r={"-":"training",:"webinar","-":"workshop",:"exam"}[t.name_ru]||"other"),{training:"bg-blue-500 text-white ring-blue-500",webinar:"bg-blue-100 text-blue-700 ring-blue-200",workshop:"bg-purple-100 text-purple-700 ring-purple-200",exam:"bg-rose-100 text-rose-700 ring-rose-200",other:"bg-amber-100 text-amber-700 ring-amber-200"}[r]||"bg-slate-100 text-slate-700 ring-slate-200"}function Lte({event:e,index:t=0,canCreateEvents:r,onNavigateToEvent:a,onEditEvent:n,onDeleteEvent:i}){var j,D;const{userProfile:l}=st(),o=Qt(),[c,d]=E.useState(!1),x=Ate(e),u=T5[e.status]||T5.draft,f=()=>{var O;const R=(l==null?void 0:l.role)==="administrator",M=((O=e.event_types)==null?void 0:O.name)==="exam_talent_reserve";R&&M?o(`/expert-exam/${e.id}`):a==null||a(e.id)},{label:h,tone:p,ring:g,Icon:y}=u,v=E.useMemo(()=>{var R,M,O;return e.type?Cte[e.type]||{label:((R=e.event_types)==null?void 0:R.name_ru)||"",icon:Vs}:((M=e.event_types)==null?void 0:M.name)==="exam_talent_reserve"?{label:"",icon:Pa}:{label:((O=e.event_types)==null?void 0:O.name_ru)||"",icon:Vs}},[(j=e.event_types)==null?void 0:j.name,(D=e.event_types)==null?void 0:D.name_ru,e.type]),w=E.useMemo(()=>Pte(e.type||"other",e.event_types||void 0),[e.event_types,e.type]),m=Rte(e),b=v.icon,_=(e.location||"").toLowerCase().includes("zoom"),C=e.test_completed_count!==void 0||e.test_pending_review_count!==void 0||e.test_not_passed_count!==void 0;return s.jsxs("article",{className:Hu("ir-card ir-ring",Ote(m),"group relative flex h-full min-w-[260px] flex-col overflow-hidden rounded-[26px]","border border-white/40 bg-white/70 p-5 shadow-[0_28px_60px_-36px_rgba(15,23,42,0.55)] backdrop-blur-2xl","transition-all duration-300 hover:-translate-y-1 hover:shadow-[0_48px_80px_-42px_rgba(15,23,42,0.45)]"),style:{animationDelay:`${t*40}ms`},children:[s.jsx("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.18),transparent_70%)] opacity-0 transition-opacity duration-500 group-hover:opacity-100"}),s.jsxs("div",{className:"relative flex h-full flex-col",children:[s.jsxs("header",{className:"mb-4 flex flex-shrink-0 items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex min-w-0 flex-col gap-3",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[(()=>{const R=!h,M=Hu("inline-flex items-center gap-1.5 text-[10px] font-semibold ring-1 shadow-sm",R?"h-8 w-8 justify-center rounded-xl p-0":"rounded-full px-2.5 py-1",p,g),O=R?"h-4 w-4":"h-3.5 w-3.5";return s.jsxs("span",{className:M,children:[s.jsx(y,{className:Hu(O,e.status==="ongoing"&&"animate-spin")}),!R&&s.jsx("span",{children:h})]})})(),s.jsxs("span",{className:Hu("inline-flex items-center gap-1.5 rounded-xl px-3 py-1 text-[11px] font-semibold ring-1 shadow-sm backdrop-blur-sm",w),children:[s.jsx(b,{className:"h-3.5 w-3.5"}),s.jsx("span",{className:"truncate",children:v.label})]})]}),s.jsx("h3",{className:"line-clamp-2 text-lg font-semibold leading-tight text-slate-900",children:e.title}),e.location&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs font-medium text-slate-500",children:[_?s.jsx(sA,{className:"h-4 w-4 text-sky-500"}):s.jsx(nr,{className:"h-3.5 w-3.5"}),s.jsx("span",{className:"truncate",title:e.location,children:e.location})]})]}),s.jsx("div",{className:"w-[112px] shrink-0",children:s.jsx(Fte,{date:x,tone:m})})]}),s.jsxs("div",{className:"flex-1",children:[e.description&&s.jsx("div",{className:"mb-4 rounded-[20px] border border-slate-200/50 bg-slate-50/70 p-4 backdrop-blur-sm",children:s.jsx("p",{className:"line-clamp-3 text-sm leading-relaxed text-slate-600",children:e.description})}),C&&s.jsxs("div",{className:"mb-4 rounded-[20px] border border-slate-200/50 bg-white/60 p-4 backdrop-blur-sm",children:[s.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-700",children:" "}),e.test_pass_percent!==void 0&&s.jsxs("span",{className:"text-xs font-medium text-slate-500",children:[" : ",e.test_pass_percent,"%"]})]}),s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.test_completed_count!==void 0&&s.jsxs("div",{className:"flex items-center gap-2 rounded-xl bg-emerald-50/80 px-3 py-2 text-xs font-medium text-emerald-700 ring-1 ring-emerald-200",children:[s.jsx(Pa,{className:"h-3.5 w-3.5"}),s.jsxs("span",{children:[": ",e.test_completed_count]})]}),e.test_not_passed_count!==void 0&&e.test_not_passed_count>0&&s.jsxs("div",{className:"flex items-center gap-2 rounded-xl bg-rose-50/80 px-3 py-2 text-xs font-medium text-rose-600 ring-1 ring-rose-200",children:[s.jsx(ds,{className:"h-3.5 w-3.5"}),s.jsxs("span",{children:[" : ",e.test_not_passed_count]})]}),e.test_pending_review_count!==void 0&&e.test_pending_review_count>0&&s.jsxs("div",{className:"flex items-center gap-2 rounded-xl bg-amber-50/80 px-3 py-2 text-xs font-medium text-amber-600 ring-1 ring-amber-200",children:[s.jsx(wr,{className:"h-3.5 w-3.5"}),s.jsxs("span",{children:[" : ",e.test_pending_review_count]})]})]})]})]}),s.jsx("footer",{className:"mt-auto flex-shrink-0",children:r?s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{className:"text-[10px] font-medium text-slate-400",children:[": ",e.created_at?(()=>{const R=new Date(e.created_at),M=R.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}),O=new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit"}).format(R);return`${M} ${O}`})():"  "]}),s.jsxs("div",{className:"flex items-center gap-2",children:[(e.test_pending_review_count??0)>0&&s.jsxs("button",{onClick:()=>d(!0),className:"btn-warning",title:" ",children:[s.jsx(wr,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:e.test_pending_review_count})]}),s.jsx("button",{onClick:()=>n==null?void 0:n(e.id),className:"btn-neutral",title:"",children:s.jsx(ER,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>i==null?void 0:i(e.id),className:"btn-danger",title:"",children:s.jsx(Zr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:f,className:"btn-primary",title:"",children:s.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium",children:["",s.jsx(io,{className:"h-4 w-4"})]})})]})]}):s.jsxs("button",{onClick:f,className:"group/button relative w-full justify-center overflow-hidden rounded-2xl bg-gradient-to-r from-emerald-500 via-teal-500 to-emerald-600 py-3 px-4 text-white shadow-sm transition-all duration-300 hover:from-emerald-600 hover:via-teal-600 hover:to-emerald-700 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2",title:"",children:[s.jsx("div",{className:"absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/40 to-transparent opacity-0 transition-all duration-500 group-hover/button:translate-x-full group-hover/button:opacity-100"}),s.jsxs("span",{className:"relative z-10 inline-flex items-center justify-center gap-2 text-sm font-medium",children:["",s.jsx(io,{className:"h-4 w-4 transition-transform duration-300 group-hover/button:translate-x-0.5"})]})]})})]}),c&&s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto m-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["  - ",e.title]}),s.jsx("button",{onClick:()=>d(!1),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:s.jsx(ds,{className:"h-5 w-5"})})]}),s.jsx("div",{className:"p-6",children:s.jsx(nA,{eventId:e.id,onReviewComplete:()=>d(!1)})})]})})]})}function Ite({onCreateEvent:e,onNavigateToEvent:t,onEditEvent:r}){const{user:a,userProfile:n}=st(),[i,l]=E.useState([]),[o,c]=E.useState(!0),[d,x]=E.useState(null),[u,f]=E.useState(""),[h,p]=E.useState("all"),[g,y]=E.useState("all"),[v,w]=E.useState("start_date"),[m,b]=E.useState("desc"),[_,C]=E.useState("active"),[j,D]=E.useState(!1),[R,M]=E.useState(!1),O=(n==null?void 0:n.role)??(a==null?void 0:a.role)??"employee",B=E.useCallback(async({silent:N=!1}={})=>{var T,S,z;if(a!=null&&a.id){N||c(!0),x(null);try{const W=O==="expert"?"expert":["administrator","moderator","trainer"].includes(O)?"admin":"participant";let k=Z.from("events").select("*, event_types(id, name, name_ru)").order("start_date",{ascending:!1});W==="expert"&&(k=k.contains("expert_emails",[n==null?void 0:n.email])),W==="participant"&&(k=k.select("*, event_types(id, name, name_ru), event_participants!inner(user_id)").eq("event_participants.user_id",a.id).order("start_date",{ascending:!1}));const{data:q,error:A}=await k;if(A)throw A;const I=(q??[]).map(de=>({...de,event_types:de.event_types??null}));if(I.length===0){l([]);return}const V=I.map(de=>de.id).filter(Boolean),H=I.map(de=>de.event_type_id).filter(de=>!!de),[Y,Q,te]=await Promise.all([V.length?Z.from("event_participants").select("event_id").in("event_id",V):Promise.resolve({data:[],error:null}),V.length?Z.from("user_test_attempts").select("event_id, status").in("event_id",V):Promise.resolve({data:[],error:null}),H.length?Z.from("tests").select("event_type_id, passing_score").in("event_type_id",H):Promise.resolve({data:[],error:null})]);if(Y.error)throw Y.error;if(Q.error)throw Q.error;if(te.error)throw te.error;const re=((T=Y.data)==null?void 0:T.reduce((de,ce)=>(ce!=null&&ce.event_id&&(de[ce.event_id]=(de[ce.event_id]??0)+1),de),{}))??{},X={},je={};(S=Q.data)==null||S.forEach(de=>{de!=null&&de.event_id&&(de.status==="completed"&&(X[de.event_id]=(X[de.event_id]??0)+1),de.status==="pending_review"&&(je[de.event_id]=(je[de.event_id]??0)+1))});const J=((z=te.data)==null?void 0:z.reduce((de,ce)=>(ce!=null&&ce.event_type_id&&(ce.event_type_id in de||(de[ce.event_type_id]=ce.passing_score??70)),de),{}))??{},ue=I.map(de=>{const ce=re[de.id]??0,fe=X[de.id]??0,pe=je[de.id]??0,Ne=J[de.event_type_id]??70,ne=Math.max(ce-fe,0);return{...de,participants_count:ce,test_completed_count:fe,test_pending_review_count:pe,test_not_passed_count:ne,test_pass_percent:Ne}});l(ue)}catch(W){console.error("  :",W),x((W==null?void 0:W.message)??"   ")}finally{N||c(!1)}}},[O,a==null?void 0:a.id,n==null?void 0:n.email]);E.useEffect(()=>{a&&B()},[a,B]),E.useCallback(async()=>{M(!0);try{await B({silent:!0})}finally{M(!1)}},[B]);const L=E.useMemo(()=>{let N=[...i];const T=u.trim().toLowerCase();return _==="active"?N=N.filter(S=>["active","published","ongoing","draft"].includes(S.status)):N=N.filter(S=>S.status==="completed"),T&&(N=N.filter(S=>{var z,W,k;return((z=S.title)==null?void 0:z.toLowerCase().includes(T))||((W=S.description)==null?void 0:W.toLowerCase().includes(T))||((k=S.location)==null?void 0:k.toLowerCase().includes(T))})),h!=="all"&&(N=N.filter(S=>S.status===h)),g!=="all"&&(N=N.filter(S=>S.type===g)),N.sort((S,z)=>{let W,k;switch(v){case"title":W=(S.title||"").toLowerCase(),k=(z.title||"").toLowerCase();break;case"participants":W=S.participants_count??0,k=z.participants_count??0;break;case"status":W=S.status||"",k=z.status||"";break;case"created_at":W=new Date(S.created_at||"").getTime(),k=new Date(z.created_at||"").getTime();break;case"start_date":default:W=new Date(S.start_date||S.date_time||"").getTime(),k=new Date(z.start_date||z.date_time||"").getTime();break}const q=W<k?-1:W>k?1:0;return m==="asc"?q:-q}),N},[i,_,u,h,g,v,m]),U=E.useMemo(()=>{const N=i.length,T=i.filter(q=>["active","published","ongoing","draft"].includes(q.status)).length,S=i.filter(q=>q.status==="completed").length,z=i.filter(q=>{const A=new Date(q.start_date||q.date_time||"");return Number.isNaN(A.getTime())?!1:A>=new Date}).length,W=i.reduce((q,A)=>q+(A.participants_count??0),0),k=i.reduce((q,A)=>q+(A.test_pending_review_count??0),0);return{total:N,active:T,completed:S,upcoming:z,participants:W,pendingReviews:k}},[i]);E.useMemo(()=>i.length?` : ${U.active}.   : ${U.pendingReviews}.`:"    ,    .",[U.active,U.pendingReviews,i.length]);const P=()=>{f(""),p("all"),y("all"),w("start_date"),b("desc"),D(!1)};if(o)return s.jsx($te,{});if(d)return s.jsx(zte,{message:d,onRetry:()=>B()});return s.jsxs("div",{className:"space-y-8 pb-safe-bottom",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-600 mt-2",children:["trainer","moderator","administrator"].includes(O)?"    ":"     "})]}),O!=="expert"&&s.jsx("div",{className:"flex items-center gap-3",children:["trainer","moderator","administrator"].includes(O)&&s.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 rounded-2xl bg-gradient-to-r from-emerald-500 to-emerald-600 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:from-emerald-600 hover:to-emerald-700",children:[s.jsx(di,{className:"h-4 w-4"})," "]})})]}),s.jsxs("section",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-4",children:[s.jsx(Wu,{title:" ",value:U.total,icon:s.jsx(di,{className:"h-4 w-4"}),tone:"emerald"}),s.jsx(Wu,{title:" ",value:U.active,icon:s.jsx(Xn,{className:"h-4 w-4"}),tone:"blue"}),s.jsx(Wu,{title:"",value:U.upcoming,icon:s.jsx(io,{className:"h-4 w-4"}),tone:"slate"}),s.jsx(Wu,{title:"  ",value:U.pendingReviews,icon:s.jsx(ar,{className:"h-4 w-4"}),tone:"amber"})]}),s.jsxs("section",{className:"rounded-[28px] border border-white/40 bg-white/80 p-6 shadow-[0_28px_60px_-36px_rgba(15,23,42,0.45)] backdrop-blur-xl",children:[s.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Ia,{className:"absolute left-4 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),s.jsx("input",{type:"search",value:u,onChange:N=>f(N.target.value),placeholder:"  ,   ...",className:"w-full rounded-2xl border border-slate-200 bg-white/70 py-3 pl-11 pr-12 text-sm font-medium text-slate-700 transition focus:border-emerald-400 focus:outline-none focus:ring-4 focus:ring-emerald-100"}),u&&s.jsx("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 flex h-8 w-8 -translate-y-1/2 items-center justify-center rounded-full bg-slate-100 text-slate-500 transition hover:bg-slate-200","aria-label":" ",children:s.jsx(Qe,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsxs("button",{onClick:()=>D(N=>!N),className:"inline-flex items-center gap-2 rounded-2xl border border-slate-200 bg-white/70 px-4 py-2 text-sm font-medium text-slate-700 transition hover:border-emerald-300 hover:text-emerald-700",children:[s.jsx(nR,{className:"h-4 w-4"}),j?" ":""]}),s.jsxs("button",{onClick:P,className:"inline-flex items-center gap-2 rounded-2xl border border-transparent bg-slate-900 px-4 py-2 text-sm font-medium text-white transition hover:bg-slate-800",children:[s.jsx(en,{className:"h-4 w-4"}),""]})]})]}),j&&s.jsxs("div",{className:"mt-5 grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[s.jsx(Gu,{label:"",value:h,onChange:p,options:[{value:"all",label:" "},{value:"draft",label:""},{value:"published",label:""},{value:"active",label:""},{value:"ongoing",label:""},{value:"completed",label:""},{value:"cancelled",label:""}]}),s.jsx(Gu,{label:"",value:g,onChange:y,options:[{value:"all",label:" "},...Object.entries(Ww).map(([N,T])=>({value:N,label:T}))]}),s.jsx(Gu,{label:"",value:v,onChange:N=>w(N),options:[{value:"start_date",label:"  "},{value:"title",label:" "},{value:"participants",label:" "},{value:"status",label:" "},{value:"created_at",label:"  "}]}),s.jsx(Gu,{label:"",value:m,onChange:N=>b(N),options:[{value:"desc",label:" "},{value:"asc",label:" "}]})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[h!=="all"&&s.jsxs(Gg,{onClear:()=>p("all"),children:[": ",h]}),g!=="all"&&s.jsxs(Gg,{onClear:()=>y("all"),children:[": ",Ww[g]??g]}),u&&s.jsxs(Gg,{onClear:()=>f(""),children:[": ",u]})]})]}),s.jsxs("section",{className:"space-y-5",children:[s.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-1 text-sm font-medium text-slate-600",children:[s.jsxs("button",{onClick:()=>C("active"),className:`flex items-center gap-2 rounded-full px-4 py-2 transition ${_==="active"?"bg-white text-slate-900 shadow-sm":"hover:text-slate-900"}`,children:[s.jsx(Xn,{className:"h-4 w-4"}),""]}),s.jsxs("button",{onClick:()=>C("completed"),className:`flex items-center gap-2 rounded-full px-4 py-2 transition ${_==="completed"?"bg-white text-slate-900 shadow-sm":"hover:text-slate-900"}`,children:[s.jsx(Pa,{className:"h-4 w-4"}),""]})]}),L.length===0?s.jsx(Ute,{hasEvents:i.length>0,canCreate:["trainer","moderator","administrator"].includes(O),onCreateEvent:e}):s.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:L.map((N,T)=>s.jsx(Lte,{event:N,index:T,canCreateEvents:["trainer","moderator","administrator"].includes(O),onNavigateToEvent:t,onEditEvent:r,onDeleteEvent:F},N.id))})]})]});async function F(N){if(window.confirm(" ?"))try{const{error:T}=await Z.from("events").delete().eq("id",N);if(T)throw T;await B({silent:!0})}catch(T){console.error("  :",T),alert("   .  .")}}}function Wu({title:e,value:t,icon:r,tone:a}){const i={emerald:{badge:"bg-emerald-500/10 text-emerald-600",border:"border-emerald-500/15"},slate:{badge:"bg-slate-500/10 text-slate-600",border:"border-slate-500/15"},blue:{badge:"bg-sky-500/10 text-sky-600",border:"border-sky-500/15"},amber:{badge:"bg-amber-500/10 text-amber-600",border:"border-amber-500/15"}}[a];return s.jsxs("div",{className:`relative flex min-w-[150px] flex-1 items-center gap-3 overflow-hidden rounded-[22px] border ${i.border} bg-white/80 px-4 py-3 shadow-[0_24px_44px_-32px_rgba(15,23,42,0.5)] backdrop-blur-xl transition-transform duration-300 hover:-translate-y-0.5`,children:[s.jsx("div",{className:`flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl ${i.badge}`,children:r}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:e}),s.jsx("div",{className:"text-lg font-semibold text-slate-900",children:t})]})]})}function Gu({label:e,value:t,onChange:r,options:a}){return s.jsxs("label",{className:"flex flex-col gap-1 text-sm font-medium text-slate-600",children:[s.jsx("span",{children:e}),s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:t,onChange:n=>r(n.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white/80 px-4 py-2 text-sm font-medium text-slate-700 transition focus:border-emerald-400 focus:outline-none focus:ring-4 focus:ring-emerald-100",children:a.map(n=>s.jsx("option",{value:n.value,children:n.label},n.value))}),s.jsx(Jh,{className:"pointer-events-none absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"})]})]})}function Gg({children:e,onClear:t}){return s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-xs font-medium text-slate-600",children:[e,s.jsx("button",{onClick:t,className:"rounded-full p-1 transition hover:bg-slate-200","aria-label":" ",children:s.jsx(Qe,{className:"h-3 w-3"})})]})}function Ute({hasEvents:e,canCreate:t,onCreateEvent:r}){return s.jsxs("div",{className:"flex flex-col items-center justify-center rounded-[32px] border border-dashed border-slate-300 bg-white/70 py-16 text-center shadow-inner",children:[s.jsx("div",{className:"mb-6 flex h-24 w-24 items-center justify-center rounded-3xl bg-slate-100",children:s.jsx(di,{className:"h-12 w-12 text-slate-400"})}),s.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-2",children:e?"    ":"  "}),s.jsx("p",{className:"mb-6 max-w-md text-sm text-slate-600",children:e?"     .":t?"        .":"    ,   ."}),t&&!e&&s.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 rounded-2xl bg-gradient-to-r from-emerald-500 to-emerald-600 px-6 py-3 text-sm font-semibold text-white shadow-sm transition hover:from-emerald-600 hover:to-emerald-700",children:[s.jsx(di,{className:"h-4 w-4"}),"  "]})]})}function $te(){return s.jsxs("div",{className:"space-y-8 animate-pulse",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"h-8 w-48 bg-slate-200 rounded mb-2"}),s.jsx("div",{className:"h-5 w-64 bg-slate-100 rounded"})]}),s.jsx("div",{className:"h-10 w-40 bg-slate-200 rounded-2xl"})]}),s.jsx("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-4",children:Array.from({length:4}).map((e,t)=>s.jsx("div",{className:"h-24 rounded-[22px] bg-slate-100"},t))}),s.jsx("div",{className:"h-40 rounded-[28px] bg-white/70"}),s.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:Array.from({length:3}).map((e,t)=>s.jsx("div",{className:"h-64 rounded-[26px] bg-white/60"},t))})]})}function zte({message:e,onRetry:t}){return s.jsxs("div",{className:"flex flex-col items-center justify-center rounded-[32px] border border-rose-200 bg-rose-50/80 px-8 py-16 text-center",children:[s.jsx("div",{className:"mb-6 flex h-24 w-24 items-center justify-center rounded-full bg-rose-100",children:s.jsx(ar,{className:"h-12 w-12 text-rose-500"})}),s.jsx("h3",{className:"text-xl font-semibold text-rose-700 mb-2",children:" "}),s.jsx("p",{className:"mb-6 max-w-md text-sm text-rose-600",children:e}),s.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 rounded-2xl bg-rose-500 px-6 py-3 text-sm font-semibold text-white shadow-sm transition hover:bg-rose-600",children:[s.jsx(en,{className:"h-4 w-4"})," "]})]})}var tu={},qte=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},iA={},da={};let Ly;const Vte=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];da.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};da.getSymbolTotalCodewords=function(t){return Vte[t]};da.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};da.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');Ly=t};da.isKanjiModeEnabled=function(){return typeof Ly<"u"};da.toSJIS=function(t){return Ly(t)};var mm={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},e.from=function(a,n){if(e.isValid(a))return a;try{return t(a)}catch{return n}}})(mm);function lA(){this.buffer=[],this.length=0}lA.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var Hte=lA;function ru(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}ru.prototype.set=function(e,t,r,a){const n=e*this.size+t;this.data[n]=r,a&&(this.reservedBit[n]=!0)};ru.prototype.get=function(e,t){return this.data[e*this.size+t]};ru.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r};ru.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var Wte=ru,oA={};(function(e){const t=da.getSymbolSize;e.getRowColCoords=function(a){if(a===1)return[];const n=Math.floor(a/7)+2,i=t(a),l=i===145?26:Math.ceil((i-13)/(2*n-2))*2,o=[i-7];for(let c=1;c<n-1;c++)o[c]=o[c-1]-l;return o.push(6),o.reverse()},e.getPositions=function(a){const n=[],i=e.getRowColCoords(a),l=i.length;for(let o=0;o<l;o++)for(let c=0;c<l;c++)o===0&&c===0||o===0&&c===l-1||o===l-1&&c===0||n.push([i[o],i[c]]);return n}})(oA);var cA={};const Gte=da.getSymbolSize,M5=7;cA.getPositions=function(t){const r=Gte(t);return[[0,0],[r-M5,0],[0,r-M5]]};var dA={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},e.from=function(n){return e.isValid(n)?parseInt(n,10):void 0},e.getPenaltyN1=function(n){const i=n.size;let l=0,o=0,c=0,d=null,x=null;for(let u=0;u<i;u++){o=c=0,d=x=null;for(let f=0;f<i;f++){let h=n.get(u,f);h===d?o++:(o>=5&&(l+=t.N1+(o-5)),d=h,o=1),h=n.get(f,u),h===x?c++:(c>=5&&(l+=t.N1+(c-5)),x=h,c=1)}o>=5&&(l+=t.N1+(o-5)),c>=5&&(l+=t.N1+(c-5))}return l},e.getPenaltyN2=function(n){const i=n.size;let l=0;for(let o=0;o<i-1;o++)for(let c=0;c<i-1;c++){const d=n.get(o,c)+n.get(o,c+1)+n.get(o+1,c)+n.get(o+1,c+1);(d===4||d===0)&&l++}return l*t.N2},e.getPenaltyN3=function(n){const i=n.size;let l=0,o=0,c=0;for(let d=0;d<i;d++){o=c=0;for(let x=0;x<i;x++)o=o<<1&2047|n.get(d,x),x>=10&&(o===1488||o===93)&&l++,c=c<<1&2047|n.get(x,d),x>=10&&(c===1488||c===93)&&l++}return l*t.N3},e.getPenaltyN4=function(n){let i=0;const l=n.data.length;for(let c=0;c<l;c++)i+=n.data[c];return Math.abs(Math.ceil(i*100/l/5)-10)*t.N4};function r(a,n,i){switch(a){case e.Patterns.PATTERN000:return(n+i)%2===0;case e.Patterns.PATTERN001:return n%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(n+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return n*i%2+n*i%3===0;case e.Patterns.PATTERN110:return(n*i%2+n*i%3)%2===0;case e.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}e.applyMask=function(n,i){const l=i.size;for(let o=0;o<l;o++)for(let c=0;c<l;c++)i.isReserved(c,o)||i.xor(c,o,r(n,c,o))},e.getBestMask=function(n,i){const l=Object.keys(e.Patterns).length;let o=0,c=1/0;for(let d=0;d<l;d++){i(d),e.applyMask(d,n);const x=e.getPenaltyN1(n)+e.getPenaltyN2(n)+e.getPenaltyN3(n)+e.getPenaltyN4(n);e.applyMask(d,n),x<c&&(c=x,o=d)}return o}})(dA);var gm={};const $i=mm,Yu=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Xu=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];gm.getBlocksCount=function(t,r){switch(r){case $i.L:return Yu[(t-1)*4+0];case $i.M:return Yu[(t-1)*4+1];case $i.Q:return Yu[(t-1)*4+2];case $i.H:return Yu[(t-1)*4+3];default:return}};gm.getTotalCodewordsCount=function(t,r){switch(r){case $i.L:return Xu[(t-1)*4+0];case $i.M:return Xu[(t-1)*4+1];case $i.Q:return Xu[(t-1)*4+2];case $i.H:return Xu[(t-1)*4+3];default:return}};var xA={},pm={};const Fd=new Uint8Array(512),bh=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)Fd[r]=t,bh[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)Fd[r]=Fd[r-255]})();pm.log=function(t){if(t<1)throw new Error("log("+t+")");return bh[t]};pm.exp=function(t){return Fd[t]};pm.mul=function(t,r){return t===0||r===0?0:Fd[bh[t]+bh[r]]};(function(e){const t=pm;e.mul=function(a,n){const i=new Uint8Array(a.length+n.length-1);for(let l=0;l<a.length;l++)for(let o=0;o<n.length;o++)i[l+o]^=t.mul(a[l],n[o]);return i},e.mod=function(a,n){let i=new Uint8Array(a);for(;i.length-n.length>=0;){const l=i[0];for(let c=0;c<n.length;c++)i[c]^=t.mul(n[c],l);let o=0;for(;o<i.length&&i[o]===0;)o++;i=i.slice(o)}return i},e.generateECPolynomial=function(a){let n=new Uint8Array([1]);for(let i=0;i<a;i++)n=e.mul(n,new Uint8Array([1,t.exp(i)]));return n}})(xA);const uA=xA;function Iy(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Iy.prototype.initialize=function(t){this.degree=t,this.genPoly=uA.generateECPolynomial(this.degree)};Iy.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const a=uA.mod(r,this.genPoly),n=this.degree-a.length;if(n>0){const i=new Uint8Array(this.degree);return i.set(a,n),i}return a};var Yte=Iy,fA={},vl={},Uy={};Uy.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var Pn={};const hA="[0-9]+",Xte="[A-Z $%*+\\-./:]+";let Nx="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Nx=Nx.replace(/u/g,"\\u");const Kte="(?:(?![A-Z0-9 $%*+\\-./:]|"+Nx+`)(?:.|[\r
]))+`;Pn.KANJI=new RegExp(Nx,"g");Pn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Pn.BYTE=new RegExp(Kte,"g");Pn.NUMERIC=new RegExp(hA,"g");Pn.ALPHANUMERIC=new RegExp(Xte,"g");const Qte=new RegExp("^"+Nx+"$"),Jte=new RegExp("^"+hA+"$"),Zte=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Pn.testKanji=function(t){return Qte.test(t)};Pn.testNumeric=function(t){return Jte.test(t)};Pn.testAlphanumeric=function(t){return Zte.test(t)};(function(e){const t=Uy,r=Pn;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,l){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?i.ccBits[0]:l<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return r.testNumeric(i)?e.NUMERIC:r.testAlphanumeric(i)?e.ALPHANUMERIC:r.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function a(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+n)}}e.from=function(i,l){if(e.isValid(i))return i;try{return a(i)}catch{return l}}})(vl);(function(e){const t=da,r=gm,a=mm,n=vl,i=Uy,l=7973,o=t.getBCHDigit(l);function c(f,h,p){for(let g=1;g<=40;g++)if(h<=e.getCapacity(g,p,f))return g}function d(f,h){return n.getCharCountIndicator(f,h)+4}function x(f,h){let p=0;return f.forEach(function(g){const y=d(g.mode,h);p+=y+g.getBitsLength()}),p}function u(f,h){for(let p=1;p<=40;p++)if(x(f,p)<=e.getCapacity(p,h,n.MIXED))return p}e.from=function(h,p){return i.isValid(h)?parseInt(h,10):p},e.getCapacity=function(h,p,g){if(!i.isValid(h))throw new Error("Invalid QR Code version");typeof g>"u"&&(g=n.BYTE);const y=t.getSymbolTotalCodewords(h),v=r.getTotalCodewordsCount(h,p),w=(y-v)*8;if(g===n.MIXED)return w;const m=w-d(g,h);switch(g){case n.NUMERIC:return Math.floor(m/10*3);case n.ALPHANUMERIC:return Math.floor(m/11*2);case n.KANJI:return Math.floor(m/13);case n.BYTE:default:return Math.floor(m/8)}},e.getBestVersionForData=function(h,p){let g;const y=a.from(p,a.M);if(Array.isArray(h)){if(h.length>1)return u(h,y);if(h.length===0)return 1;g=h[0]}else g=h;return c(g.mode,g.getLength(),y)},e.getEncodedBits=function(h){if(!i.isValid(h)||h<7)throw new Error("Invalid QR Code version");let p=h<<12;for(;t.getBCHDigit(p)-o>=0;)p^=l<<t.getBCHDigit(p)-o;return h<<12|p}})(fA);var mA={};const K1=da,gA=1335,ere=21522,R5=K1.getBCHDigit(gA);mA.getEncodedBits=function(t,r){const a=t.bit<<3|r;let n=a<<10;for(;K1.getBCHDigit(n)-R5>=0;)n^=gA<<K1.getBCHDigit(n)-R5;return(a<<10|n)^ere};var pA={};const tre=vl;function Jc(e){this.mode=tre.NUMERIC,this.data=e.toString()}Jc.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Jc.prototype.getLength=function(){return this.data.length};Jc.prototype.getBitsLength=function(){return Jc.getBitsLength(this.data.length)};Jc.prototype.write=function(t){let r,a,n;for(r=0;r+3<=this.data.length;r+=3)a=this.data.substr(r,3),n=parseInt(a,10),t.put(n,10);const i=this.data.length-r;i>0&&(a=this.data.substr(r),n=parseInt(a,10),t.put(n,i*3+1))};var rre=Jc;const sre=vl,Yg=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Zc(e){this.mode=sre.ALPHANUMERIC,this.data=e}Zc.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};Zc.prototype.getLength=function(){return this.data.length};Zc.prototype.getBitsLength=function(){return Zc.getBitsLength(this.data.length)};Zc.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let a=Yg.indexOf(this.data[r])*45;a+=Yg.indexOf(this.data[r+1]),t.put(a,11)}this.data.length%2&&t.put(Yg.indexOf(this.data[r]),6)};var are=Zc;const nre=vl;function e0(e){this.mode=nre.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}e0.getBitsLength=function(t){return t*8};e0.prototype.getLength=function(){return this.data.length};e0.prototype.getBitsLength=function(){return e0.getBitsLength(this.data.length)};e0.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var ire=e0;const lre=vl,ore=da;function t0(e){this.mode=lre.KANJI,this.data=e}t0.getBitsLength=function(t){return t*13};t0.prototype.getLength=function(){return this.data.length};t0.prototype.getBitsLength=function(){return t0.getBitsLength(this.data.length)};t0.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=ore.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),e.put(r,13)}};var cre=t0,vA={exports:{}};(function(e){var t={single_source_shortest_paths:function(r,a,n){var i={},l={};l[a]=0;var o=t.PriorityQueue.make();o.push(a,0);for(var c,d,x,u,f,h,p,g,y;!o.empty();){c=o.pop(),d=c.value,u=c.cost,f=r[d]||{};for(x in f)f.hasOwnProperty(x)&&(h=f[x],p=u+h,g=l[x],y=typeof l[x]>"u",(y||g>p)&&(l[x]=p,o.push(x,p),i[x]=d))}if(typeof n<"u"&&typeof l[n]>"u"){var v=["Could not find a path from ",a," to ",n,"."].join("");throw new Error(v)}return i},extract_shortest_path_from_predecessor_list:function(r,a){for(var n=[],i=a;i;)n.push(i),r[i],i=r[i];return n.reverse(),n},find_path:function(r,a,n){var i=t.single_source_shortest_paths(r,a,n);return t.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(r){var a=t.PriorityQueue,n={},i;r=r||{};for(i in a)a.hasOwnProperty(i)&&(n[i]=a[i]);return n.queue=[],n.sorter=r.sorter||a.default_sorter,n},default_sorter:function(r,a){return r.cost-a.cost},push:function(r,a){var n={value:r,cost:a};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(vA);var dre=vA.exports;(function(e){const t=vl,r=rre,a=are,n=ire,i=cre,l=Pn,o=da,c=dre;function d(v){return unescape(encodeURIComponent(v)).length}function x(v,w,m){const b=[];let _;for(;(_=v.exec(m))!==null;)b.push({data:_[0],index:_.index,mode:w,length:_[0].length});return b}function u(v){const w=x(l.NUMERIC,t.NUMERIC,v),m=x(l.ALPHANUMERIC,t.ALPHANUMERIC,v);let b,_;return o.isKanjiModeEnabled()?(b=x(l.BYTE,t.BYTE,v),_=x(l.KANJI,t.KANJI,v)):(b=x(l.BYTE_KANJI,t.BYTE,v),_=[]),w.concat(m,b,_).sort(function(j,D){return j.index-D.index}).map(function(j){return{data:j.data,mode:j.mode,length:j.length}})}function f(v,w){switch(w){case t.NUMERIC:return r.getBitsLength(v);case t.ALPHANUMERIC:return a.getBitsLength(v);case t.KANJI:return i.getBitsLength(v);case t.BYTE:return n.getBitsLength(v)}}function h(v){return v.reduce(function(w,m){const b=w.length-1>=0?w[w.length-1]:null;return b&&b.mode===m.mode?(w[w.length-1].data+=m.data,w):(w.push(m),w)},[])}function p(v){const w=[];for(let m=0;m<v.length;m++){const b=v[m];switch(b.mode){case t.NUMERIC:w.push([b,{data:b.data,mode:t.ALPHANUMERIC,length:b.length},{data:b.data,mode:t.BYTE,length:b.length}]);break;case t.ALPHANUMERIC:w.push([b,{data:b.data,mode:t.BYTE,length:b.length}]);break;case t.KANJI:w.push([b,{data:b.data,mode:t.BYTE,length:d(b.data)}]);break;case t.BYTE:w.push([{data:b.data,mode:t.BYTE,length:d(b.data)}])}}return w}function g(v,w){const m={},b={start:{}};let _=["start"];for(let C=0;C<v.length;C++){const j=v[C],D=[];for(let R=0;R<j.length;R++){const M=j[R],O=""+C+R;D.push(O),m[O]={node:M,lastCount:0},b[O]={};for(let B=0;B<_.length;B++){const L=_[B];m[L]&&m[L].node.mode===M.mode?(b[L][O]=f(m[L].lastCount+M.length,M.mode)-f(m[L].lastCount,M.mode),m[L].lastCount+=M.length):(m[L]&&(m[L].lastCount=M.length),b[L][O]=f(M.length,M.mode)+4+t.getCharCountIndicator(M.mode,w))}}_=D}for(let C=0;C<_.length;C++)b[_[C]].end=0;return{map:b,table:m}}function y(v,w){let m;const b=t.getBestModeForData(v);if(m=t.from(w,b),m!==t.BYTE&&m.bit<b.bit)throw new Error('"'+v+'" cannot be encoded with mode '+t.toString(m)+`.
 Suggested mode is: `+t.toString(b));switch(m===t.KANJI&&!o.isKanjiModeEnabled()&&(m=t.BYTE),m){case t.NUMERIC:return new r(v);case t.ALPHANUMERIC:return new a(v);case t.KANJI:return new i(v);case t.BYTE:return new n(v)}}e.fromArray=function(w){return w.reduce(function(m,b){return typeof b=="string"?m.push(y(b,null)):b.data&&m.push(y(b.data,b.mode)),m},[])},e.fromString=function(w,m){const b=u(w,o.isKanjiModeEnabled()),_=p(b),C=g(_,m),j=c.find_path(C.map,"start","end"),D=[];for(let R=1;R<j.length-1;R++)D.push(C.table[j[R]].node);return e.fromArray(h(D))},e.rawSplit=function(w){return e.fromArray(u(w,o.isKanjiModeEnabled()))}})(pA);const vm=da,Xg=mm,xre=Hte,ure=Wte,fre=oA,hre=cA,Q1=dA,J1=gm,mre=Yte,yh=fA,gre=mA,pre=vl,Kg=pA;function vre(e,t){const r=e.size,a=hre.getPositions(t);for(let n=0;n<a.length;n++){const i=a[n][0],l=a[n][1];for(let o=-1;o<=7;o++)if(!(i+o<=-1||r<=i+o))for(let c=-1;c<=7;c++)l+c<=-1||r<=l+c||(o>=0&&o<=6&&(c===0||c===6)||c>=0&&c<=6&&(o===0||o===6)||o>=2&&o<=4&&c>=2&&c<=4?e.set(i+o,l+c,!0,!0):e.set(i+o,l+c,!1,!0))}}function bre(e){const t=e.size;for(let r=8;r<t-8;r++){const a=r%2===0;e.set(r,6,a,!0),e.set(6,r,a,!0)}}function yre(e,t){const r=fre.getPositions(t);for(let a=0;a<r.length;a++){const n=r[a][0],i=r[a][1];for(let l=-2;l<=2;l++)for(let o=-2;o<=2;o++)l===-2||l===2||o===-2||o===2||l===0&&o===0?e.set(n+l,i+o,!0,!0):e.set(n+l,i+o,!1,!0)}}function wre(e,t){const r=e.size,a=yh.getEncodedBits(t);let n,i,l;for(let o=0;o<18;o++)n=Math.floor(o/3),i=o%3+r-8-3,l=(a>>o&1)===1,e.set(n,i,l,!0),e.set(i,n,l,!0)}function Qg(e,t,r){const a=e.size,n=gre.getEncodedBits(t,r);let i,l;for(i=0;i<15;i++)l=(n>>i&1)===1,i<6?e.set(i,8,l,!0):i<8?e.set(i+1,8,l,!0):e.set(a-15+i,8,l,!0),i<8?e.set(8,a-i-1,l,!0):i<9?e.set(8,15-i-1+1,l,!0):e.set(8,15-i-1,l,!0);e.set(a-8,8,1,!0)}function Ere(e,t){const r=e.size;let a=-1,n=r-1,i=7,l=0;for(let o=r-1;o>0;o-=2)for(o===6&&o--;;){for(let c=0;c<2;c++)if(!e.isReserved(n,o-c)){let d=!1;l<t.length&&(d=(t[l]>>>i&1)===1),e.set(n,o-c,d),i--,i===-1&&(l++,i=7)}if(n+=a,n<0||r<=n){n-=a,a=-a;break}}}function _re(e,t,r){const a=new xre;r.forEach(function(c){a.put(c.mode.bit,4),a.put(c.getLength(),pre.getCharCountIndicator(c.mode,e)),c.write(a)});const n=vm.getSymbolTotalCodewords(e),i=J1.getTotalCodewordsCount(e,t),l=(n-i)*8;for(a.getLengthInBits()+4<=l&&a.put(0,4);a.getLengthInBits()%8!==0;)a.putBit(0);const o=(l-a.getLengthInBits())/8;for(let c=0;c<o;c++)a.put(c%2?17:236,8);return jre(a,e,t)}function jre(e,t,r){const a=vm.getSymbolTotalCodewords(t),n=J1.getTotalCodewordsCount(t,r),i=a-n,l=J1.getBlocksCount(t,r),o=a%l,c=l-o,d=Math.floor(a/l),x=Math.floor(i/l),u=x+1,f=d-x,h=new mre(f);let p=0;const g=new Array(l),y=new Array(l);let v=0;const w=new Uint8Array(e.buffer);for(let j=0;j<l;j++){const D=j<c?x:u;g[j]=w.slice(p,p+D),y[j]=h.encode(g[j]),p+=D,v=Math.max(v,D)}const m=new Uint8Array(a);let b=0,_,C;for(_=0;_<v;_++)for(C=0;C<l;C++)_<g[C].length&&(m[b++]=g[C][_]);for(_=0;_<f;_++)for(C=0;C<l;C++)m[b++]=y[C][_];return m}function Nre(e,t,r,a){let n;if(Array.isArray(e))n=Kg.fromArray(e);else if(typeof e=="string"){let d=t;if(!d){const x=Kg.rawSplit(e);d=yh.getBestVersionForData(x,r)}n=Kg.fromString(e,d||40)}else throw new Error("Invalid data");const i=yh.getBestVersionForData(n,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const l=_re(t,r,n),o=vm.getSymbolSize(t),c=new ure(o);return vre(c,t),bre(c),yre(c,t),Qg(c,r,0),t>=7&&wre(c,t),Ere(c,l),isNaN(a)&&(a=Q1.getBestMask(c,Qg.bind(null,c,r))),Q1.applyMask(a,c),Qg(c,r,a),{modules:c,version:t,errorCorrectionLevel:r,maskPattern:a,segments:n}}iA.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let a=Xg.M,n,i;return typeof r<"u"&&(a=Xg.from(r.errorCorrectionLevel,Xg.M),n=yh.from(r.version),i=Q1.from(r.maskPattern),r.toSJISFunc&&vm.setToSJISFunction(r.toSJISFunc)),Nre(t,n,a,i)};var bA={},$y={};(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let a=r.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+r);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(i){return[i,i]}))),a.length===6&&a.push("F","F");const n=parseInt(a.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+a.slice(0,6).join("")}}e.getOptions=function(a){a||(a={}),a.color||(a.color={});const n=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,i=a.width&&a.width>=21?a.width:void 0,l=a.scale||4;return{width:i,scale:i?4:l,margin:n,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},e.getScale=function(a,n){return n.width&&n.width>=a+n.margin*2?n.width/(a+n.margin*2):n.scale},e.getImageWidth=function(a,n){const i=e.getScale(a,n);return Math.floor((a+n.margin*2)*i)},e.qrToImageData=function(a,n,i){const l=n.modules.size,o=n.modules.data,c=e.getScale(l,i),d=Math.floor((l+i.margin*2)*c),x=i.margin*c,u=[i.color.light,i.color.dark];for(let f=0;f<d;f++)for(let h=0;h<d;h++){let p=(f*d+h)*4,g=i.color.light;if(f>=x&&h>=x&&f<d-x&&h<d-x){const y=Math.floor((f-x)/c),v=Math.floor((h-x)/c);g=u[o[y*l+v]?1:0]}a[p++]=g.r,a[p++]=g.g,a[p++]=g.b,a[p]=g.a}}})($y);(function(e){const t=$y;function r(n,i,l){n.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=l,i.width=l,i.style.height=l+"px",i.style.width=l+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,l,o){let c=o,d=l;typeof c>"u"&&(!l||!l.getContext)&&(c=l,l=void 0),l||(d=a()),c=t.getOptions(c);const x=t.getImageWidth(i.modules.size,c),u=d.getContext("2d"),f=u.createImageData(x,x);return t.qrToImageData(f.data,i,c),r(u,d,x),u.putImageData(f,0,0),d},e.renderToDataURL=function(i,l,o){let c=o;typeof c>"u"&&(!l||!l.getContext)&&(c=l,l=void 0),c||(c={});const d=e.render(i,l,c),x=c.type||"image/png",u=c.rendererOpts||{};return d.toDataURL(x,u.quality)}})(bA);var yA={};const Cre=$y;function O5(e,t){const r=e.a/255,a=t+'="'+e.hex+'"';return r<1?a+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':a}function Jg(e,t,r){let a=e+t;return typeof r<"u"&&(a+=" "+r),a}function Are(e,t,r){let a="",n=0,i=!1,l=0;for(let o=0;o<e.length;o++){const c=Math.floor(o%t),d=Math.floor(o/t);!c&&!i&&(i=!0),e[o]?(l++,o>0&&c>0&&e[o-1]||(a+=i?Jg("M",c+r,.5+d+r):Jg("m",n,0),n=0,i=!1),c+1<t&&e[o+1]||(a+=Jg("h",l),l=0)):n++}return a}yA.render=function(t,r,a){const n=Cre.getOptions(r),i=t.modules.size,l=t.modules.data,o=i+n.margin*2,c=n.color.light.a?"<path "+O5(n.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",d="<path "+O5(n.color.dark,"stroke")+' d="'+Are(l,i,n.margin)+'"/>',x='viewBox="0 0 '+o+" "+o+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+x+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof a=="function"&&a(null,f),f};const kre=qte,Z1=iA,wA=bA,Dre=yA;function zy(e,t,r,a,n){const i=[].slice.call(arguments,1),l=i.length,o=typeof i[l-1]=="function";if(!o&&!kre())throw new Error("Callback required as last argument");if(o){if(l<2)throw new Error("Too few arguments provided");l===2?(n=r,r=t,t=a=void 0):l===3&&(t.getContext&&typeof n>"u"?(n=a,a=void 0):(n=a,a=r,r=t,t=void 0))}else{if(l<1)throw new Error("Too few arguments provided");return l===1?(r=t,t=a=void 0):l===2&&!t.getContext&&(a=r,r=t,t=void 0),new Promise(function(c,d){try{const x=Z1.create(r,a);c(e(x,t,a))}catch(x){d(x)}})}try{const c=Z1.create(r,a);n(null,e(c,t,a))}catch(c){n(c)}}tu.create=Z1.create;tu.toCanvas=zy.bind(null,wA.render);tu.toDataURL=zy.bind(null,wA.renderToDataURL);tu.toString=zy.bind(null,function(e,t,r){return Dre.render(e,r)});function Sre({email:e,fullName:t,onClose:r}){const[a,n]=E.useState(""),[i,l]=E.useState(""),[o,c]=E.useState(""),[d,x]=E.useState(!1),[u,f]=E.useState(""),[h,p]=E.useState(!1),[g,y]=E.useState(null),v=async()=>{x(!0),f("");try{const{data:_,error:C}=await Z.functions.invoke("generate-persistent-qr",{body:{email:e}});if(C)throw new Error(C.message||"    QR-");l(_.persistentUrl),c(_.token);const j=await tu.toDataURL(_.persistentUrl,{width:256,margin:2,color:{dark:"#1e293b",light:"#ffffff"}});n(j)}catch(_){f(_.message||"    QR-")}finally{x(!1)}},w=async()=>{x(!0),f("");try{const{data:{user:_}}=await Z.auth.getUser();if(!_)throw new Error("  ");await v()}catch(_){f(_.message||"    "),x(!1)}},m=async(_,C)=>{try{await navigator.clipboard.writeText(_),y(C),setTimeout(()=>y(null),2e3)}catch(j){console.error("  :",j)}},b=()=>{if(!a)return;const _=document.createElement("a");_.download=`qr-${e.replace("@","_")}.png`,_.href=a,_.click()};return E.useEffect(()=>{v()},[e]),s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950/60 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"relative w-full max-w-3xl bg-white rounded-2xl shadow-2xl overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200 bg-gradient-to-r from-slate-50 to-white",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-slate-900 text-white",children:s.jsx(Zh,{size:20})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:" QR-"}),s.jsx("p",{className:"text-xs text-slate-500",children:" "})]})]}),s.jsx("button",{onClick:r,className:"flex h-8 w-8 items-center justify-center rounded-lg text-slate-400 transition hover:bg-slate-100 hover:text-slate-900",children:s.jsx(Qe,{size:20})})]}),s.jsx("div",{className:"px-6 py-3 bg-slate-50 border-b border-slate-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"font-medium text-slate-900",children:t||e}),t&&s.jsx("span",{className:"ml-2 text-slate-500 font-mono text-xs",children:e})]}),s.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-emerald-100 text-emerald-700",children:[s.jsx(co,{size:14}),s.jsx("span",{className:"text-xs font-medium",children:""})]})]})}),u&&s.jsx("div",{className:"mx-6 mt-4 rounded-lg bg-rose-50 border border-rose-200 px-4 py-3 text-sm text-rose-600",children:u}),s.jsx("div",{className:"px-6 py-5",children:d?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 gap-3",children:[s.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-[3px] border-slate-200 border-t-slate-900"}),s.jsx("span",{className:"text-sm text-slate-500",children:" QR-"})]}):a?s.jsxs("div",{className:"grid md:grid-cols-[280px_1fr] gap-6",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"rounded-xl border-2 border-slate-200 bg-white p-4 shadow-sm",children:s.jsx("img",{src:a,alt:"QR-",className:"w-full h-auto rounded-lg"})}),s.jsx("p",{className:"mt-3 text-center text-xs text-slate-500",children:"  "}),s.jsxs("button",{onClick:b,className:"mt-3 w-full flex items-center justify-center gap-2 rounded-lg bg-slate-900 px-4 py-2 text-sm font-medium text-white transition hover:bg-slate-700",children:[s.jsx(Bn,{size:16})," QR"]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"  "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:i,readOnly:!0,className:"flex-1 px-3 py-2 text-sm bg-slate-50 border border-slate-200 rounded-lg text-slate-700 font-mono truncate"}),s.jsx("button",{onClick:()=>m(i,"url"),className:`px-3 py-2 rounded-lg text-sm font-medium transition ${g==="url"?"bg-emerald-100 text-emerald-700 border border-emerald-200":"bg-white border border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:g==="url"?"":s.jsx(Hc,{size:16})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:h?"text":"password",value:o,readOnly:!0,className:"flex-1 px-3 py-2 text-sm bg-slate-50 border border-slate-200 rounded-lg text-slate-700 font-mono"}),s.jsx("button",{onClick:()=>p(!h),className:"px-3 py-2 border border-slate-300 rounded-lg text-slate-700 hover:bg-slate-50 transition",children:h?s.jsx(H_,{size:16}):s.jsx(el,{size:16})}),s.jsx("button",{onClick:()=>m(o,"token"),className:`px-3 py-2 rounded-lg text-sm font-medium transition ${g==="token"?"bg-emerald-100 text-emerald-700 border border-emerald-200":"bg-white border border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:g==="token"?"":s.jsx(Hc,{size:16})})]}),s.jsx("p",{className:"mt-1.5 text-xs text-slate-500",children:"   "})]}),s.jsx("div",{className:"pt-2",children:s.jsxs("button",{onClick:w,disabled:d,className:"w-full flex items-center justify-center gap-2 rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 transition hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(en,{size:16,className:d?"animate-spin":""})," "]})})]})]}):null}),s.jsx("div",{className:"px-6 py-3 bg-slate-50 border-t border-slate-100",children:s.jsx("p",{className:"text-xs text-slate-500 text-center",children:"QR-     "})})]})})}const P5=e=>{if(!e||e===0)return"";if(e<30)return`${e} .`;if(e<365){const l=Math.floor(e/30),o=e%30;return o===0?`${l} .`:`${l} . ${o} .`}const t=Math.floor(e/365),r=e%365,a=Math.floor(r/30),n=r%30;let i=`${t} .`;return a>0&&(i+=` ${a} .`),n>0&&(i+=` ${n} .`),i};function Bre(){const{user:e,userProfile:t}=st(),[r,a]=E.useState([]),[n,i]=E.useState([]),[l,o]=E.useState(!0),[c,d]=E.useState(""),[x,u]=E.useState("all"),[f,h]=E.useState("all"),[p,g]=E.useState("name"),[y,v]=E.useState("asc"),[w,m]=E.useState(!1),[b,_]=E.useState(null),[C,j]=E.useState(null),[D,R]=E.useState(!1),[M,O]=E.useState(null),B=(t==null?void 0:t.role)==="manager",L=(t==null?void 0:t.role)==="trainer",U=(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="moderator",P=B||L||U;E.useEffect(()=>{e&&t&&F()},[e,t]),E.useEffect(()=>{N()},[r,c,x,f,p,y]);const F=async()=>{o(!0);try{let A=Z.from("users").select(`
          id,
          full_name,
          email,
          sap_number,
          phone,
          avatar_url,
          is_active,
          department,
          role,
          work_experience_days,
          is_leaving,
          created_at,
          updated_at,
          last_sign_in_at,
          position:position_id(
            id, 
            name
          ),
          territory:territories!users_territory_id_fkey(
            id, 
            name
          )
        `);(B&&(t!=null&&t.territory_id)||L&&(t!=null&&t.territory_id))&&(A=A.eq("territory_id",t.territory_id));const{data:I,error:V}=await A;if(V)throw console.error("Error fetching employees:",V),V;const H=(I||[]).map(Y=>({...Y,experience:Y.work_experience_days,last_login_at:Y.last_sign_in_at,stats:{total_events:0,completed_events:0,attendance_rate:0,average_test_score:0,pending_tests:0,pending_annual_tests:0}}));a(H),i(H)}catch(A){console.error("Error fetching employees:",A)}finally{o(!1)}},N=()=>{let A=[...r];c&&(A=A.filter(I=>{var V,H,Y;return I.full_name.toLowerCase().includes(c.toLowerCase())||((V=I.email)==null?void 0:V.toLowerCase().includes(c.toLowerCase()))||I.sap_number&&I.sap_number.includes(c)||((H=I.position)==null?void 0:H.name)&&I.position.name.toLowerCase().includes(c.toLowerCase())||((Y=I.territory)==null?void 0:Y.name)&&I.territory.name.toLowerCase().includes(c.toLowerCase())})),x!=="all"&&(A=A.filter(I=>I.role===x)),f!=="all"&&(f==="active"?A=A.filter(I=>I.is_active&&!I.is_leaving):f==="inactive"?A=A.filter(I=>!I.is_active):f==="leaving"&&(A=A.filter(I=>I.is_leaving))),A.sort((I,V)=>{var Q,te,re,X,je,J,ue,de;let H,Y;switch(p){case"name":H=I.full_name.toLowerCase(),Y=V.full_name.toLowerCase();break;case"position":H=((te=(Q=I.position)==null?void 0:Q.name)==null?void 0:te.toLowerCase())||"",Y=((X=(re=V.position)==null?void 0:re.name)==null?void 0:X.toLowerCase())||"";break;case"territory":H=((J=(je=I.territory)==null?void 0:je.name)==null?void 0:J.toLowerCase())||"",Y=((de=(ue=V.territory)==null?void 0:ue.name)==null?void 0:de.toLowerCase())||"";break;case"experience":H=I.experience||0,Y=V.experience||0;break;default:H=I.full_name.toLowerCase(),Y=V.full_name.toLowerCase()}return H<Y?y==="asc"?-1:1:H>Y?y==="asc"?1:-1:0}),i(A)},T=async(A,I)=>{j(A);try{const{error:V}=await Z.from("users").update({is_active:!I}).eq("id",A);if(V)throw V;a(H=>H.map(Y=>Y.id===A?{...Y,is_active:!I}:Y))}catch(V){console.error("Error updating employee status:",V),alert("    ")}finally{j(null)}},S=async(A,I)=>{j(A);try{const{error:V}=await Z.from("users").update({is_leaving:!I}).eq("id",A);if(V)throw V;a(H=>H.map(Y=>Y.id===A?{...Y,is_leaving:!I}:Y))}catch(V){console.error("Error updating leaving status:",V),alert("    ")}finally{j(null)}},z=A=>{_(b===A?null:A)},W=()=>{const I=[["","Email","SAP ","","","","",""].join(","),...n.map(Q=>{var te,re;return[Q.full_name,Q.email||"",Q.sap_number||"",Q.phone||"",((te=Q.position)==null?void 0:te.name)||"",((re=Q.territory)==null?void 0:re.name)||"",P5(Q.experience),Q.is_active?Q.is_leaving?"":"":""].join(",")})].join(`
`),V=new Blob([I],{type:"text/csv;charset=utf-8;"}),H=document.createElement("a"),Y=URL.createObjectURL(V);H.setAttribute("href",Y),H.setAttribute("download","employees.csv"),H.style.visibility="hidden",document.body.appendChild(H),H.click(),document.body.removeChild(H)},k=A=>{O(A),R(!0)},q={total:r.length,active:r.filter(A=>A.is_active&&!A.is_leaving).length,inactive:r.filter(A=>!A.is_active).length,leaving:r.filter(A=>A.is_leaving).length,pendingTests:r.reduce((A,I)=>{var V;return A+(((V=I.stats)==null?void 0:V.pending_tests)||0)},0),pendingAnnualTests:r.reduce((A,I)=>{var V;return A+(((V=I.stats)==null?void 0:V.pending_annual_tests)||0)},0)};return P?l?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-600 mt-1",children:B?"   ":L?"    ":"  "})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:W,className:"flex items-center space-x-2 px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(Bn,{size:20}),s.jsx("span",{children:""})]}),U&&s.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(ax,{size:20}),s.jsx("span",{children:" "})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[s.jsx("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:""}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.total})]}),s.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:s.jsx(nt,{size:20,className:"text-gray-600"})})]})}),s.jsx("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:""}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:q.active})]}),s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:s.jsx(at,{size:20,className:"text-green-600"})})]})}),s.jsx("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:""}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:q.inactive})]}),s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:s.jsx(ds,{size:20,className:"text-red-600"})})]})}),s.jsx("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:""}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:q.leaving})]}),s.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-xl flex items-center justify-center",children:s.jsx(an,{size:20,className:"text-yellow-600"})})]})}),s.jsx("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:" "}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:q.pendingTests})]}),s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:s.jsx(Et,{size:20,className:"text-blue-600"})})]})}),s.jsx("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:" "}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:q.pendingAnnualTests})]}),s.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center",children:s.jsx(Wc,{size:20,className:"text-purple-600"})})]})})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Ia,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"  , email, SAP ,   ...",value:c,onChange:A=>d(A.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("select",{value:x,onChange:A=>u(A.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[160px]",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"employee",children:""}),s.jsx("option",{value:"manager",children:""}),s.jsx("option",{value:"expert",children:""})]}),s.jsxs("select",{value:f,onChange:A=>h(A.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[140px]",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"active",children:""}),s.jsx("option",{value:"inactive",children:""}),s.jsx("option",{value:"leaving",children:""})]}),s.jsxs("button",{onClick:()=>m(!w),className:"px-4 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors flex items-center space-x-2",children:[s.jsx(Jh,{size:20}),s.jsx("span",{children:""})]})]})]}),w&&s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),s.jsxs("select",{value:p,onChange:A=>g(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"name",children:" "}),s.jsx("option",{value:"position",children:" "}),s.jsx("option",{value:"territory",children:" "}),s.jsx("option",{value:"experience",children:" "})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),s.jsxs("select",{value:y,onChange:A=>v(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"asc",children:" "}),s.jsx("option",{value:"desc",children:" "})]})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("button",{onClick:()=>{d(""),u("all"),h("all"),g("name"),v("asc")},className:"w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:" "})})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[" (",n.length,")"]})})}),n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(nt,{size:48,className:"mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-600",children:c||x!=="all"||f!=="all"?"     ":"     "})]}):s.jsxs("div",{className:"divide-y divide-gray-100",children:[s.jsxs("div",{className:"grid grid-cols-6 gap-4 px-6 py-3 bg-gray-50 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[s.jsx("div",{className:"col-span-2",children:""}),s.jsx("div",{children:""}),s.jsx("div",{children:""}),s.jsx("div",{className:"text-center",children:""}),s.jsx("div",{className:"text-center",children:""})]}),n.map(A=>{var I,V,H,Y;return s.jsxs("div",{className:"hover:bg-gray-50",children:[s.jsxs("div",{className:"grid grid-cols-6 gap-4 px-6 py-4 cursor-pointer",onClick:()=>z(A.id),children:[s.jsxs("div",{className:"col-span-2 flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center mr-3 text-blue-600 font-medium",children:A.avatar_url?s.jsx("img",{src:A.avatar_url,alt:A.full_name,className:"w-full h-full object-cover rounded-xl"}):A.full_name.split(" ").map(Q=>Q[0]).join("").toUpperCase()}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[A.full_name,A.is_leaving&&s.jsx("span",{className:"ml-2 text-yellow-600 text-xs px-1.5 py-0.5 bg-yellow-100 rounded-full",children:""})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[A.email,A.sap_number&&`  SAP: ${A.sap_number}`]})]})]}),s.jsx("div",{className:"flex items-center text-sm text-gray-700",children:((I=A.position)==null?void 0:I.name)||"-"}),s.jsx("div",{className:"flex items-center text-sm text-gray-700",children:((V=A.territory)==null?void 0:V.name)||"-"}),s.jsx("div",{className:"flex items-center justify-center",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${A.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.is_active?"":""})}),s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("button",{onClick:Q=>{Q.stopPropagation()},className:"text-gray-400 hover:text-blue-600 transition-colors",title:" ",children:s.jsx(el,{size:16})}),s.jsx("button",{onClick:Q=>{Q.stopPropagation()},className:"text-gray-400 hover:text-blue-600 transition-colors",title:"",children:s.jsx(Dn,{size:16})}),U&&s.jsx("button",{onClick:Q=>{Q.stopPropagation(),T(A.id,A.is_active)},disabled:!!C,className:"text-gray-400 hover:text-red-600 transition-colors",title:A.is_active?"":"",children:C===A.id?s.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):A.is_active?s.jsx(ds,{size:16}):s.jsx(at,{size:16})})]})]}),b===A.id&&s.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:" "}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(Ao,{size:14,className:"text-gray-400 mr-2"}),s.jsx("a",{href:`mailto:${A.email}`,className:"text-blue-600 hover:underline",children:A.email})]}),A.phone&&s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(tl,{size:14,className:"text-gray-400 mr-2"}),s.jsx("a",{href:`tel:${A.phone}`,className:"text-blue-600 hover:underline",children:A.phone})]}),A.sap_number&&s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(qt,{size:14,className:"text-gray-400 mr-2"}),s.jsxs("span",{className:"text-gray-700",children:["SAP: ",A.sap_number]})]}),A.experience!==void 0&&s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(wr,{size:14,className:"text-gray-400 mr-2"}),s.jsxs("span",{className:"text-gray-700",children:[": ",P5(A.experience)]})]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"  "}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(Ka,{size:14,className:"text-gray-400 mr-2"}),s.jsx("span",{className:"text-gray-700",children:((H=A.position)==null?void 0:H.name)||"  "})]}),s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(nr,{size:14,className:"text-gray-400 mr-2"}),s.jsx("span",{className:"text-gray-700",children:((Y=A.territory)==null?void 0:Y.name)||"  "})]}),s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(zt,{size:14,className:"text-gray-400 mr-2"}),s.jsxs("span",{className:"text-gray-700",children:[": ",new Date(A.created_at).toLocaleDateString("ru-RU")]})]}),A.last_login_at&&s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(wr,{size:14,className:"text-gray-400 mr-2"}),s.jsxs("span",{className:"text-gray-700",children:[" : ",new Date(A.last_login_at).toLocaleDateString("ru-RU")]})]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:""}),s.jsxs("div",{className:"space-y-2",children:[U&&s.jsx("button",{onClick:()=>S(A.id,!!A.is_leaving),disabled:!!C,className:`w-full px-3 py-2 text-xs font-medium rounded-lg transition-colors ${A.is_leaving?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-yellow-100 text-yellow-700 hover:bg-yellow-200"}`,children:C===A.id?s.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mx-auto"}):A.is_leaving?" ":" "}),A.email&&s.jsxs("button",{onClick:()=>k(A),className:"w-full flex items-center justify-center space-x-2 px-3 py-2 text-xs font-medium bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[s.jsx(Zh,{size:14}),s.jsx("span",{children:"QR "})]})]})]})]})]},A.id)})]})]}),D&&M&&s.jsx(Sre,{email:M.email,fullName:M.full_name,onClose:()=>{R(!1),O(null)}})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(an,{size:48,className:"mx-auto text-red-500 mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:"       ."})]})}const Fre="https://static.tildacdn.com/tild6637-3134-4435-b966-396135393739/Frame_3.png";function Tre({event:e,className:t="",onBack:r}){var x,u;const a=e.image||e.banner_url||Fre,n=((x=e.event_type)==null?void 0:x.name_ru)||((u=e.event_type)==null?void 0:u.name)||"";e.points;const i=e.description||"",l=f=>f?new Date(f).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}):"",o=f=>f?new Date(f).toLocaleString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",c=f=>{switch(f){case"beginner":return"bg-green-500";case"intermediate":return"bg-yellow-500";case"advanced":return"bg-red-500";default:return"bg-gray-500"}},d=f=>{switch(f){case"beginner":return"";case"intermediate":return"";case"advanced":return"";default:return""}};return s.jsx("div",{className:`w-full rounded-2xl shadow-lg overflow-hidden relative mb-4 sm:mb-6 font-mabry ${t}`,children:s.jsxs("div",{className:"relative min-h-[200px] sm:min-h-[240px] md:min-h-[280px] flex items-end",style:{background:`url('${a}') center/cover no-repeat`},children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 z-20 sm:hidden",children:s.jsxs("button",{onClick:r,className:"w-full group flex items-center justify-center gap-2 text-white font-medium rounded-none px-4 py-3 bg-black/60 hover:bg-black/80 backdrop-blur-sm border-b border-white/20 hover:border-white/30 focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 transition-all duration-200 text-sm shadow-lg hover:shadow-xl active:scale-95 touch-manipulation","aria-label":"  ",children:[s.jsx(kn,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform duration-200 flex-shrink-0",strokeWidth:2.5}),s.jsx("span",{children:"  "})]})}),s.jsx("div",{className:"absolute top-4 sm:top-6 left-4 sm:left-6 z-20 hidden sm:block",children:s.jsxs("button",{onClick:r,className:"group flex items-center gap-2 text-white font-normal rounded-xl px-3 py-2 bg-black/30 hover:bg-black/50 backdrop-blur-sm border border-white/20 hover:border-white/30 focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 transition-all duration-200 text-sm shadow-lg hover:shadow-xl active:scale-95 touch-manipulation","aria-label":"  ",children:[s.jsx(kn,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform duration-200 flex-shrink-0",strokeWidth:2.5}),s.jsx("span",{children:"  "})]})})]}),e.is_featured&&s.jsx("div",{className:"absolute top-4 sm:top-6 right-4 sm:right-6 z-20",children:s.jsxs("div",{className:"flex items-center gap-1 px-2.5 sm:px-3 py-1 sm:py-1 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold text-xs sm:text-sm shadow-lg",children:[s.jsx(er,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),s.jsx("span",{className:"hidden sm:inline",children:""}),s.jsx("span",{className:"inline sm:hidden",children:""})]})}),s.jsx("div",{className:"relative z-10 w-full p-4 pt-16 sm:pt-6 md:pt-8 sm:p-6 md:p-8",children:s.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2 sm:mb-3 leading-tight drop-shadow-lg uppercase font-sns whitespace-pre-line",children:e.title.replace("  ",`
 `)}),i&&s.jsx("p",{className:"text-white/90 text-xs sm:text-sm md:text-base leading-relaxed max-w-2xl drop-shadow mb-2 sm:mb-3 line-clamp-2 sm:line-clamp-none",children:i})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-start sm:items-center gap-2 sm:gap-4 md:gap-6 text-xs sm:text-sm text-white/90 drop-shadow",children:[e.start_date&&s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[s.jsx(zt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-white/80 flex-shrink-0"}),s.jsxs("span",{className:"font-medium truncate",children:[o(e.start_date),e.end_date&&e.end_date!==e.start_date&&` - ${l(e.end_date)}`]})]}),e.location&&s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[s.jsx(nr,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-white/80 flex-shrink-0"}),s.jsx("span",{className:"font-medium truncate",children:e.location})]}),e.duration&&s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[s.jsx(wr,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-white/80 flex-shrink-0"}),s.jsxs("span",{className:"font-medium",children:[e.duration," ",e.duration===1?"":""]})]})]}),s.jsx("div",{className:"flex flex-col items-start gap-2 sm:gap-3 mt-3 sm:mt-0",children:s.jsxs("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:[n&&s.jsx("div",{className:"px-3 sm:px-4 py-2 sm:py-2.5 rounded-xl bg-blue-500/90 text-white font-medium text-xs sm:text-sm shadow-lg backdrop-blur-sm border border-blue-400/30",children:n}),e.difficulty_level&&s.jsx("div",{className:`px-3 sm:px-4 py-2 sm:py-2.5 rounded-xl ${c(e.difficulty_level)} text-white font-medium text-xs sm:text-sm shadow-lg border border-white/20`,children:d(e.difficulty_level)})]})})]})})]})})}const Mre=e=>/^https?:\/\//i.test(e)?e:`https://${e}`,Rre=e=>{if(!Number.isFinite(e)||e<=0)return"";const t=["B","KB","MB","GB","TB"];let r=0;for(;e>=1024&&r<t.length-1;)e/=1024,r++;return`${e.toFixed(e<10&&r>0?2:0)} ${t[r]}`},Ore={pdf:s.jsx(Et,{className:"w-4 h-4"}),ppt:s.jsx(Yn,{className:"w-4 h-4"}),pptx:s.jsx(Yn,{className:"w-4 h-4"}),doc:s.jsx(Et,{className:"w-4 h-4"}),docx:s.jsx(Et,{className:"w-4 h-4"}),xls:s.jsx(Yn,{className:"w-4 h-4"}),xlsx:s.jsx(Yn,{className:"w-4 h-4"})},Pre=e=>{var t;return Ore[((t=e.split(".").pop())==null?void 0:t.toLowerCase())||""]??s.jsx(Et,{className:"w-4 h-4"})},EA=()=>typeof navigator<"u"?navigator.userAgent:"",Lre=/iP(hone|od|ad)/i.test(EA()),Ire=/Android/i.test(EA()),_A=Lre||Ire;function L5(e,t,r){const a=(r==null?void 0:r.timeout)??900;if(!_A){window.open(t,"_blank","noopener,noreferrer");return}let n=!1;const i=()=>{document.hidden&&(n=!0)};document.addEventListener("visibilitychange",i,{once:!0}),window.location.href=e,setTimeout(()=>{document.removeEventListener("visibilitychange",i),n||(window.location.href=t)},a)}const wh=e=>{if(!e)return"";try{const t=new URL(e,window.location.origin);return`${t.origin}${t.pathname}`}catch{const t=e.indexOf("?");return t===-1?e:e.slice(0,t)}};function Ure(e,t=180){const[r,a]=wt.useState(e),[n,i]=wt.useState(void 0),[l,o]=wt.useState(!1),c=wt.useRef(wh(e));return wt.useEffect(()=>{if(!e){i(void 0);return}const d=wh(e);if(d===c.current)return;const x=new Image;if(x.decoding="async",x.loading="eager",x.src=e,x.complete&&x.naturalWidth>0){c.current=d,i(e),o(!0);const h=setTimeout(()=>{a(e),i(void 0),o(!1)},t);return()=>clearTimeout(h)}const u=()=>{c.current=d,i(e),o(!0),setTimeout(()=>{a(e),i(void 0),o(!1)},t),x.removeEventListener("load",u),x.removeEventListener("error",f)},f=()=>{x.removeEventListener("load",u),x.removeEventListener("error",f)};return x.addEventListener("load",u),x.addEventListener("error",f),()=>{x.removeEventListener("load",u),x.removeEventListener("error",f)}},[e,t]),{visibleSrc:r,nextSrc:n,fading:l}}const $re=wt.memo(function({src:t,fallback:r,className:a}){const{visibleSrc:n,nextSrc:i,fading:l}=Ure(t);return s.jsxs("div",{className:`relative ${a} rounded-3xl overflow-hidden`,children:[n?s.jsx("img",{src:n,alt:"",className:"absolute inset-0 w-full h-full object-cover",decoding:"async",loading:"lazy",referrerPolicy:"no-referrer",style:{borderRadius:24},onError:o=>{var c;console.error("  :",n),o.currentTarget.style.display="none",(c=o.currentTarget.nextElementSibling)==null||c.classList.remove("hidden")}}):s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-300",children:s.jsx("span",{className:"text-white font-bold text-3xl",children:r})}),i&&s.jsx("img",{src:i,alt:"",className:"absolute inset-0 w-full h-full object-cover transition-opacity",style:{opacity:l?1:0,borderRadius:24,transitionDuration:"180ms"},decoding:"async",loading:"eager",referrerPolicy:"no-referrer"})]})});function zre({event:e,isCreator:t=!1,participants:r=[],onUpdateOrganizerData:a,onCompleteEvent:n}){var v,w,m,b,_,C,j,D,R,M,O,B,L,U,P;const{userProfile:i}=st(),{toast:l}=hm(),o=E.useCallback(async F=>{try{await navigator.clipboard.writeText(F),l("  ")}catch{const N=document.createElement("textarea");N.value=F,N.setAttribute("readonly",""),N.style.position="absolute",N.style.left="-9999px",document.body.appendChild(N),N.select();try{document.execCommand("copy"),l("")}catch{l("  ")}document.body.removeChild(N)}},[l]),c=E.useMemo(()=>`
    /* Squircle ,   border-radius */
    
    /*   touch- */
    @media (hover: none) and (pointer: coarse) {
      button, a, [role="button"] {
        min-height: 44px;
        min-width: 44px;
      }
      
      .touch-target {
        min-height: 44px;
        min-width: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    }
  `,[]);E.useEffect(()=>{var W,k;const F=(W=e==null?void 0:e.creator)==null?void 0:W.id,N=i==null?void 0:i.id,T=((k=e==null?void 0:e.creator)==null?void 0:k.avatar_url)||"",S=(i==null?void 0:i.avatar_url)||"";if(!(F&&N&&F===N)||wh(T)===wh(S))return;const z=setTimeout(()=>{a==null||a(S)},400);return()=>clearTimeout(z)},[(v=e==null?void 0:e.creator)==null?void 0:v.id,(w=e==null?void 0:e.creator)==null?void 0:w.avatar_url,i==null?void 0:i.id,i==null?void 0:i.avatar_url,a]);const d=t||(i==null?void 0:i.role)==="administrator"||(i==null?void 0:i.role)==="moderator",[x,u]=E.useState([]),[f,h]=E.useState(!1),p=E.useCallback(async F=>{var I,V;if(!e)return;const T=`${location.hostname==="localhost"?"http://51.250.94.103":location.origin}/event/${e.id}`,S=new Date(e.start_date),z=e.end_date?new Date(e.end_date):null,W=H=>new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(H),k=z?`${W(S)} - ${W(z)}`:W(S),q=r.length>0?`
  (${r.length}):
${r.slice(0,5).map(H=>` ${H.full_name||" "}`).join(`
`)}${r.length>5?`
...   ${r.length-5} `:""}`:`
 :   `;let A;F==="whatsapp"?A=[` *${e.title}*`,` ${k}`,` : ${((I=e.creator)==null?void 0:I.full_name)||" "}`,e.description?`
 ${e.description}`:"",q,`
 ${T}`].join(`
`):A=[` *${e.title}*`,` ${k}`,` : ${((V=e.creator)==null?void 0:V.full_name)||" "}`,e.description?`
 ${e.description}`:"",q,`
 [  ](${T})`].join(`
`);try{if(typeof navigator<"u"&&"share"in navigator&&_A){await navigator.share({title:e.title,text:A,url:T});return}}catch{}if(F==="whatsapp"){const H=`whatsapp://send?text=${encodeURIComponent(A)}`,Y=`https://wa.me/?text=${encodeURIComponent(A)}`;L5(H,Y,{timeout:900})}else{const H=`tg://msg_url?url=${encodeURIComponent(T)}&text=${encodeURIComponent(A)}`,Y=`https://t.me/share/url?url=${encodeURIComponent(T)}&text=${encodeURIComponent(A)}`;L5(H,Y,{timeout:900})}},[e,r]),g=F=>{var T;if(!F)return"?";const N=F.trim().split(" ");return N.length>=2?`${N[0][0]}${N[1][0]}`.toUpperCase():((T=F[0])==null?void 0:T.toUpperCase())||"?"};if(E.useEffect(()=>{if(e!=null&&e.id){let F=!0;return(async()=>{h(!0);try{const T=await KC(e.id);F&&u(T)}catch(T){F&&console.error("  :",T)}finally{F&&h(!1)}})(),()=>{F=!1}}},[e==null?void 0:e.id]),!e)return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsxs("div",{className:"px-2 sm:px-4 lg:px-6 py-3 sm:py-4 border-b border-gray-100",children:[s.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"  "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:" ..."})]}),s.jsx("div",{className:"p-2 sm:p-4 lg:p-6",children:s.jsx("p",{className:"text-gray-500",children:"   ..."})})]});const y=async F=>{if(confirm(" ,     ?"))try{const N=await XC(F);N.success?u(T=>T.filter(S=>S.id!==F)):alert("  : "+N.error)}catch(N){console.error("  :",N),alert("    ")}};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:c}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsx("div",{className:"px-3 sm:px-4 lg:px-6 py-4 sm:py-5 border-b border-gray-100 bg-white",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-6 sm:gap-4",children:[s.jsxs("div",{className:"w-full",children:[s.jsx("h3",{className:"text-xl sm:text-xl lg:text-2xl font-bold text-gray-900",children:"  "}),s.jsx("p",{className:"text-sm sm:text-sm text-gray-400",children:"   "})]}),(i==null?void 0:i.role)==="trainer"&&n&&s.jsx("div",{className:"flex items-center justify-center sm:justify-end gap-2",children:e.status==="completed"?s.jsxs("button",{type:"button",onClick:n,className:"flex items-center justify-center gap-2 px-3 py-2 sm:px-4 sm:py-3 bg-orange-500 hover:bg-orange-600 active:bg-orange-700 text-white rounded-lg text-sm font-medium transition-colors touch-manipulation min-h-[44px] w-full sm:w-auto sm:whitespace-nowrap",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),s.jsx("span",{className:"hidden sm:inline",children:" "}),s.jsx("span",{className:"sm:hidden",children:""})]}):s.jsxs("button",{type:"button",onClick:n,className:"flex items-center justify-center gap-2 px-3 py-2 sm:px-4 sm:py-3 bg-[#06A478] hover:bg-[#059669] active:bg-[#047857] text-white rounded-lg text-sm font-medium transition-colors touch-manipulation min-h-[44px] w-full sm:w-auto sm:whitespace-nowrap",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),s.jsx("span",{className:"hidden sm:inline",children:" "}),s.jsx("span",{className:"sm:hidden",children:""})]})})]})}),s.jsxs("div",{className:"space-y-4 sm:space-y-5 lg:space-y-6 p-3 sm:p-4 lg:p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6",children:[s.jsx("div",{className:"lg:col-span-2 bg-gradient-to-br from-gray-50 to-blue-50 border border-gray-200 rounded-xl p-3 sm:p-5 lg:p-6 shadow-sm",children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start gap-3 sm:gap-4 lg:gap-5",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx($re,{src:(m=e.creator)==null?void 0:m.avatar_url,fallback:g(((b=e.creator)==null?void 0:b.full_name)||""),className:"w-20 h-20 sm:w-24 sm:h-24 lg:w-32 lg:h-32 xl:w-40 xl:h-40 bg-gradient-to-br from-[#06A478] to-[#059669] shadow-lg"})}),s.jsxs("div",{className:"flex-1 min-w-0 w-full text-center sm:text-left",children:[s.jsx("div",{className:"mb-2 sm:mb-3",children:s.jsx("h5",{className:"text-base sm:text-lg lg:text-xl font-bold text-gray-900 leading-tight break-words",children:((_=e.creator)==null?void 0:_.full_name)||" "})}),((j=(C=e.creator)==null?void 0:C.position)==null?void 0:j.name)&&s.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-1 break-words",children:e.creator.position.name}),(((R=(D=e.creator)==null?void 0:D.territory)==null?void 0:R.name)||((O=(M=e.creator)==null?void 0:M.branch)==null?void 0:O.name))&&s.jsx("p",{className:"text-sm sm:text-base text-gray-500 mb-3 break-words",children:((B=e.creator.territory)==null?void 0:B.name)||((L=e.creator.branch)==null?void 0:L.name)}),s.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 justify-center sm:justify-start",children:[((U=e.creator)==null?void 0:U.phone)&&s.jsxs("button",{type:"button",onClick:()=>{var F;return o(((F=e.creator)==null?void 0:F.phone)||"")},className:"inline-flex items-center justify-center gap-2 px-4 py-3 bg-white hover:bg-gray-50 active:bg-gray-100 text-gray-700 text-sm rounded-lg border border-gray-200 transition-colors touch-manipulation min-h-[44px] w-full sm:w-auto",title:"  ","aria-label":"  ",children:[s.jsx(tl,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:e.creator.phone})]}),((P=e.creator)==null?void 0:P.email)&&s.jsxs("button",{type:"button",onClick:()=>{var F;return o(((F=e.creator)==null?void 0:F.email)||"")},className:"inline-flex items-center justify-center gap-2 px-4 py-3 bg-white hover:bg-gray-50 active:bg-gray-100 text-gray-700 text-sm rounded-lg border border-gray-200 transition-colors touch-manipulation min-h-[44px] w-full sm:w-auto",title:" email","aria-label":" email",children:[s.jsx(Ao,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:e.creator.email})]})]})]})]})}),e.meeting_link&&s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-3 sm:p-4 lg:p-6 border border-blue-200 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(sA,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm sm:text-base font-medium text-blue-700",children:"ZOOM"}),s.jsx("p",{className:"text-xs sm:text-sm text-blue-600 hidden sm:block",children:" "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[s.jsx("a",{href:Mre(e.meeting_link),target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center justify-center h-12 sm:h-10 rounded-lg text-sm font-medium\r
                               bg-blue-600 text-white shadow-md hover:shadow-lg hover:bg-blue-700 active:bg-blue-800 \r
                               transition-all no-underline touch-manipulation min-h-[44px]`,children:"  "}),s.jsxs("button",{type:"button",onClick:()=>o(e.meeting_link||""),className:`inline-flex items-center justify-center h-12 sm:h-10 rounded-lg text-sm font-medium\r
                               bg-gray-600 text-white shadow-md hover:shadow-lg hover:bg-gray-700 active:bg-gray-800 \r
                               transition-all touch-manipulation min-h-[44px]`,children:[s.jsx(Hc,{className:"w-4 h-4 mr-2 sm:mr-1"}),s.jsx("span",{children:""})]})]}),s.jsx("div",{className:"my-4 h-px bg-blue-200/60"}),(i==null?void 0:i.role)==="trainer"&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-3 text-center sm:text-left",children:"   "}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>p("whatsapp"),className:`inline-flex items-center justify-center gap-2 w-full h-12 sm:h-10 rounded-lg text-sm font-medium\r
                                   bg-[#25D3661A] text-[#25D366] border border-black/5 hover:bg-[#25D36633] active:bg-[#25D3664D] \r
                                   hover:shadow-sm transition-all touch-manipulation min-h-[44px]`,title:"  WhatsApp","aria-label":"  WhatsApp",children:[s.jsx(Nte,{className:"w-5 h-5 sm:w-4 sm:h-4"}),s.jsx("span",{children:"WhatsApp"})]}),s.jsxs("button",{type:"button",onClick:()=>p("telegram"),className:`inline-flex items-center justify-center gap-2 w-full h-12 sm:h-10 rounded-lg text-sm font-medium\r
                                   bg-[#26A5E41A] text-[#26A5E4] border border-black/5 hover:bg-[#26A5E433] active:bg-[#26A5E44D] \r
                                   hover:shadow-sm transition-all touch-manipulation min-h-[44px]`,title:"  Telegram","aria-label":"  Telegram",children:[s.jsx(jte,{className:"w-5 h-5 sm:w-4 sm:h-4"}),s.jsx("span",{children:"Telegram"})]})]})]})]})]}),x.length>0&&s.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 border border-gray-200 rounded-xl bg-gray-50/30",children:[s.jsxs("h4",{className:"text-base sm:text-lg lg:text-xl font-semibold text-gray-900 mb-4 sm:mb-5 flex items-center gap-2",children:[s.jsx(Et,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-600"})," "]}),f?s.jsxs("div",{className:"text-center py-8 sm:py-10",children:[s.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 border-2 border-[#06A478] border-t-transparent rounded-full animate-spin mx-auto mb-3"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-500",children:" ..."})]}):x.length>0?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:x.map(F=>s.jsxs("div",{className:`flex flex-col p-3 sm:p-4 rounded-lg border ${F.type==="presentation"?"bg-[#06A478]/10 border-[#06A478]/20":"bg-orange-50 border-orange-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${F.type==="presentation"?"bg-[#06A478]/20 text-[#06A478]":"bg-orange-100 text-orange-600"}`,children:Pre(F.name)}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("p",{className:"text-sm sm:text-base font-medium text-gray-900 truncate",children:F.name})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${F.type==="presentation"?"bg-[#06A478]/20 text-[#06A478]":"bg-orange-100 text-orange-700"}`,children:F.type==="presentation"?"":" "}),s.jsx("span",{className:"text-xs text-gray-500",children:Rre(F.size)})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("a",{href:F.url,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-400 hover:text-gray-600 active:text-gray-700 transition-colors touch-manipulation min-h-[44px] min-w-[44px] flex items-center justify-center",title:" ",children:s.jsx(Bn,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),d&&s.jsx("button",{onClick:()=>y(F.id),className:"p-2 text-gray-400 hover:text-red-600 active:text-red-700 transition-colors touch-manipulation min-h-[44px] min-w-[44px] flex items-center justify-center",title:" ",children:s.jsx(Qe,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]})]},F.id))}):s.jsxs("div",{className:"text-center py-8 sm:py-10 text-gray-500",children:[s.jsx(Et,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 text-gray-300"}),s.jsx("p",{className:"text-sm sm:text-base",children:"  "})]})]})]})]})]})}const r0={entry:{ring:"from-blue-400/30 to-blue-600/30",bg:"bg-gradient-to-b from-white/80 to-white/60",border:"border-blue-200/60",icon:"text-blue-600",title:"text-blue-700",accent:"bg-blue-600",chip:"bg-blue-50 text-blue-700 border-blue-200",glow:"shadow-[0_8px_30px_rgba(37,99,235,0.15)]"},final:{ring:"from-purple-400/30 to-purple-600/30",bg:"bg-gradient-to-b from-white/80 to-white/60",border:"border-purple-200/60",icon:"text-purple-600",title:"text-purple-700",accent:"bg-purple-600",chip:"bg-purple-50 text-purple-700 border-purple-200",glow:"shadow-[0_8px_30px_rgba(147,51,234,0.15)]"},annual:{ring:"from-emerald-400/30 to-emerald-600/30",bg:"bg-gradient-to-b from-white/80 to-white/60",border:"border-emerald-200/60",icon:"text-emerald-600",title:"text-emerald-700",accent:"bg-[#06A478]",chip:"bg-emerald-50 text-emerald-700 border-emerald-200",glow:"shadow-[0_8px_30px_rgba(16,185,129,0.15)]"}},Wr=(...e)=>e.filter(Boolean).join(" ");function qre({value:e,size:t=88,stroke:r=8}){const a=(t-r)/2,n=2*Math.PI*a,i=n-e/100*n;return s.jsxs("svg",{width:t,height:t,className:"block",children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"grad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[s.jsx("stop",{offset:"0%",stopOpacity:"1"}),s.jsx("stop",{offset:"100%",stopOpacity:"1"})]})}),s.jsx("circle",{cx:t/2,cy:t/2,r:a,stroke:"rgba(0,0,0,0.06)",strokeWidth:r,fill:"none"}),s.jsx("circle",{cx:t/2,cy:t/2,r:a,stroke:"currentColor",strokeWidth:r,fill:"none",strokeDasharray:n,strokeDashoffset:i,strokeLinecap:"round",style:{transition:"stroke-dashoffset 600ms ease"},transform:`rotate(-90 ${t/2} ${t/2})`}),s.jsxs("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 font-bold",fontSize:t*.24,children:[Math.round(e),"%"]})]})}function Vre({size:e=88,stroke:t=8}){const r=(e-t)/2;return s.jsxs("svg",{width:e,height:e,className:"block",children:[s.jsx("circle",{cx:e/2,cy:e/2,r,stroke:"rgba(0,0,0,0.06)",strokeWidth:t,fill:"none"}),s.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-600 font-medium",fontSize:e*.18,children:"..."})]})}function $0({className:e,children:t}){return s.jsx("span",{className:Wr("inline-flex items-center gap-1 px-2 py-0.5 rounded-full border text-[11px] font-medium",e),children:t})}const jA=e=>s.jsxs("svg",{...e,xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),s.jsx("polyline",{points:"14 2 14 8 20 8"}),s.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),s.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),s.jsx("polyline",{points:"10 9 9 9 8 9"})]}),Hre=e=>s.jsxs("svg",{...e,xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("polyline",{points:"12 6 12 12 16 14"})]}),Wre=e=>s.jsxs("svg",{...e,xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),z0=e=>s.jsxs("svg",{...e,xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),s.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),Gre=e=>s.jsxs("svg",{...e,xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]});function Zg({type:e}){const t=r0[e]??r0.entry;return s.jsxs("div",{className:Wr("relative rounded-2xl border p-5 backdrop-blur overflow-hidden",t.bg,t.border),children:[s.jsx("div",{className:Wr("absolute -top-12 -right-12 w-40 h-40 rounded-full blur-2xl opacity-60 bg-gradient-to-br",t.ring)}),s.jsxs("div",{className:"animate-pulse space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-9 w-9 rounded-xl bg-gray-200/70"}),s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsx("div",{className:"h-4 w-36 bg-gray-200/70 rounded"}),s.jsx("div",{className:"h-3 w-24 bg-gray-200/60 rounded"})]})]}),s.jsx("div",{className:"h-4 w-full bg-gray-200/70 rounded"}),s.jsx("div",{className:"h-4 w-3/5 bg-gray-200/60 rounded"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-3 w-24 bg-gray-200/60 rounded"}),s.jsx("div",{className:"h-3 w-28 bg-gray-200/60 rounded"})]}),s.jsx("div",{className:"h-10 w-full bg-gray-200/70 rounded-lg"})]})]})}function ep({type:e,testData:t,eventId:r}){const{userProfile:a}=st(),n=r0[e]??r0.entry,i=t.test,[l,o]=E.useState([]),[c,d]=E.useState(!0),[x,u]=E.useState(!1);E.useEffect(()=>{(async()=>{if(!(!(i!=null&&i.id)||!r))try{const{data:_,error:C}=await Z.from("test_questions").select("question_type").eq("test_id",i.id);if(C)throw C;const j=(_==null?void 0:_.some(U=>U.question_type==="text"))||!1;u(j);const{data:D,error:R}=await Z.from("event_participants").select("user_id, user:users(id, full_name, email)").eq("event_id",r);if(R)throw R;const M=(D??[]).map(U=>U.user_id),{data:O,error:B}=await Z.from("user_test_attempts").select("id, score, status, created_at, user:user_id(id, full_name, email)").eq("test_id",i.id).eq("event_id",r).in("user_id",M).order("created_at",{ascending:!1});if(B)throw B;const L=new Map;(D??[]).forEach(U=>{L.set(U.user_id,{user:U.user,score:null,status:null,attemptId:null})}),(O??[]).forEach(U=>{if((U.status==="completed"||U.status==="pending_review")&&U.score!=null){const P=L.get(U.user.id);(!P||U.score>(P.score??-1))&&L.set(U.user.id,{user:U.user,score:U.score,status:U.status,attemptId:U.id})}}),o(Array.from(L.values()))}catch(_){console.error("loadParticipantsData error",_)}finally{d(!1)}})()},[i==null?void 0:i.id,r]);const f=l.filter(b=>b.score!=null),h=l.filter(b=>b.status==="pending_review");l.filter(b=>b.status==="completed");const p=x?l.filter(b=>b.status==="completed"&&b.score===0):[],g=l.length,y=f.length,v=y?Math.round(f.reduce((b,_)=>b+(_.score??0),0)/y):0,w=f.filter(b=>i!=null&&i.passing_score?b.score>=i.passing_score:(b.score??0)>0).length,m=y?Math.round(w/y*100):0;return i?s.jsxs("div",{className:Wr("relative rounded-2xl border p-5 backdrop-blur overflow-hidden",n.bg,n.border,n.glow),children:[s.jsx("div",{className:Wr("absolute -top-12 -right-12 w-44 h-44 rounded-full blur-2xl opacity-70 bg-gradient-to-br",n.ring)}),s.jsx("div",{className:"mb-4 flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:Wr("p-2 rounded-xl bg-white/70 border",n.border),children:s.jsx(jA,{className:Wr("h-5 w-5",n.icon)})}),s.jsxs("div",{children:[s.jsx("div",{className:Wr("font-semibold text-sm",n.title),children:e==="entry"?" ":e==="final"?" ":" "}),s.jsx("div",{className:"text-[11px] text-gray-500",children:i==null?void 0:i.title})]})]})}),c?s.jsx("div",{className:"text-center py-6 text-sm text-gray-500",children:""}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[s.jsxs("div",{className:"rounded-lg border bg-white/70 p-3",children:[s.jsx("div",{className:"text-[11px] text-gray-500",children:""}),s.jsxs("div",{className:"text-base font-semibold text-gray-900",children:[y,"/",g]})]}),s.jsxs("div",{className:"rounded-lg border bg-white/70 p-3",children:[s.jsx("div",{className:"text-[11px] text-gray-500",children:" "}),s.jsx("div",{className:"text-base font-semibold text-gray-900",children:h.length>0||p.length>0?s.jsx("span",{className:"text-amber-600",children:" "}):y?`${v}%`:""})]}),s.jsxs("div",{className:"rounded-lg border bg-white/70 p-3",children:[s.jsx("div",{className:"text-[11px] text-gray-500",children:" "}),s.jsx("div",{className:"text-base font-semibold text-gray-900",children:h.length>0||p.length>0?s.jsx("span",{className:"text-amber-600",children:" "}):y?`${m}%`:""})]})]}),l.length>0&&s.jsx("div",{className:"max-h-32 overflow-auto rounded-lg border bg-white/70",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-xs min-w-[240px]",children:[s.jsx("thead",{className:"sticky top-0 bg-white/80 backdrop-blur",children:s.jsxs("tr",{className:"text-gray-500",children:[s.jsx("th",{className:"text-left font-medium px-1 sm:px-2 py-1 min-w-[160px]",children:""}),s.jsx("th",{className:"text-right font-medium px-1 sm:px-2 py-1 w-[60px]",children:""})]})}),s.jsx("tbody",{children:l.map(b=>{const _=b.attemptId!=null,C=b.status==="pending_review"||x&&b.status==="completed"&&b.score===0,j=b.score,D=i!=null&&i.passing_score?b.score>=i.passing_score:(b.score??0)>0,R=_&&!C&&D;return s.jsxs("tr",{className:"border-t",children:[s.jsx("td",{className:"px-1 sm:px-2 py-1",children:s.jsx("div",{className:"truncate text-gray-800 text-xs",children:b.user.full_name||b.user.email})}),s.jsx("td",{className:"px-1 sm:px-2 py-1 text-right",children:_?C?s.jsx("span",{className:"font-semibold text-xs text-amber-600",children:" "}):s.jsxs("span",{className:Wr("font-semibold text-xs",R?"text-green-700":"text-rose-700"),children:[j,"%"]}):s.jsx("span",{className:"text-gray-600 text-xs",children:""})})]},b.attemptId??b.user.id)})})]})})}),l.length===0&&s.jsx("div",{className:"text-center py-4 text-sm text-gray-500",children:" "})]})]}):s.jsx("div",{className:Wr("rounded-2xl border p-5",n.bg,n.border),children:s.jsx("div",{className:"text-sm text-gray-500",children:"  "})})}function tp({type:e,testData:t,onStart:r,eventEndDate:a}){const n=r0[e]??r0.entry,i=t.test,l=t.available,o=t.completed,c=t.score??0,d=i==null?void 0:i.passing_score,x=t.status,[u,f]=E.useState(new Date);E.useEffect(()=>{if(e==="annual"&&!l){const g=setInterval(()=>{f(new Date)},6e4);return()=>clearInterval(g)}},[e,l]);const h=g=>{if(!g)return"  ";const y=new Date(g),v=new Date(y);v.setMonth(v.getMonth()+3);const w=u;if(w>=v)return"";let m=v.getFullYear()-w.getFullYear(),b=v.getMonth()-w.getMonth(),_=v.getDate()-w.getDate();if(_<0){b--;const C=new Date(v.getFullYear(),v.getMonth(),0);_+=C.getDate()}return b<0&&(m--,b+=12),m>0?`  ${m} ${m===1?"":m<5?"":""}`:b>0?`  ${b} ${b===1?"":b<5?"":""}${_>0?`  ${_} ${_===1?"":_<5?"":""}`:""}`:`  ${_} ${_===1?"":_<5?"":""}`},p=l?o?(d&&d>0?c>=d:c>0)?s.jsx($0,{className:"bg-green-50 text-green-700 border-green-200",children:""}):s.jsx($0,{className:"bg-rose-50 text-rose-700 border-rose-200",children:" "}):s.jsx($0,{className:n.chip,children:"  "}):e==="annual"?s.jsx($0,{className:"bg-rose-50 text-rose-700 border-rose-200",children:" "}):s.jsx($0,{className:"bg-gray-100 text-gray-700 border-gray-200",children:""});return s.jsxs("div",{className:Wr("relative rounded-2xl border p-5 backdrop-blur transition-all duration-300 overflow-hidden","hover:-translate-y-1 hover:shadow-xl",n.bg,n.border,n.glow),children:[s.jsx("div",{className:Wr("pointer-events-none absolute -top-12 -right-12 w-44 h-44 rounded-full blur-2xl opacity-70 bg-gradient-to-br",n.ring)}),s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:Wr("p-2 rounded-xl bg-white/70 border",n.border),children:s.jsx(jA,{className:Wr("h-5 w-5",n.icon)})}),s.jsxs("div",{children:[s.jsx("h3",{className:Wr("font-semibold text-sm",n.title),children:e==="entry"?" ":e==="final"?" ":" "}),s.jsx("div",{className:"text-[11px] text-gray-500",children:" "})]})]}),p]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-base leading-tight line-clamp-2",children:i==null?void 0:i.title}),s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:(i==null?void 0:i.description)||" "})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600 mb-5",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Hre,{className:"h-3.5 w-3.5"}),s.jsx("span",{children:(i==null?void 0:i.time_limit)===0?" ":`${i==null?void 0:i.time_limit} `})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Wre,{className:"h-3.5 w-3.5"}),s.jsx("span",{children:d&&d>0?`: ${d}%`:" "})]})]}),l&&(o||x==="pending_review")?s.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[s.jsx("div",{className:Wr("text-emerald-600",n.icon),children:x==="pending_review"?s.jsx(Vre,{}):s.jsx(qre,{value:c})}),s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{className:"font-semibold text-gray-900",children:""}),s.jsx("div",{className:"text-gray-600",children:x==="pending_review"?" ":d&&d>0?c>=d?" ":" ":" "})]})]}):s.jsx("div",{className:"w-full mt-4",children:l?s.jsx("button",{onClick:()=>r(e),className:Wr("h-10 w-full rounded-lg text-white font-medium transition-all","hover:shadow-md active:scale-[0.99]",n.accent),children:" "}):s.jsx("button",{disabled:!0,className:Wr("h-10 w-full rounded-lg text-sm font-medium",e==="annual"?"bg-gray-100 text-gray-600 cursor-not-allowed":"bg-gray-100 text-gray-500 cursor-not-allowed"),children:e==="annual"?h(a):""})})]})}function Yre({eventId:e,onStartTest:t,testStatus:r,refreshKey:a=0}){var b,_,C,j;const{userProfile:n}=st(),i=Qt(),[l,o]=E.useState(!0),[c,d]=E.useState(null),[x,u]=E.useState(!1),[f,h]=E.useState(!1),[p,g]=E.useState(null),y=wt.useCallback(async()=>{if(!(!e||!(n!=null&&n.id))){o(!0),d(null);try{const{data:D,error:R}=await Z.from("events").select("end_date, start_date").eq("id",e).single();if(R)throw R;const M=D.end_date||D.start_date;g(M);const{data:O,error:B}=await Z.from("event_participants").select("id, attended").eq("event_id",e).eq("user_id",n.id).maybeSingle();if(B)throw B;const L=!!O,U=(O==null?void 0:O.attended)||!1;u(L),h(U)}catch(D){console.error("    :",D),d("    ")}finally{o(!1)}}},[e,n==null?void 0:n.id]);E.useEffect(()=>{y()},[y]),E.useEffect(()=>{a>0&&y()},[a,y]),E.useEffect(()=>{if(!p)return;const D=setInterval(()=>{g(R=>R)},6e4);return()=>clearInterval(D)},[p]);const v=async D=>{console.log(" handleStartTest   testType:",D),console.log(" testStatus:",r),console.log(" userProfile:",n),console.log(" isParticipant:",x),(n==null?void 0:n.role)==="administrator"||(n==null?void 0:n.role)==="moderator"||(n==null?void 0:n.role)==="trainer"||(n==null||n.role);const R=r[D];if(console.log(" testInfo ",D,":",R),!R||!R.test){console.log("     :",D),alert("  ");return}if(R.completed){console.log("   , :",R.score),alert(`    .  : ${R.score}%`);return}if(R.attemptId){console.log("   :",R.attemptId),t(R.test.id,e,R.attemptId);return}try{console.log("     :",R.test.id);const{data:M,error:O}=await Z.from("user_test_attempts").insert({user_id:n.id,test_id:R.test.id,event_id:e,status:"in_progress",start_time:new Date().toISOString()}).select().single();if(O)throw console.error("    :",O),O;console.log("   :",M),t(R.test.id,e,M.id)}catch(M){console.error("     :",M),M.message&&M.message.includes("  ")?alert(M.message):alert("    . ,   .")}};if(!n)return s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 text-center",children:[s.jsx(z0,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-base sm:text-lg font-medium text-yellow-800 mb-2",children:" "}),s.jsx("p",{className:"text-yellow-700",children:",   ,     ."})]});const w=(n==null?void 0:n.role)==="administrator"||(n==null?void 0:n.role)==="moderator"||(n==null?void 0:n.role)==="trainer"||(n==null?void 0:n.role)==="expert";return!l&&!w?s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center",children:[s.jsx(z0,{className:"h-12 w-12 text-blue-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-base sm:text-lg font-medium text-blue-800 mb-2",children:"   "}),s.jsx("p",{className:"text-blue-700",children:"    ,    ."})]}):(console.log("EventTestPrompts debug:",{loading:l,isParticipant:x,hasAdminAccess:w,userRole:n==null?void 0:n.role}),!l&&w?(console.log("Rendering admin view with testStatus:",r),r.entry.test||r.final.test||((b=r.annual)==null?void 0:b.test)?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.entry.test&&s.jsx(ep,{type:"entry",testData:r.entry,eventId:e}),r.final.test&&s.jsx(ep,{type:"final",testData:r.final,eventId:e}),((_=r.annual)==null?void 0:_.test)&&s.jsx(ep,{type:"annual",testData:r.annual,eventId:e})]}),s.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 flex flex-col",children:[s.jsxs("div",{className:"flex items-center mb-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gray-200 mr-3",children:s.jsx(Gre,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-sm sm:text-base text-gray-800",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"    ,   "})]})]}),s.jsx("button",{onClick:()=>{console.log("     :",e),i(`/event-test-review/${e}`),window.scrollTo({top:0,behavior:"smooth"})},className:"w-full px-4 py-2.5 bg-sns-green text-white rounded-lg text-sm font-semibold hover:bg-sns-green-dark transition-all duration-200 shadow-md hover:shadow-lg",children:" "})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 flex flex-col",children:[s.jsxs("div",{className:"flex items-center mb-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gray-200 mr-3",children:s.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-sm sm:text-base text-gray-800",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"  ,  ,  "})]})]}),s.jsx("button",{onClick:()=>i(`/event-test-results/${e}`),className:"w-full px-4 py-2.5 bg-gray-200 text-gray-500 rounded-lg text-sm font-medium hover:bg-gray-300 hover:text-gray-600 transition-colors",children:""})]})]})]}):s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center",children:[s.jsx(z0,{className:"h-12 w-12 text-blue-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-base sm:text-lg font-medium text-blue-800 mb-2",children:"  "}),s.jsx("p",{className:"text-blue-700",children:"     ."})]})):l?s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(Zg,{type:"entry"}),s.jsx(Zg,{type:"final"}),s.jsx(Zg,{type:"annual"})]})}):c?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[s.jsx(z0,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-base sm:text-lg font-medium text-red-800 mb-2",children:" "}),s.jsx("p",{className:"text-red-700",children:c})]}):r.entry.test||r.final.test||((C=r.annual)==null?void 0:C.test)?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.entry.test&&s.jsx(tp,{type:"entry",testData:r.entry,onStart:v,eventEndDate:p}),r.final.test&&s.jsx(tp,{type:"final",testData:r.final,onStart:v,eventEndDate:p}),((j=r.annual)==null?void 0:j.test)&&s.jsx(tp,{type:"annual",testData:r.annual,onStart:v,eventEndDate:p})]}),(n==null?void 0:n.role)&&["administrator","moderator","trainer","expert"].includes(n.role)&&s.jsx("div",{className:"mt-4",children:s.jsxs("div",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gray-200 mr-3",children:s.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm sm:text-base text-gray-800",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"  ,  ,  "})]})]}),s.jsx("button",{onClick:()=>i(`/event-test-results/${e}`),className:"px-6 py-2 bg-[#06A478] text-white rounded-lg text-xs sm:text-sm font-medium hover:bg-[#059669]",children:""})]})})]}):s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-6 text-center",children:[s.jsx(z0,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-800 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-700",children:"     ."})]}))}const Xre=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),s.jsx("polyline",{points:"14 2 14 8 20 8"}),s.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),s.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),s.jsx("polyline",{points:"10 9 9 9 8 9"})]}),Kre=e=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:s.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),Qre=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("polyline",{points:"12 6 12 12 16 14"})]}),Jre=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Zre=e=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:s.jsx("polyline",{points:"18 15 12 9 6 15"})}),ese=e=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:s.jsx("polyline",{points:"6 9 12 15 18 9"})});function tse({eventId:e,userProfile:t,onStartTest:r}){const[a,n]=E.useState(!1),[i,l]=E.useState(!1),[o,c]=E.useState({entry:null,final:null,annual:null});E.useEffect(()=>{(async()=>{if(e){l(!0);try{const{data:u,error:f}=await Z.from("events").select("event_type_id").eq("id",e).single();if(f)throw f;const{data:h,error:p}=await Z.from("tests").select("*").eq("event_type_id",u.event_type_id).eq("status","active");if(p)throw p;const g={...o};h==null||h.forEach(y=>{["entry","final","annual"].includes(y.type)&&(g[y.type]=y)}),c(g)}catch(u){console.error("   :",u)}finally{l(!1)}}})()},[e]);const d=(x,u,f)=>{const p={blue:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",textSecondary:"text-blue-700",textInfo:"text-blue-600",btn:"bg-blue-600 hover:bg-blue-700"},purple:{bg:"bg-purple-50",border:"border-purple-200",text:"text-purple-800",textSecondary:"text-purple-700",textInfo:"text-purple-600",btn:"bg-purple-600 hover:bg-purple-700"},amber:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-800",textSecondary:"text-amber-700",textInfo:"text-amber-600",btn:"bg-amber-600 hover:bg-amber-700"}}[f];return x?s.jsxs("div",{className:`${p.bg} ${p.border} rounded-lg p-4 transition-shadow hover:shadow-md`,children:[s.jsxs("h4",{className:`font-medium ${p.text} flex items-center`,children:[s.jsx(Xre,{className:"h-4 w-4 mr-2"}),u==="entry"?" ":u==="final"?" ":" "]}),s.jsx("p",{className:`text-sm ${p.textSecondary} mt-1 mb-3`,children:x.title}),s.jsxs("div",{className:`text-xs ${p.textInfo} mb-4 space-y-1`,children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Qre,{className:"h-3.5 w-3.5 mr-1"}),s.jsx("span",{children:x.time_limit===0?"  ":`${x.time_limit} `})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(Jre,{className:"h-3.5 w-3.5 mr-1"}),s.jsxs("span",{children:[" : ",x.passing_score,"%"]})]})]}),s.jsxs("button",{onClick:()=>r(u),className:`w-full ${p.btn} text-white px-4 py-3 rounded-xl transition-all duration-300 flex items-center justify-center group font-semibold`,children:[s.jsx(Kre,{size:18,className:"mr-3 group-hover:animate-pulse"}),s.jsx("span",{className:"text-base",children:""})]})]}):null};return!o.entry&&!o.final&&!o.annual?null:s.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-6",children:[s.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center cursor-pointer",onClick:()=>n(!a),children:[s.jsxs("h3",{className:"font-medium text-gray-800 flex items-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2 text-gray-600",children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})," "]}),a?s.jsx(Zre,{className:"h-5 w-5 text-gray-500"}):s.jsx(ese,{className:"h-5 w-5 text-gray-500"})]}),a&&s.jsxs("div",{className:"p-4",children:[s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"text-sm text-gray-600",children:"    .     ,    ."})}),i?s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-sm text-gray-600",children:" ..."})]}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.entry&&d(o.entry,"entry","blue"),o.final&&d(o.final,"final","purple"),o.annual&&d(o.annual,"annual","amber")]}),s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("p",{className:"text-xs text-yellow-700",children:[s.jsx("strong",{children:":"})," ,    ,           ."]})})]})]})}const I5="#06A478";function rse(e){var r,a;if(!e)return"";const t=e.trim().split(" ");return t.length===1?((r=t[0][0])==null?void 0:r.toUpperCase())||"":(t[0][0]+(((a=t[1])==null?void 0:a[0])||"")).toUpperCase()}function sse({eventId:e,refreshKey:t=0,hasOpenEndedQuestions:r=!1}){const{userProfile:a}=st(),[n,i]=E.useState([]),[l,o]=E.useState(!0),[c,d]=E.useState(null),[x,u]=E.useState(null),[f,h]=E.useState((a==null?void 0:a.role)==="employee"),p=(a==null?void 0:a.role)&&["administrator","moderator","trainer","expert"].includes(a.role),g=(a==null?void 0:a.role)==="employee";E.useEffect(()=>{(p||g)&&h(!0)},[p,g]);const y=p;if(g)return null;const v=E.useCallback(async()=>{o(!0),d(null);try{const{data:m,error:b}=await Z.from("event_participants_view").select("*").eq("event_id",e);if(b)throw b;console.log("Using hasOpenEndedQuestions from props:",r);const _=(m||[]).map(C=>{const j=r&&C.final_test_score===0&&C.final_test_status==="completed";return C.final_test_score===0&&console.log("Participant with 0% final test:",{name:C.full_name,hasOpenEndedQuestions:r,final_test_score:C.final_test_score,final_test_status:C.final_test_status,isPendingReview:j}),{...C,hasOpenEndedQuestions:r,final_test_pending_review:j}});console.log("Updated participants with pending review logic:",_),i(_)}catch(m){console.error("   :",m),d(m.message)}finally{o(!1)}},[e]);E.useEffect(()=>{e&&v()},[e,v]),E.useEffect(()=>{t>0&&e&&v()},[t,e,v]);const w=async(m,b)=>{if(!(!p||x===m)){u(m);try{const{error:_}=await Z.from("event_participants").update({attended:!b}).eq("id",m);if(_)throw _;i(C=>C.map(j=>j.id===m?{...j,attended:!b}:j))}catch{alert("   ")}finally{u(null)}}};return n.filter(m=>m.attended).length,n.filter(m=>m.feedback_submitted).length,n.filter(m=>m.entry_test_score!==null||m.final_test_score!==null).length,l?s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 sm:p-6",children:s.jsxs("div",{className:"flex items-center justify-center py-6 sm:py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 sm:h-8 sm:w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600 text-sm sm:text-base",children:" ..."})]})}):c?s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 sm:p-6",children:s.jsxs("div",{className:"text-center py-6 sm:py-8 text-red-500",children:[s.jsx("div",{className:"text-base sm:text-lg font-semibold mb-2",children:" "}),s.jsx("div",{className:"text-xs sm:text-sm",children:c})]})}):s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsx("div",{className:`px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-100 ${y?"":"cursor-pointer"}`,onClick:y?void 0:()=>h(!f),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-base sm:text-lg lg:text-xl xl:text-2xl font-bold text-gray-900",children:" "}),p&&s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"      "})]}),!y&&s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("span",{className:"text-xs text-gray-400 hidden sm:inline",children:f?" ":" "}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{className:"!w-5 !h-5 sm:!w-8 sm:!h-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 flex items-center justify-center transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",onClick:m=>{m.stopPropagation(),h(!f)},children:s.jsx("svg",{className:`!w-3 !h-3 sm:!w-4 sm:!h-4 text-white transition-transform duration-200 ${f?"rotate-45":"rotate-0"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),s.jsx("div",{className:`absolute -top-1 -right-1 w-3 h-3 rounded-full transition-all duration-200 ${f?"bg-green-400":"bg-gray-300"}`})]})]})]})}),(f||y)&&s.jsxs("div",{className:"p-3 sm:p-4 lg:p-6",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full",children:[s.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left font-semibold text-gray-700 text-xs uppercase tracking-wider rounded-l-lg",children:""}),s.jsx("th",{className:`px-2 sm:px-3 py-2 sm:py-3 text-left font-semibold text-gray-700 text-xs uppercase tracking-wider ${p?"":"rounded-r-lg"}`,children:""}),p&&s.jsxs(s.Fragment,{children:[s.jsx("th",{className:"px-1 sm:px-2 py-2 sm:py-3 text-center font-semibold text-gray-700 text-xs uppercase tracking-wider w-[120px] sm:w-[140px]",children:""}),s.jsx("th",{className:"px-1 sm:px-2 py-2 sm:py-3 text-center font-semibold text-gray-700 text-xs uppercase tracking-wider w-[100px] sm:w-[120px]",children:""}),s.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-center font-semibold text-gray-700 text-xs uppercase tracking-wider rounded-r-lg w-[100px] sm:w-[120px]",children:" "})]})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:n.map((m,b)=>s.jsxs("tr",{className:`hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 transition-all duration-200 group ${b%2===0?"bg-white":"bg-gray-50/30"}`,children:[s.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 align-middle",children:s.jsxs("div",{className:"flex gap-2 sm:gap-3 items-center",children:[s.jsx("div",{className:"w-7 h-7 sm:w-9 sm:h-9 rounded-xl text-white flex items-center justify-center font-semibold shadow-sm group-hover:shadow-md transition-shadow duration-200 text-xs sm:text-sm",style:{backgroundColor:I5},children:rse(m.full_name)}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("div",{className:"font-semibold text-gray-900 text-xs sm:text-sm leading-tight",children:m.full_name}),m.phone&&s.jsxs("a",{href:`tel:${m.phone}`,className:"text-xs text-gray-500 hover:text-blue-600 hover:underline transition-colors flex items-center gap-1 mt-1",children:[s.jsx("svg",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),s.jsx("span",{className:"text-xs sm:text-sm",children:m.phone})]})]})]})}),s.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 align-middle",children:s.jsxs("div",{className:"space-y-0.5 sm:space-y-1",children:[s.jsx("div",{className:"font-medium text-gray-900 text-xs sm:text-sm",children:m.position_name||s.jsx("span",{className:"text-gray-400 italic text-xs",children:" "})}),s.jsxs("div",{className:"text-xs font-medium",style:{color:I5},children:[m.territory_name||s.jsx("span",{className:"text-gray-400 italic",children:" "}),m.territory_region&&s.jsxs("span",{className:"text-gray-400 ml-1",children:["(",m.territory_region,")"]})]})]})}),p&&s.jsxs(s.Fragment,{children:[s.jsx("td",{className:"px-1 sm:px-2 py-2 sm:py-3 text-center align-middle",children:s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{onClick:()=>w(m.id,m.attended),className:`w-20 sm:w-24 px-1 py-1 sm:py-1.5 rounded-lg text-xs font-medium transition-all duration-200 touch-manipulation ${m.attended?"bg-green-100 text-green-700 hover:bg-green-200 border border-green-200":"bg-red-100 text-red-700 hover:bg-red-200 border border-red-200"}`,title:m.attended?"  ":"  ",children:x===m.id?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs("svg",{className:"animate-spin h-3 w-3",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.4 0 0 5.4 0 12h4z"})]}),s.jsx("span",{children:"..."})]}):m.attended?"":""})})}),s.jsx("td",{className:"px-1 sm:px-2 py-2 sm:py-3 text-center align-middle",children:s.jsxs("div",{className:"flex flex-col gap-0.5 sm:gap-1 items-center",children:[s.jsx("div",{className:`w-full px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-md text-xs font-medium border transition-all duration-200 ${m.entry_test_score!==null&&m.entry_test_status==="completed"?"bg-yellow-50 text-yellow-700 border-yellow-200":m.entry_test_status==="in_progress"?"bg-orange-50 text-orange-700 border-orange-200":"bg-gray-50 text-gray-500 border-gray-200"}`,children:m.entry_test_score!==null&&m.entry_test_status==="completed"?`${m.entry_test_score}%`:m.entry_test_status==="in_progress"?" ":""}),s.jsx("div",{className:`w-full px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-md text-xs font-medium border transition-all duration-200 ${m.final_test_pending_review?"bg-amber-50 text-amber-700 border-amber-200":m.final_test_score!==null&&m.final_test_status==="completed"?"bg-blue-50 text-blue-700 border-blue-200":m.final_test_status==="in_progress"?"bg-orange-50 text-orange-700 border-orange-200":"bg-gray-50 text-gray-500 border-gray-200"}`,children:m.final_test_pending_review?" ":m.final_test_score!==null&&m.final_test_status==="completed"?`${m.final_test_score}%`:m.final_test_status==="in_progress"?" ":""})]})}),s.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-center align-middle",children:s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:`w-12 sm:w-14 px-1 py-1 sm:py-1.5 rounded-lg text-xs font-medium transition-all duration-200 ${m.feedback_submitted?"bg-green-100 text-green-700 border border-green-200":"bg-red-100 text-red-700 border border-red-200"}`,children:m.feedback_submitted?"":""})})})]})]},m.id))})]})}),n.length===0&&s.jsxs("div",{className:"text-center py-8 sm:py-12 text-gray-500",children:[s.jsx(nt,{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-2 sm:mb-3 text-gray-300"}),s.jsx("p",{className:"text-sm font-medium",children:"  "}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"   "})]})]})]})}function ase(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return E.useMemo(()=>a=>{t.forEach(n=>n(a))},t)}const bm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function E0(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function qy(e){return"nodeType"in e}function Ks(e){var t,r;return e?E0(e)?e:qy(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Vy(e){const{Document:t}=Ks(e);return e instanceof t}function su(e){return E0(e)?!1:e instanceof Ks(e).HTMLElement}function NA(e){return e instanceof Ks(e).SVGElement}function _0(e){return e?E0(e)?e.document:qy(e)?Vy(e)?e:su(e)||NA(e)?e.ownerDocument:document:document:document}const Fn=bm?E.useLayoutEffect:E.useEffect;function Hy(e){const t=E.useRef(e);return Fn(()=>{t.current=e}),E.useCallback(function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return t.current==null?void 0:t.current(...a)},[])}function nse(){const e=E.useRef(null),t=E.useCallback((a,n)=>{e.current=setInterval(a,n)},[]),r=E.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Cx(e,t){t===void 0&&(t=[e]);const r=E.useRef(e);return Fn(()=>{r.current!==e&&(r.current=e)},t),r}function au(e,t){const r=E.useRef();return E.useMemo(()=>{const a=e(r.current);return r.current=a,a},[...t])}function Eh(e){const t=Hy(e),r=E.useRef(null),a=E.useCallback(n=>{n!==r.current&&(t==null||t(n,r.current)),r.current=n},[]);return[r,a]}function ev(e){const t=E.useRef();return E.useEffect(()=>{t.current=e},[e]),t.current}let rp={};function nu(e,t){return E.useMemo(()=>{if(t)return t;const r=rp[e]==null?0:rp[e]+1;return rp[e]=r,e+"-"+r},[e,t])}function CA(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return a.reduce((i,l)=>{const o=Object.entries(l);for(const[c,d]of o){const x=i[c];x!=null&&(i[c]=x+e*d)}return i},{...t})}}const Fc=CA(1),Ax=CA(-1);function ise(e){return"clientX"in e&&"clientY"in e}function Wy(e){if(!e)return!1;const{KeyboardEvent:t}=Ks(e.target);return t&&e instanceof t}function lse(e){if(!e)return!1;const{TouchEvent:t}=Ks(e.target);return t&&e instanceof t}function tv(e){if(lse(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return ise(e)?{x:e.clientX,y:e.clientY}:null}const s0=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[s0.Translate.toString(e),s0.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:a}=e;return t+" "+r+"ms "+a}}}),U5="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ose(e){return e.matches(U5)?e:e.querySelector(U5)}const cse={display:"none"};function dse(e){let{id:t,value:r}=e;return wt.createElement("div",{id:t,style:cse},r)}function xse(e){let{id:t,announcement:r,ariaLiveType:a="assertive"}=e;const n={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return wt.createElement("div",{id:t,style:n,role:"status","aria-live":a,"aria-atomic":!0},r)}function use(){const[e,t]=E.useState("");return{announce:E.useCallback(a=>{a!=null&&t(a)},[]),announcement:e}}const AA=E.createContext(null);function fse(e){const t=E.useContext(AA);E.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function hse(){const[e]=E.useState(()=>new Set),t=E.useCallback(a=>(e.add(a),()=>e.delete(a)),[e]);return[E.useCallback(a=>{let{type:n,event:i}=a;e.forEach(l=>{var o;return(o=l[n])==null?void 0:o.call(l,i)})},[e]),t]}const mse={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},gse={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function pse(e){let{announcements:t=gse,container:r,hiddenTextDescribedById:a,screenReaderInstructions:n=mse}=e;const{announce:i,announcement:l}=use(),o=nu("DndLiveRegion"),[c,d]=E.useState(!1);if(E.useEffect(()=>{d(!0)},[]),fse(E.useMemo(()=>({onDragStart(u){let{active:f}=u;i(t.onDragStart({active:f}))},onDragMove(u){let{active:f,over:h}=u;t.onDragMove&&i(t.onDragMove({active:f,over:h}))},onDragOver(u){let{active:f,over:h}=u;i(t.onDragOver({active:f,over:h}))},onDragEnd(u){let{active:f,over:h}=u;i(t.onDragEnd({active:f,over:h}))},onDragCancel(u){let{active:f,over:h}=u;i(t.onDragCancel({active:f,over:h}))}}),[i,t])),!c)return null;const x=wt.createElement(wt.Fragment,null,wt.createElement(dse,{id:a,value:n.draggable}),wt.createElement(xse,{id:o,announcement:l}));return r?Ml.createPortal(x,r):x}var Or;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Or||(Or={}));function _h(){}function jh(e,t){return E.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function kA(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return E.useMemo(()=>[...t].filter(a=>a!=null),[...t])}const nn=Object.freeze({x:0,y:0});function DA(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function SA(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return r-a}function vse(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return a-r}function $5(e){let{left:t,top:r,height:a,width:n}=e;return[{x:t,y:r},{x:t+n,y:r},{x:t,y:r+a},{x:t+n,y:r+a}]}function BA(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function z5(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const FA=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const n=z5(t,t.left,t.top),i=[];for(const l of a){const{id:o}=l,c=r.get(o);if(c){const d=DA(z5(c),n);i.push({id:o,data:{droppableContainer:l,value:d}})}}return i.sort(SA)},bse=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const n=$5(t),i=[];for(const l of a){const{id:o}=l,c=r.get(o);if(c){const d=$5(c),x=n.reduce((f,h,p)=>f+DA(d[p],h),0),u=Number((x/4).toFixed(4));i.push({id:o,data:{droppableContainer:l,value:u}})}}return i.sort(SA)};function yse(e,t){const r=Math.max(t.top,e.top),a=Math.max(t.left,e.left),n=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),l=n-a,o=i-r;if(a<n&&r<i){const c=t.width*t.height,d=e.width*e.height,x=l*o,u=x/(c+d-x);return Number(u.toFixed(4))}return 0}const wse=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const n=[];for(const i of a){const{id:l}=i,o=r.get(l);if(o){const c=yse(o,t);c>0&&n.push({id:l,data:{droppableContainer:i,value:c}})}}return n.sort(vse)};function Ese(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function TA(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:nn}function _se(e){return function(r){for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];return n.reduce((l,o)=>({...l,top:l.top+e*o.y,bottom:l.bottom+e*o.y,left:l.left+e*o.x,right:l.right+e*o.x}),{...r})}}const jse=_se(1);function Nse(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Cse(e,t,r){const a=Nse(t);if(!a)return e;const{scaleX:n,scaleY:i,x:l,y:o}=a,c=e.left-l-(1-n)*parseFloat(r),d=e.top-o-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),x=n?e.width/n:e.width,u=i?e.height/i:e.height;return{width:x,height:u,top:d,right:c+x,bottom:d+u,left:c}}const Ase={ignoreTransform:!1};function j0(e,t){t===void 0&&(t=Ase);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:x}=Ks(e).getComputedStyle(e);d&&(r=Cse(r,d,x))}const{top:a,left:n,width:i,height:l,bottom:o,right:c}=r;return{top:a,left:n,width:i,height:l,bottom:o,right:c}}function q5(e){return j0(e,{ignoreTransform:!0})}function kse(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function Dse(e,t){return t===void 0&&(t=Ks(e).getComputedStyle(e)),t.position==="fixed"}function Sse(e,t){t===void 0&&(t=Ks(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(n=>{const i=t[n];return typeof i=="string"?r.test(i):!1})}function ym(e,t){const r=[];function a(n){if(t!=null&&r.length>=t||!n)return r;if(Vy(n)&&n.scrollingElement!=null&&!r.includes(n.scrollingElement))return r.push(n.scrollingElement),r;if(!su(n)||NA(n)||r.includes(n))return r;const i=Ks(e).getComputedStyle(n);return n!==e&&Sse(n,i)&&r.push(n),Dse(n,i)?r:a(n.parentNode)}return e?a(e):r}function MA(e){const[t]=ym(e,1);return t??null}function sp(e){return!bm||!e?null:E0(e)?e:qy(e)?Vy(e)||e===_0(e).scrollingElement?window:su(e)?e:null:null}function RA(e){return E0(e)?e.scrollX:e.scrollLeft}function OA(e){return E0(e)?e.scrollY:e.scrollTop}function rv(e){return{x:RA(e),y:OA(e)}}var Gr;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Gr||(Gr={}));function PA(e){return!bm||!e?!1:e===document.scrollingElement}function LA(e){const t={x:0,y:0},r=PA(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},n=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,l=e.scrollTop>=a.y,o=e.scrollLeft>=a.x;return{isTop:n,isLeft:i,isBottom:l,isRight:o,maxScroll:a,minScroll:t}}const Bse={x:.2,y:.2};function Fse(e,t,r,a,n){let{top:i,left:l,right:o,bottom:c}=r;a===void 0&&(a=10),n===void 0&&(n=Bse);const{isTop:d,isBottom:x,isLeft:u,isRight:f}=LA(e),h={x:0,y:0},p={x:0,y:0},g={height:t.height*n.y,width:t.width*n.x};return!d&&i<=t.top+g.height?(h.y=Gr.Backward,p.y=a*Math.abs((t.top+g.height-i)/g.height)):!x&&c>=t.bottom-g.height&&(h.y=Gr.Forward,p.y=a*Math.abs((t.bottom-g.height-c)/g.height)),!f&&o>=t.right-g.width?(h.x=Gr.Forward,p.x=a*Math.abs((t.right-g.width-o)/g.width)):!u&&l<=t.left+g.width&&(h.x=Gr.Backward,p.x=a*Math.abs((t.left+g.width-l)/g.width)),{direction:h,speed:p}}function Tse(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:t,left:r,right:a,bottom:n}=e.getBoundingClientRect();return{top:t,left:r,right:a,bottom:n,width:e.clientWidth,height:e.clientHeight}}function IA(e){return e.reduce((t,r)=>Fc(t,rv(r)),nn)}function Mse(e){return e.reduce((t,r)=>t+RA(r),0)}function Rse(e){return e.reduce((t,r)=>t+OA(r),0)}function Ose(e,t){if(t===void 0&&(t=j0),!e)return;const{top:r,left:a,bottom:n,right:i}=t(e);MA(e)&&(n<=0||i<=0||r>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Pse=[["x",["left","right"],Mse],["y",["top","bottom"],Rse]];class Gy{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const a=ym(r),n=IA(a);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,l,o]of Pse)for(const c of l)Object.defineProperty(this,c,{get:()=>{const d=o(a),x=n[i]-d;return this.rect[c]+x},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Td{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var a;return(a=this.target)==null?void 0:a.removeEventListener(...r)})},this.target=t}add(t,r,a){var n;(n=this.target)==null||n.addEventListener(t,r,a),this.listeners.push([t,r,a])}}function Lse(e){const{EventTarget:t}=Ks(e);return e instanceof t?e:_0(e)}function ap(e,t){const r=Math.abs(e.x),a=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+a**2)>t:"x"in t&&"y"in t?r>t.x&&a>t.y:"x"in t?r>t.x:"y"in t?a>t.y:!1}var _a;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(_a||(_a={}));function V5(e){e.preventDefault()}function Ise(e){e.stopPropagation()}var yt;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(yt||(yt={}));const UA={start:[yt.Space,yt.Enter],cancel:[yt.Esc],end:[yt.Space,yt.Enter,yt.Tab]},Use=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case yt.Right:return{...r,x:r.x+25};case yt.Left:return{...r,x:r.x-25};case yt.Down:return{...r,y:r.y+25};case yt.Up:return{...r,y:r.y-25}}};class Yy{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Td(_0(r)),this.windowListeners=new Td(Ks(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(_a.Resize,this.handleCancel),this.windowListeners.add(_a.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(_a.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,a=t.node.current;a&&Ose(a),r(nn)}handleKeyDown(t){if(Wy(t)){const{active:r,context:a,options:n}=this.props,{keyboardCodes:i=UA,coordinateGetter:l=Use,scrollBehavior:o="smooth"}=n,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=a.current,x=d?{x:d.left,y:d.top}:nn;this.referenceCoordinates||(this.referenceCoordinates=x);const u=l(t,{active:r,context:a.current,currentCoordinates:x});if(u){const f=Ax(u,x),h={x:0,y:0},{scrollableAncestors:p}=a.current;for(const g of p){const y=t.code,{isTop:v,isRight:w,isLeft:m,isBottom:b,maxScroll:_,minScroll:C}=LA(g),j=Tse(g),D={x:Math.min(y===yt.Right?j.right-j.width/2:j.right,Math.max(y===yt.Right?j.left:j.left+j.width/2,u.x)),y:Math.min(y===yt.Down?j.bottom-j.height/2:j.bottom,Math.max(y===yt.Down?j.top:j.top+j.height/2,u.y))},R=y===yt.Right&&!w||y===yt.Left&&!m,M=y===yt.Down&&!b||y===yt.Up&&!v;if(R&&D.x!==u.x){const O=g.scrollLeft+f.x,B=y===yt.Right&&O<=_.x||y===yt.Left&&O>=C.x;if(B&&!f.y){g.scrollTo({left:O,behavior:o});return}B?h.x=g.scrollLeft-O:h.x=y===yt.Right?g.scrollLeft-_.x:g.scrollLeft-C.x,h.x&&g.scrollBy({left:-h.x,behavior:o});break}else if(M&&D.y!==u.y){const O=g.scrollTop+f.y,B=y===yt.Down&&O<=_.y||y===yt.Up&&O>=C.y;if(B&&!f.x){g.scrollTo({top:O,behavior:o});return}B?h.y=g.scrollTop-O:h.y=y===yt.Down?g.scrollTop-_.y:g.scrollTop-C.y,h.y&&g.scrollBy({top:-h.y,behavior:o});break}}this.handleMove(t,Fc(Ax(u,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:a}=this.props;t.preventDefault(),a(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Yy.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:a=UA,onActivation:n}=t,{active:i}=r;const{code:l}=e.nativeEvent;if(a.start.includes(l)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),n==null||n({event:e.nativeEvent}),!0)}return!1}}];function H5(e){return!!(e&&"distance"in e)}function W5(e){return!!(e&&"delay"in e)}class Xy{constructor(t,r,a){var n;a===void 0&&(a=Lse(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:i}=t,{target:l}=i;this.props=t,this.events=r,this.document=_0(l),this.documentListeners=new Td(this.document),this.listeners=new Td(a),this.windowListeners=new Td(Ks(l)),this.initialCoordinates=(n=tv(i))!=null?n:nn,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:a}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(_a.Resize,this.handleCancel),this.windowListeners.add(_a.DragStart,V5),this.windowListeners.add(_a.VisibilityChange,this.handleCancel),this.windowListeners.add(_a.ContextMenu,V5),this.documentListeners.add(_a.Keydown,this.handleKeydown),r){if(a!=null&&a({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(W5(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(H5(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:a,onPending:n}=this.props;n(a,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(_a.Click,Ise,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(_a.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:a,initialCoordinates:n,props:i}=this,{onMove:l,options:{activationConstraint:o}}=i;if(!n)return;const c=(r=tv(t))!=null?r:nn,d=Ax(n,c);if(!a&&o){if(H5(o)){if(o.tolerance!=null&&ap(d,o.tolerance))return this.handleCancel();if(ap(d,o.distance))return this.handleStart()}if(W5(o)&&ap(d,o.tolerance))return this.handleCancel();this.handlePending(o,d);return}t.cancelable&&t.preventDefault(),l(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===yt.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const $se={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class wm extends Xy{constructor(t){const{event:r}=t,a=_0(r.target);super(t,$se,a)}}wm.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return!r.isPrimary||r.button!==0?!1:(a==null||a({event:r}),!0)}}];const zse={move:{name:"mousemove"},end:{name:"mouseup"}};var sv;(function(e){e[e.RightClick=2]="RightClick"})(sv||(sv={}));class qse extends Xy{constructor(t){super(t,zse,_0(t.event.target))}}qse.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return r.button===sv.RightClick?!1:(a==null||a({event:r}),!0)}}];const np={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class $A extends Xy{constructor(t){super(t,np)}static setup(){return window.addEventListener(np.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(np.move.name,t)};function t(){}}}$A.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;const{touches:n}=r;return n.length>1?!1:(a==null||a({event:r}),!0)}}];var Md;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Md||(Md={}));var Nh;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Nh||(Nh={}));function Vse(e){let{acceleration:t,activator:r=Md.Pointer,canScroll:a,draggingRect:n,enabled:i,interval:l=5,order:o=Nh.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:x,delta:u,threshold:f}=e;const h=Wse({delta:u,disabled:!i}),[p,g]=nse(),y=E.useRef({x:0,y:0}),v=E.useRef({x:0,y:0}),w=E.useMemo(()=>{switch(r){case Md.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Md.DraggableRect:return n}},[r,n,c]),m=E.useRef(null),b=E.useCallback(()=>{const C=m.current;if(!C)return;const j=y.current.x*v.current.x,D=y.current.y*v.current.y;C.scrollBy(j,D)},[]),_=E.useMemo(()=>o===Nh.TreeOrder?[...d].reverse():d,[o,d]);E.useEffect(()=>{if(!i||!d.length||!w){g();return}for(const C of _){if((a==null?void 0:a(C))===!1)continue;const j=d.indexOf(C),D=x[j];if(!D)continue;const{direction:R,speed:M}=Fse(C,D,w,t,f);for(const O of["x","y"])h[O][R[O]]||(M[O]=0,R[O]=0);if(M.x>0||M.y>0){g(),m.current=C,p(b,l),y.current=M,v.current=R;return}}y.current={x:0,y:0},v.current={x:0,y:0},g()},[t,b,a,g,i,l,JSON.stringify(w),JSON.stringify(h),p,d,_,x,JSON.stringify(f)])}const Hse={x:{[Gr.Backward]:!1,[Gr.Forward]:!1},y:{[Gr.Backward]:!1,[Gr.Forward]:!1}};function Wse(e){let{delta:t,disabled:r}=e;const a=ev(t);return au(n=>{if(r||!a||!n)return Hse;const i={x:Math.sign(t.x-a.x),y:Math.sign(t.y-a.y)};return{x:{[Gr.Backward]:n.x[Gr.Backward]||i.x===-1,[Gr.Forward]:n.x[Gr.Forward]||i.x===1},y:{[Gr.Backward]:n.y[Gr.Backward]||i.y===-1,[Gr.Forward]:n.y[Gr.Forward]||i.y===1}}},[r,t,a])}function Gse(e,t){const r=t!=null?e.get(t):void 0,a=r?r.node.current:null;return au(n=>{var i;return t==null?null:(i=a??n)!=null?i:null},[a,t])}function Yse(e,t){return E.useMemo(()=>e.reduce((r,a)=>{const{sensor:n}=a,i=n.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,a)}));return[...r,...i]},[]),[e,t])}var kx;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(kx||(kx={}));var av;(function(e){e.Optimized="optimized"})(av||(av={}));const G5=new Map;function Xse(e,t){let{dragging:r,dependencies:a,config:n}=t;const[i,l]=E.useState(null),{frequency:o,measure:c,strategy:d}=n,x=E.useRef(e),u=y(),f=Cx(u),h=E.useCallback(function(v){v===void 0&&(v=[]),!f.current&&l(w=>w===null?v:w.concat(v.filter(m=>!w.includes(m))))},[f]),p=E.useRef(null),g=au(v=>{if(u&&!r)return G5;if(!v||v===G5||x.current!==e||i!=null){const w=new Map;for(let m of e){if(!m)continue;if(i&&i.length>0&&!i.includes(m.id)&&m.rect.current){w.set(m.id,m.rect.current);continue}const b=m.node.current,_=b?new Gy(c(b),b):null;m.rect.current=_,_&&w.set(m.id,_)}return w}return v},[e,i,r,u,c]);return E.useEffect(()=>{x.current=e},[e]),E.useEffect(()=>{u||h()},[r,u]),E.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),E.useEffect(()=>{u||typeof o!="number"||p.current!==null||(p.current=setTimeout(()=>{h(),p.current=null},o))},[o,u,h,...a]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:i!=null};function y(){switch(d){case kx.Always:return!1;case kx.BeforeDragging:return r;default:return!r}}}function zA(e,t){return au(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function Kse(e,t){return zA(e,t)}function Qse(e){let{callback:t,disabled:r}=e;const a=Hy(t),n=E.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(a)},[a,r]);return E.useEffect(()=>()=>n==null?void 0:n.disconnect(),[n]),n}function Em(e){let{callback:t,disabled:r}=e;const a=Hy(t),n=E.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(a)},[r]);return E.useEffect(()=>()=>n==null?void 0:n.disconnect(),[n]),n}function Jse(e){return new Gy(j0(e),e)}function Y5(e,t,r){t===void 0&&(t=Jse);const[a,n]=E.useState(null);function i(){n(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??r)!=null?d:null}const x=t(e);return JSON.stringify(c)===JSON.stringify(x)?c:x})}const l=Qse({callback(c){if(e)for(const d of c){const{type:x,target:u}=d;if(x==="childList"&&u instanceof HTMLElement&&u.contains(e)){i();break}}}}),o=Em({callback:i});return Fn(()=>{i(),e?(o==null||o.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),l==null||l.disconnect())},[e]),a}function Zse(e){const t=zA(e);return TA(e,t)}const X5=[];function eae(e){const t=E.useRef(e),r=au(a=>e?a&&a!==X5&&e&&t.current&&e.parentNode===t.current.parentNode?a:ym(e):X5,[e]);return E.useEffect(()=>{t.current=e},[e]),r}function tae(e){const[t,r]=E.useState(null),a=E.useRef(e),n=E.useCallback(i=>{const l=sp(i.target);l&&r(o=>o?(o.set(l,rv(l)),new Map(o)):null)},[]);return E.useEffect(()=>{const i=a.current;if(e!==i){l(i);const o=e.map(c=>{const d=sp(c);return d?(d.addEventListener("scroll",n,{passive:!0}),[d,rv(d)]):null}).filter(c=>c!=null);r(o.length?new Map(o):null),a.current=e}return()=>{l(e),l(i)};function l(o){o.forEach(c=>{const d=sp(c);d==null||d.removeEventListener("scroll",n)})}},[n,e]),E.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,l)=>Fc(i,l),nn):IA(e):nn,[e,t])}function K5(e,t){t===void 0&&(t=[]);const r=E.useRef(null);return E.useEffect(()=>{r.current=null},t),E.useEffect(()=>{const a=e!==nn;a&&!r.current&&(r.current=e),!a&&r.current&&(r.current=null)},[e]),r.current?Ax(e,r.current):nn}function rae(e){E.useEffect(()=>{if(!bm)return;const t=e.map(r=>{let{sensor:a}=r;return a.setup==null?void 0:a.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function sae(e,t){return E.useMemo(()=>e.reduce((r,a)=>{let{eventName:n,handler:i}=a;return r[n]=l=>{i(l,t)},r},{}),[e,t])}function qA(e){return E.useMemo(()=>e?kse(e):null,[e])}const Q5=[];function aae(e,t){t===void 0&&(t=j0);const[r]=e,a=qA(r?Ks(r):null),[n,i]=E.useState(Q5);function l(){i(()=>e.length?e.map(c=>PA(c)?a:new Gy(t(c),c)):Q5)}const o=Em({callback:l});return Fn(()=>{o==null||o.disconnect(),l(),e.forEach(c=>o==null?void 0:o.observe(c))},[e]),n}function nae(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return su(t)?t:e}function iae(e){let{measure:t}=e;const[r,a]=E.useState(null),n=E.useCallback(d=>{for(const{target:x}of d)if(su(x)){a(u=>{const f=t(x);return u?{...u,width:f.width,height:f.height}:f});break}},[t]),i=Em({callback:n}),l=E.useCallback(d=>{const x=nae(d);i==null||i.disconnect(),x&&(i==null||i.observe(x)),a(x?t(x):null)},[t,i]),[o,c]=Eh(l);return E.useMemo(()=>({nodeRef:o,rect:r,setRef:c}),[r,o,c])}const lae=[{sensor:wm,options:{}},{sensor:Yy,options:{}}],oae={current:{}},gf={draggable:{measure:q5},droppable:{measure:q5,strategy:kx.WhileDragging,frequency:av.Optimized},dragOverlay:{measure:j0}};class Rd extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,a;return(r=(a=this.get(t))==null?void 0:a.node.current)!=null?r:void 0}}const cae={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Rd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:_h},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:gf,measureDroppableContainers:_h,windowRect:null,measuringScheduled:!1},dae={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:_h,draggableNodes:new Map,over:null,measureDroppableContainers:_h},_m=E.createContext(dae),VA=E.createContext(cae);function xae(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Rd}}}function uae(e,t){switch(t.type){case Or.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Or.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Or.DragEnd:case Or.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Or.RegisterDroppable:{const{element:r}=t,{id:a}=r,n=new Rd(e.droppable.containers);return n.set(a,r),{...e,droppable:{...e.droppable,containers:n}}}case Or.SetDroppableDisabled:{const{id:r,key:a,disabled:n}=t,i=e.droppable.containers.get(r);if(!i||a!==i.key)return e;const l=new Rd(e.droppable.containers);return l.set(r,{...i,disabled:n}),{...e,droppable:{...e.droppable,containers:l}}}case Or.UnregisterDroppable:{const{id:r,key:a}=t,n=e.droppable.containers.get(r);if(!n||a!==n.key)return e;const i=new Rd(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function fae(e){let{disabled:t}=e;const{active:r,activatorEvent:a,draggableNodes:n}=E.useContext(_m),i=ev(a),l=ev(r==null?void 0:r.id);return E.useEffect(()=>{if(!t&&!a&&i&&l!=null){if(!Wy(i)||document.activeElement===i.target)return;const o=n.get(l);if(!o)return;const{activatorNode:c,node:d}=o;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const x of[c.current,d.current]){if(!x)continue;const u=ose(x);if(u){u.focus();break}}})}},[a,t,n,l,i]),null}function hae(e,t){let{transform:r,...a}=t;return e!=null&&e.length?e.reduce((n,i)=>i({transform:n,...a}),r):r}function mae(e){return E.useMemo(()=>({draggable:{...gf.draggable,...e==null?void 0:e.draggable},droppable:{...gf.droppable,...e==null?void 0:e.droppable},dragOverlay:{...gf.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function gae(e){let{activeNode:t,measure:r,initialRect:a,config:n=!0}=e;const i=E.useRef(!1),{x:l,y:o}=typeof n=="boolean"?{x:n,y:n}:n;Fn(()=>{if(!l&&!o||!t){i.current=!1;return}if(i.current||!a)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const x=r(d),u=TA(x,a);if(l||(u.x=0),o||(u.y=0),i.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){const f=MA(d);f&&f.scrollBy({top:u.y,left:u.x})}},[t,l,o,a,r])}const HA=E.createContext({...nn,scaleX:1,scaleY:1});var Si;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Si||(Si={}));const WA=E.memo(function(t){var r,a,n,i;let{id:l,accessibility:o,autoScroll:c=!0,children:d,sensors:x=lae,collisionDetection:u=wse,measuring:f,modifiers:h,...p}=t;const g=E.useReducer(uae,void 0,xae),[y,v]=g,[w,m]=hse(),[b,_]=E.useState(Si.Uninitialized),C=b===Si.Initialized,{draggable:{active:j,nodes:D,translate:R},droppable:{containers:M}}=y,O=j!=null?D.get(j):null,B=E.useRef({initial:null,translated:null}),L=E.useMemo(()=>{var Nr;return j!=null?{id:j,data:(Nr=O==null?void 0:O.data)!=null?Nr:oae,rect:B}:null},[j,O]),U=E.useRef(null),[P,F]=E.useState(null),[N,T]=E.useState(null),S=Cx(p,Object.values(p)),z=nu("DndDescribedBy",l),W=E.useMemo(()=>M.getEnabled(),[M]),k=mae(f),{droppableRects:q,measureDroppableContainers:A,measuringScheduled:I}=Xse(W,{dragging:C,dependencies:[R.x,R.y],config:k.droppable}),V=Gse(D,j),H=E.useMemo(()=>N?tv(N):null,[N]),Y=N0(),Q=Kse(V,k.draggable.measure);gae({activeNode:j!=null?D.get(j):null,config:Y.layoutShiftCompensation,initialRect:Q,measure:k.draggable.measure});const te=Y5(V,k.draggable.measure,Q),re=Y5(V?V.parentElement:null),X=E.useRef({activatorEvent:null,active:null,activeNode:V,collisionRect:null,collisions:null,droppableRects:q,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=M.getNodeFor((r=X.current.over)==null?void 0:r.id),J=iae({measure:k.dragOverlay.measure}),ue=(a=J.nodeRef.current)!=null?a:V,de=C?(n=J.rect)!=null?n:te:null,ce=!!(J.nodeRef.current&&J.rect),fe=Zse(ce?null:te),pe=qA(ue?Ks(ue):null),Ne=eae(C?je??V:null),ne=aae(Ne),_e=hae(h,{transform:{x:R.x-fe.x,y:R.y-fe.y,scaleX:1,scaleY:1},activatorEvent:N,active:L,activeNodeRect:te,containerNodeRect:re,draggingNodeRect:de,over:X.current.over,overlayNodeRect:J.rect,scrollableAncestors:Ne,scrollableAncestorRects:ne,windowRect:pe}),Te=H?Fc(H,R):null,Me=tae(Ne),ye=K5(Me),Re=K5(Me,[te]),De=Fc(_e,ye),Ce=de?jse(de,_e):null,Ye=L&&Ce?u({active:L,collisionRect:Ce,droppableRects:q,droppableContainers:W,pointerCoordinates:Te}):null,Ue=BA(Ye,"id"),[He,pt]=E.useState(null),Je=ce?_e:Fc(_e,Re),Jt=Ese(Je,(i=He==null?void 0:He.rect)!=null?i:null,te),or=E.useRef(null),vt=E.useCallback((Nr,mr)=>{let{sensor:ts,options:xa}=mr;if(U.current==null)return;const xs=D.get(U.current);if(!xs)return;const gr=Nr.nativeEvent,Us=new ts({active:U.current,activeNode:xs,event:gr,options:xa,context:X,onAbort(pr){if(!D.get(pr))return;const{onDragAbort:us}=S.current,Ns={id:pr};us==null||us(Ns),w({type:"onDragAbort",event:Ns})},onPending(pr,Qs,us,Ns){if(!D.get(pr))return;const{onDragPending:dn}=S.current,K={id:pr,constraint:Qs,initialCoordinates:us,offset:Ns};dn==null||dn(K),w({type:"onDragPending",event:K})},onStart(pr){const Qs=U.current;if(Qs==null)return;const us=D.get(Qs);if(!us)return;const{onDragStart:Ns}=S.current,Ln={activatorEvent:gr,active:{id:Qs,data:us.data,rect:B}};Ml.unstable_batchedUpdates(()=>{Ns==null||Ns(Ln),_(Si.Initializing),v({type:Or.DragStart,initialCoordinates:pr,active:Qs}),w({type:"onDragStart",event:Ln}),F(or.current),T(gr)})},onMove(pr){v({type:Or.DragMove,coordinates:pr})},onEnd:cn(Or.DragEnd),onCancel:cn(Or.DragCancel)});or.current=Us;function cn(pr){return async function(){const{active:us,collisions:Ns,over:Ln,scrollAdjustedTranslate:dn}=X.current;let K=null;if(us&&dn){const{cancelDrop:ie}=S.current;K={activatorEvent:gr,active:us,collisions:Ns,delta:dn,over:Ln},pr===Or.DragEnd&&typeof ie=="function"&&await Promise.resolve(ie(K))&&(pr=Or.DragCancel)}U.current=null,Ml.unstable_batchedUpdates(()=>{v({type:pr}),_(Si.Uninitialized),pt(null),F(null),T(null),or.current=null;const ie=pr===Or.DragEnd?"onDragEnd":"onDragCancel";if(K){const ee=S.current[ie];ee==null||ee(K),w({type:ie,event:K})}})}}},[D]),Is=E.useCallback((Nr,mr)=>(ts,xa)=>{const xs=ts.nativeEvent,gr=D.get(xa);if(U.current!==null||!gr||xs.dndKit||xs.defaultPrevented)return;const Us={active:gr};Nr(ts,mr.options,Us)===!0&&(xs.dndKit={capturedBy:mr.sensor},U.current=xa,vt(ts,mr))},[D,vt]),zr=Yse(x,Is);rae(x),Fn(()=>{te&&b===Si.Initializing&&_(Si.Initialized)},[te,b]),E.useEffect(()=>{const{onDragMove:Nr}=S.current,{active:mr,activatorEvent:ts,collisions:xa,over:xs}=X.current;if(!mr||!ts)return;const gr={active:mr,activatorEvent:ts,collisions:xa,delta:{x:De.x,y:De.y},over:xs};Ml.unstable_batchedUpdates(()=>{Nr==null||Nr(gr),w({type:"onDragMove",event:gr})})},[De.x,De.y]),E.useEffect(()=>{const{active:Nr,activatorEvent:mr,collisions:ts,droppableContainers:xa,scrollAdjustedTranslate:xs}=X.current;if(!Nr||U.current==null||!mr||!xs)return;const{onDragOver:gr}=S.current,Us=xa.get(Ue),cn=Us&&Us.rect.current?{id:Us.id,rect:Us.rect.current,data:Us.data,disabled:Us.disabled}:null,pr={active:Nr,activatorEvent:mr,collisions:ts,delta:{x:xs.x,y:xs.y},over:cn};Ml.unstable_batchedUpdates(()=>{pt(cn),gr==null||gr(pr),w({type:"onDragOver",event:pr})})},[Ue]),Fn(()=>{X.current={activatorEvent:N,active:L,activeNode:V,collisionRect:Ce,collisions:Ye,droppableRects:q,draggableNodes:D,draggingNode:ue,draggingNodeRect:de,droppableContainers:M,over:He,scrollableAncestors:Ne,scrollAdjustedTranslate:De},B.current={initial:de,translated:Ce}},[L,V,Ye,Ce,D,ue,de,q,M,He,Ne,De]),Vse({...Y,delta:R,draggingRect:Ce,pointerCoordinates:Te,scrollableAncestors:Ne,scrollableAncestorRects:ne});const za=E.useMemo(()=>({active:L,activeNode:V,activeNodeRect:te,activatorEvent:N,collisions:Ye,containerNodeRect:re,dragOverlay:J,draggableNodes:D,droppableContainers:M,droppableRects:q,over:He,measureDroppableContainers:A,scrollableAncestors:Ne,scrollableAncestorRects:ne,measuringConfiguration:k,measuringScheduled:I,windowRect:pe}),[L,V,te,N,Ye,re,J,D,M,q,He,A,Ne,ne,k,I,pe]),Mo=E.useMemo(()=>({activatorEvent:N,activators:zr,active:L,activeNodeRect:te,ariaDescribedById:{draggable:z},dispatch:v,draggableNodes:D,over:He,measureDroppableContainers:A}),[N,zr,L,te,v,z,D,He,A]);return wt.createElement(AA.Provider,{value:m},wt.createElement(_m.Provider,{value:Mo},wt.createElement(VA.Provider,{value:za},wt.createElement(HA.Provider,{value:Jt},d)),wt.createElement(fae,{disabled:(o==null?void 0:o.restoreFocus)===!1})),wt.createElement(pse,{...o,hiddenTextDescribedById:z}));function N0(){const Nr=(P==null?void 0:P.autoScrollEnabled)===!1,mr=typeof c=="object"?c.enabled===!1:c===!1,ts=C&&!Nr&&!mr;return typeof c=="object"?{...c,enabled:ts}:{enabled:ts}}}),pae=E.createContext(null),J5="button",vae="Draggable";function bae(e){let{id:t,data:r,disabled:a=!1,attributes:n}=e;const i=nu(vae),{activators:l,activatorEvent:o,active:c,activeNodeRect:d,ariaDescribedById:x,draggableNodes:u,over:f}=E.useContext(_m),{role:h=J5,roleDescription:p="draggable",tabIndex:g=0}=n??{},y=(c==null?void 0:c.id)===t,v=E.useContext(y?HA:pae),[w,m]=Eh(),[b,_]=Eh(),C=sae(l,t),j=Cx(r);Fn(()=>(u.set(t,{id:t,key:i,node:w,activatorNode:b,data:j}),()=>{const R=u.get(t);R&&R.key===i&&u.delete(t)}),[u,t]);const D=E.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":a,"aria-pressed":y&&h===J5?!0:void 0,"aria-roledescription":p,"aria-describedby":x.draggable}),[a,h,g,y,p,x.draggable]);return{active:c,activatorEvent:o,activeNodeRect:d,attributes:D,isDragging:y,listeners:a?void 0:C,node:w,over:f,setNodeRef:m,setActivatorNodeRef:_,transform:v}}function yae(){return E.useContext(VA)}const wae="Droppable",Eae={timeout:25};function _ae(e){let{data:t,disabled:r=!1,id:a,resizeObserverConfig:n}=e;const i=nu(wae),{active:l,dispatch:o,over:c,measureDroppableContainers:d}=E.useContext(_m),x=E.useRef({disabled:r}),u=E.useRef(!1),f=E.useRef(null),h=E.useRef(null),{disabled:p,updateMeasurementsFor:g,timeout:y}={...Eae,...n},v=Cx(g??a),w=E.useCallback(()=>{if(!u.current){u.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(v.current)?v.current:[v.current]),h.current=null},y)},[y]),m=Em({callback:w,disabled:p||!l}),b=E.useCallback((D,R)=>{m&&(R&&(m.unobserve(R),u.current=!1),D&&m.observe(D))},[m]),[_,C]=Eh(b),j=Cx(t);return E.useEffect(()=>{!m||!_.current||(m.disconnect(),u.current=!1,m.observe(_.current))},[_,m]),E.useEffect(()=>(o({type:Or.RegisterDroppable,element:{id:a,key:i,disabled:r,node:_,rect:f,data:j}}),()=>o({type:Or.UnregisterDroppable,key:i,id:a})),[a]),E.useEffect(()=>{r!==x.current.disabled&&(o({type:Or.SetDroppableDisabled,id:a,key:i,disabled:r}),x.current.disabled=r)},[a,i,r,o]),{active:l,rect:f,isOver:(c==null?void 0:c.id)===a,node:_,over:c,setNodeRef:C}}function jm(e,t,r){const a=e.slice();return a.splice(r<0?a.length+r:r,0,a.splice(t,1)[0]),a}function jae(e,t){return e.reduce((r,a,n)=>{const i=t.get(a);return i&&(r[n]=i),r},Array(e.length))}function Ku(e){return e!==null&&e>=0}function Nae(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Cae(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const GA=e=>{let{rects:t,activeIndex:r,overIndex:a,index:n}=e;const i=jm(t,a,r),l=t[n],o=i[n];return!o||!l?null:{x:o.left-l.left,y:o.top-l.top,scaleX:o.width/l.width,scaleY:o.height/l.height}},Qu={scaleX:1,scaleY:1},YA=e=>{var t;let{activeIndex:r,activeNodeRect:a,index:n,rects:i,overIndex:l}=e;const o=(t=i[r])!=null?t:a;if(!o)return null;if(n===r){const d=i[l];return d?{x:0,y:r<l?d.top+d.height-(o.top+o.height):d.top-o.top,...Qu}:null}const c=Aae(i,n,r);return n>r&&n<=l?{x:0,y:-o.height-c,...Qu}:n<r&&n>=l?{x:0,y:o.height+c,...Qu}:{x:0,y:0,...Qu}};function Aae(e,t,r){const a=e[t],n=e[t-1],i=e[t+1];return a?r<t?n?a.top-(n.top+n.height):i?i.top-(a.top+a.height):0:i?i.top-(a.top+a.height):n?a.top-(n.top+n.height):0:0}const XA="Sortable",KA=wt.createContext({activeIndex:-1,containerId:XA,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:GA,disabled:{draggable:!1,droppable:!1}});function QA(e){let{children:t,id:r,items:a,strategy:n=GA,disabled:i=!1}=e;const{active:l,dragOverlay:o,droppableRects:c,over:d,measureDroppableContainers:x}=yae(),u=nu(XA,r),f=o.rect!==null,h=E.useMemo(()=>a.map(C=>typeof C=="object"&&"id"in C?C.id:C),[a]),p=l!=null,g=l?h.indexOf(l.id):-1,y=d?h.indexOf(d.id):-1,v=E.useRef(h),w=!Nae(h,v.current),m=y!==-1&&g===-1||w,b=Cae(i);Fn(()=>{w&&p&&x(h)},[w,h,p,x]),E.useEffect(()=>{v.current=h},[h]);const _=E.useMemo(()=>({activeIndex:g,containerId:u,disabled:b,disableTransforms:m,items:h,overIndex:y,useDragOverlay:f,sortedRects:jae(h,c),strategy:n}),[g,u,b.draggable,b.droppable,m,h,y,c,f,n]);return wt.createElement(KA.Provider,{value:_},t)}const kae=e=>{let{id:t,items:r,activeIndex:a,overIndex:n}=e;return jm(r,a,n).indexOf(t)},Dae=e=>{let{containerId:t,isSorting:r,wasDragging:a,index:n,items:i,newIndex:l,previousItems:o,previousContainerId:c,transition:d}=e;return!d||!a||o!==i&&n===l?!1:r?!0:l!==n&&t===c},Sae={duration:200,easing:"ease"},JA="transform",Bae=s0.Transition.toString({property:JA,duration:0,easing:"linear"}),Fae={roleDescription:"sortable"};function Tae(e){let{disabled:t,index:r,node:a,rect:n}=e;const[i,l]=E.useState(null),o=E.useRef(r);return Fn(()=>{if(!t&&r!==o.current&&a.current){const c=n.current;if(c){const d=j0(a.current,{ignoreTransform:!0}),x={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(x.x||x.y)&&l(x)}}r!==o.current&&(o.current=r)},[t,r,a,n]),E.useEffect(()=>{i&&l(null)},[i]),i}function ZA(e){let{animateLayoutChanges:t=Dae,attributes:r,disabled:a,data:n,getNewIndex:i=kae,id:l,strategy:o,resizeObserverConfig:c,transition:d=Sae}=e;const{items:x,containerId:u,activeIndex:f,disabled:h,disableTransforms:p,sortedRects:g,overIndex:y,useDragOverlay:v,strategy:w}=E.useContext(KA),m=Mae(a,h),b=x.indexOf(l),_=E.useMemo(()=>({sortable:{containerId:u,index:b,items:x},...n}),[u,n,b,x]),C=E.useMemo(()=>x.slice(x.indexOf(l)),[x,l]),{rect:j,node:D,isOver:R,setNodeRef:M}=_ae({id:l,data:_,disabled:m.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...c}}),{active:O,activatorEvent:B,activeNodeRect:L,attributes:U,setNodeRef:P,listeners:F,isDragging:N,over:T,setActivatorNodeRef:S,transform:z}=bae({id:l,data:_,attributes:{...Fae,...r},disabled:m.draggable}),W=ase(M,P),k=!!O,q=k&&!p&&Ku(f)&&Ku(y),A=!v&&N,I=A&&q?z:null,H=q?I??(o??w)({rects:g,activeNodeRect:L,activeIndex:f,overIndex:y,index:b}):null,Y=Ku(f)&&Ku(y)?i({id:l,items:x,activeIndex:f,overIndex:y}):b,Q=O==null?void 0:O.id,te=E.useRef({activeId:Q,items:x,newIndex:Y,containerId:u}),re=x!==te.current.items,X=t({active:O,containerId:u,isDragging:N,isSorting:k,id:l,index:b,items:x,newIndex:te.current.newIndex,previousItems:te.current.items,previousContainerId:te.current.containerId,transition:d,wasDragging:te.current.activeId!=null}),je=Tae({disabled:!X,index:b,node:D,rect:j});return E.useEffect(()=>{k&&te.current.newIndex!==Y&&(te.current.newIndex=Y),u!==te.current.containerId&&(te.current.containerId=u),x!==te.current.items&&(te.current.items=x)},[k,Y,u,x]),E.useEffect(()=>{if(Q===te.current.activeId)return;if(Q!=null&&te.current.activeId==null){te.current.activeId=Q;return}const ue=setTimeout(()=>{te.current.activeId=Q},50);return()=>clearTimeout(ue)},[Q]),{active:O,activeIndex:f,attributes:U,data:_,rect:j,index:b,newIndex:Y,items:x,isOver:R,isSorting:k,isDragging:N,listeners:F,node:D,overIndex:y,over:T,setNodeRef:W,setActivatorNodeRef:S,setDroppableNodeRef:M,setDraggableNodeRef:P,transform:je??H,transition:J()};function J(){if(je||re&&te.current.newIndex===b)return Bae;if(!(A&&!Wy(B)||!d)&&(k||X))return s0.Transition.toString({...d,property:JA})}}function Mae(e,t){var r,a;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(a=e==null?void 0:e.droppable)!=null?a:t.droppable}}function Ch(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Rae=[yt.Down,yt.Right,yt.Up,yt.Left],Oae=(e,t)=>{let{context:{active:r,collisionRect:a,droppableRects:n,droppableContainers:i,over:l,scrollableAncestors:o}}=t;if(Rae.includes(e.code)){if(e.preventDefault(),!r||!a)return;const c=[];i.getEnabled().forEach(u=>{if(!u||u!=null&&u.disabled)return;const f=n.get(u.id);if(f)switch(e.code){case yt.Down:a.top<f.top&&c.push(u);break;case yt.Up:a.top>f.top&&c.push(u);break;case yt.Left:a.left>f.left&&c.push(u);break;case yt.Right:a.left<f.left&&c.push(u);break}});const d=bse({collisionRect:a,droppableRects:n,droppableContainers:c});let x=BA(d,"id");if(x===(l==null?void 0:l.id)&&d.length>1&&(x=d[1].id),x!=null){const u=i.get(r.id),f=i.get(x),h=f?n.get(f.id):null,p=f==null?void 0:f.node.current;if(p&&h&&u&&f){const y=ym(p).some((C,j)=>o[j]!==C),v=e7(u,f),w=Pae(u,f),m=y||!v?{x:0,y:0}:{x:w?a.width-h.width:0,y:w?a.height-h.height:0},b={x:h.left,y:h.top};return m.x&&m.y?b:Ax(b,m)}}}};function e7(e,t){return!Ch(e)||!Ch(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Pae(e,t){return!Ch(e)||!Ch(t)||!e7(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Lae=e=>{const t=Math.floor(e/3600),r=Math.floor(e%3600/60),a=e%60;return t>0?`${t}:${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${r}:${a.toString().padStart(2,"0")}`},Iae=({id:e,text:t,index:r})=>{const{attributes:a,listeners:n,setNodeRef:i,transform:l,transition:o,isDragging:c}=ZA({id:e,animateLayoutChanges:()=>!1});return s.jsx("div",{ref:i,style:{transform:s0.Transform.toString(l),zIndex:c?50:"auto"},className:`
        group relative bg-white rounded-xl border-2 shadow-sm
        transition-all duration-200 ease-[cubic-bezier(.4,1.2,.4,1)]
        text-sm
        ${c?"border-[#19A980] shadow-lg":"border-gray-200 hover:border-[#19A980]/60 hover:shadow-md"}
      `,children:s.jsxs("div",{className:"flex items-center p-2 sm:p-3 gap-2",children:[s.jsx("div",{className:"flex flex-col items-center gap-1 cursor-grab active:cursor-grabbing touch-none min-w-[2.25rem]",...a,...n,children:s.jsx("div",{className:"w-7 h-7 bg-[#19A980]/10 text-[#19A980] rounded-lg flex items-center justify-center font-semibold text-xs mb-1",children:r+1})}),s.jsx("span",{className:"text-gray-900 flex-1 break-words whitespace-pre-line",children:t||""})]})})},t7=({testId:e,eventId:t,attemptId:r,onComplete:a,onCancel:n,onTestLoaded:i})=>{var Q,te,re,X,je;const{userProfile:l}=st(),[o,c]=E.useState(null),[d,x]=E.useState([]),[u,f]=E.useState(0),[h,p]=E.useState([]),[g,y]=E.useState(null),[v,w]=E.useState(!0),[m,b]=E.useState(null),[_,C]=E.useState(!1),[j,D]=E.useState(!1),[R,M]=E.useState(!1),[O,B]=E.useState(!1),[L,U]=E.useState(!1),[P,F]=E.useState(0),N=E.useRef(null),T=kA(jh(wm,{activationConstraint:{distance:8}}),jh($A,{activationConstraint:{delay:100,tolerance:5}})),S=E.useCallback(async()=>{w(!0),b(null);try{if(!(l!=null&&l.id))throw new Error("  ");const{data:J,error:ue}=await Z.from("tests").select("*").eq("id",e).single();if(ue||!J)throw ue||new Error("  ");c(J),i&&(J!=null&&J.title)&&i(J.title),J&&J.time_limit>0&&y(J.time_limit*60);const{data:de,error:ce}=await Z.from("user_test_attempts").select("*").eq("id",r).eq("user_id",l.id).eq("test_id",e).eq("event_id",t).single();if(ce||!de)throw new Error("      ");if(de.status==="completed")throw new Error("  .    .");const{data:fe,error:pe}=await Z.from("test_questions").select(`
          *,
          answers:test_answers(*)
        `).eq("test_id",e).order("order");if(pe||!fe)throw pe||new Error("  ");const Ne=(fe||[]).map(Me=>{var ye;return{...Me,answers:((ye=Me.answers)==null?void 0:ye.sort((Re,De)=>Re.order-De.order))||[],correct_order:Me.correct_order}});for(const Me of Ne)if(Me.question_type==="sequence"){const{data:ye,error:Re}=await Z.from("test_sequence_answers").select("*").eq("question_id",Me.id).order("answer_order");!Re&&ye&&(Me.answers=ye.map(De=>({...De,text:De.answer_text,order:De.answer_order})))}x(Ne);let ne=Ne.map(Me=>{if(Me.question_type==="sequence"){const ye=(Me.answers||[]).map(Re=>String(Re.id)).sort(()=>Math.random()-.5);return{questionId:Me.id,marked:!1,userOrder:ye,textAnswer:"",answerId:""}}return{questionId:Me.id,marked:!1,textAnswer:"",answerId:""}});p(ne);const{data:_e,error:Te}=await Z.from("user_test_answers").select("*").eq("attempt_id",r);if(!Te&&_e&&_e.length>0){let Me=0;ne=[...ne];for(const ye of _e||[]){const Re=Ne.findIndex(De=>De.id===ye.question_id);if(Re>=0){if(Me=Math.max(Me,Re),ye.text_answer)ne[Re]={...ne[Re],textAnswer:ye.text_answer};else if(ye.answer_id){const De=Ne[Re];if(De.question_type==="single_choice")ne[Re]={...ne[Re],answerId:ye.answer_id};else if(De.question_type==="multiple_choice"){const Ce=ne[Re].answerId,Ye=Ce?Ce.split(","):[];Ye.includes(ye.answer_id)||Ye.push(ye.answer_id),ne[Re]={...ne[Re],answerId:Ye.join(",")}}else De.question_type==="sequence"&&(ne[Re]={...ne[Re],userOrder:(ye.user_order||[]).map(Ce=>String(Ce))})}}}p(ne),U(!0),F(Me),B(!0)}else p(ne)}catch(J){console.error("  :",J),b(J instanceof Error?J.message:"    ")}finally{w(!1)}},[e,t,r,l==null?void 0:l.id,i]);E.useEffect(()=>{if(g===null||g<=0||v)return;const J=setInterval(()=>{y(ue=>ue===null||ue<=1?(k(),0):ue-1)},1e3);return()=>clearInterval(J)},[g,v]),E.useEffect(()=>{S()},[S]);const z=J=>{if(B(!1),J)f(P);else{const ue=d.map(de=>{if(de.question_type==="sequence"){const ce=(de.answers||[]).map(fe=>String(fe.id)).sort(()=>Math.random()-.5);return{questionId:de.id,marked:!1,userOrder:ce,textAnswer:"",answerId:""}}return{questionId:de.id,marked:!1,textAnswer:"",answerId:""}});p(ue),f(0),Z.from("user_test_answers").delete().eq("attempt_id",r).then(()=>{console.log("  ")}).catch(de=>{console.error("   :",de)})}},W=async()=>{const J=d[u],ue=h.find(de=>de.questionId===J.id);if(!(!ue||j)){D(!0);try{const{error:de}=await Z.from("user_test_answers").delete().eq("attempt_id",r).eq("question_id",J.id);if(de&&console.error("    :",de),J.question_type==="text"){if(ue.textAnswer&&ue.textAnswer.trim()){const{error:ce}=await Z.from("user_test_answers").insert({attempt_id:r,question_id:J.id,text_answer:ue.textAnswer.trim()});if(ce)throw console.error("    :",ce),ce}}else if(J.question_type==="single_choice"){if(ue.answerId){const{error:ce}=await Z.from("user_test_answers").insert({attempt_id:r,question_id:J.id,answer_id:ue.answerId});if(ce)throw console.error("     :",ce),ce}}else if(J.question_type==="multiple_choice"){if(ue.answerId){const fe=ue.answerId.split(",").map(Ne=>({attempt_id:r,question_id:J.id,answer_id:Ne})),{error:pe}=await Z.from("user_test_answers").insert(fe);if(pe)throw console.error("    :",pe),pe}}else if(J.question_type==="sequence"&&ue.userOrder&&ue.userOrder.length>0){const{error:ce}=await Z.from("user_test_answers").insert({attempt_id:r,question_id:J.id,user_order:ue.userOrder});if(ce)throw console.error("   :",ce),ce}}catch(de){console.error("  :",de),alert("   .   .")}finally{D(!1)}}},k=async()=>{var J,ue;await W(),C(!0);try{if(!r)throw new Error(": ID   ");const{data:de,error:ce}=await Z.from("user_test_answers").select("*").eq("attempt_id",r);if(ce)throw ce;let fe=0,pe=0;for(const _e of d){pe+=_e.points;const Te=(de==null?void 0:de.filter(Me=>Me.question_id===_e.id))||[];if(_e.question_type==="single_choice"){const Me=Te[0];Me&&((J=_e.answers)!=null&&J.find(Re=>Re.id===Me.answer_id&&Re.is_correct))&&(fe+=_e.points)}else if(_e.question_type==="multiple_choice"&&Te.length>0){const Me=((ue=_e.answers)==null?void 0:ue.filter(Ce=>Ce.is_correct))||[],ye=Te.map(Ce=>Ce.answer_id),Re=Me.every(Ce=>ye.includes(Ce.id)),De=ye.every(Ce=>{var Ye,Ue;return(Ue=(Ye=_e.answers)==null?void 0:Ye.find(He=>He.id===Ce))==null?void 0:Ue.is_correct});Re&&De&&Me.length>0&&(fe+=_e.points)}else if(_e.question_type==="sequence"){const Me=Te[0];if(Me&&Me.user_order){const{data:ye}=await Z.from("test_sequence_answers").select("id").eq("question_id",_e.id).order("answer_order"),Re=ye.map(Ce=>Ce.id);JSON.stringify(Me.user_order)===JSON.stringify(Re)&&(fe+=_e.points)}}}const Ne=pe>0?Math.round(fe/pe*100):0,{error:ne}=await Z.from("user_test_attempts").update({completed_at:new Date().toISOString(),score:Ne,status:"completed"}).eq("id",r);if(ne)throw ne;M(!0),N.current=setTimeout(()=>{M(!1),a(Ne)},3e3)}catch(de){console.error("  :",de),b("    ")}finally{C(!1)}},q=async()=>{await W(),f(J=>Math.max(0,J-1))},A=async()=>{await W(),u<d.length-1?f(J=>J+1):k()};E.useEffect(()=>()=>{N.current&&clearTimeout(N.current)},[]);const I=d[u],V=h.find(J=>J.questionId===(I==null?void 0:I.id)),H=d.length>0?(u+1)/d.length*100:0;let Y=!1;return I&&(I.question_type==="single_choice"?Y=!!(V!=null&&V.answerId):I.question_type==="multiple_choice"?Y=!!(V!=null&&V.answerId)&&V.answerId.split(",").filter(Boolean).length>0:I.question_type==="sequence"?Y=Array.isArray(V==null?void 0:V.userOrder)&&V.userOrder.length===(((Q=I.answers)==null?void 0:Q.length)||0):I.question_type==="text"&&(Y=!!(V!=null&&V.textAnswer)&&V.textAnswer.trim().length>0)),v?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"text-center max-w-sm mx-auto",children:[s.jsx("div",{className:"w-16 h-16 bg-[#19A980]/10 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(Er,{className:"w-8 h-8 text-[#19A980] animate-spin"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:"   ..."})]})}):m?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-md mx-auto",children:[s.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx(an,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-red-800 mb-1",children:" "}),s.jsx("p",{className:"text-red-700 text-sm",children:m})]})]}),s.jsx("button",{onClick:n,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 px-4 rounded-xl transition-colors",children:" "})]})}):R?s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-2xl text-center max-w-md w-full border border-blue-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[s.jsx("div",{className:"w-16 h-16 bg-[#19A980]/10 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(er,{className:"text-[#19A980]",size:32})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"!"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"   "}),s.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[s.jsx("div",{className:"w-2 h-2 bg-[#19A980] rounded-full animate-pulse"}),s.jsx("span",{children:" ..."})]})]})}):!o||d.length===0?null:s.jsxs(s.Fragment,{children:[O&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-2xl text-center max-w-md w-full border border-gray-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[s.jsx("div",{className:"w-16 h-16 bg-[#06A478]/10 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(lo,{className:"text-[#06A478]",size:32})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:" ?"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["    .    ",P+1,"  ",d.length," ."]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>z(!0),className:"w-full bg-gradient-to-r from-[#06A478] to-[#148A6B] hover:from-[#148A6B] hover:to-[#06A478] text-white font-semibold py-3 px-6 rounded-2xl transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:["   ",P+1]}),s.jsx("button",{onClick:()=>z(!1),className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-3 px-6 rounded-2xl transition-all duration-300",children:" "})]})]})}),s.jsx("header",{className:"sticky top-0 z-40 bg-gradient-to-r from-[#06A478] to-[#148A6B] shadow-lg rounded-b-2xl",children:s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"font-bold text-white text-lg mb-1",children:o.title}),o.passing_score>0&&s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-white/90 mb-3",children:[s.jsx(ys,{size:14,className:"text-white/80"}),s.jsxs("span",{children:[" : ",o.passing_score,"%"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs font-semibold text-white",children:""}),s.jsxs("span",{className:"text-xs font-bold text-white",children:[Math.round(H),"%"]})]}),s.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 backdrop-blur-sm",children:s.jsx("div",{className:"bg-gradient-to-r from-white to-white/90 h-2 rounded-full transition-all duration-700 ease-out shadow-sm",style:{width:`${H}%`}})})]})]}),g!==null&&g>0&&s.jsxs("div",{className:`
                  flex items-center space-x-2 px-4 py-3 rounded-2xl font-mono text-sm bg-white/10 backdrop-blur-sm border border-white/20
                  ${g<=300?"bg-red-500/20 text-red-100 border-red-300/30":"text-white"}
                `,children:[s.jsx(wr,{size:16}),s.jsx("span",{children:Lae(g)})]})]})})}),s.jsxs("main",{className:"pb-32 font-mabry pb-safe-bottom",children:[s.jsx("div",{className:"max-w-7xl mx-auto px-2",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden mt-6",children:[s.jsxs("div",{className:"p-0",children:[s.jsx("div",{className:"flex items-start justify-between p-6 pb-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-[#06A478] to-[#148A6B] rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-xs",children:u+1})}),s.jsxs("span",{className:"text-xs font-medium text-gray-500",children:[" ",u+1,"  ",d.length]})]}),s.jsx("h2",{className:"font-bold text-gray-900 text-lg leading-relaxed",children:I.question})]})}),s.jsxs("div",{className:"space-y-3 px-6 pb-6",children:[I.question_type==="single_choice"&&s.jsx("div",{className:"space-y-3",children:(te=I.answers)==null?void 0:te.map(J=>s.jsxs("label",{className:["group flex items-start space-x-3 p-4 border-2 rounded-xl cursor-pointer transition-all duration-300 text-sm hover:shadow-md",(V==null?void 0:V.answerId)===J.id?"border-[#06A478] bg-[#06A478]/15":"border-gray-200 hover:border-[#06A478]/50 hover:bg-gray-50/80 bg-white"].join(" "),children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:s.jsx("div",{className:["w-4 h-4 rounded-full border-2 flex items-center justify-center transition-all duration-300",(V==null?void 0:V.answerId)===J.id?"border-[#06A478] bg-[#06A478]":"border-gray-300 group-hover:border-[#06A478]/50"].join(" "),children:(V==null?void 0:V.answerId)===J.id&&s.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})}),s.jsx("div",{className:"flex-1",children:s.jsx("span",{className:"text-gray-900 leading-relaxed",children:J.text})}),s.jsx("input",{type:"radio",name:`question-${I.id}`,value:J.id,checked:(V==null?void 0:V.answerId)===J.id,onChange:ue=>{const de=[...h],ce=de.findIndex(fe=>fe.questionId===I.id);ce>=0&&(de[ce]={...de[ce],answerId:ue.target.value}),p(de)},className:"sr-only"})]},J.id))}),I.question_type==="multiple_choice"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-4 flex items-center space-x-2",children:[s.jsx(at,{size:16}),s.jsx("span",{children:"   :"})]}),(re=I.answers)==null?void 0:re.map(J=>{var ue,de,ce,fe;return s.jsxs("label",{className:["group flex items-start space-x-3 p-4 border-2 rounded-xl cursor-pointer transition-all duration-300 text-sm hover:shadow-md",(ue=V==null?void 0:V.answerId)!=null&&ue.split(",").includes(J.id)?"border-[#06A478] bg-[#06A478]/15":"border-gray-200 hover:border-[#06A478]/50 hover:bg-gray-50/80 bg-white"].join(" "),children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:s.jsx("div",{className:["w-4 h-4 rounded border-2 flex items-center justify-center transition-all duration-300",(de=V==null?void 0:V.answerId)!=null&&de.split(",").includes(J.id)?"border-[#06A478] bg-[#06A478]":"border-gray-300 group-hover:border-[#06A478]/50"].join(" "),children:((ce=V==null?void 0:V.answerId)==null?void 0:ce.split(",").includes(J.id))&&s.jsx(at,{className:"w-3 h-3 text-white"})})}),s.jsx("div",{className:"flex-1",children:s.jsx("span",{className:"text-gray-900 leading-relaxed",children:J.text})}),s.jsx("input",{type:"checkbox",value:J.id,checked:((fe=V==null?void 0:V.answerId)==null?void 0:fe.split(",").includes(J.id))||!1,onChange:pe=>{const Ne=[...h],ne=Ne.findIndex(_e=>_e.questionId===I.id);if(ne>=0){const _e=Ne[ne].answerId?Ne[ne].answerId.split(","):[];if(pe.target.checked)_e.includes(J.id)||_e.push(J.id);else{const Te=_e.indexOf(J.id);Te>-1&&_e.splice(Te,1)}Ne[ne]={...Ne[ne],answerId:_e.join(",")}}p(Ne)},className:"sr-only"})]},J.id)})]}),I.question_type==="sequence"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-gray-600 flex items-center space-x-2",children:[s.jsx(W_,{size:16}),s.jsx("span",{children:"     :"})]}),s.jsx(WA,{sensors:T,collisionDetection:FA,onDragEnd:({active:J,over:ue})=>{var fe,pe;if(!ue||J.id===ue.id)return;const de=((fe=V==null?void 0:V.userOrder)==null?void 0:fe.findIndex(Ne=>String(Ne)===String(J.id)))??-1,ce=((pe=V==null?void 0:V.userOrder)==null?void 0:pe.findIndex(Ne=>String(Ne)===String(ue.id)))??-1;if(de>=0&&ce>=0){const Ne=jm((V==null?void 0:V.userOrder)||[],de,ce);p(ne=>ne.map(_e=>_e.questionId===I.id?{..._e,userOrder:Ne}:_e))}},children:s.jsx(QA,{items:(V==null?void 0:V.userOrder)||[],strategy:YA,children:s.jsx("div",{className:"space-y-3",children:(X=V==null?void 0:V.userOrder)==null?void 0:X.map((J,ue)=>{var ce;const de=(ce=I.answers)==null?void 0:ce.find(fe=>String(fe.id)===String(J));return s.jsx(Iae,{id:String(J),text:de==null?void 0:de.text,index:ue},J)})})})})]}),I.question_type==="text"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"   :"}),s.jsx("textarea",{value:(V==null?void 0:V.textAnswer)||"",onChange:J=>{const ue=[...h],de=ue.findIndex(ce=>ce.questionId===I.id);de>=0&&(ue[de]={...ue[de],textAnswer:J.target.value}),p(ue)},className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-[#19A980] focus:border-[#19A980] transition-all duration-200 resize-none bg-white",rows:6,placeholder:"  ..."}),s.jsxs("div",{className:"text-xs text-gray-500",children:[((je=V==null?void 0:V.textAnswer)==null?void 0:je.length)||0," "]})]})]})]}),s.jsx("div",{className:"border-t border-gray-100 p-6 hidden sm:block",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("button",{onClick:q,disabled:_||u===0,className:"flex items-center space-x-2 px-6 py-3 text-gray-600 bg-gray-50 hover:bg-gray-100 rounded-xl font-semibold transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-md",children:[s.jsx(Sn,{size:18}),s.jsx("span",{children:""})]}),s.jsx("button",{onClick:A,disabled:_||j||!Y,className:"flex items-center space-x-2 px-6 py-3 rounded-xl font-bold transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-[#06A478] to-[#148A6B] hover:from-[#148A6B] hover:to-[#06A478] text-white shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:_||j?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:u===d.length-1?" ":""}),u===d.length-1?s.jsx(rl,{size:18}):s.jsx(Fa,{size:18})]})})]})})]})}),s.jsx("div",{className:"fixed bottom-4 left-2 right-2 z-50 sm:hidden pb-safe-bottom",children:s.jsxs("div",{className:`\r
              flex items-center justify-between gap-2 px-4 py-3 rounded-2xl shadow-xl\r
              bg-white/95 backdrop-blur-xl\r
            `,children:[s.jsxs("button",{onClick:q,disabled:_||u===0,className:"flex items-center space-x-2 px-3 py-2 text-gray-600 bg-gray-50 hover:bg-gray-100 rounded-xl font-semibold transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(Sn,{size:16}),s.jsx("span",{children:""})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("span",{className:"text-xs text-gray-500 font-medium",children:[u+1,"  ",d.length]}),s.jsx("div",{className:"w-12 h-1 bg-gray-200 rounded-full mt-1",children:s.jsx("div",{className:"h-1 bg-gradient-to-r from-[#06A478] to-[#148A6B] rounded-full transition-all duration-500",style:{width:`${(u+1)/d.length*100}%`}})})]}),s.jsx("button",{onClick:A,disabled:_||!Y,className:"flex items-center space-x-2 px-3 py-2 rounded-xl font-bold transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-[#06A478] to-[#148A6B] hover:from-[#148A6B] hover:to-[#06A478] text-white shadow-lg",children:_?s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:u===d.length-1?"":""}),u===d.length-1?s.jsx(rl,{size:18}):s.jsx(Fa,{size:18})]})})]})})]})]})};function Uae({attemptId:e,onClose:t}){}function $ae({eventId:e,userProfile:t,isAdmin:r,onStartTest:a,refreshKey:n=0,onRefreshData:i}){const[l,o]=E.useState("list"),[c,d]=E.useState(null),[x,u]=E.useState(null),[f,h]=E.useState(null),[p,g]=E.useState(!0),[y,v]=E.useState(null),[w,m]=E.useState([]),[b,_]=E.useState({entry:{available:!1,completed:!1,score:null,attemptId:null,testId:null,test:null},final:{available:!1,completed:!1,score:null,attemptId:null,testId:null,test:null},annual:{available:!1,completed:!1,score:null,attemptId:null,testId:null,test:null}}),[C,j]=E.useState(!0);Qt();const D=(t==null?void 0:t.role)==="employee";E.useEffect(()=>{D&&j(!0)},[D]);const R=()=>(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="moderator"||(t==null?void 0:t.role)==="trainer"||(t==null?void 0:t.role)==="expert"?"      ":"        ",M=async()=>{if(!(!e||!(t!=null&&t.id))){g(!0),v(null);try{const{data:U,error:P}=await Z.from("events").select("event_type_id").eq("id",e).single();if(P)throw console.error("    :",P),new Error("     ");if(!U)throw new Error("  ");const F=U.event_type_id;console.log("eventTypeId:",F);const{data:N,error:T}=await Z.from("tests").select("*").eq("event_type_id",F).eq("status","active");if(T)throw console.error("   :",T),new Error("   ");m(N||[]),console.log("tests:",N);const S={entry:{available:!1,completed:!1,score:null,attemptId:null,testId:null,test:null},final:{available:!1,completed:!1,score:null,attemptId:null,testId:null,test:null},annual:{available:!1,completed:!1,score:null,attemptId:null,testId:null,test:null}};for(const W of N||[]){if(!["entry","final","annual"].includes(W.type)){console.warn(`  : ${W.type}`);continue}if(S[W.type].testId){console.log(`Skipping duplicate ${W.type} test:`,W.id);continue}const{data:k,error:q}=await Z.from("user_test_attempts").select("id, status, score, created_at").eq("test_id",W.id).eq("user_id",t.id).eq("event_id",e).order("created_at",{ascending:!1});q&&console.error(`      ${W.type}:`,q);let A=null,I=null;k&&k.length>0&&(A=k.find(Q=>Q.status==="completed"),I=k[0]);const{data:V,error:H}=await Z.from("test_questions").select("question_type").eq("test_id",W.id);H&&console.error(`      ${W.type}:`,H);const Y=(V==null?void 0:V.some(Q=>Q.question_type==="text"))||!1;if(console.log(`Test ${W.type}:`,{testId:W.id,attemptsCount:(k==null?void 0:k.length)||0,completedAttempt:A==null?void 0:A.id,lastAttempt:I==null?void 0:I.id,lastAttemptStatus:I==null?void 0:I.status,hasOpenEndedQuestions:Y}),A){let Q=A.status;Y&&A.score===0&&A.status==="completed"&&(Q="pending_review"),S[W.type]={available:!0,completed:!0,score:A.score,attemptId:A.id,testId:W.id,test:W,status:Q}}else if(I){let Q=I.status;Y&&I.score===0&&I.status==="completed"&&(Q="pending_review"),S[W.type]={available:!0,completed:I.status==="completed",score:I.score,attemptId:I.id,testId:W.id,test:W,status:Q}}else S[W.type]={...S[W.type],available:!1,completed:!1,score:null,attemptId:null,testId:W.id,test:W}}for(const W of N||[]){if(!["entry","final","annual"].includes(W.type))continue;if(!S[W.type].attemptId){console.log(`Creating ${W.type} test attempt:`,{testId:W.id});const{data:q,error:A}=await Z.from("user_test_attempts").insert({user_id:t.id,test_id:W.id,event_id:e,status:"in_progress",start_time:new Date().toISOString()}).select().single();A?console.error(`     ${W.type} :`,A):q&&(S[W.type]={available:!0,completed:!1,score:null,attemptId:q.id,testId:W.id,test:W})}}const z=N==null?void 0:N.find(W=>W.type==="final");if(z&&!S.final.attemptId&&S.entry.completed){const{data:W,error:k}=await Z.from("user_test_attempts").insert({user_id:t.id,test_id:z.id,event_id:e,status:"in_progress",start_time:new Date().toISOString()}).select().single();k?console.error("      :",k):W&&(S.final={available:!0,completed:!1,score:null,attemptId:W.id,testId:z.id,test:z})}console.log("Final statusObj:",S),_(S)}catch(U){console.error("   :",U),v(U.message||"  ")}finally{g(!1)}}};E.useEffect(()=>{M()},[e,t==null?void 0:t.id]),E.useEffect(()=>{n>0&&M()},[n]);const O=async U=>{var N;console.log(" EventTestsContainer handleStartTest   testType:",U),console.log("  :",w),console.log("  testStatus:",b);const P=w.find(T=>T.type===U);if(!P){console.log("     :",U),alert("  ");return}console.log("  :",P);let F=(N=b[U])==null?void 0:N.attemptId;if(console.log("  attemptId:",F),!F)try{const{data:T,error:S}=await Z.from("user_test_attempts").select("id, status").eq("user_id",t.id).eq("test_id",P.id).eq("event_id",e).maybeSingle();if(S){console.error("    :",S),alert("   ");return}if(T)console.log("   :",T.id,":",T.status),F=T.id,_(z=>({...z,[U]:{...z[U],attemptId:T.id}}));else{console.log("     :",P.id);const{data:z,error:W}=await Z.from("user_test_attempts").insert({user_id:t.id,test_id:P.id,event_id:e,status:"in_progress",start_time:new Date().toISOString()}).select().single();if(W){console.error("     :",W),alert("   ");return}if(!z){console.error("     "),alert("    ");return}console.log("   :",z),F=z.id,_(k=>({...k,[U]:{...k[U],attemptId:z.id}}))}}catch(T){console.error("    :",T),alert("     ");return}console.log("    :",{testType:U,testId:P.id,attemptId:F}),d(U),u(P.id),h(F),o("test"),a?(console.log("   onStartTest  :",{testId:P.id,eventId:e,attemptId:F}),a(P.id,e,F)):console.log(" onStartTest  ")},B=()=>{o("results"),M(),i&&i()},L=()=>{o("list"),d(null),u(null),h(null),M()};return s.jsx(s.Fragment,{children:p?s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:s.jsx("div",{className:"p-4 sm:p-6",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[1,2,3].map(U=>s.jsxs("div",{className:"bg-gray-100 border border-gray-200 rounded-xl p-3 sm:p-4 animate-pulse flex flex-col justify-between h-full min-h-[160px] sm:min-h-[180px]",children:[s.jsxs("div",{children:[s.jsx("div",{className:"h-4 sm:h-5 w-24 sm:w-32 bg-gray-200 rounded mb-2"}),s.jsx("div",{className:"h-3 sm:h-4 w-32 sm:w-40 bg-gray-200 rounded mb-1"}),s.jsx("div",{className:"h-3 w-20 sm:w-24 bg-gray-200 rounded mb-1"}),s.jsx("div",{className:"h-3 w-24 sm:w-28 bg-gray-200 rounded mb-2"})]}),s.jsx("div",{className:"mt-2",children:s.jsx("div",{className:"h-8 sm:h-10 w-full bg-gray-200 rounded"})})]},U))})})}):y?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4 text-center",children:[s.jsx("p",{className:"text-red-600 text-sm sm:text-base",children:y}),s.jsx("button",{onClick:M,className:"mt-2 px-3 sm:px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm sm:text-base",children:" "})]}):s.jsxs(s.Fragment,{children:[l==="list"&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-100 cursor-pointer",onClick:()=>j(!C),children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-base sm:text-lg lg:text-xl xl:text-2xl font-bold text-gray-900",children:""}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:R()})]})})}),C&&s.jsxs("div",{className:"p-4 sm:p-6",children:[s.jsx(Yre,{eventId:e,userProfile:t,onStartTest:(U,P,F)=>{console.log(" EventTestPrompts  onStartTest :",{testId:U,eventId:P,attemptId:F});const N=w.find(T=>T.id===U);N?(console.log("    :",N),O(N.type)):console.error("     ID:",U)},testStatus:b,refreshKey:n}),r&&s.jsx(tse,{eventId:e,userProfile:t,onStartTest:(U,P,F)=>{console.log(" AdminTestSection  onStartTest :",{testId:U,eventId:P,attemptId:F});const N=w.find(T=>T.id===U);N?(console.log("    :",N),O(N.type)):console.error("     ID:",U)},testStatus:b})]})]}),l==="test"&&x&&f&&s.jsx(t7,{testId:x,eventId:e,attemptId:f,onComplete:B,onCancel:L}),l==="results"&&f&&s.jsx(Uae,{attemptId:f,onClose:L})]})})}function zae({eventId:e,userProfile:t}){const r=Qt();return(t==null?void 0:t.role)==="trainer"||(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="moderator"?s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:s.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-base sm:text-lg lg:text-xl xl:text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"      .         ."})]}),s.jsx("button",{className:"px-4 py-2 bg-[#06A478] text-white rounded-lg text-sm font-medium hover:bg-[#059669] transition-colors",onClick:()=>r(`/event-tp-evaluation/${e}`),children:""})]})})}):null}function qae({eventId:e,onClose:t,onSuccess:r}){const{userProfile:a}=st(),[n,i]=E.useState(null),[l,o]=E.useState([]),[c,d]=E.useState([]),[x,u]=E.useState(null),[f,h]=E.useState(""),[p,g]=E.useState(!0),[y,v]=E.useState(!1),[w,m]=E.useState(null),[b,_]=E.useState(!1);E.useEffect(()=>{e&&(async()=>{try{console.log("Fetching feedback template for event:",e),g(!0);const{data:B,error:L}=await Z.from("events").select("event_type_id").eq("id",e).single();if(L)throw console.error("Error fetching event data:",L),L;console.log("Event data:",B);const{data:U,error:P}=await Z.from("feedback_templates").select("*").eq("event_type_id",B.event_type_id).eq("is_default",!0).single();if(P){console.error("Error fetching feedback template:",P),P.code==="PGRST116"?m("        "):m("     "),g(!1);return}console.log("Template data:",U),i(U);const{data:F,error:N}=await Z.from("feedback_questions").select("*").eq("template_id",U.id).order("order_num");if(N)throw console.error("Error fetching questions:",N),N;if(console.log("Questions data:",F),o(F||[]),!F||F.length===0){m("     "),g(!1);return}d(F.map(T=>({questionId:T.id,ratingValue:T.question_type==="rating"?null:void 0,textValue:T.question_type==="text"?"":void 0})))}catch(B){console.error("Error fetching feedback template:",B),B instanceof Error?B.message.includes("function does not exist")?m("       "):B.message.includes("permission denied")?m("      "):m(`      : ${B.message}`):m("      ")}finally{g(!1)}})()},[e]);const C=(O,B)=>{console.log("Rating changed:",O,B),d(L=>L.map(U=>U.questionId===O?{...U,ratingValue:B}:U))},j=(O,B)=>{d(L=>L.map(U=>U.questionId===O?{...U,textValue:B}:U))},D=()=>{console.log("Checking form validity:",{questions:l.length,answers:c.length});const O=l.filter(B=>B.required&&B.question_type==="rating");console.log("Required rating questions:",O.length);for(const B of O){const L=c.find(U=>U.questionId===B.id);if(console.log("Question:",B.question,"Answer:",L),!L||L.ratingValue===void 0||L.ratingValue===null)return console.log("Missing answer for question:",B.question),!1}return console.log("Form is valid"),!0},R=()=>{const O=c.filter(U=>U.ratingValue!==void 0&&U.ratingValue!==null);if(console.log("Rating answers:",O.length),O.length===0)return console.log("No rating answers found"),null;const B=O.reduce((U,P)=>U+(P.ratingValue||0),0),L=Math.round(B/O.length*10)/10;return console.log("Average rating:",L),L},M=async O=>{if(O.preventDefault(),console.log("Form submitted"),!D()){console.log("Form is not valid"),m(",     ");return}if(!a||!n){console.log("Missing userProfile or template:",{userProfile:!!a,template:!!n}),m("    ");return}v(!0),m(null);try{const B=x||R()||0;console.log("Calculated rating:",B,"Overall rating:",x);const{data:L,error:U}=await Z.from("feedback_submissions").insert({user_id:a.id,event_id:e,template_id:n.id,overall_rating:B,comments:f||null,submitted_at:new Date().toISOString()}).select().single();if(U)throw console.error("Error creating feedback submission:",U),U;const P=c.filter(N=>N.ratingValue!==void 0&&N.ratingValue!==null||N.textValue).map(N=>({submission_id:L.id,question_id:N.questionId,rating_value:N.ratingValue||null,text_value:N.textValue||null}));if(console.log("Answers to insert:",P.length),P.length>0){const{error:N}=await Z.from("feedback_answers").insert(P);if(N)throw console.error("Error creating feedback answers:",N),N}const{error:F}=await Z.from("event_participants").update({feedback_submitted:!0}).match({event_id:e,user_id:a.id});F&&console.error("Error updating participant status:",F),console.log("Feedback submitted successfully"),_(!0),setTimeout(()=>{console.log("Closing form after success"),r(),t()},2e3)}catch(B){console.error("Error submitting feedback:",B),B instanceof Error?B.message.includes("duplicate key")?m("       "):B.message.includes("foreign key")?m("    "):m(`     : ${B.message}`):m("     ")}finally{v(!1)}};return console.log("FeedbackForm render:",{loading:p,error:w,success:b,template:!!n,questionsCount:l.length,eventId:e}),p?s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-4 animate-pulse",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded mb-3"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded"})]})]})}):s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 max-w-lg w-full max-h-[95vh] overflow-y-auto flex flex-col",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 px-4 py-3 border-b border-gray-100 sticky top-0 bg-white z-10 rounded-t-2xl",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-1 rounded-lg bg-sns-100",children:s.jsx(La,{className:"h-5 w-5 text-sns-500"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-900 leading-tight",children:(n==null?void 0:n.name)||"        "}),(n==null?void 0:n.description)&&s.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 leading-snug",children:n.description})]})]}),s.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-all duration-200","aria-label":"",children:s.jsx(Qe,{size:22})})]}),b?s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto rounded-full flex items-center justify-center mb-4 shadow-lg",style:{backgroundColor:"#10B981"},children:s.jsx(Pa,{className:"w-8 h-8 text-white"})}),s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"    !"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"            ."})]}):s.jsxs("form",{onSubmit:M,className:"flex-1 flex flex-col gap-4 p-4",children:[w&&s.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-3 rounded-xl text-sm flex items-center gap-2",children:[s.jsx(an,{className:"h-5 w-5 text-red-400"}),s.jsx("span",{className:"text-red-600 font-medium",children:w})]}),s.jsxs("div",{className:"bg-amber-50 p-3 rounded-xl border border-amber-200 text-xs sm:text-sm flex items-center gap-2",children:[s.jsx(Ms,{className:"h-4 w-4 text-amber-400"}),s.jsx("span",{children:"1   , 2  , 3  , 4  , 5  "})]}),s.jsx("div",{className:"flex-1 flex flex-col gap-4",children:l.map(O=>{var B;return s.jsxs("div",{className:Ve("p-3 border rounded-xl bg-white flex flex-col gap-2",O.required?"border-blue-200":"border-gray-200"),children:[s.jsxs("label",{className:"block font-semibold text-gray-900 text-sm mb-1",children:[O.question,O.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),O.question_type==="rating"?s.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(L=>{var P;const U=(P=c.find(F=>F.questionId===O.id))==null?void 0:P.ratingValue;return s.jsx("button",{type:"button",onClick:()=>C(O.id,L),className:Ve("p-1 rounded-full transition-all duration-200",U&&U>=L?"text-amber-400":"text-gray-300 hover:text-amber-400"),style:U&&U>=L?{color:"#F59E0B",fill:"#F59E0B"}:{},title:`${L} ${L===1?"":L<5?"":""}`,children:s.jsx(Ms,{className:"w-6 h-6 fill-current"})},L)}),(()=>{var U;const L=(U=c.find(P=>P.questionId===O.id))==null?void 0:U.ratingValue;return L?s.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 rounded-full text-xs font-semibold text-gray-700",children:[L," ",L===1?"":L<5?"":""]}):null})()]}):s.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white text-sm",rows:3,value:((B=c.find(L=>L.questionId===O.id))==null?void 0:B.textValue)||"",onChange:L=>j(O.id,L.target.value),placeholder:"  ...",required:O.required})]},O.id)})}),s.jsxs("div",{className:"p-3 border border-purple-200 rounded-xl bg-purple-50 flex flex-col gap-2",children:[s.jsx("label",{className:"block font-semibold text-gray-900 text-sm mb-1",children:"  "}),s.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(O=>s.jsx("button",{type:"button",onClick:()=>u(O),className:Ve("p-1 rounded-full transition-all duration-200",x&&x>=O?"text-purple-500":"text-gray-300 hover:text-purple-500"),style:x&&x>=O?{color:"#a78bfa",fill:"#a78bfa"}:{},title:`${O} ${O===1?"":O<5?"":""}`,children:s.jsx(Ms,{className:"w-6 h-6 fill-current"})},O)),x?s.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white border border-purple-200 rounded-full text-xs font-semibold text-purple-700",children:[x," ",x===1?"":x<5?"":""]}):null]}),s.jsxs("p",{className:"text-xs text-gray-500 bg-white p-2 rounded-lg border border-gray-200 mt-1",children:[s.jsx("span",{className:"font-medium",children:""}),"   ,        ."]})]}),s.jsxs("div",{className:"p-3 border border-gray-200 rounded-xl bg-gray-50 flex flex-col gap-2",children:[s.jsx("label",{className:"block font-semibold text-gray-900 text-sm mb-1",children:" "}),s.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white text-sm",rows:3,value:f,onChange:O=>h(O.target.value),placeholder:"    ..."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2 border-t border-gray-100 mt-2",children:[s.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 font-semibold text-sm",children:""}),s.jsx("button",{type:"submit",disabled:y||!D(),className:Ve("w-full sm:w-auto px-6 py-2 rounded-lg transition-all duration-200 font-semibold shadow-md text-sm",y||!D()?"bg-gray-300 text-gray-500 cursor-not-allowed":"text-white hover:shadow-lg bg-sns-500"),children:y?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),s.jsx("span",{children:"..."})]}):s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx(rl,{className:"w-4 h-4 mr-1"}),s.jsx("span",{children:" "})]})})]})]})]})})}function Vae({comments:e,title:t="  "}){const[r,a]=E.useState(new Set),[n,i]=E.useState(0),l=1,o=v=>{const w=new Set(r);w.has(v)?w.delete(v):w.add(v),a(w)},c=async v=>{try{await navigator.clipboard.writeText(v)}catch(w){console.error("Failed to copy text: ",w)}},d=Math.ceil(e.length/l),x=n*l,u=x+l,f=e.slice(x,u),h=()=>{n<d-1&&i(n+1)},p=()=>{n>0&&i(n-1)},g=v=>{if(!v)return"bg-gray-500";const w=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-indigo-500"],m=v.split("").reduce((b,_)=>b+_.charCodeAt(0),0);return w[m%w.length]},y=v=>v?v.split(" ").map(w=>w.charAt(0)).join("").toUpperCase().slice(0,2):"?";return!e||e.length===0?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("div",{className:"flex items-center gap-3 mb-4",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t})}),s.jsxs("div",{className:"text-center py-6",children:[s.jsx(La,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"    "})]})]}):s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),s.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:[e.length," ",e.length===1?"":e.length<5?"":""]})]}),s.jsx("div",{className:"space-y-4",children:f.map((v,w)=>s.jsxs("div",{className:"rounded-xl p-4 border shadow-sm",style:{borderColor:"#06A478",backgroundColor:"#06A47810"},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:Ve("w-10 h-10 rounded-full flex items-center justify-center text-white font-semibold text-sm",g(v.user_id)),children:v.is_anonymous?"":y(v.user_full_name)}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-gray-900 uppercase text-sm",children:v.is_anonymous?" ":v.user_full_name.toUpperCase()}),s.jsxs("div",{className:"text-gray-500 text-xs",children:[v.user_territory||"",v.user_territory_region&&`-${v.user_territory_region}`]})]})]}),s.jsxs("div",{className:"relative bg-white rounded-xl p-4 border border-gray-200 shadow-sm",children:[s.jsx("button",{onClick:()=>c(v.value),className:"absolute top-3 right-3 p-2 rounded-lg hover:bg-gray-50 transition-colors duration-200",title:" ",children:s.jsx(Hc,{className:"w-4 h-4 text-gray-300 hover:text-gray-500"})}),s.jsx("div",{className:"text-gray-800 leading-relaxed pr-10",children:v.value.length>200&&!r.has(v.id)?s.jsxs("div",{children:[s.jsxs("p",{className:"mb-2",children:[v.value.substring(0,200),"..."]}),s.jsx("button",{onClick:()=>o(v.id),className:"text-sm font-medium hover:underline",style:{color:"#06A478"},children:" "})]}):s.jsxs("div",{children:[s.jsx("p",{children:v.value}),v.value.length>200&&r.has(v.id)&&s.jsx("button",{onClick:()=>o(v.id),className:"text-sm font-medium mt-2 hover:underline block",style:{color:"#06A478"},children:""})]})})]})]},v.id||w))}),d>1&&s.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:p,disabled:n===0,className:Ve("p-2 rounded-lg transition-colors duration-200",n===0?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:s.jsx(Sn,{className:"w-5 h-5"})}),s.jsxs("span",{className:"text-sm text-gray-600",children:[n+1,"  ",d]}),s.jsx("button",{onClick:h,disabled:n===d-1,className:Ve("p-2 rounded-lg transition-colors duration-200",n===d-1?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:s.jsx(Fa,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex gap-1",children:Array.from({length:d},(v,w)=>s.jsx("button",{onClick:()=>i(w),className:Ve("w-2 h-2 rounded-full transition-colors duration-200",w===n?"bg-gray-600":"bg-gray-300 hover:bg-gray-400")},w))})]})]})}function Hae({eventId:e,adminStatOnly:t=!1}){const{userProfile:r}=st(),[a,n]=E.useState({canSubmitFeedback:!0,hasSubmittedFeedback:!1,reasonDisabled:null}),[i,l]=E.useState(!1),[o,c]=E.useState(!0),[d,x]=E.useState(null),[u,f]=E.useState(!1),[h,p]=E.useState(0),[g,y]=E.useState(0),[v,w]=E.useState([]),[m,b]=E.useState((r==null?void 0:r.role)==="employee"),[_,C]=E.useState(!1),[j,D]=E.useState(null),[R,M]=E.useState(0),[O,B]=E.useState([]),L=t||(r==null?void 0:r.role)==="administrator"||(r==null?void 0:r.role)==="moderator",U=t||(r==null?void 0:r.role)==="trainer"||L,P=(r==null?void 0:r.role)==="employee";E.useEffect(()=>{P&&b(!0)},[P]),E.useEffect(()=>{console.log("useEffect triggered:",{eventId:e,userId:r==null?void 0:r.id,userProfile:r}),e&&(r!=null&&r.id)?F():e&&!(r!=null&&r.id)&&console.log("User profile not loaded yet")},[e,r==null?void 0:r.id]),E.useEffect(()=>{U&&e&&N()},[U,e]),E.useEffect(()=>{console.log("FeedbackTab: feedbackStats",v,"averageRating",h)},[v,h]);const F=E.useCallback(async()=>{c(!0);try{if(console.log("Checking feedback status for event:",e,"user:",r==null?void 0:r.id),!(r!=null&&r.id)){console.log("User profile not loaded"),n({canSubmitFeedback:!1,hasSubmittedFeedback:!1,reasonDisabled:"  "}),c(!1);return}const{data:A,error:I}=await Z.from("feedback_submissions").select("id").eq("event_id",e).eq("user_id",r==null?void 0:r.id).maybeSingle();if(I)throw console.error("Error checking feedback submissions:",I),I;const V=!!A;if(console.log("Has submitted feedback:",V),U){console.log("User is trainer/admin, setting status"),n({canSubmitFeedback:!V,hasSubmittedFeedback:V,reasonDisabled:V?"    ":null}),c(!1);return}const{data:H,error:Y}=await Z.rpc("should_show_feedback_form",{p_user_id:r==null?void 0:r.id,p_event_id:e});if(Y)throw console.error("Error calling should_show_feedback_form:",Y),Y;console.log("should_show_feedback_form result:",H);let Q=null;!H&&!V?Q="         ":V&&(Q="    ");const te={canSubmitFeedback:H&&!V,hasSubmittedFeedback:V,reasonDisabled:Q};console.log("Setting feedback status:",te),n(te)}catch(A){console.error("Error checking feedback status:",A),A instanceof Error?A.message.includes("function does not exist")?x("       "):A.message.includes("permission denied")?x("      "):x(`     : ${A.message}`):x("     "),n({canSubmitFeedback:!1,hasSubmittedFeedback:!1,reasonDisabled:"   "})}finally{c(!1)}},[e,r==null?void 0:r.id]),N=async()=>{try{const{data:A,error:I}=await Z.from("events").select("id, event_type_id").eq("id",e).single();if(I)throw console.error("Error fetching event data:",I),I;const{data:V,error:H}=await Z.from("feedback_templates").select("id, name, description").eq("event_type_id",A.event_type_id).eq("is_default",!0).limit(1);if(H)throw console.error("Error fetching feedback template:",H),H;if(!V||V.length===0){console.log("No feedback template found for event type:",A.event_type_id),w([]),p(0),y(0),B([]);return}const Y=V[0],{data:Q,error:te}=await Z.from("feedback_questions").select("id, question, question_type, required, order_num, options").eq("template_id",Y.id).order("order_num");if(te)throw console.error("Error fetching feedback questions:",te),te;const{data:re,error:X}=await Z.from("feedback_submissions").select(`
          id, 
          user_id, 
          overall_rating, 
          comments, 
          is_anonymous,
          users!inner(full_name)
        `).eq("event_id",e).eq("template_id",Y.id);if(X)throw console.error("Error fetching feedback submissions:",X),X;const{data:je,error:J}=await Z.from("feedback_answers").select(`
          id, 
          submission_id, 
          question_id, 
          rating_value, 
          text_value, 
          options_value
        `).in("submission_id",re.map(De=>De.id));if(J)throw console.error("Error fetching feedback answers:",J),J;const ue=re.map(De=>De.user_id),{data:de}=await Z.from("event_participants_view").select("user_id, full_name, territory_name, territory_region").eq("event_id",e).in("user_id",ue),ce=new Map;de&&de.forEach(De=>{ce.set(De.user_id,De)});const fe=new Map;je.forEach(De=>{fe.has(De.submission_id)||fe.set(De.submission_id,[]),fe.get(De.submission_id).push(De)});const pe=Q.map(De=>{const Ce=[];let Ye=0,Ue=0;return re.forEach(He=>{var Jt;const Je=(fe.get(He.id)||[]).find(or=>or.question_id===De.id);if(Je){let or=null;if(De.question_type==="rating"&&Je.rating_value?(or=Je.rating_value,Ye+=or,Ue++):De.question_type==="text"&&Je.text_value?or=Je.text_value:De.question_type==="options"&&Je.options_value&&(or=Je.options_value),or!==null){const vt=ce.get(He.user_id);Ce.push({user_id:He.user_id,value:or,user_full_name:(vt==null?void 0:vt.full_name)||((Jt=He.users)==null?void 0:Jt.full_name)||" ",user_territory:(vt==null?void 0:vt.territory_name)||"",user_territory_region:(vt==null?void 0:vt.territory_region)||"",submission_id:He.id,is_anonymous:He.is_anonymous})}}}),{question_id:De.id,question:De.question,question_type:De.question_type,required:De.required,order_num:De.order_num,options:De.options,responses:Ce,average_rating:Ue>0?Ye/Ue:null,response_count:Ce.length}}),Ne=re.length,ne=re.filter(De=>De.overall_rating).map(De=>De.overall_rating),_e=ne.length>0?ne.reduce((De,Ce)=>De+Ce,0)/ne.length:0;w(pe),y(Ne),p(_e);const Te=[];pe.forEach(De=>{De.question_type==="text"&&De.responses.forEach(Ce=>{Te.push({id:`${De.question_id}-${Ce.submission_id}`,...Ce,question_text:De.question})})}),B(Te);const{data:Me}=await Z.from("event_participants_view").select("user_id").eq("event_id",e),ye=(Me==null?void 0:Me.length)||0,Re=ye>0?Math.round(Ne/ye*100):0;M(Re)}catch(A){console.error("Error fetching feedback stats:",A),w([]),y(0),p(0)}},T=()=>{console.log("Feedback submitted successfully"),F(),f(!0),setTimeout(()=>f(!1),3e3)},S=(A,I,V)=>{D({rating:A,participants:I,question:V}),C(!0)};function z(A){if(A==null)return s.jsx("span",{className:"text-gray-400 text-xs sm:text-sm",children:" "});const I=Math.floor(A),V=A%1>=.5,H=5-I-(V?1:0);return s.jsxs("div",{className:"flex items-center gap-0.5",children:[Array(I).fill(0).map((Y,Q)=>s.jsx("svg",{className:"h-3 w-3 sm:h-4 sm:w-4 text-yellow-400 fill-current",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},Q)),V&&s.jsx("svg",{className:"h-3 w-3 sm:h-4 sm:w-4 text-yellow-400 fill-current opacity-75",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),Array(H).fill(0).map((Y,Q)=>s.jsx("svg",{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-300",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},Q+10))]})}function W(A){var V;if(!A)return"";const I=A.trim().split(" ");return I.length===1?((V=I[0][0])==null?void 0:V.toUpperCase())||"":(I[0][0]+I[1][0]).toUpperCase()}function k(A){if(!A)return"bg-gray-100 text-gray-800";const I=["bg-blue-100 text-blue-800","bg-green-100 text-green-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-yellow-100 text-yellow-800","bg-indigo-100 text-indigo-800","bg-red-100 text-red-800","bg-orange-100 text-orange-800","bg-teal-100 text-teal-800"],V=A.split("").reduce((H,Y)=>H+Y.charCodeAt(0),0);return I[V%I.length]}function q(A){if(!A.responses||A.responses.length===0)return null;const I={1:[],2:[],3:[],4:[],5:[]};A.responses.forEach(H=>{H.value>=1&&H.value<=5&&I[H.value].push(H)});const V=A.responses.length;return s.jsx("div",{className:"space-y-1",children:Object.entries(I).reverse().map(([H,Y])=>{const Q=Y,te=Q.length,re=V>0?te/V*100:0;return s.jsxs("div",{className:"flex items-center gap-2 p-1 rounded hover:bg-gray-50 cursor-pointer transition-colors duration-200 touch-manipulation",onClick:()=>S(parseInt(H),Q,A.question),children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-600 w-3 sm:w-4",children:H}),s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"h-1.5 sm:h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:Ve("h-full rounded-full",H==="5"?"bg-green-500":H==="4"?"bg-blue-500":H==="3"?"bg-yellow-500":H==="2"?"bg-orange-500":"bg-red-500"),style:{width:`${re}%`}})})}),s.jsxs("div",{className:"flex items-center gap-1 min-w-[50px] sm:min-w-[60px] justify-end",children:[s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:te}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",re.toFixed(0),"%)"]})]})]},H)})})}return console.log("FeedbackTab render:",{loading:o,error:d,feedbackStatus:a,showFeedbackForm:i,isTrainer:U,userProfile:r==null?void 0:r.role}),o?s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-4 sm:mb-6 animate-pulse",children:[s.jsx("div",{className:"h-6 sm:h-8 bg-gray-200 rounded w-1/3 mb-3 sm:mb-4"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[1,2,3].map(A=>s.jsxs("div",{className:"bg-gray-100 rounded-xl h-20 sm:h-24 animate-pulse shadow flex flex-col items-center justify-center",children:[s.jsx("div",{className:"h-6 w-6 sm:h-8 sm:w-8 bg-gray-200 rounded-full mb-2"}),s.jsx("div",{className:"h-3 w-12 sm:w-16 bg-gray-200 rounded"})]},A))}),s.jsx("div",{className:"h-8 sm:h-10 bg-gray-200 rounded w-32 sm:w-40 mx-auto"})]}):d?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 sm:p-6",children:[s.jsx("h3",{className:"text-red-800 font-medium mb-2 text-sm sm:text-base",children:""}),s.jsx("p",{className:"text-red-600 text-xs sm:text-sm",children:d})]}):s.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-base sm:text-lg lg:text-xl xl:text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:U?"     ":"     "})]}),s.jsx("button",{className:"px-4 py-2 bg-[#06A478] text-white rounded-lg text-sm font-medium hover:bg-[#059669] transition-colors",onClick:()=>b(!m),children:""})]})}),m&&s.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[!U&&s.jsx("div",{className:Ve("p-4 sm:p-6 rounded-xl border border-gray-200 transition-all duration-200",a.hasSubmittedFeedback?"bg-green-50 border-green-200":a.canSubmitFeedback?"bg-blue-50 border-blue-200":"bg-amber-50 border-amber-200"),children:a.hasSubmittedFeedback?s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-1.5 sm:p-2 rounded-full mr-3 sm:mr-4",style:{backgroundColor:"#10B981"},children:s.jsx(at,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-900 font-semibold text-base sm:text-lg",children:"    !"}),s.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:"          ."})]})]}):a.canSubmitFeedback?s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-1.5 sm:p-2 rounded-full mr-3 sm:mr-4",style:{backgroundColor:"#06A478"},children:s.jsx(Ms,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-900 font-semibold text-base sm:text-lg",children:"  ?"}),s.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:"       . ,   ."})]})]}),s.jsx("div",{className:"flex justify-end sm:justify-start",children:s.jsxs("button",{onClick:()=>{console.log("Feedback button clicked"),console.log("Current status:",a),console.log("isTrainer:",U),l(!0)},disabled:!a.canSubmitFeedback,className:Ve("flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-all duration-200 touch-manipulation min-h-[48px] rounded-lg shadow-sm w-full sm:w-auto",a.canSubmitFeedback?"bg-[#06A478] hover:bg-[#059669] active:bg-[#047857] text-white hover:shadow-md hover:scale-[1.02] active:scale-[0.98]":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:[s.jsx(q_,{className:"h-4 w-4"}),s.jsx("span",{children:" "})]})})]}):s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-1.5 sm:p-2 rounded-full mr-3 sm:mr-4",style:{backgroundColor:"#F59E0B"},children:s.jsx(er,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-900 font-semibold text-base sm:text-lg",children:"  "}),s.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:a.reasonDisabled||"         ."})]})]})}),U&&v.length>0&&g>0&&s.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-4 sm:p-6 border border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg",style:{backgroundColor:"#06A47820"},children:s.jsx(Dn,{className:"w-4 h-4 sm:w-5 sm:h-5",style:{color:"#06A478"}})}),s.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900",children:" "})]}),s.jsxs("div",{className:"text-xs sm:text-sm font-medium",style:{color:"#06A478"},children:[R,"%   "]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6",children:[s.jsx("div",{className:"bg-white rounded-lg p-3 sm:p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg",style:{backgroundColor:"#06A47815"},children:s.jsx(nt,{className:"w-3 h-3 sm:w-4 sm:h-4",style:{color:"#06A478"}})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:" "}),s.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:g})]})]})}),s.jsx("div",{className:"bg-white rounded-lg p-3 sm:p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg",style:{backgroundColor:"#06A47815"},children:s.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4",style:{color:"#06A478"}})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:" "}),s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[s.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:h.toFixed(1)}),z(h)]})]})]})}),s.jsx("div",{className:"bg-white rounded-lg p-3 sm:p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg",style:{backgroundColor:"#06A47815"},children:s.jsx(La,{className:"w-3 h-3 sm:w-4 sm:h-4",style:{color:"#06A478"}})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:""}),s.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:O.length})]})]})})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-2 sm:gap-3",children:v.filter(A=>A.question_type!=="text"&&A.response_count>0).map((A,I)=>{var V;return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-2.5 sm:p-3",children:[s.jsxs("div",{className:"flex items-start justify-between mb-1.5 sm:mb-2",children:[s.jsx("h4",{className:"text-gray-900 font-medium text-sm sm:text-base leading-tight pr-2 flex-1",children:A.question}),s.jsxs("div",{className:"flex items-center gap-1 text-gray-500 text-xs sm:text-sm",children:[s.jsx(nt,{className:"h-3 w-3 sm:h-4 sm:w-4"}),s.jsx("span",{children:A.response_count})]})]}),A.question_type==="rating"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-1.5 sm:mb-2",children:[z(A.average_rating),s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:((V=A.average_rating)==null?void 0:V.toFixed(1))||"0.0"})]}),q(A)]}),A.question_type==="options"&&s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:[" : ",s.jsx("span",{className:"font-semibold text-gray-900",children:A.response_count})]}),A.options&&s.jsxs("div",{className:"text-xs text-gray-600",children:[": ",A.options.split(",").length," "]})]})]},A.question_id||I)})}),O.length>0&&s.jsx("div",{className:"mt-4 sm:mt-6",children:s.jsx(Vae,{comments:O})})]}),U&&(v.length===0||g===0)&&s.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 border border-blue-200 shadow-sm",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-16 h-16 sm:w-20 sm:h-20 bg-blue-100 rounded-full flex items-center justify-center mb-4 sm:mb-6",children:s.jsx(La,{className:"w-8 h-8 sm:w-10 sm:h-10 text-blue-600"})}),s.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-900 mb-2 sm:mb-3",children:"    "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 max-w-md mx-auto",children:"      .            ."})]})})]})]}),i&&s.jsx(qae,{eventId:e,onClose:()=>{console.log("Closing feedback form"),l(!1)},onSuccess:T}),u&&s.jsx("div",{className:"fixed bottom-4 sm:bottom-6 right-4 sm:right-6 text-white px-4 sm:px-6 py-3 sm:py-4 rounded-xl shadow-lg text-base sm:text-lg font-semibold z-50 animate-fade-in",style:{backgroundColor:"#10B981"},children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx(at,{className:"h-5 w-5 sm:h-6 sm:w-6"}),s.jsx("span",{children:"   !"})]})}),_&&j&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-3 sm:p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-sm sm:max-w-md w-full max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:[" ",j.rating," "]}),s.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:j.question})]}),s.jsx("div",{className:"p-3 sm:p-4 overflow-y-auto max-h-[60vh]",children:s.jsx("div",{className:"space-y-2",children:j.participants.map((A,I)=>s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 rounded-lg hover:bg-gray-50",children:[s.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full flex items-center justify-center font-semibold text-xs sm:text-sm text-white",style:{backgroundColor:k(A.user_id).includes("bg-blue")?"#3B82F6":k(A.user_id).includes("bg-green")?"#10B981":k(A.user_id).includes("bg-purple")?"#8B5CF6":k(A.user_id).includes("bg-pink")?"#EC4899":k(A.user_id).includes("bg-yellow")?"#F59E0B":k(A.user_id).includes("bg-indigo")?"#6366F1":k(A.user_id).includes("bg-red")?"#EF4444":k(A.user_id).includes("bg-orange")?"#F97316":k(A.user_id).includes("bg-teal")?"#14B8A6":"#6B7280"},children:W(A.user_full_name)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:A.user_full_name||" "}),s.jsxs("div",{className:"text-xs text-gray-500 space-y-0.5",children:[A.user_territory&&s.jsxs("p",{children:[": ",A.user_territory]}),A.user_territory_region&&s.jsxs("p",{children:[": ",A.user_territory_region]}),!A.user_territory&&!A.user_territory_region&&s.jsxs("p",{children:["ID: ",A.user_id]})]})]}),s.jsx("div",{className:"flex items-center gap-0.5 sm:gap-1",children:[...Array(5)].map((V,H)=>s.jsx("svg",{className:`w-3 h-3 sm:w-4 sm:h-4 ${H<j.rating?"text-yellow-400 fill-current":"text-gray-300"}`,viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},H))})]},A.user_id||I))})}),s.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200 bg-gray-50",children:s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 text-center",children:[" : ",j.participants.length]})})]})})]})}function Wae({event:e,userProfile:t,participants:r,onMarkAttendance:a,onViewParticipants:n,onStartEvent:i,onCompleteEvent:l}){const[o,c]=E.useState([]),[d,x]=E.useState(0),[u,f]=E.useState(!1),[h,p]=E.useState(new Set),[g,y]=E.useState("notifications");E.useEffect(()=>{if(!t||t.role!=="trainer"||!e)return;const N=[],T=new Date,S=new Date(e.start_date),z=new Date(e.end_date),W=T>=S,k=e.status==="completed"||e.end_date&&T>=z,q=T.toDateString()===S.toDateString(),A=r.length,I=r.filter(H=>H.attended).length,V=A-I;if(W&&!k&&V>0&&N.push({id:"mark-attendance",type:"action",title:" ",description:`${V}  ${A}     `,actionText:" ",onAction:a,icon:s.jsx(nt,{className:"w-5 h-5"}),priority:1,autoHide:!1}),!W&&q&&Math.floor((S.getTime()-T.getTime())/6e4)<=0&&N.push({id:"start-event",type:"action",title:" ",description:"   .   .",actionText:" ",onAction:i,icon:s.jsx(ar,{className:"w-5 h-5"}),priority:1,autoHide:!1}),q&&!W&&A>0){const H=Math.floor((S.getTime()-T.getTime())/6e4);H<=30&&H>0&&N.push({id:"event-starting",type:"warning",title:"  ",description:`    ${H} .  .`,icon:s.jsx(wr,{className:"w-5 h-5"}),priority:2,autoHide:!1})}W&&e.status!=="completed"&&e.end_date&&T>=z&&N.push({id:"event-can-be-completed",type:"info",title:"  ",description:"  .      .",icon:s.jsx(at,{className:"w-5 h-5"}),priority:3,autoHide:!1}),k&&I<A&&N.push({id:"complete-attendance",type:"info",title:"  ",description:" .    .",actionText:" ",onAction:a,icon:s.jsx(at,{className:"w-5 h-5"}),priority:2,autoHide:!1}),A>0&&!k&&N.push({id:"view-participants",type:"info",title:" ",description:`   ${A} .   .`,actionText:" ",onAction:n,icon:s.jsx(nt,{className:"w-5 h-5"}),priority:3,autoHide:!1}),N.sort((H,Y)=>H.priority-Y.priority),c(N),x(0)},[e,t,r,a,n,i,l]),E.useEffect(()=>{const N=o[d];if(N!=null&&N.autoHide&&N.autoHideDelay){const T=setTimeout(()=>{v(N.id)},N.autoHideDelay);return()=>clearTimeout(T)}},[o,d]);const v=N=>{p(S=>new Set([...S,N]));const T=d+1;T<o.length?x(T):x(0)},w=()=>{const N=(d+1)%o.length;x(N)},m=()=>{const N=d-1<0?o.length-1:d-1;x(N)},b=o.filter(N=>!h.has(N.id)),_=b[d],C=new Date,j=new Date(e.start_date),D=new Date(e.end_date),R=C>=j,M=e.status==="completed"||e.end_date&&C>=D,O=r.length,B=r.filter(N=>N.attended).length,L=O-B,U=[{id:"check-participants",title:" ",completed:O>0,inProgress:!1},{id:"mark-attendance",title:" ",completed:L===0&&O>0,inProgress:R&&L>0},{id:"conduct-event",title:" ",completed:M,inProgress:R&&!M},{id:"complete-event",title:" ",completed:e.status==="completed",inProgress:e.end_date&&C>=D&&e.status!=="completed"}],P=U.filter(N=>N.completed).length,F=P/U.length*100;return(t==null?void 0:t.role)!=="trainer"?null:s.jsx("div",{className:"fixed bottom-5 right-5 z-50 pointer-events-none",children:s.jsx(Xa.div,{initial:{opacity:0,y:24,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:24,scale:.98},transition:{duration:.25,ease:"easeOut"},className:"pointer-events-auto",children:u?s.jsxs("button",{onClick:()=>f(!1),className:`relative flex items-center justify-center w-14 h-14 rounded-full\r
                       bg-white/80 dark:bg-zinc-900/70 backdrop-blur-xl\r
                       border border-white/40 dark:border-white/10 shadow-[0_8px_30px_rgba(2,6,23,.1)]\r
                       hover:shadow-[0_12px_40px_rgba(2,6,23,.15)]\r
                       transition-all`,"aria-label":"  ",children:[s.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-emerald-500/15 to-emerald-600/10 pointer-events-none"}),g==="notifications"?s.jsx(Gl,{className:"w-6 h-6 text-emerald-600 dark:text-emerald-400","aria-hidden":"true"}):s.jsx(Dn,{className:"w-6 h-6 text-emerald-600 dark:text-emerald-400","aria-hidden":"true"}),b.length>0&&s.jsx("span",{className:`absolute -top-1.5 -right-1.5 min-w-5 h-5 px-1 rounded-full\r
                               bg-emerald-600 text-white text-[11px] font-semibold\r
                               flex items-center justify-center shadow-md`,children:b.length})]}):s.jsxs(Xa.div,{initial:{opacity:0,y:14,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:14,scale:.98},transition:{duration:.2},className:`w-[320px] sm:w-[360px] rounded-2xl\r
                       bg-white/75 dark:bg-zinc-900/70 backdrop-blur-xl\r
                       border border-white/50 dark:border-white/10\r
                       shadow-[0_12px_50px_rgba(2,6,23,.15)]`,children:[s.jsxs("div",{className:"px-4 pt-3 pb-2 flex items-center justify-between",children:[s.jsxs("div",{className:"inline-flex p-1 rounded-xl bg-zinc-100/80 dark:bg-zinc-800/60",children:[s.jsxs("button",{onClick:()=>y("notifications"),className:`px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1.5 transition
                    ${g==="notifications"?"bg-white dark:bg-zinc-900 shadow-sm text-emerald-700 dark:text-emerald-300":"text-zinc-600 dark:text-zinc-300 hover:text-zinc-900 dark:hover:text-white"}`,children:[s.jsx(Gl,{className:"w-3.5 h-3.5"}),"",b.length>0&&s.jsx("span",{className:`ml-1 inline-flex items-center justify-center w-4 h-4 rounded-full\r
                                     bg-emerald-600 text-white text-[10px]`,children:b.length})]}),s.jsxs("button",{onClick:()=>y("progress"),className:`px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1.5 transition
                    ${g==="progress"?"bg-white dark:bg-zinc-900 shadow-sm text-emerald-700 dark:text-emerald-300":"text-zinc-600 dark:text-zinc-300 hover:text-zinc-900 dark:hover:text-white"}`,children:[s.jsx(Dn,{className:"w-3.5 h-3.5"}),""]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("button",{onClick:()=>f(!0),className:`p-1.5 rounded-md text-zinc-500 hover:text-zinc-800 dark:hover:text-white\r
                             hover:bg-zinc-100/80 dark:hover:bg-zinc-800/60 transition`,"aria-label":"",children:s.jsx(Fa,{className:"w-4 h-4"})}),g==="notifications"&&_&&s.jsx("button",{onClick:()=>v(_.id),className:`p-1.5 rounded-md text-zinc-500 hover:text-zinc-800 dark:hover:text-white\r
                               hover:bg-zinc-100/80 dark:hover:bg-zinc-800/60 transition`,"aria-label":" ",children:s.jsx(Qe,{className:"w-4 h-4"})})]})]}),s.jsx(oJ,{mode:"wait",children:g==="notifications"?s.jsx(Xa.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"px-4 pb-4",children:_?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[s.jsx("div",{className:`p-2.5 rounded-lg ring-1 ring-inset
                            ${_.type==="action"?"bg-emerald-50 text-emerald-700 ring-emerald-200":_.type==="warning"?"bg-amber-50 text-amber-700 ring-amber-200":_.type==="success"?"bg-emerald-50 text-emerald-700 ring-emerald-200":"bg-zinc-100 text-zinc-700 ring-zinc-200"}`,children:_.icon}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-50",children:_.title}),b.length>1&&s.jsxs("p",{className:"mt-0.5 text-[11px] text-zinc-500",children:[d+1,"  ",b.length]})]})]}),s.jsx("p",{className:"text-sm text-zinc-700 dark:text-zinc-200 mb-4",children:_.description}),_.actionText&&_.onAction&&s.jsxs("button",{onClick:_.onAction,className:`w-full inline-flex items-center justify-center gap-2 px-4 py-2.5\r
                                     rounded-lg text-sm font-medium\r
                                     bg-emerald-600 text-white hover:bg-emerald-700\r
                                     shadow-sm transition`,children:[_.actionText,s.jsx(Fa,{className:"w-4 h-4"})]}),b.length>1&&s.jsxs("div",{className:"mt-3 flex items-center justify-center gap-2",children:[s.jsx("button",{onClick:m,className:`p-1.5 rounded-md text-zinc-500 hover:text-zinc-800 dark:hover:text-white\r
                                       hover:bg-zinc-100/80 dark:hover:bg-zinc-800/60 transition`,"aria-label":"",children:s.jsx(Sn,{className:"w-4 h-4"})}),s.jsxs("span",{className:"text-xs text-zinc-500",children:[d+1," / ",b.length]}),s.jsx("button",{onClick:w,className:`p-1.5 rounded-md text-zinc-500 hover:text-zinc-800 dark:hover:text-white\r
                                       hover:bg-zinc-100/80 dark:hover:bg-zinc-800/60 transition`,"aria-label":"",children:s.jsx(Fa,{className:"w-4 h-4"})})]})]}):s.jsxs("div",{className:"py-10 text-center text-zinc-500",children:[s.jsx(Gl,{className:"w-8 h-8 mx-auto mb-2 text-zinc-300"}),s.jsx("p",{className:"text-sm",children:"  "})]})},"notifications"):s.jsxs(Xa.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"px-4 pb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-50",children:""}),s.jsxs("span",{className:"text-xs text-zinc-500",children:[P,"/",U.length]})]}),s.jsx("div",{className:"w-full h-2 rounded-full bg-zinc-200/80 dark:bg-zinc-700/60 mb-4 overflow-hidden",children:s.jsx(Xa.div,{initial:{width:0},animate:{width:`${F}%`},transition:{duration:.5,ease:"easeOut"},className:"h-full rounded-full bg-emerald-600"})}),s.jsx("div",{className:"space-y-2",children:U.map(N=>s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[N.completed?s.jsx(at,{className:"w-4 h-4 text-emerald-600"}):N.inProgress?s.jsx(wr,{className:"w-4 h-4 text-blue-600"}):s.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-zinc-300 dark:border-zinc-600"}),s.jsx("span",{className:`${N.completed?"text-emerald-700 dark:text-emerald-400":N.inProgress?"text-blue-700 dark:text-blue-400":"text-zinc-600 dark:text-zinc-300"}`,children:N.title})]},N.id))})]},"progress")})]},"trainer-panel")})})}function Gae({event:e,userProfile:t,participants:r,onMarkAttendance:a,onViewParticipants:n,onStartEvent:i,onCompleteEvent:l,onViewTests:o,onViewFeedback:c,onViewStats:d}){return s.jsx(Wae,{event:e,userProfile:t,participants:r,onMarkAttendance:a,onViewParticipants:n,onStartEvent:i,onCompleteEvent:l})}function Yae({eventId:e,onStartTest:t,onBack:r}){var R;const{userProfile:a}=st();Qt();const[n,i]=E.useState(""),[l,o]=E.useState(null),[c,d]=E.useState(!0),[x,u]=E.useState(null),[f,h]=E.useState(0),[p,g]=E.useState([]);E.useEffect(()=>{async function M(){d(!0),u(null);try{const{data:O,error:B}=await Z.from("events").select(`
            *,
            creator:creator_id(
              id,
              full_name,
              email,
              phone,
              avatar_url,
              position:position_id(name),
              territory:territory_id(name)
            )
          `).eq("id",e).single();if(B)throw B;o(O)}catch{u("      "),o(null)}finally{d(!1)}}M()},[e]),E.useEffect(()=>{var M,O;(O=(M=l==null?void 0:l.creator)==null?void 0:M.position)!=null&&O.name?i(l.creator.position.name):i("")},[l]),(R=l==null?void 0:l.creator)!=null&&R.full_name;const y=()=>{try{console.log("   "),h(M=>M+1)}catch(M){console.error("    :",M)}};E.useEffect(()=>{async function M(){if(e)try{const{data:O,error:B}=await Z.from("event_participants").select(`
            *,
            user:user_id(
              id,
              full_name,
              email,
              position:position_id(name),
              territory:territory_id(name)
            )
          `).eq("event_id",e);if(B)throw B;g(O||[])}catch(O){console.error("  :",O)}}M()},[e,f]);const v=()=>{const M=document.querySelector('[data-section="participants"]');M&&M.scrollIntoView({behavior:"smooth"})},w=async()=>{if(!l||!a){console.error("      ");return}const M=l.status==="completed"?" ,     ?":" ,    ?";if(confirm(M))try{const O=l.status==="completed"?"published":"completed";console.log(`     "${l.status}"  "${O}"`);const{error:B}=await Z.from("events").update({status:O,updated_at:new Date().toISOString()}).eq("id",l.id);if(B)throw console.error("  Supabase:",B),B;console.log("     "),o(U=>U?{...U,status:O}:(console.error("    "),U)),console.log("   ");const L=O==="completed"?"   ":"   ";console.log(L),alert(L)}catch(O){console.error("    :",O),alert("      .   .")}},m=()=>{const M=document.querySelector('[data-section="participants"]');M&&M.scrollIntoView({behavior:"smooth"})},b=()=>{console.log(" ")},_=()=>{const M=document.querySelector('[data-section="tests"]');M&&M.scrollIntoView({behavior:"smooth"})},C=()=>{const M=document.querySelector('[data-section="feedback"]');M&&M.scrollIntoView({behavior:"smooth"})},j=()=>{console.log("  ")},D=M=>{l&&o(O=>({...O,creator:{...O.creator,avatar_url:M}}))};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:s.jsxs("div",{className:"space-y-8",children:[c&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[s.jsx("div",{className:"w-12 h-12 border-4 border-sns-green border-t-transparent rounded-full animate-spin mb-4"}),s.jsx("p",{className:"text-gray-600 text-lg font-medium",children:" ..."})]}),x&&!c&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600 text-center max-w-md",children:x})]}),!c&&!x&&!l&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.47-.881-6.08-2.33"})})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-600 text-center max-w-md",children:"      "})]}),l&&!c&&!x&&l.id&&s.jsxs(s.Fragment,{children:[s.jsx(Tre,{event:l,onBack:r}),s.jsxs("div",{className:"space-y-4 mt-8 sm:mt-4",children:[s.jsx(zre,{event:l,isCreator:l.creator_id===(a==null?void 0:a.id),onUpdateOrganizerData:D,onCompleteEvent:w}),s.jsx("div",{"data-section":"participants",children:s.jsx(sse,{eventId:e,refreshKey:f,hasOpenEndedQuestions:!0})}),s.jsx("div",{"data-section":"tests",children:s.jsx($ae,{eventId:e,userProfile:a,isAdmin:!1,onStartTest:t,refreshKey:f,onRefreshData:y})}),s.jsx("div",{"data-section":"tp-evaluation",children:s.jsx(zae,{eventId:e,userProfile:a})}),s.jsx("div",{"data-section":"feedback",children:s.jsx(Hae,{eventId:e})})]}),s.jsx(Gae,{event:l,userProfile:a,participants:p,onMarkAttendance:v,onViewParticipants:m,onStartEvent:b,onCompleteEvent:w,onViewTests:_,onViewFeedback:C,onViewStats:j})]})]})})}function Xae(){return s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-600 mt-2",children:"        "})]}),s.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-purple-50 to-blue-50 rounded-3xl border border-purple-100",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-purple-200 to-blue-200 rounded-full blur-3xl opacity-30"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-blue-200 to-purple-200 rounded-full blur-2xl opacity-30"}),s.jsxs("div",{className:"relative p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 animate-pulse",children:s.jsx(zt,{size:40,className:"text-white"})}),s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"  "}),s.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"     ,     ,      ."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(wr,{size:24,className:"text-purple-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"     "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(Yf,{size:24,className:"text-blue-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"      "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(fb,{size:24,className:"text-green-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"       "})]})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(io,{size:20,className:"mr-2 text-purple-600"})," "]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-gray-700",children:"      "})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),s.jsx("span",{className:"text-gray-700",children:"      "})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-gray-700",children:"     "})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),s.jsx("span",{className:"text-gray-700",children:"    "})]})]})]})]})}function Kae(){return s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-600 mt-2",children:"     "})]}),s.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-green-50 to-teal-50 rounded-3xl border border-green-100",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-green-200 to-teal-200 rounded-full blur-3xl opacity-30"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-teal-200 to-green-200 rounded-full blur-2xl opacity-30"}),s.jsxs("div",{className:"relative p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-teal-600 rounded-2xl flex items-center justify-center mx-auto mb-6 animate-pulse",children:s.jsx(Ka,{size:40,className:"text-white"})}),s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"  "}),s.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"      :  ,      ."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(sx,{size:24,className:"text-green-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:" KPI    "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-teal-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(ys,{size:24,className:"text-teal-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"     "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(nr,{size:24,className:"text-blue-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"    "})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(nt,{size:20,className:"mr-2 text-green-600"})," "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"     "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"    "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"  "]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(er,{size:20,className:"mr-2 text-teal-600"})," "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"  "]})]})]})]})]})}function Qae(){return s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),s.jsx("p",{className:"text-gray-600 mt-2",children:"        "})]}),s.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 to-indigo-50 rounded-3xl border border-blue-100",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-200 to-indigo-200 rounded-full blur-3xl opacity-30"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-indigo-200 to-blue-200 rounded-full blur-2xl opacity-30"}),s.jsxs("div",{className:"relative p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-6 animate-pulse",children:s.jsx(co,{size:40,className:"text-white"})}),s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"  "}),s.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"     ,      ."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(nt,{size:24,className:"text-blue-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"      "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(lo,{size:24,className:"text-indigo-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"     "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(ys,{size:24,className:"text-purple-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:" ,     "})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(sx,{size:20,className:"mr-2 text-blue-600"})," "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"    "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(er,{size:20,className:"mr-2 text-indigo-600"})," "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full mt-2 mr-3 flex-shrink-0"})," "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"  "]})]})]})]})]})}function Jae(){return s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-600 mt-2",children:"        "})]}),s.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-amber-50 to-orange-50 rounded-3xl border border-amber-100",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-amber-200 to-orange-200 rounded-full blur-3xl opacity-30"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-orange-200 to-amber-200 rounded-full blur-2xl opacity-30"}),s.jsxs("div",{className:"relative p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-6 animate-pulse",children:s.jsx(Ms,{size:40,className:"text-white"})}),s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:" "}),s.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"     -: -,       ."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(tR,{size:24,className:"text-amber-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"-"}),s.jsx("p",{className:"text-sm text-gray-600",children:"     "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(lo,{size:24,className:"text-orange-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"     "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(fb,{size:24,className:"text-red-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"     "})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(nt,{size:20,className:"mr-2 text-amber-600"}),"  "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"     "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"    "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"    "]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(er,{size:20,className:"mr-2 text-orange-600"})," "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   VIP-"]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   HD "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]})]})]})]})]})}function Zae(){return s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-600 mt-2",children:"     ,   "})]}),s.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-red-50 to-orange-50 rounded-3xl border border-red-100",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-red-200 to-orange-200 rounded-full blur-3xl opacity-30"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-orange-200 to-red-200 rounded-full blur-2xl opacity-30"}),s.jsxs("div",{className:"relative p-12 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-red-500 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-6 animate-pulse",children:s.jsx(an,{size:40,className:"text-white"})}),s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:" "}),s.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"     .     ,   ."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(wr,{size:24,className:"text-red-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"      "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(Gl,{size:24,className:"text-orange-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"      "})]}),s.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[s.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(fb,{size:24,className:"text-yellow-600"})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"     "})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(ys,{size:20,className:"mr-2 text-red-600"})," "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(at,{size:20,className:"mr-2 text-orange-600"})," "]}),s.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"   "]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2 mr-3 flex-shrink-0"}),"  "]})]})]})]})]})}function ene({answer:e,answerIndex:t,questionIndex:r,onAnswerChange:a,onDeleteAnswer:n}){const{attributes:i,listeners:l,setNodeRef:o,transform:c,transition:d,isDragging:x}=ZA({id:`answer-${r}-${t}`}),u={transform:s0.Transform.toString(c),transition:d};return s.jsxs("li",{ref:o,style:u,className:"bg-gray-100 rounded px-4 py-2 flex items-center shadow "+(x?"ring-2 ring-green-400":""),children:[s.jsxs("span",{className:"mr-2 text-gray-400",children:[t+1,"."]}),s.jsx("input",{type:"text",value:e.text,onChange:f=>a(r,t,"text",f.target.value),className:"flex-1 px-3 py-1.5 border border-gray-200 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:" ",required:!0}),s.jsx("button",{...i,...l,className:"ml-2 p-1 text-gray-400 hover:text-blue-600 cursor-grab",title:"   ",children:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),s.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),s.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),s.jsx("button",{onClick:()=>n(r,t),className:"ml-2 text-gray-400 hover:text-red-600 transition-colors",title:" ",children:s.jsx(Zr,{size:14})})]})}function tne({isOpen:e,onClose:t,testId:r,onSuccess:a}){const[n,i]=E.useState({title:"",description:"",type:"entry",passing_score:70,time_limit:30,event_type_id:null,status:"draft"}),[l,o]=E.useState([]),[c,d]=E.useState([]),[x,u]=E.useState(!1),[f,h]=E.useState(!1),[p,g]=E.useState(null),[y,v]=E.useState(!1),w=kA(jh(wm),jh(Yy,{coordinateGetter:Oae})),m=(N,T)=>{const{active:S,over:z}=N;if(S.id!==z.id){const k=l[T].answers||[],q=k.findIndex((I,V)=>`answer-${T}-${V}`===S.id),A=k.findIndex((I,V)=>`answer-${T}-${V}`===z.id);if(q!==-1&&A!==-1){const V=jm(k,q,A).map((H,Y)=>({...H,order:Y+1}));D(T,"answers",V)}}};E.useEffect(()=>{e&&(b(),r?_(r):(i({title:"",description:"",type:"entry",passing_score:70,time_limit:30,event_type_id:null,status:"draft"}),o([]),g(null),v(!1)))},[e,r]);const b=async()=>{try{const{data:N,error:T}=await Z.from("event_types").select("id, name, name_ru").order("name_ru");if(T)throw T;d(N||[])}catch(N){console.error("   :",N)}},_=async N=>{u(!0);try{const{data:T,error:S}=await Z.from("tests").select("*").eq("id",N).single();if(S)throw S;i(T);const{data:z,error:W}=await Z.from("test_questions").select("*").eq("test_id",N).order("order");if(W)throw W;const k=await Promise.all(z.map(async q=>{let A=[];if(q.question_type==="sequence"){const{data:I,error:V}=await Z.from("test_sequence_answers").select("*").eq("question_id",q.id).order("answer_order");if(V)throw V;A=I.map((H,Y)=>({...H,text:H.answer_text,order:H.answer_order}))}else{const{data:I,error:V}=await Z.from("test_answers").select("*").eq("question_id",q.id).order("order");if(V)throw V;A=I.map((H,Y)=>({...H,order:Y+1}))}return{...q,answers:A||[],isExpanded:!1}}));o(k||[])}catch(T){console.error("   :",T),g("    ")}finally{u(!1)}},C=N=>{const{name:T,value:S}=N.target;i(z=>({...z,[T]:S}))},j=()=>{const T={question:"",question_type:"single_choice",order:l.length>0?Math.max(...l.map(S=>S.order))+1:1,points:1,answers:[],isNew:!0,isExpanded:!0};o([...l,T])},D=(N,T,S)=>{const z=[...l];z[N]={...z[N],[T]:S},o(z)},R=N=>{confirm(" ,     ?")&&o(l.filter((T,S)=>S!==N))},M=N=>{const T=[...l];T[N].isExpanded=!T[N].isExpanded,o(T)},O=(N,T,S)=>{const z=[...N],[W]=z.splice(T,1);return z.splice(S,0,W),z.map((k,q)=>({...k,order:q+1}))},B=N=>{var W,k;const T=l[N];let S=[];if(T.question_type==="sequence"){const A={text:"",is_correct:!1,order:((W=T.answers)==null?void 0:W.length)>0?Math.max(...T.answers.map(I=>I.order))+1:1,isNew:!0};S=[...T.answers||[],A]}else{const A={text:"",is_correct:!1,order:((k=T.answers)==null?void 0:k.length)>0?Math.max(...T.answers.map(I=>I.order))+1:1,isNew:!0};S=[...T.answers||[],A]}const z=[...l];z[N].answers=S,o(z)},L=(N,T,S,z)=>{const W=[...l],k=W[N],q=[...k.answers||[]];S==="is_correct"&&z===!0&&k.question_type==="single_choice"&&q.forEach(A=>A.is_correct=!1),q[T]={...q[T],[S]:z},k.answers=q,o(W)},U=(N,T)=>{var k;const S=[...l],z=S[N],W=((k=z.answers)==null?void 0:k.filter((q,A)=>A!==T))||[];z.answers=W,o(S)},P=()=>{if(!n.title.trim())return g("  "),!1;if(l.length===0)return g("    "),!1;for(let N=0;N<l.length;N++){const T=l[N];if(!T.question.trim())return g(` ${N+1}:   `),!1;if((T.question_type==="single_choice"||T.question_type==="multiple_choice")&&(!T.answers||T.answers.length===0))return g(` ${N+1}:      `),!1;if(T.question_type==="single_choice"&&T.answers&&T.answers.filter(S=>S.is_correct).length!==1)return g(` ${N+1}:      `),!1;if(T.question_type==="multiple_choice"&&T.answers&&!T.answers.some(S=>S.is_correct))return g(` ${N+1}:       `),!1;if(T.answers){for(let S=0;S<T.answers.length;S++)if(!T.answers[S].text.trim())return g(` ${N+1},  ${S+1}:   `),!1}}return!0},F=async()=>{if(P()){h(!0),g(null);try{let N=n.id;if(N){const{error:T}=await Z.from("tests").update({title:n.title,description:n.description,type:n.type,passing_score:n.passing_score,time_limit:n.time_limit,event_type_id:n.event_type_id,status:n.status,updated_at:new Date().toISOString()}).eq("id",N);if(T)throw T}else{const{data:T,error:S}=await Z.from("tests").insert({title:n.title,description:n.description,type:n.type,passing_score:n.passing_score,time_limit:n.time_limit,event_type_id:n.event_type_id,status:n.status}).select().single();if(S)throw S;N=T.id}for(const T of l){let S=T.id;if(S&&!T.isNew){const{error:z}=await Z.from("test_questions").update({question:T.question,question_type:T.question_type,order:T.order,points:T.points,updated_at:new Date().toISOString()}).eq("id",S);if(z)throw z}else{const{data:z,error:W}=await Z.from("test_questions").insert({test_id:N,question:T.question,question_type:T.question_type,order:T.order,points:T.points}).select().single();if(W)throw W;S=z.id}if(T.answers&&T.question_type!=="text")if(!T.isNew&&T.id&&(T.question_type==="sequence"?await Z.from("test_sequence_answers").delete().eq("question_id",T.id):await Z.from("test_answers").delete().eq("question_id",T.id)),T.question_type==="sequence"){const z=T.answers.map((k,q)=>({question_id:S,answer_text:k.text,answer_order:k.order??q+1})),{error:W}=await Z.from("test_sequence_answers").insert(z);if(W)throw W}else{const z=T.answers.map((k,q)=>({question_id:S,text:k.text,is_correct:k.is_correct,order:k.order})),{error:W}=await Z.from("test_answers").insert(z);if(W)throw W}}v(!0),setTimeout(()=>{a(),t()},2e3)}catch(N){console.error("  :",N),g(N.message||"  ")}finally{h(!1)}}};return E.useEffect(()=>{if(l.length>0){const N=Math.floor(100/l.length),T=100-N*(l.length-1);o(S=>S.map((z,W)=>({...z,points:W===S.length-1?T:N})))}},[l.length]),e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?" ":"  "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{size:20})})]})}),x?s.jsxs("div",{className:"p-10 flex flex-col justify-center items-center",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-sns-green border-t-transparent rounded-full animate-spin mb-4"}),s.jsx("p",{className:"text-gray-500",children:" ..."})]}):y?s.jsxs("div",{className:"p-10 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(at,{size:32,className:"text-green-600"})}),s.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600 mb-6",children:"    "})]}):s.jsxs("div",{className:"p-6 space-y-6",children:[p&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-700 text-sm",children:p}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),s.jsx("input",{type:"text",name:"title",value:n.title,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"  ",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),s.jsxs("select",{name:"type",value:n.type,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"entry",children:" "}),s.jsx("option",{value:"final",children:" "}),s.jsx("option",{value:"annual",children:" "})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("textarea",{name:"description",value:n.description,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:" ",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  (%)"}),s.jsxs("div",{className:"relative",children:[s.jsx(jR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"number",name:"passing_score",value:n.passing_score,onChange:C,min:"1",max:"100",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  ()"}),s.jsxs("div",{className:"relative",children:[s.jsx($T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"number",name:"time_limit",value:n.time_limit,onChange:C,min:"0",max:"180",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{className:"flex items-center mt-2",children:[s.jsx("input",{type:"checkbox",id:"unlimited_time",checked:n.time_limit===0,onChange:N=>{N.target.checked?i(T=>({...T,time_limit:0})):i(T=>({...T,time_limit:30}))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"unlimited_time",className:"ml-2 block text-sm text-gray-500",children:"  "})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("select",{name:"status",value:n.status,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"draft",children:""}),s.jsx("option",{value:"active",children:""}),s.jsx("option",{value:"inactive",children:""})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsxs("select",{name:"event_type_id",value:n.event_type_id||"",onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"  "}),c.map(N=>s.jsx("option",{value:N.id,children:N.name_ru||N.name},N.id))]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[" (",l.length,")"]}),s.jsxs("button",{onClick:j,className:"px-3 py-1.5 bg-sns-green text-white text-sm rounded-lg hover:bg-sns-green-dark transition-colors flex items-center space-x-1",children:[s.jsx(es,{size:16}),s.jsx("span",{children:" "})]})]}),l.length===0?s.jsxs("div",{className:"bg-gray-50 border border-dashed border-gray-300 rounded-lg p-8 text-center",children:[s.jsx(Et,{size:32,className:"mx-auto text-gray-400 mb-3"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"     "}),s.jsx("button",{onClick:j,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"  "})]}):s.jsx("div",{className:"space-y-4",children:l.map((N,T)=>s.jsxs("div",{className:Ve("border rounded-lg transition-all shadow-sm",N.isExpanded?"border-sns-green bg-green-50/40":"border-gray-200 bg-white"),children:[s.jsxs("div",{className:"p-4 flex justify-between items-center cursor-pointer gap-2",onClick:()=>M(T),children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[s.jsx("div",{className:"w-9 h-9 min-w-9 min-h-9 rounded-full bg-sns-green flex items-center justify-center shadow text-white font-bold text-base",children:T+1}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900 truncate text-base leading-tight",children:N.question||" "}),s.jsxs("div",{className:"flex items-center mt-1 gap-2",children:[s.jsx("span",{className:Ve("px-2 py-0.5 rounded text-xs font-medium",N.question_type==="single_choice"?"bg-blue-100 text-blue-800":N.question_type==="multiple_choice"?"bg-purple-100 text-purple-800":N.question_type==="sequence"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:N.question_type==="single_choice"?"  ":N.question_type==="multiple_choice"?"  ":N.question_type==="sequence"?"":" "}),s.jsxs("span",{className:"text-xs text-gray-500",children:[N.points," ()"]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[s.jsx("button",{type:"button",disabled:T===0,onClick:S=>{S.stopPropagation(),T>0&&o(O(l,T,T-1))},className:"rounded-full p-1.5 text-sns-green hover:bg-sns-green/10 disabled:opacity-30 transition",title:" ",children:s.jsx(Vc,{size:18})}),s.jsx("button",{type:"button",disabled:T===l.length-1,onClick:S=>{S.stopPropagation(),T<l.length-1&&o(O(l,T,T+1))},className:"rounded-full p-1.5 text-sns-green hover:bg-sns-green/10 disabled:opacity-30 transition",title:" ",children:s.jsx(xi,{size:18})}),s.jsx("button",{onClick:S=>{S.stopPropagation(),R(T)},className:"rounded-full p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 transition",title:" ",children:s.jsx(Zr,{size:16})}),s.jsx("button",{className:"ml-1 text-gray-400 hover:text-sns-green transition",tabIndex:-1,children:N.isExpanded?s.jsx(Vc,{size:18}):s.jsx(xi,{size:18})})]})]}),N.isExpanded&&s.jsx("div",{className:"px-4 pb-4 pt-2",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),s.jsx("input",{type:"text",value:N.question,onChange:S=>D(T,"question",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"  ",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsxs("select",{value:N.question_type,onChange:S=>D(T,"question_type",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"single_choice",children:"  "}),s.jsx("option",{value:"multiple_choice",children:"  "}),s.jsx("option",{value:"text",children:" "}),s.jsx("option",{value:"sequence",children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsx("input",{type:"number",value:N.points,onChange:S=>D(T,"points",parseInt(S.target.value)||1),min:"1",max:"100",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0})]})]}),(N.question_type==="single_choice"||N.question_type==="multiple_choice"||N.question_type==="sequence")&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[" ",N.question_type==="sequence"?" (   )":""]}),s.jsxs("button",{onClick:()=>B(T),className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded hover:bg-gray-200 flex items-center space-x-1",children:[s.jsx(es,{size:12}),s.jsx("span",{children:""})]})]}),!N.answers||N.answers.length===0?s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[s.jsx("p",{className:"text-gray-500 text-sm",children:"  "}),s.jsx("button",{onClick:()=>B(T),className:"mt-2 text-blue-600 hover:underline text-sm",children:"  "})]}):N.question_type==="sequence"?s.jsx(WA,{sensors:w,collisionDetection:FA,onDragEnd:S=>m(S,T),children:s.jsx(QA,{items:(N.answers||[]).map((S,z)=>`answer-${T}-${z}`),strategy:YA,children:s.jsx("ul",{className:"space-y-2",children:(N.answers||[]).map((S,z)=>s.jsx(ene,{answer:S,answerIndex:z,questionIndex:T,onAnswerChange:L,onDeleteAnswer:U},z))})})}):s.jsx("div",{className:"space-y-2",children:N.answers.map((S,z)=>s.jsxs("div",{className:Ve("flex items-center border rounded-lg p-3",S.is_correct?"border-green-300 bg-green-50":"border-gray-200"),children:[s.jsx("div",{className:"flex-shrink-0 mr-3",children:s.jsx("input",{type:N.question_type==="single_choice"?"radio":"checkbox",checked:S.is_correct,onChange:W=>L(T,z,"is_correct",W.target.checked),className:N.question_type==="single_choice"?"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300":"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),s.jsx("div",{className:"flex-1",children:s.jsx("input",{type:"text",value:S.text,onChange:W=>L(T,z,"text",W.target.value),className:"w-full px-3 py-1.5 border border-gray-200 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:" ",required:!0})}),s.jsx("button",{onClick:()=>U(T,z),className:"ml-2 text-gray-400 hover:text-red-600 transition-colors",title:" ",children:s.jsx(Zr,{size:14})})]},z))})]}),N.question_type==="text"&&s.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[s.jsxs("p",{className:"text-blue-800 mb-2",children:[s.jsx("span",{className:"font-medium",children:" :"}),"       ."]}),s.jsx("p",{className:"text-blue-600",children:"       ."})]})]})})]},T))})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""}),s.jsx("button",{onClick:F,disabled:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:f?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{size:16}),s.jsx("span",{children:" "})]})})]})]})]})}):null}function rne({isOpen:e,onClose:t,question:r}){return!e||!r?null:s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Qe,{size:20})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"mr-3 mt-1",children:s.jsx("div",{className:"w-7 h-7 bg-blue-100 rounded-full flex items-center justify-center text-blue-700 font-semibold",children:r.order})}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-medium text-gray-900",children:r.question}),s.jsxs("div",{className:"flex items-center mt-2 space-x-2",children:[s.jsx("span",{className:Ve("px-2 py-0.5 rounded text-xs font-medium",r.question_type==="single_choice"?"bg-blue-100 text-blue-800":r.question_type==="multiple_choice"?"bg-purple-100 text-purple-800":(r.question_type==="sequence","bg-green-100 text-green-800")),children:r.question_type==="single_choice"?" ":r.question_type==="multiple_choice"?" ":r.question_type==="sequence"?"":" "}),s.jsxs("span",{className:"text-xs text-gray-500",children:[r.points," ()"]})]})]})]})}),(r.question_type==="single_choice"||r.question_type==="multiple_choice")&&r.answers&&r.answers.length>0?s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700",children:" :"}),r.answers.map((a,n)=>s.jsxs("div",{className:Ve("p-3 border rounded-lg flex items-center",a.is_correct?"border-green-300 bg-green-50":"border-gray-200 bg-white"),children:[s.jsx("div",{className:"mr-3",children:r.question_type==="single_choice"?s.jsx("div",{className:Ve("w-4 h-4 rounded-full border flex items-center justify-center",a.is_correct?"border-green-500 bg-green-100":"border-gray-300"),children:a.is_correct&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"})}):s.jsx("div",{className:Ve("w-4 h-4 rounded border flex items-center justify-center",a.is_correct?"border-green-500 bg-green-100":"border-gray-300"),children:a.is_correct&&s.jsx(at,{size:10,className:"text-green-500"})})}),s.jsx("span",{className:a.is_correct?"font-medium":"text-gray-700",children:a.text}),a.is_correct&&s.jsxs("span",{className:"ml-auto inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(at,{size:12,className:"mr-1"}),""]})]},n)),r.explanation&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4",children:[s.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-1",children:":"}),s.jsx("p",{className:"text-sm text-blue-700",children:r.explanation})]})]}):r.question_type==="sequence"&&r.answers&&r.answers.length>0?s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"  ( ):"}),s.jsx("ol",{className:"list-decimal pl-5",children:r.answers.sort((a,n)=>(a.order||a.answer_order)-(n.order||n.answer_order)).map((a,n)=>s.jsx("li",{className:"py-1 text-gray-900",children:a.text||a.answer_text},a.id))}),r.explanation&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4",children:[s.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-1",children:":"}),s.jsx("p",{className:"text-sm text-blue-700",children:r.explanation})]})]}):r.question_type==="text"?s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:s.jsx("p",{className:"text-gray-600 text-sm italic",children:"     "})}),r.explanation&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4",children:[s.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-1",children:":"}),s.jsx("p",{className:"text-sm text-blue-700",children:r.explanation})]})]}):s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-center text-yellow-800",children:[s.jsx(an,{size:20,className:"mr-2"}),s.jsx("span",{children:"    "})]})}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:""})})]})]})})}function sne(){const{userProfile:e}=st(),t=Qt(),[r,a]=E.useState([]),[n,i]=E.useState([]),[l,o]=E.useState([]),[c,d]=E.useState(!0),[x,u]=E.useState(null),[f,h]=E.useState("active");E.useEffect(()=>{e!=null&&e.id&&p()},[e==null?void 0:e.id]);const p=async()=>{d(!0),u(null);try{const{data:b,error:_}=await Z.from("user_test_attempts").select(`
          id,
          test_id,
          event_id,
          status,
          score,
          start_time,
          completed_at,
          test:tests(
            id,
            title,
            description,
            type,
            passing_score,
            time_limit
          ),
          event:events(
            id,
            title,
            start_date,
            end_date
          )
        `).eq("user_id",e.id).not("score","is",null).order("completed_at",{ascending:!1});if(console.log("Completed tests raw data:",b),console.log("Completed tests details:",b==null?void 0:b.map(U=>({id:U.id,test_id:U.test_id,test_title:U.test.title,test_type:U.test.type,status:U.status,score:U.score,start_time:U.start_time}))),_)throw _;a(b||[]);let{data:C,error:j}=await Z.from("user_test_attempts").select(`
          id,
          test_id,
          event_id,
          status,
          score,
          start_time,
          completed_at,
          test:tests(
            id,
            title,
            description,
            type,
            passing_score,
            time_limit
          ),
          event:events(
            id,
            title,
            start_date,
            end_date
          )
        `).eq("user_id",e.id).in("status",["in_progress","failed"]).is("score",null).order("start_time",{ascending:!1});if(C&&C.length>0){const U=new Set,{data:P}=await Z.from("user_test_attempts").select("test_id, event_id").eq("user_id",e.id).eq("status","completed").not("score","is",null);P==null||P.forEach(N=>{U.add(`${N.test_id}-${N.event_id}`)});const F=C.filter(N=>{const T=`${N.test_id}-${N.event_id}`;return!U.has(T)});console.log("Active tests after filtering completed:",F),C=F}if(console.log("Active tests raw data:",C),console.log("Active tests details:",C==null?void 0:C.map(U=>({id:U.id,test_id:U.test_id,test_title:U.test.title,test_type:U.test.type,status:U.status,score:U.score,start_time:U.start_time}))),j)throw j;console.log("Fetching future tests for user:",e.id);const{data:D,error:R}=await Z.from("event_participants").select(`
          event_id,
          attended,
          event:events(
            id,
            title,
            start_date,
            end_date,
            event_type:event_type_id(
              id,
              has_entry_test,
              has_final_test,
              has_annual_test
            )
          )
        `).eq("user_id",e.id);if(console.log("Event participants data:",D),console.log("Event participants error:",R),R)throw R;const M=[];for(const U of D||[]){const P=U.event;if(!(P!=null&&P.event_type)){console.log("Skipping event without event_type:",P);continue}if(console.log("Processing event:",P.title,"attended:",U.attended),P.event_type.has_entry_test){console.log("Checking for entry test in event type:",P.event_type.id);const{data:F,error:N}=await Z.from("tests").select("*").eq("event_type_id",P.event_type.id).eq("type","entry").eq("status","active").maybeSingle();if(console.log("Entry test query result:",F,"error:",N),F){const{data:T,count:S}=await Z.from("user_test_attempts").select("id",{count:"exact"}).eq("user_id",e.id).eq("test_id",F.id).eq("event_id",P.id);if(console.log(`Checking entry test ${F.id} for event ${P.id}:`,S>0?`Already attempted (${S} attempts)`:"Not attempted"),S===0){console.log(`Creating automatic attempt for entry test ${F.id}`);const{data:z,error:W}=await Z.from("user_test_attempts").insert({user_id:e.id,test_id:F.id,event_id:P.id,status:"in_progress",start_time:new Date().toISOString()}).select().single();W?console.error("Error creating entry test attempt:",W):console.log("Created entry test attempt:",z)}else{const{data:z}=await Z.from("user_test_attempts").select("status, score").eq("user_id",e.id).eq("test_id",F.id).eq("event_id",P.id).order("start_time",{ascending:!1}).limit(1).single();console.log(`Existing entry test attempt: status=${z==null?void 0:z.status}, score=${z==null?void 0:z.score}`),z&&z.status==="completed"&&z.score!==null&&console.log("Entry test already completed, skipping")}}else console.log(`Entry test not found for event type ${P.event_type.id}`)}if(P.event_type.has_final_test){console.log("Checking for final test in event type:",P.event_type.id);const{data:F,error:N}=await Z.from("tests").select("*").eq("event_type_id",P.event_type.id).eq("type","final").eq("status","active").maybeSingle();if(console.log("Final test query result:",F,"error:",N),F){const{data:T,count:S}=await Z.from("user_test_attempts").select("id",{count:"exact"}).eq("user_id",e.id).eq("test_id",F.id).eq("event_id",P.id);if(console.log(`Checking final test ${F.id} for event ${P.id}:`,S>0?`Already attempted (${S} attempts)`:"Not attempted"),S===0){const{data:z}=await Z.from("tests").select("id, passing_score").eq("event_type_id",P.event_type.id).eq("type","entry").eq("status","active").maybeSingle();if(z){const{data:W}=await Z.from("user_test_attempts").select("status, score").eq("user_id",e.id).eq("test_id",z.id).eq("event_id",P.id).eq("status","completed").order("created_at",{ascending:!1}).limit(1),k=W==null?void 0:W[0];console.log(`Entry test attempt: score=${k==null?void 0:k.score}, passing_score=${z==null?void 0:z.passing_score}`),k&&k.score!==null&&k.score!==void 0&&(z.passing_score>0?k.score>=z.passing_score:k.score>0)?(console.log(`Adding final test ${F.id} to future tests`),M.push({test:F,event:P,scheduled_date:P.end_date})):console.log("Entry test not passed, skipping final test")}else console.log(`No entry test found, but adding final test ${F.id} to future tests`),M.push({test:F,event:P,scheduled_date:P.end_date})}else console.log("Final test already attempted, skipping")}else console.log(`Final test not found for event type ${P.event_type.id}`)}if(P.event_type.has_annual_test){console.log("Checking for annual test in event type:",P.event_type.id);const{data:F,error:N}=await Z.from("tests").select("*").eq("event_type_id",P.event_type.id).eq("type","annual").eq("status","active").maybeSingle();if(console.log("Annual test query result:",F,"error:",N),F){const{data:T,count:S}=await Z.from("user_test_attempts").select("id",{count:"exact"}).eq("user_id",e.id).eq("test_id",F.id).eq("event_id",P.id);if(console.log(`Checking annual test ${F.id} for event ${P.id}:`,S>0?`Already attempted (${S} attempts)`:"Not attempted"),S===0){const z=P.end_date?new Date(P.end_date):new Date(P.start_date),W=new Date(z);W.setMonth(W.getMonth()+3);const k=new Date;console.log(`Event start date: ${P.start_date}`),console.log(`Event end date: ${P.end_date}`),console.log(`Event date used: ${z.toISOString()}`),console.log(`Three months later: ${W.toISOString()}`),console.log(`Current date: ${k.toISOString()}`),console.log(`Is current date >= three months later: ${k>=W}`),console.log(`Time difference in days: ${Math.floor((k.getTime()-W.getTime())/(1e3*60*60*24))}`),console.log(`Adding annual test ${F.id} to future tests`),M.push({test:F,event:P,scheduled_date:W.toISOString(),isAvailable:k>=W})}}else console.log(`Annual test not found for event type ${P.event_type.id}`)}}console.log("Final future tests data:",M),console.log("Setting future tests state with length:",M.length),i(M);const O=C==null?void 0:C.reduce((U,P)=>{const F=`${P.test_id}-${P.event_id}`;return(!U[F]||new Date(P.start_time)>new Date(U[F].start_time))&&(U[F]=P),U},{}),B=Object.values(O||{});console.log("Active tests after deduplication:",B.length);const L=B.filter(U=>{const P=D==null?void 0:D.some(F=>F.event_id===U.event_id);if(U.test.type==="annual"){const F=U.event.end_date?new Date(U.event.end_date):new Date(U.event.start_date),N=new Date(F);return N.setMonth(N.getMonth()+3),P&&new Date>=N}return P});console.log("Available active tests after filtering:",L.length),o(L)}catch(b){console.error("   :",b),u(b.message)}finally{d(!1)}},g=b=>{switch(b){case"entry":return" ";case"final":return" ";case"annual":return" ";default:return""}},y=b=>{const _={entry:{bg:"bg-blue-50",bgHover:"hover:bg-blue-100",border:"border-blue-200",icon:"text-blue-600",title:"text-blue-700",accent:"bg-blue-600",badge:"bg-blue-100 text-blue-800"},final:{bg:"bg-purple-50",bgHover:"hover:bg-purple-100",border:"border-purple-200",icon:"text-purple-600",title:"text-purple-700",accent:"bg-purple-600",badge:"bg-purple-100 text-purple-800"},annual:{bg:"bg-[#06A478]/10",bgHover:"hover:bg-[#06A478]/20",border:"border-[#06A478]/30",icon:"text-[#06A478]",title:"text-[#06A478]",accent:"bg-[#06A478]",badge:"bg-[#06A478]/20 text-[#06A478]"}};return _[b]||_.entry},v=b=>new Date(b).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}),w=(b,_)=>{const C=b?new Date(b):new Date(_),j=new Date(C);j.setMonth(j.getMonth()+3);const D=new Date;if(D>=j)return"";const R=j.getTime()-D.getTime(),M=Math.ceil(R/(1e3*60*60*24)),O=Math.floor(M/30),B=M%30;return O>0?`  ${O} ${O===1?"":O<5?"":""}${B>0?`  ${B} ${B===1?"":B<5?"":""}`:""}`:`  ${M} ${M===1?"":M<5?"":""}`},m=async(b,_)=>{console.log("handleStartTest called with:",{testId:b,eventId:_,userProfileId:e==null?void 0:e.id});try{const{data:C,error:j}=await Z.from("tests").select("type").eq("id",b).single();if(j)throw j;if(C.type==="annual"){const{data:B,error:L}=await Z.from("events").select("end_date, start_date").eq("id",_).single();if(L)throw L;const U=B.end_date?new Date(B.end_date):new Date(B.start_date),P=new Date(U);if(P.setMonth(P.getMonth()+3),new Date<P){alert("     3    ");return}}console.log("Checking for existing attempts with:",{userId:e.id,testId:b,eventId:_});const{data:D,error:R}=await Z.from("user_test_attempts").select("id, status, score").eq("user_id",e.id).eq("test_id",b).eq("event_id",_).order("start_time",{ascending:!1});if(console.log("Existing attempts check result:",{existingAttempts:D,checkError:R}),R)throw R;const M=D==null?void 0:D[0];if(M&&M.score!==null){alert("    . : "+M.score+"%");return}let O;if(M)console.log(`Using existing attempt ${M.id} with status ${M.status}`),O=M.id;else{const{data:B,error:L}=await Z.from("user_test_attempts").insert({user_id:e.id,test_id:b,event_id:_,status:"in_progress",start_time:new Date().toISOString()}).select().single();if(L)throw console.error("Error creating attempt:",L),L;if(!B)throw new Error("Failed to create attempt - no data returned");O=B.id,console.log(`Created new attempt ${O}`)}t(`/take-test?eventId=${_}&testId=${b}&attemptId=${O}`),t(`/take-test?eventId=${_}&testId=${b}&attemptId=${O}`)}catch(C){console.error("    :",C),C.message&&C.message.includes("  ")?alert(C.message):alert("     .   .")}};return c?s.jsx("div",{className:"flex items-center justify-center min-h-64",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Er,{className:"w-6 h-6 animate-spin text-sns-green"}),s.jsx("span",{className:"text-gray-600",children:" ..."})]})}):x?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[s.jsx(ar,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-red-800 mb-2",children:" "}),s.jsx("p",{className:"text-red-700",children:x})]}):(console.log("ParticipantTestsView render - completedTests:",r.length,"activeTests:",l.length,"futureTests:",n.length,"activeTab:",f),s.jsxs("div",{className:"space-y-4 md:space-y-6 pb-safe-bottom",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("div",{className:"flex items-center space-x-4",children:s.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:" "})})}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 md:gap-4",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-4 md:p-4 transition-all duration-200 hover:-translate-y-0.5",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-600 mb-1",children:" "}),s.jsx("p",{className:"text-xl md:text-2xl font-bold text-green-600",children:r.length})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-4 md:p-4 transition-all duration-200 hover:-translate-y-0.5",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-600 mb-1",children:" "}),s.jsx("p",{className:"text-xl md:text-2xl font-bold text-orange-600",children:l.length})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-4 md:p-4 transition-all duration-200 hover:-translate-y-0.5",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-600 mb-1",children:" "}),s.jsx("p",{className:"text-xl md:text-2xl font-bold text-blue-600",children:n.length})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-4 md:p-4 transition-all duration-200 hover:-translate-y-0.5",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-600 mb-1",children:" "}),s.jsxs("p",{className:"text-xl md:text-2xl font-bold text-purple-600",children:[r.length>0?Math.round(r.reduce((b,_)=>b+(_.score||0),0)/r.length):0,"%"]})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-4 md:p-4 transition-all duration-200 hover:-translate-y-0.5 col-span-2 md:col-span-1",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-600 mb-1",children:" "}),s.jsx("p",{className:"text-xl md:text-2xl font-bold text-emerald-600",children:r.filter(b=>b.test.passing_score&&b.test.passing_score>0?b.score>=b.test.passing_score:b.score>0).length})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100",children:[s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("nav",{className:"flex flex-wrap md:flex-nowrap space-x-0 md:space-x-8 px-2 md:px-6",children:[s.jsx("button",{onClick:()=>h("active"),className:Ve("py-2.5 md:py-4 px-1 md:px-1 border-b-2 font-medium text-xs md:text-sm flex-1 md:flex-none transition-all duration-200",f==="active"?"border-[#06A478] text-[#06A478]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:s.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-1 md:space-x-2",children:[s.jsx("span",{className:"hidden md:inline",children:" "}),s.jsx("span",{className:"md:hidden text-xs",children:""}),s.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-1.5 md:px-2 py-0.5 rounded-full",children:["(",l.length,")"]})]})}),s.jsx("button",{onClick:()=>h("completed"),className:Ve("py-2.5 md:py-4 px-1 md:px-1 border-b-2 font-medium text-xs md:text-sm flex-1 md:flex-none transition-all duration-200",f==="completed"?"border-[#06A478] text-[#06A478]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:s.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-1 md:space-x-2",children:[s.jsx("span",{className:"hidden md:inline",children:" "}),s.jsx("span",{className:"md:hidden text-xs",children:""}),s.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-1.5 md:px-2 py-0.5 rounded-full",children:["(",r.length,")"]})]})}),s.jsx("button",{onClick:()=>h("future"),className:Ve("py-2.5 md:py-4 px-1 md:px-1 border-b-2 font-medium text-xs md:text-sm flex-1 md:flex-none transition-all duration-200",f==="future"?"border-[#06A478] text-[#06A478]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:s.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-1 md:space-x-2",children:[s.jsx("span",{className:"hidden md:inline",children:" "}),s.jsx("span",{className:"md:hidden text-xs",children:""}),s.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-1.5 md:px-2 py-0.5 rounded-full",children:["(",n.length,")"]})]})})]})}),s.jsx("div",{className:"p-4 md:p-6",children:f==="active"?s.jsx("div",{className:"space-y-3 md:space-y-4",children:l.length===0?s.jsxs("div",{className:"text-center py-8 md:py-12",children:[s.jsx(Xn,{className:"h-10 w-10 md:h-12 md:w-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-base md:text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"      "})]}):l.map(b=>{const _=y(b.test.type);return s.jsx("div",{className:`${_.bg} ${_.bgHover} ${_.border} rounded-xl p-4 transition-all duration-200 hover:-translate-y-0.5 group`,children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-3 md:space-y-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center mb-3",children:[s.jsx("div",{className:`p-1.5 rounded-lg ${_.accent} bg-opacity-20 mr-2 group-hover:scale-105 transition-transform duration-200 flex-shrink-0 h-6 w-6 flex items-center justify-center`,children:s.jsx(Xn,{className:`h-4 w-4 ${_.icon}`})}),s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${_.badge} h-6`,children:g(b.test.type)})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900 leading-tight break-words mb-2",children:b.test.title}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2 leading-relaxed",children:[": ",b.event.title]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-gray-500",children:[s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(wr,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",v(b.start_time)]})]}),s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(at,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",b.test.time_limit===0?" ":`${b.test.time_limit} `]})]}),s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(er,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",b.test.passing_score&&b.test.passing_score>0?`${b.test.passing_score}%`:" "]})]})]})]})]}),s.jsx("div",{className:"md:ml-4 flex justify-center md:justify-end w-full md:w-auto",children:s.jsxs("button",{onClick:()=>{console.log("Button clicked for test:",b.test.id,"event:",b.event.id),m(b.test.id,b.event.id)},className:`${_.accent} text-white px-4 py-2 rounded-lg transition-all duration-200 font-medium flex items-center justify-center space-x-2 transform hover:scale-[1.01] w-full md:w-auto`,children:[s.jsx(Xn,{size:16}),s.jsx("span",{children:" "})]})})]})},b.id)})}):f==="completed"?s.jsx("div",{className:"space-y-3 md:space-y-4",children:r.length===0?s.jsxs("div",{className:"text-center py-8 md:py-12",children:[s.jsx(Et,{className:"h-10 w-10 md:h-12 md:w-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-base md:text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"    "})]}):r.map(b=>{const _=y(b.test.type),C=b.test.passing_score&&b.test.passing_score>0?b.score>=b.test.passing_score:b.score>0;return s.jsx("div",{className:`${_.bg} ${_.bgHover} ${_.border} rounded-xl p-4 transition-all duration-200 hover:-translate-y-0.5 group`,children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-3 md:space-y-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center mb-3",children:[s.jsx("div",{className:`p-1.5 rounded-lg ${_.accent} bg-opacity-20 mr-2 group-hover:scale-105 transition-transform duration-200 flex-shrink-0 h-6 w-6 flex items-center justify-center`,children:s.jsx(at,{className:`h-4 w-4 ${_.icon}`})}),s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${_.badge} h-6`,children:g(b.test.type)})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900 leading-tight break-words mb-2",children:b.test.title}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2 leading-relaxed",children:[": ",b.event.title]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-gray-500",children:[s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(wr,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",v(b.completed_at||b.start_time)]})]}),s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(at,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",b.test.time_limit===0?" ":`${b.test.time_limit} `]})]}),s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(er,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",b.test.passing_score&&b.test.passing_score>0?`${b.test.passing_score}%`:" "]})]})]})]})]}),s.jsx("div",{className:"md:ml-4 flex justify-center md:justify-end w-full md:w-auto",children:s.jsxs("div",{className:"text-center w-full md:w-auto",children:[s.jsxs("div",{className:`text-xl font-bold ${C?"text-green-600":"text-red-600"} mb-1`,children:[b.score,"%"]}),s.jsx("div",{className:`text-xs font-medium px-2 py-1 rounded-full ${C?"bg-green-100 text-green-800":"bg-red-100 text-red-800"} w-full md:w-auto`,children:C?"":" "})]})})]})},b.id)})}):s.jsx("div",{className:"space-y-3 md:space-y-4",children:n.length===0?s.jsxs("div",{className:"text-center py-8 md:py-12",children:[s.jsx(wr,{className:"h-10 w-10 md:h-12 md:w-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-base md:text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"   ,  "})]}):n.map((b,_)=>{const C=y(b.test.type);return s.jsx("div",{className:`${C.bg} ${C.bgHover} ${C.border} rounded-xl p-4 transition-all duration-200 hover:-translate-y-0.5 group`,children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-3 md:space-y-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center mb-3",children:[s.jsx("div",{className:`p-1.5 rounded-lg ${C.accent} bg-opacity-20 mr-2 group-hover:scale-105 transition-transform duration-200 flex-shrink-0 h-6 w-6 flex items-center justify-center`,children:b.test.type==="annual"&&!b.isAvailable?s.jsx(Xw,{className:`h-4 w-4 ${C.icon}`}):s.jsx(Xn,{className:`h-4 w-4 ${C.icon}`})}),s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${C.badge} h-6`,children:g(b.test.type)})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900 leading-tight break-words mb-2",children:b.test.title}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2 leading-relaxed",children:[": ",b.event.title]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-gray-500",children:[s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(wr,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",v(b.event.start_date)]})]}),s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(at,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",b.test.time_limit===0?" ":`${b.test.time_limit} `]})]}),s.jsxs("div",{className:"flex items-center space-x-1 min-w-0",children:[s.jsx(er,{className:"h-3 w-3 flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap",children:[": ",b.test.passing_score&&b.test.passing_score>0?`${b.test.passing_score}%`:" "]})]})]}),b.test.description&&s.jsx("p",{className:"text-xs text-gray-600 mt-2 leading-relaxed",children:b.test.description})]})]}),s.jsx("div",{className:"md:ml-4 flex justify-center md:justify-end w-full md:w-auto",children:b.test.type==="annual"&&!b.isAvailable?s.jsxs("div",{className:`${C.accent} bg-opacity-20 px-4 py-2 rounded-lg text-sm ${C.title} flex items-center justify-center space-x-2 w-full md:w-auto`,children:[s.jsx(Xw,{size:16}),s.jsx("span",{children:w(b.event.end_date,b.event.start_date)})]}):s.jsxs("button",{onClick:()=>{console.log("Button clicked for future test:",b.test.id,"event:",b.event.id),m(b.test.id,b.event.id)},className:`${C.accent} text-white px-4 py-2 rounded-lg transition-all duration-200 font-medium flex items-center justify-center space-x-2 transform hover:scale-[1.01] w-full md:w-auto`,children:[s.jsx(Xn,{size:16}),s.jsx("span",{children:" "})]})})]})},`${b.test.id}-${b.event.id}`)})})})]})]}))}function r7({eventId:e,onBack:t}){var W;const{userProfile:r}=st(),[a,n]=E.useState([]),[i,l]=E.useState(null),[o,c]=E.useState([]),[d,x]=E.useState(!0),[u,f]=E.useState(null),[h,p]=E.useState(""),[g,y]=E.useState("all"),[v,w]=E.useState(null),[m,b]=E.useState(!1);Qt();const[_,C]=E.useState(!1),[j,D]=E.useState(null),[R,M]=E.useState(!1),[O,B]=E.useState(null);E.useEffect(()=>{e?U(e):L()},[e]);const L=async()=>{console.log("loadEvents called"),x(!0),f(null);try{console.log("Fetching events from Supabase...");const{data:k,error:q}=await Z.from("events").select(`
          id,
          title,
          start_date,
          end_date,
          event_type:event_type_id(
            id,
            name,
            name_ru,
            has_entry_test,
            has_final_test
          )
        `).order("start_date",{ascending:!1});if(console.log("Supabase response:",{data:k,error:q}),q)throw q;console.log("Setting events:",k||[]),console.log("Events count:",(k==null?void 0:k.length)||0),n(k||[])}catch(k){console.error("  :",k),f(k.message)}finally{x(!1)}},U=async k=>{x(!0),f(null);try{const{data:q,error:A}=await Z.from("events").select(`
          id,
          title,
          start_date,
          end_date,
          event_type:event_type_id(
            id,
            name,
            name_ru,
            has_entry_test,
            has_final_test
          )
        `).eq("id",k).single();if(A)throw A;n([q]),l(q),w(q.id),P(q.id)}catch(q){console.error("  :",q),f(q.message)}finally{x(!1)}},P=async k=>{console.log("loadEventParticipants called for eventId:",k),x(!0),f(null);try{const{data:q,error:A}=await Z.from("event_participants").select(`
          id,
          user_id,
          attended,
          entry_test_score,
          final_test_score,
          user:users(
            id,
            full_name,
            email
          )
        `).eq("event_id",k);if(console.log("Participants data:",q),console.log("Participants error:",A),A)throw A;const I=(q==null?void 0:q.map(te=>te.user_id))||[],{data:V,error:H}=await Z.from("user_test_attempts").select(`
          id,
          user_id,
          test_id,
          event_id,
          status,
          score,
          start_time,
          end_time,
          test:tests(
            id,
            title,
            type,
            passing_score
          )
        `).eq("event_id",k).in("user_id",I);if(H)throw H;const Y={};V==null||V.forEach(te=>{Y[te.user_id]||(Y[te.user_id]=[]),Y[te.user_id].push(te)});const Q=(q==null?void 0:q.map(te=>{var J,ue;const re=Y[te.user_id]||[],X=re.filter(de=>de.test.type==="entry"&&de.status==="completed").sort((de,ce)=>(ce.score||0)-(de.score||0))[0],je=re.filter(de=>de.test.type==="final"&&de.status==="completed").sort((de,ce)=>(ce.score||0)-(de.score||0))[0];return{id:te.id,user_id:te.user_id,full_name:((J=te.user)==null?void 0:J.full_name)||" ",email:((ue=te.user)==null?void 0:ue.email)||"",attended:te.attended,entry_test_score:(X==null?void 0:X.score)||te.entry_test_score,final_test_score:(je==null?void 0:je.score)||te.final_test_score,test_attempts:re}}))||[];console.log("Formatted participants:",Q),c(Q)}catch(q){console.error("  :",q),f(q.message)}finally{x(!1)}},F=k=>{const q=v===k.id?null:k.id;console.log("Event clicked:",k.title,"Current expanded:",v,"New expanded:",q),l(k),w(q),q===k.id&&(console.log("Loading participants for event:",k.id),P(k.id))},N=k=>new Date(k).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}),T=async k=>{M(!0),B(null);try{console.log("Loading test details for attempt:",k);const{data:q,error:A}=await Z.from("user_test_attempts").select(`
          id,
          test_id,
          event_id,
          user_id,
          status,
          score,
          start_time,
          end_time,
          user:users!user_id(
            id,
            full_name,
            email
          ),
          test:tests(
            id,
            title,
            description,
            type,
            passing_score,
            time_limit
          ),
          event:events(
            id,
            title,
            start_date,
            end_date
          )
        `).eq("id",k).single();if(A)throw A;if(!q)throw new Error("   ");let I=q.user;if(!I&&q.user_id){const{data:je,error:J}=await Z.from("users").select("id, full_name, email").eq("id",q.user_id).single();!J&&je&&(I=je)}const{data:V,error:H}=await Z.from("user_test_answers").select(`
          id,
          question_id,
          answer_id,
          text_answer,
          is_correct,
          user_order,
          question:test_questions(
            id,
            question,
            question_type,
            points,
            correct_order,
            answers:test_answers(
              id,
              text,
              is_correct,
              "order"
            )
          )
        `).eq("attempt_id",k).order("question_id",{ascending:!0});if(H)throw console.error("Error loading answers:",H),H;const Q=((V==null?void 0:V.filter(je=>{var J;return((J=je.question)==null?void 0:J.question_type)==="sequence"}))||[]).map(je=>je.question_id);let te={};if(Q.length>0){const{data:je,error:J}=await Z.from("test_sequence_answers").select("*").in("question_id",Q).order("answer_order");!J&&je&&je.forEach(ue=>{te[ue.question_id]||(te[ue.question_id]=[]),te[ue.question_id].push(ue)})}if(H)throw H;const re={...q,user:I},X=V?V.reduce((je,J)=>{if(je.findIndex(de=>de.question_id===J.question_id)===-1){const de={...J,question:{...J.question,sequence_answers:te[J.question_id]||[]}};je.push(de)}return je},[]):[];D({...re,answers:X||[]}),C(!0)}catch(q){console.error("   :",q),B(q.message)}finally{M(!1)}},S=k=>{if(v!==k.id)return{totalParticipants:0,entryTestsCompleted:0,finalTestsCompleted:0,annualTestsCompleted:0,averageEntryScore:0,averageFinalScore:0,averageAnnualScore:0};const q=o.filter(X=>X.test_attempts.some(je=>je.event_id===k.id));console.log(`Event ${k.title} (${k.id}) has ${q.length} participants`);const A=q.length,I=q.filter(X=>X.entry_test_score!==null).length,V=q.filter(X=>X.final_test_score!==null).length,H=q.filter(X=>X.test_attempts.some(je=>je.event_id===k.id&&je.test.type==="annual"&&je.status==="completed")).length,Y=I>0?Math.round(q.reduce((X,je)=>X+(je.entry_test_score||0),0)/I):0,Q=V>0?Math.round(q.reduce((X,je)=>X+(je.final_test_score||0),0)/V):0,te=q.map(X=>{var je;return(je=X.test_attempts.find(J=>J.event_id===k.id&&J.test.type==="annual"&&J.status==="completed"))==null?void 0:je.score}).filter(X=>X!=null),re=te.length>0?Math.round(te.reduce((X,je)=>X+(je||0),0)/te.length):0;return{totalParticipants:A,entryTestsCompleted:I,finalTestsCompleted:V,annualTestsCompleted:H,averageEntryScore:Y,averageFinalScore:Q,averageAnnualScore:re}},z=a.filter(k=>{const q=k.title.toLowerCase().includes(h.toLowerCase()),A=g==="all"||g==="entry"&&k.event_type.has_entry_test||g==="final"&&k.event_type.has_final_test;return q&&A});return console.log("TestResultsOverview render state:",{loading:d,error:u,eventsCount:a.length,filteredEventsCount:z.length,participantsCount:o.length,expandedEvent:v,events:a.map(k=>({id:k.id,title:k.title}))}),d?s.jsxs("div",{className:"flex items-center justify-center min-h-64",children:[s.jsx(Er,{className:"w-8 h-8 animate-spin text-sns-green"}),s.jsx("span",{className:"text-gray-600 ml-2",children:"  ..."})]}):u?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ar,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:u})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[s.jsxs("div",{children:[t&&s.jsx("div",{className:"mb-4",children:s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx(kn,{size:20}),s.jsx("span",{children:"   "})]})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-600",children:"    "})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:" ...",value:h,onChange:k=>p(k.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent"})]}),s.jsxs("select",{value:g,onChange:k=>y(k.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sns-green focus:border-transparent",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"entry",children:" "}),s.jsx("option",{value:"final",children:" "})]})]})]}),s.jsx("div",{className:"space-y-4",children:z.map(k=>{const q=v===k.id,A=S(k),I=o.filter(V=>V.test_attempts.some(H=>H.event_id===k.id));return s.jsxs("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100 overflow-hidden",children:[s.jsx("div",{className:"p-6 cursor-pointer hover:bg-gray-50 transition-colors duration-200",onClick:()=>F(k),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:k.title}),s.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(zt,{size:16}),s.jsxs("span",{children:[N(k.start_date)," - ",N(k.end_date)]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(nt,{size:16}),s.jsxs("span",{children:[A.totalParticipants," "]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500",children:" "}),s.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[A.entryTestsCompleted,"/",A.totalParticipants]}),A.entryTestsCompleted>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[" : ",A.averageEntryScore,"%"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500",children:" "}),s.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[A.finalTestsCompleted,"/",A.totalParticipants]}),A.finalTestsCompleted>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[" : ",A.averageFinalScore,"%"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500",children:" "}),s.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[A.annualTestsCompleted||0,"/",A.totalParticipants]}),A.annualTestsCompleted>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:[" : ",A.averageAnnualScore||0,"%"]})]}),s.jsx("div",{className:"flex items-center",children:q?s.jsx(Vc,{size:20}):s.jsx(xi,{size:20})})]})]})}),q&&s.jsx("div",{className:"border-t border-gray-100",children:d?s.jsxs("div",{className:"p-6 text-center",children:[s.jsx(Er,{className:"w-6 h-6 animate-spin text-sns-green mx-auto"}),s.jsx("span",{className:"text-gray-600 ml-2",children:" ..."})]}):s.jsxs("div",{className:"p-6",children:[s.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"   "}),I.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(nt,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),s.jsx("p",{children:"   "})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.map(V=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:V.full_name}),s.jsx("div",{className:"text-sm text-gray-500",children:V.email})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:Ve("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",V.attended?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:V.attended?"":""})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.entry_test_score!==null?s.jsxs("button",{onClick:()=>{const H=V.test_attempts.find(Y=>Y.test.type==="entry"&&Y.status==="completed");H&&(console.log("Loading entry test details for attempt:",H.id),T(H.id))},className:"flex items-center space-x-2 hover:bg-gray-50 p-1 rounded transition-colors cursor-pointer",title:"     ",children:[s.jsxs("span",{className:Ve("text-sm font-medium",V.entry_test_score>=70?"text-green-600":"text-red-600"),children:[V.entry_test_score,"%"]}),V.entry_test_score>=70?s.jsx(at,{className:"h-4 w-4 text-green-500"}):s.jsx(ds,{className:"h-4 w-4 text-red-500"})]}):s.jsx("span",{className:"text-sm text-gray-500",children:" "})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.final_test_score!==null?s.jsxs("button",{onClick:()=>{const H=V.test_attempts.find(Y=>Y.test.type==="final"&&Y.status==="completed");if(H)T(H.id);else{const Y=V.test_attempts.find(Q=>Q.test.type==="final");Y&&T(Y.id)}},className:"flex items-center space-x-2 hover:bg-gray-50 p-1 rounded transition-colors cursor-pointer",title:"     ",children:[s.jsxs("span",{className:Ve("text-sm font-medium",V.final_test_score>=70?"text-green-600":"text-red-600"),children:[V.final_test_score,"%"]}),V.final_test_score>=70?s.jsx(at,{className:"h-4 w-4 text-green-500"}):s.jsx(ds,{className:"h-4 w-4 text-red-500"})]}):s.jsx("span",{className:"text-sm text-gray-500",children:" "})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(()=>{const H=V.test_attempts.find(Y=>Y.test.type==="annual"&&Y.status==="completed");return H?s.jsxs("button",{onClick:()=>{console.log("Loading annual test details for attempt:",H.id),T(H.id)},className:"flex items-center space-x-2 hover:bg-gray-50 p-1 rounded transition-colors cursor-pointer",title:"     ",children:[s.jsxs("span",{className:Ve("text-sm font-medium",H.score>=H.test.passing_score?"text-green-600":"text-red-600"),children:[H.score,"%"]}),H.score>=H.test.passing_score?s.jsx(at,{className:"h-4 w-4 text-green-500"}):s.jsx(ds,{className:"h-4 w-4 text-red-500"})]}):s.jsx("span",{className:"text-sm text-gray-500",children:" "})})()})]},V.id))})]})})]})})]},k.id)})}),z.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Et,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-600",children:"   "})]}),_&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"  "}),(j==null?void 0:j.user)&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[": ",j.user.full_name]})]}),s.jsx("button",{onClick:()=>{C(!1),D(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Qe,{size:24})})]})}),s.jsx("div",{className:"p-6",children:R?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Er,{className:"w-8 h-8 animate-spin text-sns-green mx-auto"}),s.jsx("span",{className:"text-gray-600 ml-2",children:" ..."})]}):O?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ar,{className:"w-8 h-8 text-red-500 mx-auto mb-4"}),s.jsx("p",{className:"text-red-600",children:O})]}):j?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:j.test.title}),s.jsx("p",{className:"text-sm text-gray-600",children:j.event.title})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:Ve("text-3xl font-bold",j.score>=j.test.passing_score?"text-green-600":"text-red-600"),children:[j.score,"%"]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[" : ",j.test.passing_score,"%"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500",children:N(j.start_time)}),s.jsx("div",{className:"text-sm text-gray-500",children:j.test.time_limit>0?`${j.test.time_limit} `:" "})]})]})}),j.answers&&j.answers.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["   (",j.answers.length,")"]}),j.answers.map((k,q)=>{var A,I,V,H,Y,Q,te,re,X,je;return s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[" ",q+1,": ",k.question.question]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("span",{className:Ve("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",(()=>{var J;if(k.question.question_type==="single_choice")if(k.answer_id){const ue=(J=k.question.answers)==null?void 0:J.find(de=>de.id===k.answer_id);return(ue==null?void 0:ue.is_correct)||!1}else return!1;else if(k.question.question_type==="sequence"&&k.user_order){const de=(k.question.sequence_answers||[]).sort((ce,fe)=>ce.answer_order-fe.answer_order).map(ce=>ce.id);return JSON.stringify(k.user_order)===JSON.stringify(de)}return k.is_correct||!1})()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:(()=>{var J;if(k.question.question_type==="single_choice")if(k.answer_id){const ue=(J=k.question.answers)==null?void 0:J.find(de=>de.id===k.answer_id);return ue!=null&&ue.is_correct?"":""}else return"  ";else if(k.question.question_type==="sequence"&&k.user_order){const de=(k.question.sequence_answers||[]).sort((ce,fe)=>ce.answer_order-fe.answer_order).map(ce=>ce.id);return JSON.stringify(k.user_order)===JSON.stringify(de)?"":""}return k.is_correct?"":""})()})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:" :"}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:k.question.question_type==="single_choice"?k.answer_id?s.jsx("p",{className:"text-blue-800",children:((I=(A=k.question.answers)==null?void 0:A.find(J=>J.id===k.answer_id))==null?void 0:I.text)||"  "}):s.jsxs("div",{className:"text-blue-800",children:[s.jsx("p",{className:"font-medium mb-2",children:"  "}),s.jsx("p",{className:"text-sm text-gray-600",children:" :"}),s.jsx("ul",{className:"mt-1 space-y-1",children:(V=k.question.answers)==null?void 0:V.map((J,ue)=>s.jsxs("li",{className:"text-sm",children:[ue+1,". ",J.text]},J.id))})]}):k.question.question_type==="multiple_choice"?k.answer_id?s.jsx("p",{className:"text-blue-800",children:((Y=(H=k.question.answers)==null?void 0:H.find(J=>J.id===k.answer_id))==null?void 0:Y.text)||"  "}):s.jsxs("div",{className:"text-blue-800",children:[s.jsx("p",{className:"font-medium mb-2",children:"  "}),s.jsx("p",{className:"text-sm text-gray-600",children:" :"}),s.jsx("ul",{className:"mt-1 space-y-1",children:(Q=k.question.answers)==null?void 0:Q.map((J,ue)=>s.jsxs("li",{className:"text-sm",children:[ue+1,". ",J.text]},J.id))})]}):k.question.question_type==="text"?k.text_answer?s.jsx("p",{className:"text-blue-800",children:k.text_answer}):s.jsx("p",{className:"text-blue-800",children:"   "}):k.question.question_type==="sequence"&&k.user_order?(()=>{const J=k.question.sequence_answers||[];if(J.length===0)return s.jsxs("div",{className:"text-blue-800",children:[s.jsxs("p",{children:[": ",k.user_order.join("  ")]}),k.question.correct_order&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[" : ",k.question.correct_order.join("  ")]})]});const ue=J.sort((pe,Ne)=>pe.answer_order-Ne.answer_order).map(pe=>pe.id),de=k.user_order.map(pe=>{const Ne=J.find(ne=>ne.id===pe);return Ne?Ne.answer_text:`ID: ${pe}`}),ce=ue.map(pe=>{const Ne=J.find(ne=>ne.id===pe);return Ne?Ne.answer_text:`ID: ${pe}`}),fe=JSON.stringify(k.user_order)===JSON.stringify(ue);return s.jsxs("div",{className:"text-gray-800",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${fe?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:fe?" ":""}),s.jsx("div",{className:"text-xs text-gray-500",children:fe?" ":"  "})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-xs mb-2 text-blue-700 uppercase tracking-wide",children:" :"}),s.jsx("div",{className:"space-y-1",children:de.map((pe,Ne)=>{const ne=ue.indexOf(k.user_order[Ne]),_e=ne===Ne,Te=ne!==-1&&ne!==Ne;return s.jsxs("div",{className:`flex items-center p-2 rounded text-xs ${_e?"bg-green-50 border-l-2 border-green-400":Te?"bg-yellow-50 border-l-2 border-yellow-400":"bg-red-50 border-l-2 border-red-400"}`,children:[s.jsx("span",{className:`text-white text-xs font-medium rounded-full w-5 h-5 flex items-center justify-center mr-2 flex-shrink-0 ${_e?"bg-green-500":Te?"bg-yellow-500":"bg-red-500"}`,children:Ne+1}),s.jsx("span",{className:"leading-tight",children:pe}),Te&&s.jsxs("span",{className:"ml-auto text-yellow-600 text-xs",children:["",ne+1]})]},Ne)})})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-xs mb-2 text-green-700 uppercase tracking-wide",children:" :"}),s.jsx("div",{className:"space-y-1",children:ce.map((pe,Ne)=>s.jsxs("div",{className:"flex items-center p-2 bg-green-50 rounded border-l-2 border-green-400",children:[s.jsx("span",{className:"bg-green-500 text-white text-xs font-medium rounded-full w-5 h-5 flex items-center justify-center mr-2 flex-shrink-0",children:Ne+1}),s.jsx("span",{className:"leading-tight text-xs",children:pe})]},Ne))})]})]})]})})():s.jsx("p",{className:"text-gray-500",children:"  "})})]}),(k.question.question_type==="single_choice"||k.question.question_type==="multiple_choice")&&s.jsxs("div",{children:[s.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:" :"}),s.jsx("div",{className:"bg-green-50 border border-green-200 rounded p-3",children:k.question.question_type==="single_choice"?s.jsx("p",{className:"text-green-800",children:((re=(te=k.question.answers)==null?void 0:te.find(J=>J.is_correct))==null?void 0:re.text)||"   "}):k.question.question_type==="multiple_choice"?s.jsx("p",{className:"text-green-800",children:((je=(X=k.question.answers)==null?void 0:X.find(J=>J.is_correct))==null?void 0:je.text)||"   "}):s.jsx("p",{className:"text-green-800",children:"   "})})]})]},k.id)}),s.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-base font-medium text-gray-900 mb-3",children:" "}),(()=>{var H,Y;let k=0,q=0,A=0,I=((H=j.answers)==null?void 0:H.length)||0;(Y=j.answers)==null||Y.forEach(Q=>{var re;k+=Q.question.points;let te=!1;if(Q.question.question_type==="single_choice")if(Q.answer_id){const X=(re=Q.question.answers)==null?void 0:re.find(je=>je.id===Q.answer_id);te=(X==null?void 0:X.is_correct)||!1}else te=!1;else if(Q.question.question_type==="sequence"&&Q.user_order){const je=(Q.question.sequence_answers||[]).sort((J,ue)=>J.answer_order-ue.answer_order).map(J=>J.id);te=JSON.stringify(Q.user_order)===JSON.stringify(je)}else te=Q.is_correct;te&&(q+=Q.question.points,A++)});const V=k>0?Math.round(q/k*100):0;return s.jsxs("div",{className:"bg-white p-3 rounded border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:" :"}),s.jsx("span",{className:`text-sm px-2 py-1 rounded-full ${V>=j.test.passing_score?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:V>=j.test.passing_score?"":" "})]}),s.jsxs("div",{className:"text-xl font-bold text-gray-900 mb-2",children:[q," / ",k," = ",V,"%"]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[s.jsxs("span",{children:[": ",I]}),s.jsxs("span",{children:[": ",A]}),s.jsxs("span",{children:[": ",q,"/",k]})]})]})})()]})]}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Et,{className:"w-12 h-12 mx-auto text-gray-300 mb-4"}),s.jsx("p",{children:"  "}),s.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[": ",((W=j.answers)==null?void 0:W.length)||0]})]})]}):null})]})})]})}const ane={entry:"",final:"",annual:""},nne={draft:"",active:"",inactive:""},ine={single_choice:" ",multiple_choice:" ",text:" ",sequence:""};function s7({type:e}){const r={entry:"bg-emerald-500/10 text-emerald-600 ring-1 ring-emerald-500/30",final:"bg-sky-500/10 text-sky-600 ring-1 ring-sky-500/30",annual:"bg-purple-500/10 text-purple-600 ring-1 ring-purple-500/30"}[e]??"bg-slate-500/10 text-slate-600 ring-1 ring-slate-500/30",a=ane[e]??e;return s.jsx("span",{className:Ve("inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold uppercase tracking-wide",r),children:a})}function a7({status:e}){const r={active:"bg-emerald-400/15 text-emerald-600 ring-1 ring-emerald-400/30",draft:"bg-amber-400/15 text-amber-700 ring-1 ring-amber-400/30",inactive:"bg-slate-400/15 text-slate-600 ring-1 ring-slate-400/30"}[e]??"bg-slate-400/15 text-slate-600 ring-1 ring-slate-400/30",a=nne[e]??e;return s.jsx("span",{className:Ve("inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold uppercase tracking-wide",r),children:a})}function lne({title:e,value:t,icon:r,accent:a}){const n={emerald:"bg-emerald-500/12 text-emerald-600",sky:"bg-sky-500/12 text-sky-600",indigo:"bg-indigo-500/12 text-indigo-600",amber:"bg-amber-500/12 text-amber-600",purple:"bg-purple-500/12 text-purple-600"};return s.jsx("div",{className:"relative overflow-hidden rounded-[24px] border border-white/60 bg-white/80 px-5 py-4 shadow-[0_28px_60px_-36px_rgba(15,23,42,0.35)] backdrop-blur-xl transition-transform duration-300 hover:-translate-y-1",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:e}),s.jsx("p",{className:"text-2xl font-semibold text-slate-900",children:t})]}),s.jsx("div",{className:Ve("flex h-12 w-12 items-center justify-center rounded-xl",n[a]),children:r})]})})}function one({rawSearch:e,onSearchChange:t,selectedType:r,onTypeChange:a,countsByType:n,totalTests:i,sortKey:l,onSortKeyChange:o,sortDir:c,onSortDirChange:d,onExport:x,onImport:u,disabled:f}){const h=[{value:"all",label:` (${i})`},{value:"entry",label:` (${n.entry})`},{value:"final",label:` (${n.final})`},{value:"annual",label:` (${n.annual})`}];return s.jsxs("div",{className:"rounded-[28px] border border-white/60 bg-white/75 p-5 shadow-[0_24px_44px_-32px_rgba(15,23,42,0.4)] backdrop-blur-xl space-y-5",children:[s.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Ia,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-slate-400"}),s.jsx("input",{type:"text",value:e,onChange:p=>t(p.target.value),placeholder:"    ...",className:"w-full rounded-2xl border border-slate-200 bg-white/80 py-3 pl-11 pr-4 text-sm text-slate-700 shadow-inner shadow-slate-900/5 focus:border-emerald-400 focus:outline-none focus:ring-4 focus:ring-emerald-500/15"})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200/60 bg-white/70 px-3 py-1 text-xs font-semibold uppercase tracking-[0.12em] text-slate-500",children:[s.jsx(Jh,{className:"h-3.5 w-3.5 text-slate-400"})," "]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(p=>s.jsx("button",{onClick:()=>a(p.value),className:Ve("rounded-full px-4 py-1.5 text-sm font-medium transition-all duration-200",r===p.value?"bg-emerald-500/15 text-emerald-700 ring-2 ring-emerald-500/30 shadow-sm shadow-emerald-950/10":"bg-white/70 text-slate-500 hover:text-slate-700"),children:p.label},p.value))})]})]}),s.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[s.jsx("div",{className:"flex flex-wrap items-center gap-3",children:s.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200/60 bg-white/70 px-3 py-2 text-sm text-slate-500",children:[s.jsx("span",{children:""}),s.jsxs("select",{value:l,onChange:p=>o(p.target.value),className:"rounded-lg border border-slate-200 bg-white px-3 py-1 text-sm text-slate-600 focus:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-400/20",children:[s.jsx("option",{value:"updated",children:" "}),s.jsx("option",{value:"title",children:" "}),s.jsx("option",{value:"status",children:" "}),s.jsx("option",{value:"questions",children:" "})]}),s.jsxs("select",{value:c,onChange:p=>d(p.target.value),className:"rounded-lg border border-slate-200 bg-white px-3 py-1 text-sm text-slate-600 focus:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-400/20",children:[s.jsx("option",{value:"desc",children:" "}),s.jsx("option",{value:"asc",children:" "})]})]})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsxs("button",{onClick:x,disabled:f,className:"inline-flex items-center gap-2 text-sm font-medium text-emerald-600 transition hover:text-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",children:[s.jsx(Bn,{className:"h-4 w-4"}),""]}),s.jsxs("button",{onClick:u,disabled:f,className:"inline-flex items-center gap-2 text-sm font-medium text-sky-600 transition hover:text-sky-700 disabled:cursor-not-allowed disabled:opacity-60",children:[s.jsx(xo,{className:"h-4 w-4"}),""]})]})]})]})}function n7({test:e,onView:t,onEdit:r,onDuplicate:a,onDelete:n,busy:i,loadingQuestions:l}){var o;return s.jsxs("div",{className:"group relative flex h-full flex-col rounded-[26px] border border-white/60 bg-white/80 p-5 shadow-[0_28px_60px_-38px_rgba(15,23,42,0.4)] transition-transform duration-200 hover:-translate-y-1 hover:shadow-[0_48px_80px_-42px_rgba(15,23,42,0.4)]",children:[i&&s.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center rounded-[26px] bg-white/70 backdrop-blur-sm",children:s.jsx(Er,{className:"h-6 w-6 animate-spin text-rose-500"})}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(s7,{type:e.type}),s.jsx(a7,{status:e.status})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-semibold leading-tight text-slate-900",children:e.title}),e.description&&s.jsx("p",{className:"text-sm leading-relaxed text-slate-600 line-clamp-3",children:e.description})]}),((o=e.event_type)==null?void 0:o.name_ru)&&s.jsxs("div",{className:"inline-flex items-center gap-2 rounded-xl border border-slate-200/60 bg-slate-50/60 px-3 py-1 text-xs font-medium text-slate-500",children:[s.jsx(Et,{className:"h-3.5 w-3.5 text-slate-400"}),e.event_type.name_ru]})]}),s.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-3 text-xs text-slate-500",children:[s.jsxs("div",{className:"rounded-2xl border border-slate-200/60 bg-white/80 px-3 py-2 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm font-semibold text-slate-900",children:[s.jsx(YM,{className:"h-4 w-4 text-emerald-500"}),s.jsxs("span",{children:[e.passing_score,"%"]})]}),s.jsx("p",{className:"mt-1 text-[11px] uppercase tracking-[0.08em]",children:""})]}),s.jsxs("div",{className:"rounded-2xl border border-slate-200/60 bg-white/80 px-3 py-2 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm font-semibold text-slate-900",children:[s.jsx(MM,{className:"h-4 w-4 text-sky-500"}),s.jsx("span",{children:e.time_limit===0?"":`${e.time_limit} `})]}),s.jsx("p",{className:"mt-1 text-[11px] uppercase tracking-[0.08em]",children:""})]}),s.jsxs("div",{className:"rounded-2xl border border-slate-200/60 bg-white/80 px-3 py-2 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm font-semibold text-slate-900",children:[s.jsx(V_,{className:"h-4 w-4 text-purple-500"}),s.jsx("span",{children:e.questions_count??0})]}),s.jsx("p",{className:"mt-1 text-[11px] uppercase tracking-[0.08em]",children:""})]})]}),s.jsxs("div",{className:"mt-5 flex items-center justify-between gap-3",children:[s.jsxs("button",{onClick:()=>t(e),disabled:l||i,className:"inline-flex items-center gap-2 rounded-full bg-slate-900 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:[l?s.jsx(Er,{className:"h-4 w-4 animate-spin"}):s.jsx(el,{className:"h-4 w-4"}),""]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>r(e),className:"rounded-full border border-slate-200 bg-white/80 p-2 text-slate-500 transition hover:text-emerald-600",children:s.jsx(sn,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>a(e),className:"rounded-full border border-slate-200 bg-white/80 p-2 text-slate-500 transition hover:text-sky-600",children:s.jsx(Hc,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>n(e.id),className:"rounded-full border border-slate-200 bg-white/80 p-2 text-slate-500 transition hover:text-rose-600",children:s.jsx(Zr,{className:"h-4 w-4"})})]})]})]})}function i7(){return s.jsxs("div",{className:"flex h-full flex-col rounded-[26px] border border-slate-200/60 bg-white/70 p-5",children:[s.jsx("div",{className:"h-4 w-1/3 animate-pulse rounded-full bg-slate-200/70"}),s.jsx("div",{className:"mt-3 h-6 w-3/4 animate-pulse rounded-full bg-slate-200/70"}),s.jsx("div",{className:"mt-2 h-4 w-full animate-pulse rounded-full bg-slate-200/60"}),s.jsx("div",{className:"mt-2 h-4 w-2/3 animate-pulse rounded-full bg-slate-200/60"}),s.jsxs("div",{className:"mt-5 grid grid-cols-3 gap-3",children:[s.jsx("div",{className:"h-16 animate-pulse rounded-2xl bg-slate-200/60"}),s.jsx("div",{className:"h-16 animate-pulse rounded-2xl bg-slate-200/60"}),s.jsx("div",{className:"h-16 animate-pulse rounded-2xl bg-slate-200/60"})]}),s.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[s.jsx("div",{className:"h-10 w-28 animate-pulse rounded-full bg-slate-200/60"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"h-10 w-10 animate-pulse rounded-full bg-slate-200/60"}),s.jsx("div",{className:"h-10 w-10 animate-pulse rounded-full bg-slate-200/60"}),s.jsx("div",{className:"h-10 w-10 animate-pulse rounded-full bg-slate-200/60"})]})]})]})}function Ky({title:e,description:t,action:r}){return s.jsxs("div",{className:"flex flex-col items-center gap-3 rounded-[24px] border border-slate-200/70 bg-slate-50/60 px-6 py-10 text-center",children:[s.jsx(Et,{className:"h-10 w-10 text-slate-300"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-700",children:e}),s.jsx("p",{className:"text-xs text-slate-500",children:t})]}),r]})}function Z5({title:e,subtitle:t,tests:r,loading:a,deletingTestId:n,loadingQuestions:i,onView:l,onEdit:o,onDuplicate:c,onDelete:d,onCreate:x}){const[u,f]=E.useState(!0);return s.jsxs("section",{className:"rounded-[28px] border border-white/60 bg-white/70 p-5 shadow-[0_28px_60px_-38px_rgba(15,23,42,0.4)] backdrop-blur-xl",children:[s.jsxs("button",{onClick:()=>f(h=>!h),className:"flex w-full items-center justify-between gap-4 rounded-2xl border border-slate-200/60 bg-white/70 px-4 py-3 text-left transition hover:border-slate-300",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:e}),t&&s.jsx("span",{className:"text-xs font-medium text-slate-400",children:t})]}),t&&s.jsx("p",{className:"mt-1 text-xs text-slate-500",children:t})]}),s.jsx("div",{className:"rounded-full border border-slate-200 bg-white/70 p-1 text-slate-500",children:u?s.jsx(Vc,{className:"h-4 w-4"}):s.jsx(xi,{className:"h-4 w-4"})})]}),u&&s.jsx("div",{className:"mt-5",children:a?s.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:Array.from({length:3}).map((h,p)=>s.jsx(i7,{},p))}):r.length===0?s.jsx(Ky,{title:"    ",description:" ,      .",action:x&&s.jsxs("button",{onClick:x,className:"inline-flex items-center gap-2 rounded-full border border-emerald-200 bg-white px-4 py-2 text-sm font-medium text-emerald-600 transition hover:border-emerald-300 hover:text-emerald-700",children:[s.jsx(es,{className:"h-4 w-4"})," "]})}):s.jsx("div",{className:"-mx-2 flex snap-x gap-4 overflow-x-auto px-2 pb-1 scrollbar-hide md:mx-0 md:grid md:grid-cols-2 md:gap-6 md:overflow-visible md:px-0 xl:grid-cols-3",children:r.map(h=>s.jsx(n7,{test:h,onView:l,onEdit:o,onDuplicate:c,onDelete:d,busy:n===h.id,loadingQuestions:i},h.id))})})]})}function cne({tests:e,loading:t,pagedTests:r,deletingTestId:a,loadingQuestions:n,page:i,totalPages:l,onPageChange:o,pageSize:c,onPageSizeChange:d,onView:x,onEdit:u,onDuplicate:f,onDelete:h}){return s.jsxs("section",{className:"rounded-[28px] border border-white/60 bg-white/75 p-5 shadow-[0_28px_60px_-38px_rgba(15,23,42,0.4)] backdrop-blur-xl",children:[s.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-200/60 pb-5 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:" "}),s.jsx("p",{className:"text-xs text-slate-500",children:"      "})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[s.jsx("span",{children:" :"}),s.jsx("select",{value:c,onChange:p=>d(Number(p.target.value)||20),className:"rounded-lg border border-slate-200 bg-white px-3 py-1 focus:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-400/20",children:[9,12,18,24].map(p=>s.jsx("option",{value:p,children:p},p))}),s.jsxs("span",{className:"hidden md:block",children:[" ",i,"  ",l]})]})]}),s.jsx("div",{className:"mt-5 grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:t?Array.from({length:c}).map((p,g)=>s.jsx(i7,{},g)):r.map(p=>s.jsx(n7,{test:p,onView:x,onEdit:u,onDuplicate:f,onDelete:h,busy:a===p.id,loadingQuestions:n},p.id))}),!t&&r.length===0&&s.jsx("div",{className:"mt-5",children:s.jsx(Ky,{title:"     ",description:"  ,      ."})}),s.jsxs("div",{className:"mt-6 flex flex-col items-center justify-between gap-4 border-t border-slate-200/60 pt-5 text-sm text-slate-500 md:flex-row",children:[s.jsxs("div",{children:[" ",r.length,"  ",e.length," "]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>o(Math.max(1,i-1)),disabled:i<=1,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-600 transition hover:border-slate-300 disabled:cursor-not-allowed disabled:opacity-50",children:[s.jsx(Sn,{className:"h-4 w-4"}),""]}),s.jsxs("span",{className:"hidden md:inline",children:[" ",i,"  ",l]}),s.jsxs("button",{onClick:()=>o(Math.min(l,i+1)),disabled:i>=l,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-600 transition hover:border-slate-300 disabled:cursor-not-allowed disabled:opacity-50",children:["",s.jsx(Fa,{className:"h-4 w-4"})]})]})]})]})}function dne({open:e,test:t,questions:r,loading:a,onClose:n,onDuplicate:i,onEdit:l,onViewQuestion:o}){var c;return!e||!t?null:s.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-slate-900/50 backdrop-blur-sm px-4 py-6",children:s.jsxs("div",{className:"relative flex max-h-[90vh] w-full max-w-4xl flex-col overflow-hidden rounded-[30px] border border-white/15 bg-white shadow-[0_40px_120px_-50px_rgba(15,23,42,0.6)]",children:[s.jsxs("div",{className:"flex flex-col gap-4 border-b border-slate-200/60 bg-slate-50/60 p-6",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(s7,{type:t.type}),s.jsx(a7,{status:t.status}),((c=t.event_type)==null?void 0:c.name_ru)&&s.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200/60 bg-white px-3 py-1 text-xs text-slate-500",children:[s.jsx(Et,{className:"h-3.5 w-3.5 text-slate-400"}),t.event_type.name_ru]})]}),s.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:t.title}),t.description&&s.jsx("p",{className:"text-sm text-slate-600",children:t.description})]}),s.jsx("button",{onClick:n,className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-500 transition hover:text-slate-700",children:""})]}),s.jsxs("div",{className:"grid gap-3 rounded-[20px] border border-white/70 bg-white/80 p-4 text-sm text-slate-600 md:grid-cols-4",children:[s.jsxs("div",{className:"flex flex-col gap-1 rounded-[16px] border border-slate-200/60 bg-slate-50/60 p-3",children:[s.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-400",children:" "}),s.jsxs("span",{className:"text-base font-semibold text-slate-900",children:[t.passing_score,"%"]})]}),s.jsxs("div",{className:"flex flex-col gap-1 rounded-[16px] border border-slate-200/60 bg-slate-50/60 p-3",children:[s.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-400",children:" "}),s.jsx("span",{className:"text-base font-semibold text-slate-900",children:t.time_limit===0?" ":`${t.time_limit} `})]}),s.jsxs("div",{className:"flex flex-col gap-1 rounded-[16px] border border-slate-200/60 bg-slate-50/60 p-3",children:[s.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-400",children:""}),s.jsx("span",{className:"text-base font-semibold text-slate-900",children:r.length})]}),s.jsxs("div",{className:"flex flex-col gap-1 rounded-[16px] border border-slate-200/60 bg-slate-50/60 p-3",children:[s.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-400",children:" "}),s.jsx("span",{className:"text-base font-semibold text-slate-900",children:new Date(t.updated_at).toLocaleDateString("ru-RU")})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsxs("button",{onClick:()=>l(t),className:"inline-flex items-center gap-2 rounded-full border border-emerald-200 bg-white px-4 py-2 text-sm font-medium text-emerald-600 transition hover:border-emerald-300 hover:text-emerald-700",children:[s.jsx(sn,{className:"h-4 w-4"}),""]}),s.jsxs("button",{onClick:()=>i(t),className:"inline-flex items-center gap-2 rounded-full border border-sky-200 bg-white px-4 py-2 text-sm font-medium text-sky-600 transition hover:border-sky-300 hover:text-sky-700",children:[s.jsx(Hc,{className:"h-4 w-4"}),""]})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s.jsx("h4",{className:"text-lg font-semibold text-slate-900",children:" "}),s.jsx("p",{className:"mb-4 text-xs text-slate-500",children:"  ,    ."}),a?s.jsxs("div",{className:"flex items-center justify-center py-12 text-slate-500",children:[s.jsx(Er,{className:"mr-2 h-5 w-5 animate-spin"})," ..."]}):r.length===0?s.jsx(Ky,{title:"    ",description:" ,      .",action:s.jsxs("button",{onClick:()=>l(t),className:"inline-flex items-center gap-2 rounded-full border border-emerald-200 bg-white px-4 py-2 text-sm font-medium text-emerald-600 transition hover:border-emerald-300 hover:text-emerald-700",children:[s.jsx(es,{className:"h-4 w-4"})," "]})}):s.jsx("div",{className:"space-y-4",children:r.map((d,x)=>s.jsx("button",{onClick:()=>o(d),className:"w-full rounded-[20px] border border-slate-200/70 bg-white/90 p-4 text-left transition hover:border-emerald-200 hover:bg-emerald-50/40",children:s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[s.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-500/15 font-semibold text-emerald-600",children:x+1}),s.jsx("span",{children:ine[d.question_type]??""}),s.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-medium text-slate-500",children:[d.points," "]}),d.answers&&s.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-medium text-slate-500",children:[d.answers.length," "]})]}),s.jsx("p",{className:"text-sm font-medium text-slate-900",children:d.question})]}),s.jsx(el,{className:"h-4 w-4 text-slate-400"})]})},d.id))})]})]})})}function xne(){const{userProfile:e}=st(),{toast:t}=hm(),[r,a]=E.useState([]),[n,i]=E.useState(!0),[l,o]=E.useState(!1),[c,d]=E.useState(null),[x,u]=E.useState(null),[f,h]=E.useState([]),[p,g]=E.useState(!1),[y,v]=E.useState(!1),[w,m]=E.useState(!1),[b,_]=E.useState(!1),[C,j]=E.useState(""),[D,R]=E.useState(""),[M,O]=E.useState("all"),[B,L]=E.useState("updated"),[U,P]=E.useState("desc"),[F,N]=E.useState(null),[T,S]=E.useState("tests"),[z,W]=E.useState(1),[k,q]=E.useState(12),A=E.useCallback(async()=>{i(!0);try{const{data:Ce,error:Ye}=await Z.from("tests").select(`
            *,
            event_type:event_type_id(name, name_ru),
            test_questions(count)
          `).order("updated_at",{ascending:!1});if(Ye)throw Ye;const Ue=(Ce==null?void 0:Ce.map(He=>{var pt,Je;return{...He,questions_count:((Je=(pt=He.test_questions)==null?void 0:pt[0])==null?void 0:Je.count)??0}}))??[];a(Ue)}catch(Ce){console.error("   :",Ce),t("   ,  .")}finally{i(!1)}},[t]),I=E.useCallback(async Ce=>{o(!0);try{const{data:Ye,error:Ue}=await Z.from("test_questions").select("*").eq("test_id",Ce).order('"order"',{ascending:!0,nullsLast:!0}).order("created_at",{ascending:!0,nullsLast:!0}).order("id",{ascending:!0});if(Ue)throw Ue;const He=await Promise.all((Ye??[]).map(async pt=>{if(pt.question_type==="sequence"){const{data:vt,error:Is}=await Z.from("test_sequence_answers").select("*").eq("question_id",pt.id).order("answer_order");if(Is)throw Is;const zr=(vt==null?void 0:vt.map(za=>({id:za.id,question_id:za.question_id,text:za.answer_text,order:za.answer_order,is_correct:!0})))??[];return{...pt,answers:zr}}const{data:Je,error:Jt}=await Z.from("test_answers").select("*").eq("question_id",pt.id).order("order");if(Jt)throw Jt;const or=(Je==null?void 0:Je.map(vt=>({id:vt.id,question_id:vt.question_id,text:vt.text,order:vt.order,is_correct:!!vt.is_correct})))??[];return{...pt,answers:or}}));return h(He),He}catch(Ye){return console.error("   :",Ye),t("    ."),[]}finally{o(!1)}},[t]);E.useEffect(()=>{A()},[A]),E.useEffect(()=>{const Ce=window.setTimeout(()=>R(C.trim()),250);return()=>window.clearTimeout(Ce)},[C]);const V=E.useMemo(()=>{const Ce=D.toLowerCase(),Ye=r.filter(He=>{var Jt;const pt=Ce?He.title.toLowerCase().includes(Ce)||((Jt=He.description)==null?void 0:Jt.toLowerCase().includes(Ce)):!0,Je=M==="all"?!0:He.type===M;return pt&&Je}),Ue=U==="asc"?1:-1;return Ye.sort((He,pt)=>{switch(B){case"title":return He.title.localeCompare(pt.title)*Ue;case"status":return He.status.localeCompare(pt.status)*Ue;case"questions":return((He.questions_count??0)-(pt.questions_count??0))*Ue;case"updated":default:return(new Date(He.updated_at).getTime()-new Date(pt.updated_at).getTime())*Ue}})},[r,D,M,B,U]),H=E.useMemo(()=>({entry:r.filter(Ce=>Ce.type==="entry").length,final:r.filter(Ce=>Ce.type==="final").length,annual:r.filter(Ce=>Ce.type==="annual").length}),[r]),Y=V.filter(Ce=>{var Ye;return((Ye=Ce.event_type)==null?void 0:Ye.name)==="online_training"&&["entry","final","annual"].includes(Ce.type)}),Q=V.filter(Ce=>{var Ye;return((Ye=Ce.event_type)==null?void 0:Ye.name)==="in_person_training"&&Ce.title.includes("    ")&&["entry","final","annual"].includes(Ce.type)}),te=V.filter(Ce=>{var Ye,Ue;return!(((Ye=Ce.event_type)==null?void 0:Ye.name)==="online_training"&&["entry","final","annual"].includes(Ce.type)||((Ue=Ce.event_type)==null?void 0:Ue.name)==="in_person_training"&&Ce.title.includes("    ")&&["entry","final","annual"].includes(Ce.type))});E.useEffect(()=>{W(1)},[D,M,B,U,k]);const re=Math.max(1,Math.ceil(te.length/k)),X=E.useMemo(()=>{const Ce=(z-1)*k;return te.slice(Ce,Ce+k)},[te,z,k]),je=E.useMemo(()=>({totalTests:r.length,activeTests:r.filter(Ce=>Ce.status==="active").length,entryTests:r.filter(Ce=>Ce.type==="entry").length,finalTests:r.filter(Ce=>Ce.type==="final").length,totalQuestions:r.reduce((Ce,Ye)=>Ce+(Ye.questions_count??0),0)}),[r]);function J(){_(!1),d(null),m(!0)}function ue(Ce){d(Ce),_(!0),m(!0)}function de(){m(!1),d(null),_(!1)}async function ce(Ce){d(Ce),h([]),await I(Ce.id),v(!0)}function fe(Ce){u(Ce),g(!0)}function pe(){v(!1),d(null),h([])}async function Ne(Ce){var Ye;try{const{data:Ue,error:He}=await Z.from("tests").insert({title:` ${Ce.title}`,description:Ce.description,type:Ce.type,passing_score:Ce.passing_score,time_limit:Ce.time_limit,event_type_id:Ce.event_type_id,status:"draft"}).select().single();if(He)throw He;const pt=await I(Ce.id);for(const Je of pt){const{data:Jt,error:or}=await Z.from("test_questions").insert({test_id:Ue.id,question:Je.question,question_type:Je.question_type,order:Je.order,points:Je.points,explanation:Je.explanation??null}).select().single();if(or)throw or;if((Ye=Je.answers)!=null&&Ye.length)if(Je.question_type==="sequence"){const vt=Je.answers.map(zr=>({question_id:Jt.id,answer_text:zr.text,answer_order:zr.order,is_correct:!0})),{error:Is}=await Z.from("test_sequence_answers").insert(vt);if(Is)throw Is}else{const vt=Je.answers.map(zr=>({question_id:Jt.id,text:zr.text,is_correct:zr.is_correct,order:zr.order})),{error:Is}=await Z.from("test_answers").insert(vt);if(Is)throw Is}}await A(),t(` : ${Ue.title}`)}catch(Ue){console.error("   :",Ue),t("    .")}}async function ne(Ce){if(window.confirm(" ?  .")){N(Ce);try{const{error:Ye}=await Z.from("tests").delete().eq("id",Ce);if(Ye)throw Ye;a(Ue=>Ue.filter(He=>He.id!==Ce)),t(" ")}catch(Ye){console.error("   :",Ye),t("   .")}finally{N(null)}}}function _e(){A()}function Te(){t("    .")}function Me(){t("    .")}if((e==null?void 0:e.role)==="employee")return s.jsx(sne,{});if(T==="results")return s.jsx(r7,{onBack:()=>S("tests")});const Re=[{title:" ",value:je.totalTests,icon:s.jsx(Et,{className:"h-5 w-5"}),accent:"emerald"},{title:"",value:je.activeTests,icon:s.jsx(K_,{className:"h-5 w-5"}),accent:"sky"},{title:"",value:je.entryTests,icon:s.jsx(Dn,{className:"h-5 w-5"}),accent:"purple"},{title:" ",value:je.totalQuestions,icon:s.jsx(V_,{className:"h-5 w-5"}),accent:"amber"}],De=je.totalTests?` : ${je.totalTests}. : ${je.activeTests}.`:"  ,     .";return s.jsxs("div",{className:"space-y-8 pb-safe-bottom",children:[s.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:" "}),s.jsx("p",{className:"text-sm text-slate-600",children:De}),s.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-1 text-sm font-medium text-slate-600",children:[s.jsxs("button",{onClick:()=>S("tests"),className:Ve("flex items-center gap-2 rounded-full px-4 py-2 transition",T==="tests"?"bg-white text-slate-900 shadow-sm":"hover:text-slate-900"),children:[s.jsx(Et,{className:"h-4 w-4"}),""]}),s.jsxs("button",{onClick:()=>S("results"),className:Ve("flex items-center gap-2 rounded-full px-4 py-2 transition",T==="results"?"bg-white text-slate-900 shadow-sm":"hover:text-slate-900"),children:[s.jsx(Dn,{className:"h-4 w-4"}),""]})]})]}),s.jsx("div",{className:"flex flex-col-reverse gap-3 sm:flex-row sm:items-center",children:s.jsxs("button",{onClick:J,className:"inline-flex items-center gap-2 rounded-2xl bg-gradient-to-r from-emerald-500 to-emerald-600 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:from-emerald-600 hover:to-emerald-700",children:[s.jsx(es,{className:"h-4 w-4"})," "]})})]}),s.jsx("section",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4",children:Re.map(Ce=>s.jsx(lne,{title:Ce.title,value:Ce.value,icon:Ce.icon,accent:Ce.accent},Ce.title))}),s.jsx(one,{rawSearch:C,onSearchChange:j,selectedType:M,onTypeChange:O,countsByType:H,totalTests:r.length,sortKey:B,onSortKeyChange:L,sortDir:U,onSortDirChange:P,onExport:Te,onImport:Me,disabled:n||l}),s.jsx(Z5,{title:' "Online training"',subtitle:" ,      -",tests:Y,loading:n,deletingTestId:F,loadingQuestions:l,onView:ce,onEdit:ue,onDuplicate:Ne,onDelete:ne,onCreate:J}),s.jsx(Z5,{title:' "    "',subtitle:"      ",tests:Q,loading:n,deletingTestId:F,loadingQuestions:l,onView:ce,onEdit:ue,onDuplicate:Ne,onDelete:ne,onCreate:J}),s.jsx(cne,{tests:te,loading:n,pagedTests:X,deletingTestId:F,loadingQuestions:l,page:z,totalPages:re,onPageChange:W,pageSize:k,onPageSizeChange:q,onView:ce,onEdit:ue,onDuplicate:Ne,onDelete:ne}),s.jsx(dne,{open:y,test:c,questions:f,loading:l,onClose:pe,onDuplicate:Ne,onEdit:ue,onViewQuestion:fe}),s.jsx(tne,{isOpen:w,onClose:de,testId:b?c==null?void 0:c.id:void 0,onSuccess:_e}),s.jsx(rne,{isOpen:p,onClose:()=>g(!1),question:x})]})}function une(){const{userProfile:e}=st(),{territories:t}=eA(),[r,a]=E.useState([]),[n,i]=E.useState([]),[l,o]=E.useState([]),[c,d]=E.useState(!0),[x,u]=E.useState(!1),[f,h]=E.useState(null),[p,g]=E.useState(null),[y,v]=E.useState(null),[w,m]=E.useState({}),[b,_]=E.useState(null),[C,j]=E.useState(null),[D,R]=E.useState(""),[M,O]=E.useState(!1),[B,L]=E.useState(!1),[U,P]=E.useState(""),[F,N]=E.useState(10),T=(e==null?void 0:e.role)==="administrator",S=(e==null?void 0:e.role)==="administrator"||(e==null?void 0:e.role)==="trainer",z=typeof window<"u"&&matchMedia("(pointer: coarse)").matches,W=E.useRef(null),[k,q]=E.useState("");E.useEffect(()=>(W.current&&window.clearTimeout(W.current),W.current=window.setTimeout(()=>q(D.trim().toLowerCase()),250),()=>{W.current&&window.clearTimeout(W.current)}),[D]),E.useEffect(()=>{S&&A()},[S,F]);async function A(){d(!0),h(null);try{const{data:fe,error:pe}=await Z.from("trainer_territories").select(`
          id, trainer_id, territory_id, assigned_at, is_active,
          trainer:users!trainer_territories_trainer_id_fkey(
            id, full_name, email, phone, territory_id,
            territory:territories!users_territory_id_fkey(id, name, region)
          ),
          territory:territories!trainer_territories_territory_id_fkey(id, name, region)
        `).order("assigned_at",{ascending:!1});if(pe)throw pe;const{data:Ne,error:ne}=await Z.from("users").select(`
          id, full_name, email, phone, territory_id,
          territory:territories!users_territory_id_fkey(id, name, region)
        `).eq("role","trainer").eq("is_active",!0).order("full_name");if(ne)throw ne;const{data:_e,error:Te}=await Z.from("trainer_territories_log").select(`
          id, trainer_territory_id, trainer_id, territory_id, action, performed_by, performed_at, metadata,
          trainer:users!trainer_territories_log_trainer_id_fkey(full_name),
          territory:territories!trainer_territories_log_territory_id_fkey(name),
          performer:users!trainer_territories_log_performed_by_fkey(full_name)
        `).order("performed_at",{ascending:!1}).limit(F);if(Te)throw Te;const Me=(fe||[]).map(De=>{const Ce=Array.isArray(De.trainer)?De.trainer[0]:De.trainer,Ye=Array.isArray(Ce==null?void 0:Ce.territory)?Ce.territory[0]:Ce==null?void 0:Ce.territory,Ue=Array.isArray(De.territory)?De.territory[0]:De.territory;return{...De,trainer:{...Ce,territory:Ye},territory:Ue}}),ye=(Ne||[]).map(De=>{const Ce=Array.isArray(De.territory)?De.territory[0]:De.territory;return{...De,territory:Ce}}),Re=(_e||[]).map(De=>({...De,trainer:Array.isArray(De.trainer)?De.trainer[0]:De.trainer,territory:Array.isArray(De.territory)?De.territory[0]:De.territory,performer:Array.isArray(De.performer)?De.performer[0]:De.performer}));a(Me),i(ye),o(Re)}catch(fe){console.error(fe),h("   .   .")}finally{d(!1)}}function I(fe){return r.filter(pe=>pe.trainer_id===fe)}function V(fe){const pe=fe%10,Ne=fe%100;return Ne>=11&&Ne<=19?`${fe} `:pe===1?`${fe} `:pe>=2&&pe<=4?`${fe} `:`${fe} `}function H(fe,pe){return r.some(Ne=>Ne.trainer_id===fe&&Ne.territory_id===pe)}function Y(){const fe=new Set(r.map(pe=>pe.territory_id));return t.filter(pe=>!fe.has(pe.id))}function Q(){const fe=Y();return U?fe.filter(pe=>pe.name.toLowerCase().includes(U.toLowerCase())||pe.region&&pe.region.toLowerCase().includes(U.toLowerCase())):fe}function te(fe){return{assigned:"",unassigned:" ",activated:"",deactivated:"",deleted:""}[fe]||fe}function re(fe){!z&&T&&_(fe)}function X(){_(null),j(null)}function je(fe,pe){T&&(fe.preventDefault(),j(pe))}async function J(fe){b&&T&&(H(fe,b)||await ue(fe,b)),_(null),j(null)}async function ue(fe,pe){u(!0),h(null);try{const{error:Ne}=await Z.from("trainer_territories").insert({trainer_id:fe,territory_id:pe,is_active:!0});if(Ne)throw Ne;await A()}catch(Ne){console.error(Ne),h("  .")}finally{u(!1)}}async function de(fe){u(!0),h(null);try{if((e==null?void 0:e.role)!=="administrator")throw new Error("      ");const{error:pe}=await Z.from("trainer_territories").delete().eq("id",fe);if(pe)throw pe;g(null),await A()}catch(pe){console.error(pe),h(` : ${pe.message||" "}`)}finally{u(!1)}}const ce=E.useMemo(()=>k?n.filter(fe=>{var _e;const pe=(fe.full_name||"").toLowerCase(),Ne=(fe.email||"").toLowerCase(),ne=(((_e=fe.territory)==null?void 0:_e.name)||"").toLowerCase();return pe.includes(k)||Ne.includes(k)||ne.includes(k)}):n,[n,k]);return S?s.jsxs("div",{className:"p-4 sm:p-6",children:[s.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"inline-flex h-10 w-10 items-center justify-center rounded-2xl bg-emerald-100",children:s.jsx(Ka,{className:"h-5 w-5 text-emerald-700"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl sm:text-2xl font-bold tracking-tight",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"    .      ."})]})]}),s.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:s.jsxs("button",{onClick:A,className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm hover:bg-gray-50",children:[s.jsx(en,{className:"h-4 w-4"}),""]})})]}),s.jsxs("div",{className:"mb-4 sm:mb-6 grid grid-cols-2 gap-3 sm:grid-cols-3",children:[s.jsx(ip,{icon:s.jsx(nt,{className:"h-5 w-5 text-emerald-600"}),label:"",value:n.length}),s.jsx(ip,{icon:s.jsx(nr,{className:"h-5 w-5 text-sky-600"}),label:"",value:t.length}),s.jsx(ip,{icon:s.jsx(at,{className:"h-5 w-5 text-green-600"}),label:"",value:r.length})]}),s.jsx("div",{className:"sticky top-0 z-10 mb-4 rounded-2xl border border-gray-200 bg-white/80 p-2 sm:p-3 backdrop-blur supports-[backdrop-filter]:bg-white/60",children:s.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{className:"relative w-full sm:max-w-md",children:[s.jsx(Ia,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),s.jsx("input",{value:D,onChange:fe=>R(fe.target.value),className:"w-full rounded-xl border border-gray-300 bg-white pl-9 pr-3 py-2 text-sm outline-none focus:border-emerald-500",placeholder:"  , email  "})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>L(fe=>!fe),className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm hover:bg-gray-50",children:[s.jsx(Ka,{className:"h-4 w-4"}),B?" ":" "]}),s.jsxs("button",{onClick:()=>O(fe=>!fe),className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm hover:bg-gray-50",children:[s.jsx(ar,{className:"h-4 w-4"}),M?" ":" "]})]})]})}),s.jsx("div",{className:"space-y-6",children:c?s.jsx(fne,{}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"   "}),ce.length===0&&s.jsx(hne,{title:"  ",subtitle:"  ,   "})]}),s.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row",children:[s.jsx("div",{className:"flex-1 space-y-3 sm:space-y-4",children:ce.map(fe=>{const pe=I(fe.id),Ne=C===fe.id,ne=w[fe.id]??!0;return s.jsxs("div",{onDrop:()=>!z&&T&&J(fe.id),onDragOver:_e=>!z&&T&&je(_e,fe.id),onDragLeave:()=>j(null),className:`rounded-2xl border bg-white p-3 sm:p-4 transition-colors ${!z&&T&&Ne?"border-emerald-400 ring-2 ring-emerald-200":"border-gray-200"}`,children:[s.jsxs("div",{className:"w-full flex items-center justify-between gap-3",onClick:()=>z&&m(_e=>({..._e,[fe.id]:!ne})),role:z?"button":void 0,tabIndex:z?0:void 0,onKeyDown:_e=>{z&&(_e.key==="Enter"||_e.key===" ")&&(_e.preventDefault(),m(Te=>({...Te,[fe.id]:!ne})))},"aria-expanded":z?ne:void 0,children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-emerald-100",children:s.jsx(nt,{className:"h-4 w-4 text-emerald-600"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"truncate font-medium text-gray-900",children:fe.full_name}),s.jsx("div",{className:"truncate text-xs sm:text-sm text-gray-500",children:fe.email})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"hidden sm:inline rounded-full bg-gray-100 px-2 py-1 text-xs text-gray-600",children:V(pe.length)}),T&&s.jsx("button",{type:"button",onClick:_e=>{_e.stopPropagation(),v(fe)},className:"flex h-9 w-9 items-center justify-center rounded-lg bg-gray-100 text-gray-600 hover:bg-emerald-100 hover:text-emerald-700",title:" ",children:s.jsx(bR,{className:"h-4 w-4"})}),z&&s.jsx(xi,{className:`h-5 w-5 text-gray-400 transition-transform ${ne?"rotate-180":""}`})]})]}),(!z||ne)&&s.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:[pe.sort((_e,Te)=>{const Me=fe.territory_id===_e.territory.id,ye=fe.territory_id===Te.territory.id;return Me&&!ye?-1:!Me&&ye?1:0}).map(_e=>{const Te=fe.territory_id===_e.territory.id;return s.jsxs("div",{className:`flex items-center justify-between rounded-lg border px-3 py-2 ${Te?"border-blue-300 bg-blue-50":"border-emerald-200 bg-emerald-50"}`,children:[s.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[s.jsx(nr,{className:`h-3.5 w-3.5 flex-shrink-0 ${Te?"text-blue-600":"text-emerald-600"}`}),s.jsxs("div",{className:"min-w-0",children:[s.jsxs("div",{className:`truncate text-sm font-medium ${Te?"text-blue-900":"text-emerald-900"}`,children:[_e.territory.name,Te&&s.jsx("span",{className:"ml-1 text-xs font-normal text-blue-600",children:"()"})]}),_e.territory.region&&s.jsx("div",{className:`truncate text-xs ${Te?"text-blue-600":"text-emerald-600"}`,children:_e.territory.region})]})]}),!Te&&T&&s.jsx("button",{onClick:()=>de(_e.id),className:"rounded p-1 text-red-500 hover:bg-white hover:text-red-600",title:" ",children:s.jsx(Qe,{className:"h-3.5 w-3.5"})})]},_e.id)}),pe.length===0&&s.jsx("div",{className:"col-span-full rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-3 text-center text-xs sm:text-sm text-gray-500",children:z?" ,   ":"     "})]})]},fe.id)})}),B&&!z&&s.jsx("div",{className:"w-full flex-shrink-0 lg:w-72",children:s.jsxs("div",{className:"sticky top-4 rounded-2xl border border-gray-200 bg-white p-3",children:[s.jsx("h3",{className:"mb-3 text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"max-h-80 space-y-1 overflow-y-auto",children:Y().length>0?Y().map(fe=>s.jsx("div",{draggable:T,onDragStart:()=>re(fe.id),onDragEnd:X,className:`${T?"cursor-move":"cursor-default"} rounded-lg border border-dashed border-gray-300 bg-gray-50 px-3 py-2 transition-all hover:border-emerald-400 hover:bg-emerald-50 ${b===fe.id?"opacity-50":""}`,title:T?"   ":"  ",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(W_,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("div",{className:"truncate text-sm font-medium text-gray-900",children:fe.name}),fe.region&&s.jsx("div",{className:"truncate text-xs text-gray-500",children:fe.region})]})]})},fe.id)):s.jsxs("div",{className:"rounded-lg border border-dashed border-gray-300 bg-gray-50 px-3 py-4 text-center text-sm text-gray-500",children:[s.jsx(Ka,{className:"mx-auto h-8 w-8 text-gray-400"}),s.jsx("p",{className:"mt-2",children:"   "})]})}),s.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[s.jsx("span",{role:"img","aria-label":"hint",children:""}),"   "]})]})})]})]})}),M&&s.jsxs("div",{className:"mt-4 rounded-2xl border border-gray-200 bg-white p-4",children:[s.jsx("h3",{className:"mb-3 sm:mb-4 text-base sm:text-lg font-semibold text-gray-900",children:" "}),s.jsxs("div",{className:"max-h-64 space-y-2 overflow-y-auto",children:[l.map(fe=>{var pe,Ne,ne;return s.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-gray-100 bg-gray-50 p-3",children:[s.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-blue-100",children:s.jsx(ar,{className:"h-4 w-4 text-blue-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[(pe=fe.performer)==null?void 0:pe.full_name," ",te(fe.action),"  ",(Ne=fe.territory)==null?void 0:Ne.name,"  ",(ne=fe.trainer)==null?void 0:ne.full_name]}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(fe.performed_at).toLocaleString("ru-RU")})]}),s.jsx("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${fe.action==="assigned"||fe.action==="activated"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:te(fe.action)})]},fe.id)}),l.length===0&&s.jsx("div",{className:"rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-4 text-center text-sm text-gray-500",children:"   "}),l.length>0&&l.length>=F&&s.jsx("div",{className:"flex justify-center pt-2",children:s.jsx("button",{onClick:()=>N(fe=>fe+10),className:"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:" "})})]})]}),f&&s.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:s.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-rose-800 shadow",children:[s.jsx(ar,{className:"h-5 w-5"}),s.jsx("span",{className:"text-sm",children:f}),s.jsx("button",{onClick:()=>h(null),className:"ml-2 rounded-md px-2 text-xs hover:bg-white/40",children:""})]})}),p&&s.jsxs(mne,{onClose:()=>g(null),title:" ?",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"   .    ."}),s.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>g(null),className:"rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm hover:bg-gray-50",disabled:x,children:""}),s.jsx("button",{onClick:()=>de(p),disabled:x,className:"rounded-xl bg-rose-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-rose-700",children:""})]})]}),y&&!y.bulk&&s.jsxs(gne,{onClose:()=>{v(null),P("")},title:" ",children:[s.jsx("div",{className:"mb-4 rounded-xl border border-gray-200 bg-gray-50 p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-emerald-100",children:s.jsx(nt,{className:"h-6 w-6 text-emerald-600"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900",children:y.full_name}),s.jsx("div",{className:"text-sm text-gray-500",children:y.email}),s.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:[V(I(y.id).length)," "]})]})]})}),s.jsxs("div",{className:"mb-6 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-1 text-xs font-medium text-emerald-700",children:I(y.id).length})]}),s.jsxs("div",{className:"max-h-48 space-y-2 overflow-y-auto rounded-lg border border-gray-200 p-3",children:[I(y.id).sort((fe,pe)=>{const Ne=y.territory_id===fe.territory.id,ne=y.territory_id===pe.territory.id;return Ne&&!ne?-1:!Ne&&ne?1:0}).map(fe=>{const pe=y.territory_id===fe.territory.id;return s.jsxs("div",{className:`flex items-center justify-between rounded-lg border px-3 py-2.5 ${pe?"border-blue-300 bg-blue-50":"border-emerald-200 bg-emerald-50"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(nr,{className:`h-4 w-4 ${pe?"text-blue-600":"text-emerald-600"}`}),s.jsxs("div",{children:[s.jsxs("div",{className:`text-sm font-medium ${pe?"text-blue-900":"text-emerald-900"}`,children:[fe.territory.name,pe&&s.jsx("span",{className:"ml-2 text-xs font-normal text-blue-600",children:"()"})]}),fe.territory.region&&s.jsx("div",{className:`text-xs ${pe?"text-blue-600":"text-emerald-600"}`,children:fe.territory.region})]})]}),!pe&&T&&s.jsx("button",{onClick:()=>de(fe.id),className:"rounded-lg p-1.5 text-red-500 hover:bg-red-50 hover:text-red-600 transition-colors",title:" ",children:s.jsx(Qe,{className:"h-4 w-4"})})]},fe.id)}),I(y.id).length===0&&s.jsxs("div",{className:"rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-4 text-center text-sm text-gray-500",children:[s.jsx(nr,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),"  "]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-1 text-xs font-medium text-gray-700",children:Q().length})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Ia,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),s.jsx("input",{value:U,onChange:fe=>P(fe.target.value),className:"w-full rounded-xl border border-gray-300 bg-white pl-9 pr-3 py-2.5 text-sm outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",placeholder:"    ..."})]}),s.jsxs("div",{className:"max-h-64 space-y-2 overflow-y-auto rounded-lg border border-gray-200 p-3",children:[Q().map(fe=>s.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-gray-200 bg-white p-3 text-sm transition-colors hover:border-emerald-300 hover:bg-emerald-50",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:fe.name}),fe.region&&s.jsx("div",{className:"text-xs text-gray-500",children:fe.region})]}),T&&s.jsx("button",{onClick:async()=>{await ue(y.id,fe.id)},className:"flex h-8 w-8 items-center justify-center rounded-lg bg-emerald-100 text-emerald-600 hover:bg-emerald-200 hover:text-emerald-700 transition-colors",title:" ",children:s.jsx(es,{className:"h-4 w-4"})})]},fe.id)),Q().length===0&&s.jsxs("div",{className:"rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-4 text-center text-sm text-gray-500",children:[s.jsx(Ka,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),U?"  ":"   "]})]})]}),s.jsx("div",{className:"mt-4 flex justify-end",children:s.jsx("button",{onClick:()=>{v(null),P("")},className:"rounded-lg bg-emerald-600 px-5 py-2 text-sm font-medium text-white shadow-sm hover:bg-emerald-700 transition-colors",children:""})})]})]}):s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50/60 p-4",children:s.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[s.jsx(ar,{className:"h-5 w-5"}),s.jsx("span",{children:"        "})]})})})}function ip({icon:e,label:t,value:r}){return s.jsx("div",{className:"rounded-2xl border border-gray-200 bg-white p-3 sm:p-4 shadow-sm",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-gray-50",children:e}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:t}),s.jsx("p",{className:"text-lg sm:text-2xl font-semibold text-gray-900",children:r})]})]})})}function fne(){return s.jsx("div",{className:"flex-1 space-y-3 sm:space-y-4",children:Array.from({length:4}).map((e,t)=>s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-3 sm:p-4",children:[s.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[s.jsx("div",{className:"h-9 w-9 animate-pulse rounded-full bg-gray-100"}),s.jsx("div",{className:"h-5 w-48 animate-pulse rounded bg-gray-100"})]}),s.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:3}).map((r,a)=>s.jsx("div",{className:"h-11 sm:h-12 animate-pulse rounded-lg bg-gray-100"},a))})]},t))})}function hne({title:e,subtitle:t}){return s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-8 text-center",children:[s.jsx("div",{className:"mx-auto mb-3 h-10 w-10 rounded-2xl bg-gray-100"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e}),s.jsx("p",{className:"text-sm text-gray-500",children:t})]})}function mne({title:e,children:t,onClose:r}){return E.useEffect(()=>{const a=n=>n.key==="Escape"&&r();return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[r]),s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:s.jsxs("div",{className:"w-[min(96vw,720px)] rounded-2xl border border-gray-200 bg-white p-5 shadow-xl",children:[s.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:e}),s.jsx("button",{onClick:r,className:"rounded-md px-2 py-1 text-sm text-gray-500 hover:bg-gray-100",children:""})]}),t]})})}function gne({title:e,children:t,onClose:r}){return E.useEffect(()=>{const a=n=>n.key==="Escape"&&r();return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[r]),s.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40",children:s.jsxs("div",{className:"w-full sm:w-[720px] max-h-[90vh] overflow-y-auto rounded-t-2xl sm:rounded-2xl border border-gray-200 bg-white p-4 sm:p-5 shadow-xl",children:[s.jsxs("div",{className:"mb-3 sm:mb-4 flex items-center justify-between",children:[s.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:e}),s.jsx("button",{onClick:r,className:"rounded-md px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100",children:""})]}),t]})})}function e6(){const{user:e,userProfile:t}=st(),[r,a]=E.useState([]),[n,i]=E.useState(!0),[l,o]=E.useState(null),[c,d]=E.useState(null),x=async()=>{i(!0),o(null);try{console.log("  :",e),console.log("  :",t==null?void 0:t.role);const{data:h,error:p}=await Z.rpc("get_test_users");if(p){console.error("   :",p),o(` : ${p.message}`),a([]);return}console.log("  :",(h==null?void 0:h.length)||0),console.log("  :",h),a(h||[]),d(new Date)}catch(h){console.error("  :",h),o(` : ${h instanceof Error?h.message:"Unknown error"}`),a([])}finally{i(!1)}};E.useEffect(()=>{x()},[e]);const u=h=>({administrator:"bg-purple-100 text-purple-800",moderator:"bg-blue-100 text-blue-800",expert:"bg-indigo-100 text-indigo-800",trainer:"bg-green-100 text-green-800",supervisor:"bg-yellow-100 text-yellow-800",employee:"bg-gray-100 text-gray-800"})[h]||"bg-gray-100 text-gray-800",f=h=>h==="management_company"?"bg-emerald-100 text-emerald-800":"bg-orange-100 text-orange-800";return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#06A478] to-[#4ade80] rounded-xl flex items-center justify-center shadow-lg",children:s.jsx(nt,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"  "}),s.jsx("p",{className:"text-sm text-gray-600",children:"     Supabase"})]})]}),s.jsxs("button",{onClick:x,disabled:n,className:"flex items-center space-x-2 px-4 py-2 bg-[#06A478] text-white rounded-lg hover:bg-[#059669] transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:[s.jsx(en,{className:`h-4 w-4 ${n?"animate-spin":""}`}),s.jsx("span",{children:""})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:s.jsx(nt,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:" "}),s.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[s.jsxs("div",{children:[s.jsx("strong",{children:":"})," ",(e==null?void 0:e.full_name)||" "]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Email:"})," ",(e==null?void 0:e.email)||" "]}),s.jsxs("div",{children:[s.jsx("strong",{children:":"})," ",s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-blue-200 text-blue-900",children:(t==null?void 0:t.role)||" "})]}),s.jsxs("div",{children:[s.jsx("strong",{children:":"})," ",s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-blue-200 text-blue-900",children:(t==null?void 0:t.subdivision)||" "})]})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border p-4 shadow-sm",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.length}),s.jsx("div",{className:"text-sm text-gray-600",children:" "})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-4 shadow-sm",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.filter(h=>h.is_active).length}),s.jsx("div",{className:"text-sm text-gray-600",children:""})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-4 shadow-sm",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.filter(h=>h.subdivision==="management_company").length}),s.jsx("div",{className:"text-sm text-gray-600",children:" "})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-4 shadow-sm",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:r.filter(h=>h.subdivision==="branches").length}),s.jsx("div",{className:"text-sm text-gray-600",children:""})]})]}),c&&s.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[s.jsx(at,{className:"h-4 w-4 mr-2 text-green-500"})," : ",c.toLocaleString("ru-RU")]})]}),l&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(ar,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"  "}),s.jsx("p",{className:"text-sm text-red-800",children:l}),s.jsx("p",{className:"text-xs text-red-700 mt-2",children:"  ,              RLS ."})]})]})}),n&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-[#06A478] border-t-transparent"}),s.jsx("p",{className:"mt-4 text-gray-600",children:" ..."})]}),!n&&!l&&r.length>0&&s.jsx("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SAP"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(h=>{var p,g;return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gradient-to-br from-[#06A478] to-[#4ade80] flex items-center justify-center text-white font-semibold",children:((g=(p=h.full_name)==null?void 0:p.charAt(0))==null?void 0:g.toUpperCase())||"?"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:h.full_name}),s.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",h.id.slice(0,8),"..."]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[s.jsx(Ao,{className:"h-4 w-4 mr-2 text-gray-400"}),h.email]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:h.sap_number||"-"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[s.jsx(tl,{className:"h-4 w-4 mr-2 text-gray-400"}),h.phone||"-"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${u(h.role)}`,children:h.role})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(vd,{className:"h-4 w-4 mr-2 text-gray-400"}),s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${f(h.subdivision)}`,children:h.subdivision==="management_company"?"":""})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${h.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:h.is_active?"":""})})]},h.id)})})]})})}),!n&&!l&&r.length===0&&s.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border",children:[s.jsx(nt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-600",children:"   . ,       ."})]}),s.jsxs("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"   "}),s.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1 list-disc list-inside",children:[s.jsxs("li",{children:["     ",s.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"get_test_users()"}),"    "]}),s.jsxs("li",{children:["       RLS   ",s.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"users"})]}),s.jsx("li",{children:"         "}),s.jsx("li",{children:"      "}),s.jsx("li",{children:"      (F12)  "})]})]})]})}function pne(){const{user:e}=st(),t=Qt(),[r,a]=E.useState([]),[n,i]=E.useState(!0),[l,o]=E.useState(""),[c,d]=E.useState("all"),[x,u]=E.useState("all"),[f,h]=E.useState(!1),[p,g]=E.useState(null),[y,v]=E.useState(null),w=async()=>{try{i(!0),console.log("   ...");const{data:L,error:U}=await Z.from("events").select(`
          id,
          title,
          description,
          start_date,
          end_date,
          location,
          status,
          group_name,
          expert_emails,
          created_at,
          talent_category_id,
          talent_category: talent_categories (
            id,
            name_ru,
            color
          ),
          event_types!inner (
            name,
            name_ru
          ),
          creator: creator_id (
            full_name
          ),
          event_participants (
            user_id,
            users (
              id,
              full_name,
              email,
              sap_number
            )
          )
        `).eq("event_types.name","exam_talent_reserve").order("created_at",{ascending:!1});if(U)throw console.error("  :",U),U;console.log(" :",L),a(L||[])}catch(L){console.error("  :",L)}finally{i(!1)}};E.useEffect(()=>{w()},[]),E.useEffect(()=>{const L=U=>{y&&v(null)};if(y)return document.addEventListener("click",L),()=>document.removeEventListener("click",L)},[y]);const m=()=>{console.log(" ,  defaultEventType: exam"),console.log("showCreateModal :",f),g(null),h(!0),console.log("showCreateModal :",!0)},b=async L=>{console.log(" :",L);try{const{data:U,error:P}=await Z.from("events").select(`
          *,
          event_types (*),
          event_participants (
            user_id,
            users (
              id,
              full_name,
              email,
              sap_number
            )
          ),
          talent_category: talent_categories (*),
          creator: creator_id (
            id,
            full_name,
            email
          )
        `).eq("id",L.id).single();if(P)throw console.error("   :",P),P;console.log("    :",U),g(U),h(!0)}catch(U){console.error("     :",U),g(L),h(!0)}},_=()=>{h(!1),g(null)},C=()=>{h(!1),g(null),w()},j=async(L,U)=>{try{const{error:P}=await Z.from("events").update({status:U,updated_at:new Date().toISOString()}).eq("id",L);if(P)throw P;w()}catch(P){console.error("Error updating exam status:",P)}},D=async L=>{try{const{error:U}=await Z.from("events").delete().eq("id",L);if(U)throw U;w()}catch(U){console.error("Error deleting exam:",U)}},R=r.filter(L=>{var N,T,S;const U=L.title.toLowerCase().includes(l.toLowerCase())||((N=L.group_name)==null?void 0:N.toLowerCase().includes(l.toLowerCase()))||((T=L.talent_category)==null?void 0:T.name_ru.toLowerCase().includes(l.toLowerCase())),P=c==="all"||L.status===c,F=x==="all"||((S=L.talent_category)==null?void 0:S.name_ru)===x;return U&&P&&F}),M=L=>{switch(L){case"published":return s.jsx(at,{className:"w-4 h-4 text-green-500"});case"draft":return s.jsx(ar,{className:"w-4 h-4 text-yellow-500"});case"completed":return s.jsx(at,{className:"w-4 h-4 text-blue-500"});case"cancelled":return s.jsx(ds,{className:"w-4 h-4 text-red-500"});default:return s.jsx(wr,{className:"w-4 h-4 text-gray-500"})}},O=L=>{switch(L){case"published":return"";case"draft":return"";case"completed":return"";case"cancelled":return"";default:return""}},B=L=>{switch(L){case"published":return"bg-green-100 text-green-800";case"draft":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return n?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-8 h-8 border-4 border-[#06A478] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:" ..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"  "}),s.jsxs("p",{className:"text-gray-600 mt-1",children:["       ",r.length>0&&s.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",r.length," )"]})]})]}),s.jsxs("button",{onClick:()=>{console.log(' " " '),m()},className:"inline-flex items-center px-4 py-2 bg-[#06A478] text-white rounded-lg hover:bg-[#05976b] transition-colors",children:[s.jsx(es,{className:"w-4 h-4 mr-2"})," "]})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"  ,   ...",value:l,onChange:L=>o(L.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent"})]}),s.jsxs("select",{value:c,onChange:L=>d(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:"draft",children:""}),s.jsx("option",{value:"published",children:""}),s.jsx("option",{value:"completed",children:""}),s.jsx("option",{value:"cancelled",children:""})]}),s.jsxs("select",{value:x,onChange:L=>u(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",children:[s.jsx("option",{value:"all",children:" "}),s.jsx("option",{value:" ",children:" "}),s.jsx("option",{value:" ",children:" "}),s.jsx("option",{value:" ",children:" "})]})]})}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:R.map(L=>s.jsxs(Xa.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:L.title}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(L.status)}`,children:[M(L.status),s.jsx("span",{className:"ml-1",children:O(L.status)})]})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:U=>{U.stopPropagation(),v(y===L.id?null:L.id)},className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:s.jsx(IM,{className:"w-4 h-4"})}),y===L.id&&s.jsxs("div",{onClick:U=>U.stopPropagation(),className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg py-2 z-10 min-w-[200px]",children:[L.status==="draft"&&s.jsxs("button",{onClick:()=>{confirm(" ?      .")&&(j(L.id,"published"),v(null))},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})," "]}),L.status==="published"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{confirm(" ?     .")&&(j(L.id,"completed"),v(null))},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-green-50 hover:text-green-600 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})," "]}),s.jsxs("button",{onClick:()=>{confirm("   ?     .")&&(j(L.id,"draft"),v(null))},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-yellow-50 hover:text-yellow-600 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),"  "]})]}),L.status==="completed"&&s.jsxs("button",{onClick:()=>{confirm("    ?")&&(j(L.id,"published"),v(null))},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})," "]}),s.jsx("div",{className:"border-t border-gray-100 my-1"}),s.jsxs("button",{onClick:()=>{g(L),h(!0),v(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:()=>{confirm(" ,     ?")&&(D(L.id),v(null))},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[s.jsx(Zr,{className:"w-4 h-4"}),""]})]})]})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[L.talent_category&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:L.talent_category.color}}),s.jsx("span",{className:"text-sm text-gray-600",children:L.talent_category.name_ru})]}),L.group_name&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(nt,{className:"w-4 h-4 text-gray-400"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[": ",L.group_name]})]}),L.event_participants&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(nt,{className:"w-4 h-4 text-gray-400"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[": ",L.event_participants.length]})]})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(zt,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-600",children:new Date(L.start_date).toLocaleDateString("ru-RU")})]}),L.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ys,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-600",children:L.location})]})]}),L.expert_emails&&L.expert_emails.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(nt,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:":"})]}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[L.expert_emails.slice(0,2).map((U,P)=>s.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:U},P)),L.expert_emails.length>2&&s.jsxs("span",{className:"text-xs text-gray-500",children:["+",L.expert_emails.length-2," "]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-gray-100",children:[s.jsxs("button",{onClick:()=>t(`/exam-details/${L.id}`),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(el,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:()=>b(L),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(sn,{className:"w-4 h-4"}),""]}),s.jsx("button",{className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:s.jsx(Zr,{className:"w-4 h-4"})})]})]},L.id))}),R.length===0&&!n&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ys,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-500 mb-6",children:l||c!=="all"||x!=="all"?"   ":"    "}),!l&&c==="all"&&x==="all"&&s.jsxs("button",{onClick:()=>{console.log(' " " () '),m()},className:"inline-flex items-center px-4 py-2 bg-[#06A478] text-white rounded-lg hover:bg-[#05976b] transition-colors",children:[s.jsx(es,{className:"w-4 h-4 mr-2"})," "]})]}),console.log("ExamReservePage: showCreateModal:",f),s.jsx(JC,{isOpen:f,onClose:_,onSuccess:C,editingEvent:p,defaultEventType:"exam"})]})}const vne=({participant:e,dossier:t,groupName:r,onEdit:a,onSave:n})=>{var j,D,R,M,O,B,L,U,P,F,N,T;const{userProfile:i}=st(),[l,o]=E.useState(!1),[c,d]=E.useState(!1),x=(i==null?void 0:i.role)==="administrator",u=()=>`   : -${r||"20"}`,f=()=>{if(t!=null&&t.experience_in_position)return t.experience_in_position;if(e.user.work_experience_days){const S=e.user.work_experience_days,z=Math.floor(S/365),W=Math.floor(S%365/30);let k="";return z>0&&W>0?k=`${z}  ${W} `:z>0?k=`${z} `:W>0?k=`${W} `:k=`${S} `,`${k} (${S} )`}return""},[h,p]=E.useState(()=>{var S;return t?{...t,program_name:u()}:{user_id:e.user.id,program_name:u(),position:((S=e.user.position)==null?void 0:S.name)||"",experience_in_position:f(),education:{},achievements:[]}}),g=()=>{n(e.user.id,h),o(!1)},y=()=>{p(t||{user_id:e.user.id,program_name:u(),education:{},achievements:[]}),o(!1)},v=async S=>{var W;const z=(W=S.target.files)==null?void 0:W[0];if(z){if(!z.type.startsWith("image/")){alert(",  ");return}if(z.size>5*1024*1024){alert("     5MB");return}d(!0);try{const k=z.name.split(".").pop(),A=`dossier-photos/${`${e.user.id}_${Date.now()}.${k}`}`,{error:I}=await Z.storage.from("dossier-photos").upload(A,z);if(I)throw I;const{data:{publicUrl:V}}=Z.storage.from("dossier-photos").getPublicUrl(A);p(Y=>({...Y,photo_url:V}));const H=document.createElement("div");H.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300",H.textContent="  !",document.body.appendChild(H),setTimeout(()=>{H.style.transform="translateX(0)"},100),setTimeout(()=>{H.style.transform="translateX(100%)",setTimeout(()=>{document.body.removeChild(H)},300)},3e3)}catch(k){console.error("  :",k),alert("   .  .")}finally{d(!1)}}},w=()=>{const S=document.createElement("input");S.type="file",S.accept="image/*",S.onchange=v,S.click()};E.useEffect(()=>{var S;p(t?{...t,program_name:u()}:{user_id:e.user.id,program_name:u(),position:((S=e.user.position)==null?void 0:S.name)||"",experience_in_position:f(),education:{},achievements:[]})},[t,e.user.id,(j=e.user.position)==null?void 0:j.name,e.user.work_experience_days,r]);const m=()=>{p(S=>({...S,achievements:[...S.achievements||[],""]}))},b=S=>{let z=S.split(`
`).map(W=>W.trim()).filter(W=>W.length>0);if(z.length===1){const W=z[0];return W.includes("")||W.includes("")?W.split(/[]/).map(k=>k.trim()).filter(k=>k.length>0):W.includes(" ")?W.split(" ").map(q=>{const A=q.trim();return A?` ${A}`:""}).filter(q=>q.length>0):W.includes("")?W.split("").map(q=>{const A=q.trim();return A&&!A.startsWith("")?`${A}`:A}).filter(q=>q.length>0):[W]}if(z.length===1||z.length===2&&z[1].length<50){const W=z.join(" ");if(W.includes(" "))return W.split(" ").map(q=>{const A=q.trim();return A?` ${A}`:""}).filter(q=>q.length>0)}return z},_=(S,z)=>{p(W=>{var k;return{...W,achievements:((k=W.achievements)==null?void 0:k.map((q,A)=>A===S?z:q))||[]}})},C=S=>{p(z=>{var W;return{...z,achievements:((W=z.achievements)==null?void 0:W.filter((k,q)=>q!==S))||[]}})};return l?s.jsxs("div",{className:"bg-white rounded-2xl border-2 border-dashed border-gray-300 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:" "}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:g,className:"px-4 py-2 bg-[#06A478] text-white rounded-lg hover:bg-[#059669] transition-colors",children:""}),s.jsx("button",{onClick:y,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:""})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start space-x-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-xl flex items-center justify-center border-2 border-dashed border-gray-300",children:h.photo_url?s.jsx("img",{src:h.photo_url,alt:"",className:"w-full h-full object-cover rounded-xl"}):s.jsx(oo,{className:"w-8 h-8 text-gray-400"})}),s.jsx("button",{onClick:w,disabled:c,className:"absolute -bottom-2 -right-2 w-8 h-8 bg-[#06A478] text-white rounded-full flex items-center justify-center hover:bg-[#059669] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(oo,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex-1 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"text",value:h.program_name||u(),readOnly:!0,className:"w-full px-3 py-2 border border-gray-200 bg-gray-50 rounded-lg text-gray-600",placeholder:u()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"text",value:h.position||((D=e.user.position)==null?void 0:D.name)||"",onChange:S=>p(z=>({...z,position:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",placeholder:"   "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"text",value:((R=e.user.territory)==null?void 0:R.name)||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-200 bg-gray-50 rounded-lg text-gray-600",placeholder:""})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"number",value:h.age||"",onChange:S=>p(z=>({...z,age:parseInt(S.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",placeholder:"35"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsx("input",{type:"text",value:h.experience_in_position||"",onChange:S=>p(z=>({...z,experience_in_position:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",placeholder:"1  6 "})]})]})]})]}),s.jsx("div",{className:"border-t border-gray-200 pt-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"text-lg font-semibold text-[#06A478] mb-4 flex items-center",children:[s.jsx(Wc,{className:"w-5 h-5 mr-2"}),""]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"text",value:((M=h.education)==null?void 0:M.level)||"",onChange:S=>p(z=>({...z,education:{...z.education,level:S.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",placeholder:""})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("input",{type:"text",value:((O=h.education)==null?void 0:O.institution)||"",onChange:S=>p(z=>({...z,education:{...z.education,institution:S.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",placeholder:"    "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"text",value:((B=h.education)==null?void 0:B.specialty)||"",onChange:S=>p(z=>({...z,education:{...z.education,specialty:S.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",placeholder:""})]})]})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-lg font-semibold text-[#06A478] mb-4 flex items-center",children:[s.jsx(nr,{className:"w-5 h-5 mr-2"}),"   "]}),s.jsx("textarea",{value:h.career_path||"",onChange:S=>p(z=>({...z,career_path:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent",rows:6,placeholder:"  2023 -   "})]})]})}),s.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h4",{className:"text-lg font-semibold text-[#06A478] flex items-center",children:[s.jsx(er,{className:"w-5 h-5 mr-2"}),""]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>{const S=document.createElement("div");S.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",S.innerHTML=`
                      <div class="bg-white rounded-lg p-6 w-96 max-w-full mx-4">
                        <h3 class="text-lg font-semibold mb-4">  </h3>
                        <textarea 
                          id="achievements-text" 
                          class="w-full h-32 p-3 border border-gray-300 rounded-lg resize-none"
                          placeholder="  ...&#10;&#10;:&#10;  4-5-6 &#10;   i:FORCE MS10000_&#10;      "
                        ></textarea>
                        <div class="flex justify-end space-x-2 mt-4">
                          <button id="cancel-btn" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"></button>
                          <button id="add-btn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"></button>
                        </div>
                      </div>
                    `,document.body.appendChild(S);const z=S.querySelector("#achievements-text"),W=S.querySelector("#cancel-btn"),k=S.querySelector("#add-btn");z.focus();const q=()=>{document.body.removeChild(S)};W==null||W.addEventListener("click",q),k==null||k.addEventListener("click",()=>{const A=z.value.trim();if(A){const I=b(A);p(V=>({...V,achievements:[...V.achievements||[],...I]}))}q()}),S.addEventListener("click",A=>{A.target===S&&q()})},className:"px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:"  "}),s.jsx("button",{onClick:m,className:"px-3 py-1 bg-[#06A478] text-white rounded-lg hover:bg-[#059669] transition-colors text-sm",children:"+ "})]})]}),s.jsx("div",{className:"space-y-2",children:(L=h.achievements)==null?void 0:L.map((S,z)=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gradient-to-r from-[#06A478]/5 to-[#059669]/5 border border-[#06A478]/20 rounded-lg hover:shadow-sm transition-all duration-200",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-[#06A478] to-[#059669] rounded-full flex items-center justify-center shadow-sm",children:s.jsx(er,{className:"w-3 h-3 text-white"})})}),s.jsx("input",{type:"text",value:S,onChange:W=>_(z,W.target.value),className:"flex-1 px-3 py-2 bg-white border border-[#06A478]/30 rounded-lg focus:ring-2 focus:ring-[#06A478] focus:border-transparent text-sm",placeholder:" ..."}),s.jsx("button",{onClick:()=>C(z),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:s.jsx(Qe,{className:"w-4 h-4"})})]},z))})]})]})]}):s.jsxs("div",{className:"bg-white rounded-2xl border-2 border-dashed border-gray-300 p-6",children:[s.jsx("div",{className:"bg-[#06A478] text-white px-4 py-2 rounded-lg mb-6 text-center font-semibold",children:(t==null?void 0:t.program_name)||u()}),s.jsxs("div",{className:"flex items-start space-x-6 mb-6",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-xl flex items-center justify-center border-2 border-dashed border-gray-300 cursor-pointer hover:bg-gray-50 transition-colors",onClick:w,title:"   ",children:t!=null&&t.photo_url?s.jsx("img",{src:t.photo_url,alt:"",className:"w-full h-full object-cover rounded-xl"}):s.jsx(qt,{className:"w-8 h-8 text-gray-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-2xl font-bold text-[#06A478] mb-2",children:e.user.full_name}),s.jsx("p",{className:"text-gray-600 mb-1",children:(t==null?void 0:t.position)||((U=e.user.position)==null?void 0:U.name)||"  "}),s.jsx("p",{className:"text-sm text-gray-500",children:(t==null?void 0:t.territory)||((P=e.user.territory)==null?void 0:P.name)||"  "}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500 space-x-4",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx(zt,{className:"w-4 h-4 mr-1"}),t!=null&&t.age?`${t.age} `:"  "]}),s.jsxs("span",{className:"flex items-center",children:[s.jsx(qt,{className:"w-4 h-4 mr-1"}),f()||"  "]})]})]}),x&&s.jsx("button",{onClick:()=>o(!0),className:"p-2 text-[#06A478] hover:bg-[#06A478]/10 rounded-lg transition-colors",children:s.jsx(sn,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"border-t-2 border-dashed border-gray-300 pt-4",children:[s.jsxs("h4",{className:"text-lg font-semibold text-[#06A478] mb-3 flex items-center",children:[s.jsx(Wc,{className:"w-5 h-5 mr-2"}),""]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-[#06A478] rounded-full"}),s.jsx("span",{className:"font-medium",children:((F=t==null?void 0:t.education)==null?void 0:F.level)||" "})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-[#06A478] rounded-full"}),s.jsx("span",{children:((N=t==null?void 0:t.education)==null?void 0:N.institution)||" "})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-[#06A478] rounded-full"}),s.jsx("span",{children:((T=t==null?void 0:t.education)==null?void 0:T.specialty)||" "})]})]})]}),s.jsxs("div",{className:"border-t-2 border-dashed border-gray-300 pt-4",children:[s.jsxs("h4",{className:"text-lg font-semibold text-[#06A478] mb-3 flex items-center",children:[s.jsx(nr,{className:"w-5 h-5 mr-2"}),"   "]}),s.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:s.jsx("p",{className:"text-sm leading-relaxed",children:(t==null?void 0:t.career_path)||" "})})]}),s.jsxs("div",{className:"border-t-2 border-dashed border-gray-300 pt-4 lg:col-span-2",children:[s.jsxs("h4",{className:"text-lg font-semibold text-[#06A478] mb-4 flex items-center",children:[s.jsx(er,{className:"w-5 h-5 mr-2"}),""]}),s.jsx("div",{className:"space-y-2",children:t!=null&&t.achievements&&t.achievements.length>0?t.achievements.map((S,z)=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gradient-to-r from-[#06A478]/5 to-[#059669]/5 border border-[#06A478]/20 rounded-lg hover:shadow-sm transition-all duration-200",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-[#06A478] to-[#059669] rounded-full flex items-center justify-center shadow-sm",children:s.jsx(er,{className:"w-3 h-3 text-white"})})}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:S})]},z)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(er,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"  "})]})})]})]}),s.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"   !"}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-[#06A478]",children:"SNS"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Group of companies"})]})]})]})},bne=({isOpen:e,onClose:t,examId:r,participants:a,onAssignmentSaved:n})=>{const[i,l]=E.useState([]),[o,c]=E.useState(!0),[d,x]=E.useState(!1);E.useEffect(()=>{e&&r&&u()},[e,r]);const u=async()=>{c(!0);try{const{data:y,error:v}=await Z.from("case_assignments").select("*").eq("exam_event_id",r);if(v)throw v;const w=y||[],m=[];a.forEach(b=>{const _=w.find(C=>C.participant_id===b.user.id);_?m.push(_):m.push({exam_event_id:r,participant_id:b.user.id,case_numbers:[],assigned_by:""})}),l(m)}catch(y){console.error("   :",y)}finally{c(!1)}},f=(y,v)=>{l(w=>w.map(m=>m.participant_id===y?{...m,case_numbers:v}:m))},h=(y,v)=>{const w=i.find(m=>m.participant_id===y);if(w&&!w.case_numbers.includes(v)){const m=[...w.case_numbers,v].sort();f(y,m)}},p=(y,v)=>{const w=i.find(m=>m.participant_id===y);if(w){const m=w.case_numbers.filter(b=>b!==v);f(y,m)}},g=async()=>{x(!0);try{const{data:{user:y}}=await Z.auth.getUser();if(!y)throw new Error("  ");const v=i.filter(m=>m.case_numbers.length>0).map(m=>({exam_event_id:r,participant_id:m.participant_id,case_numbers:m.case_numbers,assigned_by:y.id,updated_at:new Date().toISOString()})),{error:w}=await Z.from("case_assignments").delete().eq("exam_event_id",r);if(w)throw w;if(v.length>0){const{error:m}=await Z.from("case_assignments").insert(v);if(m)throw m}n(),t()}catch(y){console.error("  :",y),alert("   ")}finally{x(!1)}};return e?s.jsx("div",{className:"fixed inset-0 z-[4999] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"relative max-w-4xl w-full max-h-[90vh] overflow-hidden rounded-3xl bg-white shadow-2xl",children:[s.jsx("div",{className:"relative bg-gradient-to-r from-emerald-500 via-emerald-600 to-teal-600 p-6 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-1",style:{fontFamily:"SNS, sans-serif"},children:" "}),s.jsx("p",{className:"text-emerald-100 text-sm",children:"    "})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-xl transition-colors duration-200",children:s.jsx(Qe,{className:"w-6 h-6"})})]})}),s.jsx("div",{className:"p-6 max-h-[calc(90vh-200px)] overflow-y-auto",children:o?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:" ..."})]}):s.jsx("div",{className:"space-y-4",children:a.map(y=>{var m,b;const v=i.find(_=>_.participant_id===y.user.id),w=(v==null?void 0:v.case_numbers)||[];return s.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 border border-gray-100",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:s.jsx(qt,{className:"w-5 h-5 text-emerald-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:y.user.full_name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[(m=y.user.position)==null?void 0:m.name,((b=y.user.territory)==null?void 0:b.name)&&`  ${y.user.territory.name}`]})]})]})}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" :"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.map(_=>s.jsxs("div",{className:"flex items-center gap-2 bg-emerald-100 text-emerald-800 px-3 py-1 rounded-full text-sm font-medium",children:[s.jsx(Et,{className:"w-4 h-4"})," #",_,s.jsx("button",{onClick:()=>p(y.user.id,_),className:"hover:text-emerald-900 transition-colors",children:s.jsx(Qe,{className:"w-3 h-3"})})]},_)),w.length===0&&s.jsx("p",{className:"text-gray-500 text-sm",children:"  "})]})]}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"number",min:"1",placeholder:" ",className:"w-24 px-3 py-1 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500",onKeyPress:_=>{if(_.key==="Enter"){const C=_.target,j=parseInt(C.value);j&&!w.includes(j)&&(h(y.user.id,j),C.value="")}}}),s.jsxs("button",{onClick:_=>{var D;const C=(D=_.currentTarget.parentElement)==null?void 0:D.querySelector("input"),j=parseInt(C.value);j&&!w.includes(j)&&(h(y.user.id,j),C.value="")},className:"flex items-center gap-1 px-3 py-1 bg-emerald-500 text-white rounded-lg text-sm font-medium hover:bg-emerald-600 transition-all",children:[s.jsx(es,{className:"w-3 h-3"}),""]})]})]},y.id)})})}),s.jsx("div",{className:"border-t border-gray-100 p-6 bg-gray-50",children:s.jsxs("div",{className:"flex justify-end gap-4",children:[s.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:""}),s.jsx("button",{onClick:g,disabled:d,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all ${d?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg hover:shadow-xl"}`,children:d?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{className:"w-4 h-4"})," "]})})]})})]})}):null},l7=({isOpen:e,onClose:t,examId:r,participants:a,onAssignmentSaved:n})=>{const{user:i}=st(),[l,o]=E.useState([]),[c,d]=E.useState(!1),[x,u]=E.useState(!1),[f,h]=E.useState(null),p=async()=>{if(r){d(!0);try{const{data:b,error:_}=await Z.from("presentation_assignments").select("participant_id, presentation_number").eq("exam_event_id",r).order("presentation_number");if(_){console.error("  :",_),g();return}const C=a.map(j=>{const D=b==null?void 0:b.find(R=>R.participant_id===j.user.id);return{participant_id:j.user.id,presentation_number:(D==null?void 0:D.presentation_number)||0}});o(C)}catch(b){console.error("  :",b),g()}finally{d(!1)}}},g=()=>{const b=a.map((_,C)=>({participant_id:_.user.id,presentation_number:C+1}));o(b)},y=()=>{const b=a.map((_,C)=>({participant_id:_.user.id,presentation_number:C+1}));o(b)},v=()=>{const b=Array.from({length:a.length},(C,j)=>j+1);for(let C=b.length-1;C>0;C--){const j=Math.floor(Math.random()*(C+1));[b[C],b[j]]=[b[j],b[C]]}const _=a.map((C,j)=>({participant_id:C.user.id,presentation_number:b[j]}));o(_)},w=(b,_)=>{o(C=>C.map(j=>j.participant_id===b?{...j,presentation_number:_}:j))},m=async()=>{if(!(i!=null&&i.id))return;if(l.filter(D=>D.presentation_number<=0).length>0){h("       0");return}const j=[...l.filter(D=>D.presentation_number>0)].sort((D,R)=>D.presentation_number-R.presentation_number).map((D,R)=>({...D,presentation_number:R+1}));u(!0),h(null);try{console.log("  :",{examId:r,assignments:j,assignedBy:i.id});const{data:D,error:R}=await Z.rpc("assign_presentation_numbers_batch",{p_exam_event_id:r,p_assignments:JSON.stringify(j),p_assigned_by:i.id});if(console.log("  :",{data:D,error:R}),R){console.error("   :",R),h(`  : ${R.message}`);return}if(D&&D.length>0&&!D[0].success){console.error("   :",D[0].message),h(D[0].message);return}console.log("   "),n==null||n(),t()}catch(D){console.error("   :",D),h(`    : ${D instanceof Error?D.message:" "}`)}finally{u(!1)}};return E.useEffect(()=>{e&&a.length>0&&p()},[e,r,a]),e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[5002] p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[85vh] overflow-hidden",children:[s.jsx("div",{className:"bg-emerald-600 text-white p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:s.jsx(rx,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"  "}),s.jsx("p",{className:"text-emerald-100",children:"   "})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",children:s.jsx(Qe,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"bg-gray-50 border-b border-gray-200 p-4",children:s.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[s.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[s.jsx(rx,{className:"w-4 h-4"})," "]}),s.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[s.jsx(XT,{className:"w-4 h-4"}),""]}),s.jsx("div",{className:"flex-1"}),s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",a.length]})]})}),f&&s.jsxs("div",{className:"mx-6 mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[s.jsx(ar,{className:"w-5 h-5 text-red-500"}),s.jsx("span",{className:"text-red-700",children:f})]}),s.jsx("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(85vh - 240px)"},children:c?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"}),s.jsx("span",{className:"ml-3 text-gray-600",children:" ..."})]}):s.jsx("div",{className:"space-y-3",children:l.sort((b,_)=>b.presentation_number-_.presentation_number).map(b=>{var C,j;const _=a.find(D=>D.user.id===b.participant_id);return _?s.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 bg-white hover:border-emerald-300 rounded-xl transition-all",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-600 min-w-0",children:""}),s.jsx("input",{type:"number",min:"1",max:"50",value:b.presentation_number||"",onChange:D=>w(b.participant_id,parseInt(D.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg text-center font-semibold focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:s.jsx(qt,{className:"w-5 h-5 text-emerald-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-semibold text-gray-900",children:_.user.full_name}),s.jsxs("div",{className:"text-sm text-gray-500",children:[((C=_.user.position)==null?void 0:C.name)||"  ",((j=_.user.territory)==null?void 0:j.name)&&`  ${_.user.territory.name}`]})]})]})]},b.participant_id):null})})}),s.jsxs("div",{className:"sticky bottom-0 bg-white p-6 border-t border-gray-100 flex gap-3 justify-between",children:[s.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:""}),s.jsx("button",{onClick:m,disabled:x,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all ${x?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg hover:shadow-xl"}`,children:x?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{className:"w-4 h-4"})," "]})})]})]})}):null},yne=e=>{const t=e%10,r=e%100;return r>=11&&r<=14?`${e} `:t===1?`${e} `:t>=2&&t<=4?`${e} `:`${e} `},wne=()=>{const{id:e}=gi(),t=Qt(),{userProfile:r}=st(),[a,n]=E.useState(null),[i,l]=E.useState([]),[o,c]=E.useState(!0),[d,x]=E.useState(null),[u,f]=E.useState(!1),[h,p]=E.useState({fullName:"",position:"",email:""}),[g,y]=E.useState([]),[v,w]=E.useState(!1),[m,b]=E.useState([{startTime:"09:00",endTime:"09:30",title:" -",duration:"",description:""},{startTime:"09:30",endTime:"09:35",title:" ",duration:"",description:"    . ."},{startTime:"09:35",endTime:"12:30",title:"    ",duration:"",description:"5   , 20     2-   , 30    2-   "},{startTime:"12:30",endTime:"13:30",title:"",duration:"",description:""},{startTime:"13:30",endTime:"15:15",title:"   ",duration:"",description:"5  -    , 20      "},{startTime:"15:15",endTime:"15:30",title:"-",duration:"",description:""},{startTime:"15:30",endTime:"17:20",title:'  " "',duration:"",description:"5   , 40 .    -  , 40 .     "},{startTime:"17:20",endTime:"17:35",title:"  ",duration:"",description:"  "},{startTime:"17:35",endTime:"18:00",title:"   ",duration:"",description:"  ,     , "}]),[_,C]=E.useState(!1),[j,D]=E.useState(!1),[R,M]=E.useState(""),[O,B]=E.useState({}),[L,U]=E.useState(!1),[P,F]=E.useState(!1),[N,T]=E.useState(!1);E.useEffect(()=>{e&&S()},[e]);const S=async()=>{try{c(!0),x(null),console.log("   ID:",e);let{data:J,error:ue}=await Z.from("events").select(`
          *,
          event_types(name, name_ru),
          talent_category:talent_categories(name, name_ru)
        `).eq("id",e).single();if(console.log(" :",{data:J,error:ue}),ue){console.log("  ...");const{data:de,error:ce}=await Z.from("events").select("*").eq("id",e).single();if(ce)throw console.error("  :",ce),ce;J=de,console.log("  :",J)}if(!J)throw new Error("  ");if(n(J),J.creator_id)try{const{data:de}=await Z.from("users").select("full_name").eq("id",J.creator_id).single();M((de==null?void 0:de.full_name)||" ")}catch(de){console.log("    :",de),M(" ")}if(J.detailed_schedule&&Array.isArray(J.detailed_schedule)&&J.detailed_schedule.length>0){const de=J.detailed_schedule.map(ce=>{if(ce.time&&!ce.startTime){const[fe,pe]=ce.time.split("-").map(Ne=>Ne.trim());return{startTime:fe||"",endTime:pe||"",title:ce.title||"",duration:k(fe||"",pe||""),description:ce.description||""}}return{...ce,duration:ce.duration||k(ce.startTime||"",ce.endTime||"")}});b(de)}if(J.expert_emails&&J.expert_emails.length>0){const de=J.expert_emails.map(ce=>({fullName:"",position:"",email:ce}));l(de)}await z(J.id),await W(J.id)}catch(J){console.error("  :",J),x(`    : ${J instanceof Error?J.message:" "}`)}finally{c(!1)}},z=async J=>{try{const{data:ue,error:de}=await Z.from("event_participants").select("*").eq("event_id",J);if(de){console.error("   :",de);return}if(ue&&ue.length>0){const ce=ue.map(ne=>ne.user_id),{data:fe,error:pe}=await Z.from("users").select(`
            id,
            full_name,
            email,
            sap_number,
            position:positions(name),
            territory:territories(name)
          `).in("id",ce);if(pe){console.error("  :",pe);return}const Ne=ue.map(ne=>{const _e=fe==null?void 0:fe.find(Te=>Te.id===ne.user_id);return{...ne,user:_e||null}});y(Ne)}else y([])}catch(ue){console.error(" fetchReservists:",ue)}},W=async J=>{try{const{data:ue}=await Z.from("event_participants").select("user_id").eq("event_id",J);if(!ue||ue.length===0)return;const de=ue.map(Ne=>Ne.user_id),{data:ce,error:fe}=await Z.from("participant_dossiers").select("*").in("user_id",de).eq("event_id",J);if(fe){console.error("  :",fe);return}const pe={};ce==null||ce.forEach(Ne=>{pe[Ne.user_id]=Ne}),console.log(" :",pe),B(pe)}catch(ue){console.error(" fetchDossiers:",ue)}},k=(J,ue)=>{if(!J||!ue)return"";const de=_e=>{const[Te,Me]=_e.split(":").map(Number);return Te*60+(Me||0)},ce=de(J),fe=de(ue);if(isNaN(ce)||isNaN(fe))return"";const pe=fe-ce;if(pe<0)return"";const Ne=Math.floor(pe/60),ne=pe%60;return Ne>0&&ne>0?`${Ne} ${ne}`:Ne>0?`${Ne}`:`${ne}`},q=()=>{t(`/exam-reserve?edit=${e}`)},A=async()=>{if(confirm(" ,     ?"))try{const{error:J}=await Z.from("events").delete().eq("id",e);if(J)throw J;t("/exam-reserve")}catch(J){console.error("  :",J),alert("   ")}},I=()=>{h.email&&(l([...i,h]),p({fullName:"",position:"",email:""}))},V=J=>{l(i.filter((ue,de)=>de!==J))},H=async()=>{try{const J=i.map(de=>de.email),{error:ue}=await Z.from("events").update({expert_emails:J}).eq("id",e);if(ue)throw ue;f(!1),alert(" ")}catch(J){console.error("  :",J),alert("   ")}},Y=(J,ue,de)=>{const ce=[...m];ce[J]={...ce[J],[ue]:de},(ue==="startTime"||ue==="endTime")&&(ce[J].duration=k(ce[J].startTime,ce[J].endTime)),b(ce)},Q=()=>{b([...m,{startTime:"",endTime:"",title:"",duration:"",description:""}])},te=J=>{b(m.filter((ue,de)=>de!==J))},re=async()=>{try{const{error:J}=await Z.from("events").update({detailed_schedule:m}).eq("id",e);if(J)throw J;C(!1),alert(" ")}catch(J){console.error("  :",J),alert("   ")}},X=async(J,ue)=>{try{if(!e){alert("ID   ");return}const{error:de}=await Z.from("participant_dossiers").upsert({user_id:J,event_id:e,...ue,updated_at:new Date().toISOString()});if(de)throw de;B(ce=>({...ce,[J]:{...ce[J],...ue}})),console.log("   :",J),alert(" ")}catch(de){console.error("  :",de),alert("   ")}},je=async J=>{if(confirm(" ,       ?"))try{console.log("    :",J);const{error:ue,count:de}=await Z.from("event_participants").delete({count:"exact"}).eq("event_id",e).eq("user_id",J);if(ue){console.error("   :",ue),alert("  : "+ue.message);return}if(console.log("   ,  :",de),de===0){console.warn("       "),alert("      ");return}console.log("   ..."),await z(e),console.log("   ")}catch(ue){console.error("   :",ue),alert("  ")}};return o?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"text-gray-600",children:"..."})}):d||!a?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:""}),s.jsx("p",{className:"text-gray-600 mb-6",children:d||"  "}),s.jsx("button",{onClick:()=>t("/exam-reserve"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"  "})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8 hidden md:block",children:[s.jsxs("button",{onClick:()=>t("/exam-reserve"),className:"flex items-center text-gray-600 hover:text-blue-600 mb-6 transition-colors",children:[s.jsx(kn,{className:"w-5 h-5 mr-2"}),s.jsx("span",{className:"font-medium",children:"  "})]}),s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a.title}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:[s.jsx(ys,{className:"w-4 h-4 mr-2"}),"  "]}),s.jsxs("div",{className:"flex items-center px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),""]})]})]}),s.jsxs("div",{className:"flex space-x-3",children:[(r==null?void 0:r.role)==="administrator"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>F(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(Et,{className:"w-4 h-4 mr-2"})," "]}),s.jsxs("button",{onClick:()=>T(!0),className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[s.jsx(rx,{className:"w-4 h-4 mr-2"})," "]})]}),s.jsxs("button",{onClick:q,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(sn,{className:"w-4 h-4 mr-2"}),""]}),s.jsxs("button",{onClick:A,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[s.jsx(Zr,{className:"w-4 h-4 mr-2"}),""]})]})]})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center mb-6",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(ys,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-500",children:"   "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),s.jsx("p",{className:"text-gray-800",children:a.description})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),s.jsx("p",{className:"text-gray-800 font-medium",children:a.location})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),s.jsx("p",{className:"text-gray-800 font-medium",children:a.group_name?` #${a.group_name}`:" "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),s.jsx("p",{className:"text-gray-800 font-medium",children:R||" "})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(zt,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-500",children:"   "})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>D(!j),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:j?" ":" "}),s.jsx("button",{onClick:()=>C(!_),className:"px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:_?"":""})]})]}),_&&s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("button",{onClick:Q,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(es,{className:"w-4 h-4 mr-2"})," "]}),s.jsx("div",{className:"space-y-3",children:m.map((J,ue)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[" ",ue+1]}),s.jsx("button",{onClick:()=>te(ue),className:"text-red-600 hover:text-red-800",children:s.jsx(Qe,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[s.jsx("input",{type:"text",placeholder:"",value:J.startTime,onChange:de=>Y(ue,"startTime",de.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",placeholder:"",value:J.endTime,onChange:de=>Y(ue,"endTime",de.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",placeholder:"",value:J.title,onChange:de=>Y(ue,"title",de.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-600",children:J.duration||""})]}),s.jsx("textarea",{placeholder:"",value:J.description,onChange:de=>Y(ue,"description",de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]},ue))}),s.jsxs("button",{onClick:re,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(Ps,{className:"w-4 h-4 mr-2"})," "]})]}),j&&!_&&s.jsx("div",{className:"space-y-4",children:m.map((J,ue)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"bg-blue-600 text-white px-3 py-1 rounded text-sm font-medium",children:J.startTime}),s.jsx("div",{className:"text-gray-400",children:""}),s.jsx("div",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded text-sm",children:J.endTime})]}),s.jsx("div",{className:"bg-green-100 text-green-700 px-3 py-1 rounded text-sm font-medium",children:J.duration})]}),s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:J.title}),J.description&&s.jsx("p",{className:"text-gray-600 text-sm",children:J.description})]},ue))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(nt,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[" (",i.length,")"]}),s.jsx("p",{className:"text-gray-500",children:"  "})]})]}),s.jsx("button",{onClick:()=>f(!u),className:"px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:u?"":""})]}),u?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[s.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:" "}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[s.jsx("input",{type:"text",placeholder:"",value:h.fullName,onChange:J=>p({...h,fullName:J.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",placeholder:"",value:h.position,onChange:J=>p({...h,position:J.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"email",placeholder:"Email",value:h.email,onChange:J=>p({...h,email:J.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:s.jsx(es,{className:"w-4 h-4"})})]})]}),s.jsx("div",{className:"space-y-0",children:i.map((J,ue)=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(qt,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-gray-900 truncate",children:J.fullName}),s.jsx("p",{className:"text-sm text-gray-600 truncate",children:J.position})]}),s.jsxs("div",{className:"flex items-center text-gray-500 mr-4",children:[s.jsx(Ao,{className:"w-4 h-4 mr-2"}),s.jsx("span",{className:"text-sm truncate",children:J.email})]}),s.jsx("button",{onClick:()=>V(ue),className:"text-red-600 hover:text-red-800",children:s.jsx(Qe,{className:"w-4 h-4"})})]}),ue<i.length-1&&s.jsx("div",{className:"mx-4 border-b border-gray-200"})]},ue))}),s.jsxs("button",{onClick:H,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(Ps,{className:"w-4 h-4 mr-2"}),""]})]}):s.jsx("div",{className:"space-y-3",children:i.length>0?i.map((J,ue)=>s.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(qt,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900",children:J.fullName}),s.jsx("p",{className:"text-sm text-gray-600",children:J.position})]}),s.jsx("div",{className:"text-sm text-gray-500",children:J.email}),(r==null?void 0:r.role)==="expert"&&J.email===(r==null?void 0:r.email)||(r==null?void 0:r.role)==="administrator"?s.jsx("button",{onClick:()=>t(`/expert-exam/${e}`),className:"ml-4 px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:(r==null?void 0:r.role)==="administrator"?"":""}):null]},ue)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:s.jsx(nt,{className:"w-6 h-6 text-gray-400"})}),s.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"  "}),s.jsx("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:" "})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(nt,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[" (",g.length,")"]}),s.jsx("p",{className:"text-gray-500",children:" "})]})]}),s.jsx("button",{onClick:()=>w(!v),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:v?"":""})]}),v&&s.jsx("div",{className:"space-y-3",children:g.length>0?g.map((J,ue)=>{var de,ce,fe,pe,Ne,ne,_e;return s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(qt,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900",children:((de=J.user)==null?void 0:de.full_name)||" "}),s.jsx("p",{className:"text-sm text-gray-600",children:((fe=(ce=J.user)==null?void 0:ce.position)==null?void 0:fe.name)||"  "}),s.jsx("p",{className:"text-xs text-gray-500",children:(pe=J.dossier)!=null&&pe.age?yne(J.dossier.age):"  "})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["SAP: ",((Ne=J.user)==null?void 0:Ne.sap_number)||" "]}),s.jsx("p",{className:"text-xs text-gray-500",children:((_e=(ne=J.user)==null?void 0:ne.territory)==null?void 0:_e.name)||"  "})]}),(r==null?void 0:r.role)==="administrator"&&J.user&&s.jsx("button",{onClick:()=>je(J.user.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"   ",children:s.jsx(Zr,{className:"h-4 w-4"})})]})]},ue)}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:s.jsx(nt,{className:"w-6 h-6 text-gray-400"})}),s.jsx("p",{className:"text-sm text-gray-500",children:"  "})]})})]}),g.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(qt,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsx("p",{className:"text-gray-500",children:"   "})]})]}),s.jsx("button",{onClick:()=>U(!L),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:L?"":""})]}),L&&s.jsx("div",{className:"space-y-6",children:g.map(J=>s.jsx(vne,{participant:J,dossier:J.user?O[J.user.id]:null,groupName:a==null?void 0:a.group_name,onEdit:(ue,de)=>{},onSave:X},J.id))})]})]})]}),s.jsx(bne,{isOpen:P,onClose:()=>F(!1),examId:e||"",participants:g,onAssignmentSaved:()=>{F(!1)}}),s.jsx(l7,{isOpen:N,onClose:()=>T(!1),examId:e||"",participants:g,onAssignmentSaved:async()=>{T(!1),e&&await z(e)}})]})};function Ene(e){if(!e)return{top:"",bottom:""};const t=e.trim().split(/\s+/);return t.length===1?{top:t[0],bottom:""}:{top:t[0],bottom:t.slice(1).join(" ")}}const t6=({participant:e,dossier:t,onRate:r,onViewDossier:a,onRemove:n,showRemoveButton:i=!1})=>{var x,u,f,h,p;const l=E.useMemo(()=>{var g;return Ene(((g=e==null?void 0:e.user)==null?void 0:g.full_name)||"")},[e]),o=(t==null?void 0:t.position)||((u=(x=e==null?void 0:e.user)==null?void 0:x.position)==null?void 0:u.name)||"",c=(t==null?void 0:t.territory)||((h=(f=e==null?void 0:e.user)==null?void 0:f.territory)==null?void 0:h.name)||"";t==null||t.age;const d=E.useMemo(()=>{var v;const[g,y]=(((v=e==null?void 0:e.user)==null?void 0:v.full_name)||"").split(/\s+/).map(w=>{var m;return(m=w[0])==null?void 0:m.toUpperCase()}).filter(Boolean);return[g,y].filter(Boolean).join("")},[e]);return s.jsxs("div",{className:`\r
        relative overflow-hidden rounded-3xl\r
        bg-white/90 backdrop-blur-sm border border-slate-200/60\r
        shadow-[0_4px_20px_rgba(0,0,0,0.08)]\r
        hover:shadow-[0_8px_32px_rgba(0,0,0,0.12)]\r
        hover:shadow-slate-200/50\r
        p-4 sm:p-5 md:p-6\r
        h-fit\r
        group\r
        transition-all duration-300 ease-out\r
        hover:scale-[1.01] hover:border-slate-300/80\r
        min-h-[180px] sm:min-h-[200px]\r
        active:scale-[0.99]\r
      `,role:"group",children:[s.jsxs("div",{className:"flex gap-3 sm:gap-4 md:gap-5",children:[s.jsx("div",{className:"relative shrink-0",children:s.jsx("div",{className:"h-[140px] w-[100px] sm:h-[160px] sm:w-[115px] md:h-[180px] md:w-[130px] rounded-2xl bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200/60 overflow-hidden shadow-sm group-hover:shadow-md transition-all duration-300",children:t!=null&&t.photo_url?s.jsx("img",{src:t.photo_url,alt:((p=e==null?void 0:e.user)==null?void 0:p.full_name)||"",loading:"lazy",className:"h-full w-full object-cover object-center group-hover:scale-105 transition-transform duration-500 ease-out"}):s.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gradient-to-br from-gray-50 to-gray-100",children:d?s.jsx("span",{className:"text-3xl font-bold group-hover:scale-110 transition-transform duration-300",style:{color:"#06A478",fontFamily:"SNS, sans-serif"},children:d}):s.jsx(qt,{className:"w-7 h-7 group-hover:scale-110 transition-transform duration-300",style:{color:"#06A478",opacity:.6}})})})}),s.jsx("div",{className:"min-w-0 flex-1 flex flex-col justify-between",children:s.jsxs("div",{children:[s.jsxs("div",{className:"mb-2 leading-tight",children:[s.jsx("div",{className:"text-base sm:text-lg md:text-xl font-bold tracking-wide uppercase truncate",style:{color:"#06A478",fontFamily:"SNS, sans-serif"},children:l.top}),l.bottom?s.jsx("div",{className:"text-base sm:text-lg md:text-xl font-bold tracking-wide uppercase truncate",style:{color:"#06A478",fontFamily:"SNS, sans-serif"},children:l.bottom}):null]}),s.jsx("div",{className:"text-sm sm:text-base text-slate-700 leading-relaxed mb-1",children:o}),c?s.jsxs("div",{className:"flex items-center gap-1.5 text-sm sm:text-base text-slate-600 leading-relaxed",children:[s.jsx(nr,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}),s.jsx("span",{children:c})]}):null]})})]}),s.jsxs("div",{className:"mt-4 space-y-2 sm:space-y-3",children:[s.jsx("button",{onClick:()=>a==null?void 0:a(e.user.id),className:`\r
            w-full h-10 sm:h-11 rounded-2xl\r
            bg-slate-50/80 text-slate-500 text-sm sm:text-base font-medium\r
            border border-slate-200/60\r
            hover:bg-slate-100/80 hover:text-slate-600 hover:border-slate-300/80\r
            active:bg-slate-200/80 active:scale-[0.98]\r
            focus:outline-none focus-visible:ring-2 focus-visible:ring-slate-300/30\r
            transition-all duration-200 ease-out\r
            backdrop-blur-sm\r
          `,"aria-label":" ",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>r==null?void 0:r(e.user.id),className:`\r
              flex-1 h-10 sm:h-11 rounded-2xl\r
              text-white text-sm sm:text-base font-semibold\r
              shadow-sm shadow-slate-200/50\r
              hover:shadow-md hover:shadow-slate-300/50 hover:scale-[1.01]\r
              active:scale-[0.98] active:shadow-sm\r
              focus:outline-none focus-visible:ring-2 focus-visible:ring-[#06A478]/30\r
              transition-all duration-300 ease-out\r
              inline-flex items-center justify-center gap-2\r
              relative overflow-hidden\r
            `,style:{backgroundColor:"#06A478"},"aria-label":" ",children:[s.jsx("span",{className:"relative z-10",children:" "}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-out"})]}),i&&n&&s.jsx("button",{onClick:()=>n(e.user.id),className:`\r
                h-10 sm:h-11 px-3 sm:px-4 rounded-2xl\r
                text-white text-sm sm:text-base font-semibold\r
                shadow-sm shadow-red-200/50\r
                hover:shadow-md hover:shadow-red-300/50 hover:scale-[1.01]\r
                active:scale-[0.98] active:shadow-sm\r
                focus:outline-none focus-visible:ring-2 focus-visible:ring-red-300/30\r
                transition-all duration-300 ease-out\r
                inline-flex items-center justify-center gap-2\r
                relative overflow-hidden\r
              `,style:{backgroundColor:"#dc2626"},"aria-label":" ",children:s.jsx("span",{className:"relative z-10",children:""})})]})]}),s.jsx("div",{className:"pointer-events-none absolute -bottom-8 -right-8 h-32 w-32 rounded-full blur-2xl opacity-60 group-hover:opacity-80 transition-opacity duration-300",style:{background:"radial-gradient(circle, rgba(6, 164, 120, 0.3) 0%, rgba(6, 164, 120, 0.1) 50%, transparent 100%)",WebkitBackfaceVisibility:"hidden",backfaceVisibility:"hidden",transform:"translateZ(0)",willChange:"transform"}})]})},_ne=e=>{const t=e%10,r=e%100;return r>=11&&r<=14?`${e} `:t===1?`${e} `:t>=2&&t<=4?`${e} `:`${e} `},jl=({className:e=""})=>s.jsx("div",{className:`bg-gray-200 rounded animate-pulse ${e}`}),jne=()=>s.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-xl animate-pulse"}),Nne=({isOpen:e,onClose:t,onBack:r,user:a,dossier:n,loading:i=!1,onModalStateChange:l})=>{var R,M,O,B,L,U,P,F;const{userProfile:o}=st(),[c,d]=E.useState(!0),[x,u]=E.useState(!1),[f,h]=E.useState(!1),[p,g]=E.useState(null),[y,v]=E.useState(!1),w=(o==null?void 0:o.role)==="administrator",m=N=>N?N.split(" ").map(T=>T[0]).join("").toUpperCase().slice(0,2):"",b=(N,T)=>{if(T)return T;if(!N||N<=0)return" ";const S=Math.floor(N/365),z=Math.floor(N%365/30),W=S>0?`${S} ${S===1?"":S<5?"":""}`:"",k=z>0?`${z} ${z===1?"":z<5?"":""}`:"";return[W,k].filter(Boolean).join(" ")||" "},_=N=>N?Array.isArray(N)?N:typeof N=="string"?N.split(`
`).filter(T=>T.trim()).map(T=>T.trim()):[]:[];E.useEffect(()=>{g(n?{...n,user_id:a.id,achievements:Array.isArray(n.achievements)?n.achievements.join(`
`):n.achievements||"",skills:Array.isArray(n.skills)?n.skills.join(`
`):n.skills||""}:{user_id:a.id,photo_url:"",phone:"",location:"",experience_in_position:b(a==null?void 0:a.work_experience_days),education:{level:"",specialty:"",institution:""},career_path:"",achievements:"",skills:"",additional_info:""})},[n,a.id,a.work_experience_days]);const C=async()=>{if(p){v(!0);try{const{error:N}=await Z.from("participant_dossiers").upsert({...p,event_id:p.event_id||p.exam_event_id,updated_at:new Date().toISOString()});if(N)throw N;alert(" "),h(!1)}catch(N){console.error("  :",N),alert("   ")}finally{v(!1)}}},j=()=>{g(n?{...n,user_id:a.id,achievements:Array.isArray(n.achievements)?n.achievements.join(`
`):n.achievements||"",skills:Array.isArray(n.skills)?n.skills.join(`
`):n.skills||""}:{user_id:a.id,photo_url:"",phone:"",location:"",experience_in_position:b(a==null?void 0:a.work_experience_days),education:{level:"",specialty:"",institution:""},career_path:"",achievements:"",skills:"",additional_info:""}),h(!1)};E.useEffect(()=>{n!=null&&n.photo_url&&(d(!0),u(!1))},[n==null?void 0:n.photo_url]),E.useEffect(()=>{if(e){const N=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${N}px`,document.body.style.left="0",document.body.style.right="0",document.body.style.width="100%",document.body.style.overflow="hidden",()=>{document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,N)}}},[e]),E.useEffect(()=>{l==null||l(e)},[e,l]);const D=`
    /*        */
    .dossier-modal {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      z-index: 10002 !important;
      background: white !important;
    }
    
    /*    body     */
    body.modal-open {
      margin: 0 !important;
      padding: 0 !important;
      overflow: hidden !important;
    }
    
    /*    iPhone */
    @media screen and (max-width: 768px) {
      .dossier-modal {
        -webkit-overflow-scrolling: touch !important;
        -webkit-transform: translate3d(0, 0, 0) !important;
        transform: translate3d(0, 0, 0) !important;
      }
      
      .dossier-modal header {
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        will-change: transform !important;
      }
      
      .dossier-modal button {
        -webkit-tap-highlight-color: transparent !important;
        -webkit-touch-callout: none !important;
        -webkit-user-select: none !important;
        user-select: none !important;
        touch-action: manipulation !important;
      }
      
      /*  safe area    */
      .dossier-modal {
        padding-top: 0px !important;
        padding-left: 0px !important;
        padding-right: 0px !important;
        padding-bottom: 0px !important;
      }
    }
  `;return!e||!a?null:s.jsxs(s.Fragment,{children:[s.jsx("style",{children:D}),s.jsxs("div",{className:"dossier-modal fixed inset-0 z-[10002] overflow-y-auto bg-white",style:{pointerEvents:"auto"},children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-gray-100 bg-white/80 backdrop-blur-sm",style:{paddingTop:"0px"},children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:s.jsx(qt,{className:"w-5 h-5 text-emerald-700"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"text-xs text-gray-500",children:" "}),s.jsx("div",{className:"text-base font-semibold truncate",children:a.full_name})]})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsx("button",{onClick:N=>{N.preventDefault(),N.stopPropagation(),t()},onPointerUp:N=>{N.preventDefault(),N.stopPropagation(),t()},className:"p-2 rounded-lg hover:bg-gray-50 active:bg-gray-100","aria-label":"",style:{minWidth:"44px",minHeight:"44px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation",userSelect:"none"},children:s.jsx(Qe,{className:"w-6 h-6 text-gray-700 pointer-events-none"})})})]})}),s.jsx("main",{className:"px-4 pt-3",children:s.jsxs("div",{className:"space-y-3",children:[i?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex gap-6",children:[s.jsx(jne,{}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsx(jl,{className:"h-7 md:h-8 w-3/4"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.jsx(jl,{className:"h-6 w-20"}),s.jsx(jl,{className:"h-6 w-24"}),s.jsx(jl,{className:"h-6 w-16"})]})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[...Array(6)].map((N,T)=>s.jsxs("div",{className:"space-y-3",children:[s.jsx(jl,{className:"h-6 w-1/3"}),s.jsx(jl,{className:"h-4 w-full"}),s.jsx(jl,{className:"h-4 w-3/4"})]},T))})]}):s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex gap-6",children:[s.jsx("div",{className:"relative shrink-0",children:s.jsxs("div",{className:"w-32 h-40 md:w-44 md:h-52 rounded-2xl overflow-hidden bg-gradient-to-br from-gray-100 to-gray-200 shadow-lg border-4 border-white",children:[n!=null&&n.photo_url&&!x?s.jsx("img",{src:n.photo_url,alt:a.full_name,className:"w-full h-full object-cover",onLoad:()=>d(!1),onError:()=>{u(!0),d(!1)}}):s.jsx("div",{className:"w-full h-full bg-gradient-to-br from-emerald-400 to-teal-500 flex items-center justify-center",children:s.jsx("span",{className:"text-4xl font-bold text-white",children:m(a.full_name)})}),c&&s.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"})]})}),s.jsxs("div",{className:"flex-1 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",style:{fontFamily:"SNS, sans-serif"},children:a.full_name}),s.jsx("p",{className:"text-gray-600 mb-1",children:(R=a.position)==null?void 0:R.name}),s.jsx("p",{className:"text-sm text-gray-500",children:(M=a.territory)==null?void 0:M.name})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(zt,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:n!=null&&n.age?_ne(n.age):"  "})]}),f?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(tl,{className:"w-4 h-4 text-gray-500"}),s.jsx("input",{type:"text",value:(p==null?void 0:p.phone)||"",onChange:N=>g(T=>T?{...T,phone:N.target.value}:null),className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:""})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(nr,{className:"w-4 h-4 text-gray-500"}),s.jsx("input",{type:"text",value:(p==null?void 0:p.location)||"",onChange:N=>g(T=>T?{...T,location:N.target.value}:null),className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:""})]})]}):s.jsxs(s.Fragment,{children:[(n==null?void 0:n.phone)&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(tl,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:n.phone})]}),(n==null?void 0:n.location)&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(nr,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:n.location})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 rounded-2xl p-6 border border-emerald-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-xl flex items-center justify-center",children:s.jsx(tx,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"   "})]})]}),s.jsx("div",{className:"text-sm text-gray-700",children:b(a==null?void 0:a.work_experience_days,n==null?void 0:n.experience_in_position)})]}),((n==null?void 0:n.education)||f)&&s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-xl flex items-center justify-center",children:s.jsx(Wc,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:"  "})]})]}),f?s.jsxs("div",{className:"space-y-3",children:[s.jsx("input",{type:"text",value:((O=p==null?void 0:p.education)==null?void 0:O.level)||"",onChange:N=>g(T=>T?{...T,education:{...T.education,level:N.target.value}}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:" "}),s.jsx("input",{type:"text",value:((B=p==null?void 0:p.education)==null?void 0:B.specialty)||"",onChange:N=>g(T=>T?{...T,education:{...T.education,specialty:N.target.value}}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:""}),s.jsx("input",{type:"text",value:((L=p==null?void 0:p.education)==null?void 0:L.institution)||"",onChange:N=>g(T=>T?{...T,education:{...T.education,institution:N.target.value}}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:" "})]}):s.jsx("div",{className:"space-y-2",children:typeof(n==null?void 0:n.education)=="string"?s.jsx("div",{className:"text-sm text-gray-700",children:n.education}):s.jsxs(s.Fragment,{children:[((U=n==null?void 0:n.education)==null?void 0:U.level)&&s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-medium",children:":"})," ",n.education.level]}),((P=n==null?void 0:n.education)==null?void 0:P.specialty)&&s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-medium",children:":"})," ",n.education.specialty]}),((F=n==null?void 0:n.education)==null?void 0:F.institution)&&s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-medium",children:" :"})," ",n.education.institution]})]})})]}),((n==null?void 0:n.career_path)||f)&&s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 border border-purple-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-xl flex items-center justify-center",children:s.jsx(tx,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900",children:"   "}),s.jsx("p",{className:"text-sm text-gray-600",children:"   "})]})]}),f?s.jsx("textarea",{value:(p==null?void 0:p.career_path)||"",onChange:N=>g(T=>T?{...T,career_path:N.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm h-24 resize-none",placeholder:"     "}):s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-line",children:(n==null?void 0:n.career_path)||"   "})]}),((n==null?void 0:n.achievements)||f)&&s.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 rounded-2xl p-6 border border-yellow-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-yellow-500 rounded-xl flex items-center justify-center",children:s.jsx(er,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:" "})]})]}),f?s.jsx("textarea",{value:(p==null?void 0:p.achievements)||"",onChange:N=>g(T=>T?{...T,achievements:N.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm h-24 resize-none",placeholder:" ,    "}):s.jsx("div",{className:"space-y-2",children:(()=>{const N=_(n==null?void 0:n.achievements);return N.length>0?N.map((T,S)=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gradient-to-r from-[#06A478]/5 to-[#059669]/5 border border-[#06A478]/20 rounded-lg hover:shadow-sm transition-all duration-200",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-[#06A478] to-[#059669] rounded-full flex items-center justify-center shadow-sm",children:s.jsx(er,{className:"w-3 h-3 text-white"})})}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:T})]},S)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(er,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"  "})]})})()})]}),((n==null?void 0:n.skills)||f)&&s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 border border-purple-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-xl flex items-center justify-center",children:s.jsx(vd,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900",children:""}),s.jsx("p",{className:"text-sm text-gray-600",children:" "})]})]}),f?s.jsx("textarea",{value:(p==null?void 0:p.skills)||"",onChange:N=>g(T=>T?{...T,skills:N.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm h-24 resize-none",placeholder:" ,    "}):s.jsx("div",{className:"space-y-2",children:(()=>{const N=_(n==null?void 0:n.skills);return N.length>0?N.map((T,S)=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg hover:shadow-sm transition-all duration-200",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center shadow-sm",children:s.jsx(vd,{className:"w-3 h-3 text-white"})})}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:T})]},S)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(vd,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"  "})]})})()})]}),((n==null?void 0:n.additional_info)||f)&&s.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-6 border border-gray-200 md:col-span-2",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-500 rounded-xl flex items-center justify-center",children:s.jsx(wr,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"  "})]})]}),f?s.jsx("textarea",{value:(p==null?void 0:p.additional_info)||"",onChange:N=>g(T=>T?{...T,additional_info:N.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm h-24 resize-none",placeholder:"  "}):s.jsx("div",{className:"text-sm text-gray-700",children:n==null?void 0:n.additional_info})]})]})]}),s.jsx("div",{className:"mt-6 px-4 pb-6",children:s.jsxs("div",{className:"flex gap-2",children:[f?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:C,disabled:y,className:"flex-1 px-4 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:y?"...":""}),s.jsx("button",{onClick:j,className:"flex-1 px-4 py-2.5 bg-gray-500 text-white rounded-lg hover:bg-gray-600 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:""})]}):w?s.jsx("button",{onClick:()=>h(!0),className:"flex-1 px-4 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:""}):null,s.jsx("button",{onClick:N=>{N.preventDefault(),N.stopPropagation(),r?r():t()},onPointerUp:N=>{N.preventDefault(),N.stopPropagation(),r?r():t()},className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:""})]})})]})})]})]})},Qy=({isOpen:e,onClose:t,participantName:r,caseNumber:a,totalScore:n,evaluationType:i=" ",detailedScores:l={},onRemoveEvaluation:o})=>{if(!e)return null;console.log(" EvaluationSuccessModal received totalScore:",n);const c=f=>f>=4?"text-green-600":f>=3?"text-yellow-600":"text-red-600",x=i===" "?{correctness:"  ",clarity:"    ",independence:"    "}:i===" "?{goal_achievement:" ",topic_development:" ",presentation_quality:" "}:i===" "?{results_orientation:"   ",effective_communication:"  ",teamwork_skills:"    ",systemic_thinking:"  "}:{},u=Object.keys(l).length>0;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10003] p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-4 sm:p-6",children:[s.jsx("div",{className:"flex justify-center mb-4 sm:mb-6",children:s.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(at,{className:"w-10 h-10 sm:w-12 sm:h-12 text-green-600"})})}),s.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:"  "}),s.jsxs("p",{className:"text-sm sm:text-base text-gray-600",children:[a?`  #${a} `:`${i} `," ",s.jsx("span",{className:"font-semibold",children:r})]})]}),u&&s.jsxs("div",{className:"mb-4 sm:mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3 text-center",children:"  "}),s.jsx("div",{className:"space-y-2",children:Object.entries(l).map(([f,h])=>s.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[s.jsx("span",{className:"text-sm text-gray-700 flex-1",children:x[f]||f}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-lg font-semibold ${c(h)}`,children:h%1===0?h.toFixed(0):h.toFixed(1)}),s.jsx("span",{className:"text-sm text-gray-500",children:"/ 5"})]})]},f))})]}),s.jsx("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-4 mb-4 sm:mb-6",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[s.jsx(Ms,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:" "})]}),s.jsx("div",{className:`text-xl sm:text-2xl font-semibold ${c(n)}`,children:n%1===0?n.toFixed(0):n.toFixed(1)})]})}),s.jsx("button",{onClick:t,className:"w-full px-4 py-3 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 transition-colors font-semibold text-base touch-manipulation",children:""})]})})},Jy=({isOpen:e,onClose:t,onConfirm:r,participantName:a,evaluationType:n,totalScore:i})=>e?(console.log(" ChangeEvaluationConfirmModal received totalScore:",i),s.jsx("div",{className:"fixed inset-0 z-[10004] flex items-center justify-center bg-black bg-opacity-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full shadow-2xl",children:[s.jsx("div",{className:"p-6 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center",children:s.jsx(an,{className:"w-5 h-5 text-amber-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:" ?"}),s.jsx("p",{className:"text-sm text-gray-500",children:"    "})]})]})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-2",children:" :"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:a}),s.jsx("div",{className:"text-sm text-gray-500",children:n})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:i.toFixed(1)}),s.jsx("div",{className:"text-xs text-gray-400",children:" "})]})]})]}),s.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:" ,     ?     ."})]}),s.jsx("div",{className:"p-6 pt-0",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onPointerUp:t,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:""}),s.jsx("button",{onPointerUp:r,className:"flex-1 px-4 py-2.5 bg-amber-500 text-white rounded-lg hover:bg-amber-600 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:", "})]})})]})})):null,Wo=Array.from({length:9},(e,t)=>1+t*.5),Cne=[{key:"correctness",title:"",icon:at},{key:"clarity",title:"",icon:La},{key:"independence",title:"",icon:qt}];function r6(e){return e>=4?"#10B981":e>=3?"#F59E0B":e>0?"#EF4444":"#6B7280"}function Ane({value:e,onChange:t,ariaLabel:r,color:a}){const n=Math.max(0,Wo.indexOf(e)),i=l=>{const o=parseInt(l.target.value,10);t(Wo[o])};return s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"mb-2 grid grid-cols-9 gap-1",children:[1,1.5,2,2.5,3,3.5,4,4.5,5].map(l=>{const o=e===l;return s.jsx("button",{className:"h-7 w-full rounded-full text-[10px] font-semibold border transition "+(o?"bg-emerald-500 border-emerald-500 text-white":"bg-white border-gray-200 text-gray-700 hover:border-emerald-300 hover:bg-emerald-50"),onClick:()=>t(l),"aria-label":` ${l}`,children:l},l)})}),s.jsxs("div",{className:"relative pt-3",children:[s.jsx("div",{className:"absolute left-1 right-1 top-[9px] h-[2px] bg-gray-200 rounded-full"}),s.jsx("div",{className:"absolute left-1 top-[9px] h-[2px] bg-emerald-500 rounded-full",style:{width:`${n/(Wo.length-1)*100}%`}}),s.jsx("div",{className:"absolute left-1 right-1 top-0 h-5 pointer-events-none",children:Wo.map((l,o)=>{const c=`${o/(Wo.length-1)*100}%`,d=Number.isInteger(l);return s.jsxs("div",{className:"absolute",style:{left:c,transform:"translateX(-50%)"},children:[s.jsx("div",{className:d?"w-[2px] h-5 bg-gray-300":"w-[1px] h-3 bg-gray-300"}),d&&s.jsx("div",{className:"text-[10px] text-gray-500 text-center mt-1 translate-x-[-50%]",children:l})]},l)})}),s.jsx("input",{type:"range",min:0,max:Wo.length-1,step:1,value:n,onChange:i,"aria-label":r,className:"relative z-10 w-full h-3 bg-transparent appearance-none slider-thumb",style:{"--thumb-color":a}})]})]})}const kne=({isOpen:e,onClose:t,participantId:r,participantName:a,caseNumber:n,examId:i,onEvaluationComplete:l,onRemoveEvaluation:o,existingEvaluation:c,onModalStateChange:d})=>{const{user:x}=st(),[u,f]=E.useState({exam_event_id:i,reservist_id:r,evaluator_id:(x==null?void 0:x.id)||"",case_number:n,criteria_scores:{correctness:0,clarity:0,independence:0}}),[h,p]=E.useState(!1),[g,y]=E.useState(!1),[v,w]=E.useState(!1),[m,b]=E.useState(!1),[_,C]=E.useState(!1),[j,D]=E.useState(!1),[R,M]=E.useState(null),O=E.useRef(null);E.useLayoutEffect(()=>{const k=e||m||_;d==null||d(k);const q=new CustomEvent("modalStateChange",{detail:{isOpen:k}});window.dispatchEvent(q)},[e,m,_,d,a,n]),E.useEffect(()=>{console.log(" CaseEvaluationModal useEffect triggered:",{isOpen:e,participantId:r,examId:i,userId:x==null?void 0:x.id,caseNumber:n,hasExistingEvaluation:!!c}),window.dispatchEvent(new CustomEvent("modalStateChange",{detail:{isOpen:e}})),e&&r&&i&&(x!=null&&x.id)&&B()},[e,r,i,x==null?void 0:x.id,n,c]);const B=async()=>{if(x!=null&&x.id){p(!0),M(null);try{if(c){console.log("    existingEvaluation:",c),console.log(" criteria_scores  existingEvaluation:",c.criteria_scores),f({id:c.id,exam_event_id:i,reservist_id:r,evaluator_id:c.evaluator_id||x.id,case_number:n,criteria_scores:c.criteria_scores||{correctness:0,clarity:0,independence:0},comments:c.comments||""}),w(!0),D(!0),p(!1),console.log("    existingEvaluation:",{criteria_scores:c.criteria_scores,comments:c.comments});return}console.log("       :",{exam_event_id:i,reservist_id:r,evaluator_id:x.id,case_number:n});const{count:k,error:q}=await Z.from("case_evaluations").select("*",{count:"exact",head:!0}).eq("exam_event_id",i).eq("reservist_id",r).eq("evaluator_id",x.id).eq("case_number",n);console.log("    :",k,q);const{data:A,error:I}=await Z.from("case_evaluations").select("*").eq("exam_event_id",i).eq("reservist_id",r).eq("evaluator_id",x.id).eq("case_number",n).maybeSingle();if(I){console.error("    :",I),M(`  : ${I.message}`),f({exam_event_id:i,reservist_id:r,evaluator_id:x.id,case_number:n,criteria_scores:{correctness:0,clarity:0,independence:0}}),w(!1),D(!1),p(!1);return}A?(console.log("     :",A),f({id:A.id,exam_event_id:A.exam_event_id,reservist_id:A.reservist_id,evaluator_id:A.evaluator_id,case_number:A.case_number,criteria_scores:A.criteria_scores,comments:A.comments||""}),w(!0),D(!0),console.log("     ")):(console.warn(" 0 :    ,  RLS  ,    "),f({exam_event_id:i,reservist_id:r,evaluator_id:x.id,case_number:n,criteria_scores:{correctness:0,clarity:0,independence:0}}),w(!1),D(!1),console.log("   "))}catch(k){console.error("    :",k),M(` : ${k instanceof Error?k.message:" "}`),f({exam_event_id:i,reservist_id:r,evaluator_id:x.id,case_number:n,criteria_scores:{correctness:0,clarity:0,independence:0}}),w(!1),D(!1)}finally{p(!1),console.log("   ")}}};E.useEffect(()=>{e&&requestAnimationFrame(()=>O.current&&(O.current.scrollTop=0))},[e]);const L=(k,q)=>{f(A=>({...A,criteria_scores:{...A.criteria_scores,[k]:q}})),w(!1)},U=()=>{const k=Object.values(u.criteria_scores).filter(I=>I>0);if(!k.length)return 0;const q=k.reduce((I,V)=>I+V,0)/k.length,A=Math.round(q*10)/10;return console.log(" CaseEvaluationModal getTotalScore calculated:",{criteria_scores:u.criteria_scores,validScores:k,average:q,result:A}),A},P=E.useMemo(()=>U(),[u.criteria_scores]),F=E.useMemo(()=>Object.values(u.criteria_scores).some(k=>k>0),[u.criteria_scores]),N=F&&!g,T=()=>{if(console.log(" handleSaveClick :",{saving:g,hasExistingEvaluation:j,saved:v,hasAnyScore:Object.values(u.criteria_scores).some(k=>k>0),criteriaScores:u.criteria_scores}),g){console.log("   -   ");return}if(!Object.values(u.criteria_scores).some(k=>k>0)){console.log("   -  ");return}if(j&&!v){console.log("       totalScore:",U()),setTimeout(()=>{C(!0)},0);return}console.log("   "),S()},S=async()=>{console.log("   :",u),y(!0);try{const k={...u.id&&{id:u.id},exam_event_id:i,reservist_id:r,evaluator_id:x==null?void 0:x.id,case_number:n,criteria_scores:u.criteria_scores,comments:u.comments||null};console.log("    :",k);const{data:q,error:A}=await Z.from("case_evaluations").upsert(k,{onConflict:"exam_event_id,reservist_id,evaluator_id,case_number"}).select().single();if(A){console.error("    :",A),alert(`  : ${A.message}`);return}console.log("   :",q),q&&f(I=>({...I,id:q.id})),w(!0),D(!0),console.log("      totalScore:",U()),setTimeout(()=>{b(!0)},0)}catch(k){console.error("  :",k),alert(` : ${k instanceof Error?k.message:" "}`)}finally{y(!1)}},z=async()=>{b(!1),await(l==null?void 0:l()),t()};return e?s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
    .slider-thumb::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 20px; height: 20px; border-radius: 9999px;
      background: var(--thumb-color, #10B981);
      border: 3px solid #fff; box-shadow: 0 0 5px rgba(0,0,0,.15);
      margin-top: -9px; /*      */
    }
    .slider-thumb::-moz-range-thumb {
      width: 20px; height: 20px; border-radius: 9999px;
      background: var(--thumb-color, #10B981);
      border: 3px solid #fff; box-shadow: 0 0 5px rgba(0,0,0,.15);
    }
    
    /*        */
    .case-evaluation-modal {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      z-index: 10002 !important;
      background: white !important;
    }
    
    /*      */
    .case-evaluation-modal {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      z-index: 10002 !important;
      background: white !important;
    }
    
    
    /*    body     */
    body.modal-open {
      margin: 0 !important;
      padding: 0 !important;
      overflow: hidden !important;
    }
    
    /*    iPhone */
    @media screen and (max-width: 768px) {
      .case-evaluation-modal {
        -webkit-overflow-scrolling: touch !important;
        -webkit-transform: translate3d(0, 0, 0) !important;
        transform: translate3d(0, 0, 0) !important;
      }
      
      .case-evaluation-modal header {
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        will-change: transform !important;
      }
      
      .case-evaluation-modal button {
        -webkit-tap-highlight-color: transparent !important;
        -webkit-touch-callout: none !important;
        -webkit-user-select: none !important;
        user-select: none !important;
        touch-action: manipulation !important;
      }
      
      /*  safe area    */
      .case-evaluation-modal {
        padding-top: 0px !important;
        padding-left: 0px !important;
        padding-right: 0px !important;
        padding-bottom: 0px !important;
      }
    }
  `}),s.jsxs("div",{className:"case-evaluation-modal fixed inset-0 z-[10002] overflow-y-auto bg-white",style:{pointerEvents:"auto"},children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-gray-100 bg-white/80 backdrop-blur-sm",children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:s.jsx(Et,{className:"w-5 h-5 text-emerald-700"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsxs("div",{className:"text-xs text-gray-500",children:[" #",n]}),s.jsx("div",{className:"text-base font-semibold truncate",children:a})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold",style:{color:r6(P)},children:P.toFixed(1)}),s.jsx("div",{className:"text-[11px] text-gray-400",children:" "})]}),s.jsx("button",{onPointerUp:t,className:"p-2 rounded-lg hover:bg-gray-50 active:bg-gray-100","aria-label":"",style:{minWidth:"44px",minHeight:"44px",WebkitTapHighlightColor:"transparent",userSelect:"none",touchAction:"manipulation"},children:s.jsx(Qe,{className:"w-6 h-6 text-gray-700 pointer-events-none"})})]})]})}),s.jsx("main",{ref:O,className:"px-4 pt-3",children:s.jsxs("div",{className:"space-y-3",children:[R&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-5 h-5 text-red-500",children:""}),s.jsx("div",{className:"text-red-700 text-sm",children:R})]}),s.jsx("button",{onClick:()=>{M(null),B()},className:"mt-2 text-red-600 hover:text-red-800 text-sm font-medium",children:" "})]}),h?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):Cne.map(k=>{const q=k.icon,A=u.criteria_scores[k.key],I=r6(A);return s.jsxs("div",{className:"rounded-xl border border-gray-100 bg-white p-3 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("div",{className:"w-9 h-9 rounded-lg bg-gray-50 flex items-center justify-center",children:s.jsx(q,{className:"w-5 h-5 text-emerald-600"})}),s.jsx("div",{className:"text-sm font-medium text-gray-900",children:k.title})]}),s.jsx("div",{className:"text-lg font-bold",style:{color:I},children:A?A.toFixed(1):""})]}),s.jsx(Ane,{value:A,onChange:V=>L(k.key,V),ariaLabel:`: ${k.title}`,color:I})]},k.key)}),s.jsx("div",{className:"mt-6 px-4 pb-6",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onPointerUp:t,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:" "}),s.jsx("button",{onPointerUp:()=>{console.log(" CaseEvaluationModal Submit button clicked:",{canSave:N,hasAnyScore:F,saving:g}),N?(console.log("  handleSaveClick"),T()):console.log("  ")},disabled:!N,className:`flex-1 px-4 py-2.5 rounded-lg font-semibold text-sm ${N?"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:g?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"..."]}):v?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(at,{className:"w-4 h-4"}),""]}):s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(Ps,{className:"w-4 h-4"}),""]})})]})})]})})]}),s.jsx(Qy,{isOpen:m,onClose:z,participantName:a,caseNumber:n,totalScore:U(),evaluationType:" ",onRemoveEvaluation:async()=>{await(o==null?void 0:o(r,n))}}),s.jsx(Jy,{isOpen:_,onClose:()=>C(!1),onConfirm:()=>{C(!1),S()},participantName:a,evaluationType:" ",totalScore:U()})]}):null},Dne=({children:e})=>{const t=E.useRef(null);return t.current||(t.current=document.createElement("div")),E.useEffect(()=>{const r=t.current;return document.body.appendChild(r),()=>{document.body.contains(r)&&document.body.removeChild(r)}},[]),Ml.createPortal(e,t.current)},Sne=({isVisible:e,targetRef:t,onClose:r})=>{const[a,n]=E.useState({top:0,left:0,arrowPosition:"left"}),[i,l]=E.useState(null),o=8;return E.useEffect(()=>{if(!e||!t.current)return;let c=0;const d=()=>{const u=t.current.getBoundingClientRect();l(u);const f=window.innerWidth,h=window.innerHeight,p=f<=768,g=p?240:280,y=80,v=16,w=8;let m,b,_;b=u.right+v,m=u.top+u.height*.7-y/2,_="left",b+g>f-v&&(b=u.left-g-v,m=u.top+u.height*.7-y/2,_="right",b<v&&(b=Math.max(v,u.left+u.width/2-g/2),m=u.bottom+v+w,_="top")),m<v?m=v:m+y>h-v&&(_==="top"?(m=u.top-y-v-w,_="bottom"):m=h-y-v),b<v?b=v:b+g>f-v&&(b=f-g-v),n({top:m,left:b,arrowPosition:_})},x=()=>{cancelAnimationFrame(c),c=requestAnimationFrame(d)};return d(),window.addEventListener("scroll",x,{passive:!0}),window.addEventListener("resize",x,{passive:!0}),()=>{window.removeEventListener("scroll",x),window.removeEventListener("resize",x),cancelAnimationFrame(c)}},[e,t]),!e||!i?null:s.jsxs(Dne,{children:[s.jsxs("div",{className:"fixed inset-0 z-[5000] pointer-events-none",children:[s.jsx("div",{className:"fixed left-0 bg-black/20 pointer-events-auto",style:{top:0,width:"100vw",height:Math.max(0,i.top-o)},onClick:r}),s.jsx("div",{className:"fixed left-0 bg-black/20 pointer-events-auto",style:{top:i.bottom+o,width:"100vw",bottom:0},onClick:r}),s.jsx("div",{className:"fixed bg-black/20 pointer-events-auto",style:{top:Math.max(0,i.top-o),left:0,width:Math.max(0,i.left-o),height:i.height+o*2},onClick:r}),s.jsx("div",{className:"fixed bg-black/20 pointer-events-auto",style:{top:Math.max(0,i.top-o),left:i.right+o,right:0,height:i.height+o*2},onClick:r})]}),s.jsxs("div",{className:"fixed z-[5001] bg-white rounded-xl shadow-2xl p-4 sm:max-w-[280px] max-w-[240px]",style:{top:`${a.top}px`,left:`${a.left}px`,fontFamily:"Mabry, sans-serif"},role:"tooltip",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(hR,{className:"w-4 h-4 mt-0.5 text-emerald-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:" "}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"  ,     ."})]})]}),s.jsx("div",{className:`absolute w-0 h-0 ${a.arrowPosition==="left"?"border-t-[8px] border-b-[8px] border-r-[8px] border-t-transparent border-b-transparent border-r-white -right-2 top-1/2 -translate-y-1/2":a.arrowPosition==="right"?"border-t-[8px] border-b-[8px] border-l-[8px] border-t-transparent border-b-transparent border-l-white -left-2 top-1/2 -translate-y-1/2":a.arrowPosition==="bottom"?"border-l-[8px] border-r-[8px] border-b-[8px] border-l-transparent border-r-transparent border-b-white -bottom-2 left-1/2 -translate-x-1/2":"border-l-[8px] border-r-[8px] border-b-[8px] border-l-transparent border-r-transparent border-b-white -top-2 left-1/2 -translate-x-1/2"}`})]})]})},Bne=({isOpen:e,onClose:t,onStageSelect:r,participantName:a,participantPhoto:n,examId:i,participantId:l,onCaseEvaluationComplete:o,onRemoveEvaluation:c,evaluations:d=[],onModalStateChange:x})=>{const{user:u}=st(),[f,h]=E.useState(!1),p=wt.useRef(null),[g,y]=E.useState(!1),[v,w]=E.useState([]),[m,b]=E.useState(!1),[_,C]=E.useState(!1),[j,D]=E.useState(1),[R,M]=E.useState(!1),[O,B]=E.useState([]),[L,U]=E.useState(!1),[P,F]=E.useState(!1),N=E.useRef(null);E.useEffect(()=>{const H=_||g;x==null||x(H)},[_,g,x]);const T=async()=>{if(!i||!(u!=null&&u.id)){console.log(" EvaluationStageModal:  examId  userId   ");return}console.log(" EvaluationStageModal:    :",{examId:i,userId:u.id}),F(!0);try{const{data:H,error:Y}=await Z.from("case_evaluations").select("*").eq("exam_event_id",i).eq("evaluator_id",u.id);if(Y)throw console.error(" EvaluationStageModal:   :",Y),Y;console.log(" EvaluationStageModal:  :",(H==null?void 0:H.length)||0,H),B(H||[])}catch(H){console.error(" EvaluationStageModal:    :",H)}finally{F(!1)}};E.useEffect(()=>{e&&T()},[e,i,u==null?void 0:u.id]);const S=E.useMemo(()=>{const H=new Map;for(const Y of O??[]){const Q=`${Y.reservist_id}:${Y.case_number}`,te=Object.values(Y.criteria_scores??{}),re=te.length?Math.round(te.reduce((X,je)=>X+je,0)/te.length*10)/10:null;H.set(Q,{avg:re,raw:Y})}return H},[O,l]),z=E.useCallback(H=>S.get(`${l}:${H}`),[S,l]),W=async()=>{if(!(!i||!l)){b(!0);try{const{data:H,error:Y}=await Z.from("case_assignments").select("case_numbers").eq("exam_event_id",i).eq("participant_id",l).single();if(Y&&Y.code!=="PGRST116"){console.error("   :",Y),w([1,2]);return}H&&H.case_numbers?w(H.case_numbers):w([1,2])}catch(H){console.error("   :",H),w([1,2])}finally{b(!1)}}};E.useEffect(()=>{var H;e&&((H=N.current)==null||H.focus())},[e]),E.useEffect(()=>{if(e&&!L){y(!1),C(!1),D(1),U(!0);const H=window.innerWidth<=768,Y=H?800:500,Q=H?300:200,te=setTimeout(()=>{setTimeout(()=>{p.current&&(p.current.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{h(!0),M(!0)},H?200:100))},Q)},Y);return()=>{clearTimeout(te)}}else e?(h(!1),M(!1)):U(!1)},[e,L]);const k=()=>{h(!1),M(!1)},q=H=>{h(!1),M(!1),H==="case-solving"?y(!0):r==null||r(H)};E.useEffect(()=>{if(e)return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",()=>{document.body.style.overflow="",document.body.style.position="",document.body.style.width=""};document.body.style.overflow="",document.body.style.position="",document.body.style.width=""},[e]),E.useEffect(()=>{g&&e&&W()},[g,e,i,l]);const A=E.useCallback(H=>!!z(H),[z]),I=E.useCallback(H=>{var Y;return((Y=z(H))==null?void 0:Y.avg)??null},[z]);if(!e)return null;const V=[{id:"case-solving",title:" ",description:"   ",icon:Et,color:"emerald",bgGradient:"from-emerald-50 to-teal-50",borderColor:"border-emerald-100",iconBg:"bg-emerald-500"},{id:"project-defense",title:" ",description:"    ",icon:nt,color:"blue",bgGradient:"from-blue-50 to-indigo-50",borderColor:"border-blue-100",iconBg:"bg-blue-500"},{id:"diagnostic-game",title:" ",description:'   " "',icon:eO,color:"cyan",bgGradient:"from-cyan-50 to-blue-50",borderColor:"border-cyan-100",iconBg:"bg-cyan-500"}];return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
          /*     " " */
          .case-solving-highlight {
            border: 3px solid #06A478 !important;
            background: linear-gradient(135deg, rgba(6,164,120,0.08), rgba(6,164,120,0.03)) !important;
            animation: gentleGlow 2s ease-in-out infinite;
            transform: scale(1.02) !important;
          }
          
          /*  hover     */
          .case-solving-highlight:hover {
            transform: scale(1.02) !important;
          }
          
          @keyframes gentleGlow {
            0% { 
              transform: scale(1.02);
            }
            50% { 
              transform: scale(1.03);
            }
            100% { 
              transform: scale(1.02);
            }
          }
          
          /*      */
          @media (max-width: 768px) {
            [data-tour="case-solving-card"] {
              position: relative !important;
              z-index: 500 !important;
              transform: translateZ(0) !important; /*     GPU */
              will-change: transform !important;
            }
            
            /*       */
            .reactour__popover {
              position: fixed !important;
              transform: translateZ(0) !important;
              backface-visibility: hidden !important;
            }
          }
          
          /*   Joyride */
          .react-joyride__tooltip {
            font-family: 'Mabry', sans-serif !important;
          }
          .react-joyride__tooltip h4 {
            font-family: 'Mabry', sans-serif !important;
          }
          .react-joyride__tooltip p {
            font-family: 'Mabry', sans-serif !important;
          }
          .react-joyride__tooltip button {
            font-family: 'Mabry', sans-serif !important;
          }
        `}),s.jsxs("div",{className:"fixed inset-0 z-[4999] flex items-center justify-center bg-black/50 backdrop-blur-sm p-2 xs:p-4",children:[s.jsxs("div",{className:`relative max-w-lg w-full max-h-[70vh] overflow-hidden rounded-2xl bg-white shadow-2xl transform transition-all duration-500 ease-out ${e&&!_?"translate-y-0 opacity-100 scale-100":"translate-y-full opacity-0 scale-95"}`,role:"dialog","aria-modal":"true","aria-labelledby":"evaluation-stage-title",onKeyDown:H=>{H.key==="Escape"&&t()},tabIndex:-1,children:[s.jsxs("div",{className:"relative bg-gradient-to-r from-emerald-500 via-emerald-600 to-teal-600 p-3 text-white",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-3xl"}),s.jsxs("div",{className:"relative flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 pr-2",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 border-2 border-white/30 overflow-hidden flex-shrink-0",children:n?s.jsx("img",{src:n,alt:a,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-white/10",children:s.jsx(qt,{className:"w-6 h-6 text-white/80"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{id:"evaluation-stage-title",className:"text-base font-bold mb-1 leading-tight",style:{fontFamily:"SNS, sans-serif"},children:"  "}),s.jsx("p",{className:"text-emerald-100 text-xs truncate",children:a})]})]}),s.jsx("button",{ref:N,onClick:t,className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors duration-200 touch-target","aria-label":"  ",children:s.jsx(Qe,{className:"w-4 h-4"})})]})]}),s.jsx("div",{className:"p-3 overflow-y-auto max-h-[calc(70vh-120px)]",children:g?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"text-center",children:(()=>{const H=v.filter(Q=>A(Q));return H.length===v.length&&v.length>0?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",style:{fontFamily:"SNS, sans-serif"},children:" "}),s.jsx("p",{className:"text-gray-600",children:"  .    ,    ."})]}):H.length>0?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",style:{fontFamily:"SNS, sans-serif"},children:"  "}),s.jsxs("p",{className:"text-gray-600",children:[" ",H.length,"  ",v.length," "]})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",style:{fontFamily:"SNS, sans-serif"},children:"  "}),s.jsx("p",{className:"text-gray-600",children:"    "})]})})()}),m?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(Er,{className:"w-8 h-8 animate-spin text-emerald-500"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"  ..."})]}):v.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Et,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-600",children:"       "})]}):s.jsx("div",{className:`grid gap-3 ${v.length===1?"grid-cols-1 max-w-xs mx-auto":v.length===2?"grid-cols-1 xs:grid-cols-2":"grid-cols-1 xs:grid-cols-2 sm:grid-cols-3"}`,children:v.map(H=>{const Y=A(H),Q=I(H);return s.jsxs("div",{className:`group cursor-pointer rounded-2xl p-4 border transition-all duration-300 relative ${Y?"border-green-300 bg-gradient-to-br from-green-50 to-emerald-50 hover:scale-[1.02] hover:shadow-lg":P?"border-gray-200 bg-gray-50 cursor-wait":"border-emerald-100 bg-gradient-to-br from-emerald-50 to-teal-50 hover:scale-[1.02] hover:shadow-lg"}`,onClick:async()=>{if(console.log("  :",H),D(H),P){console.log("   , ...");return}O.length===0&&!P&&(console.log("      "),await T()),console.log("    :",O),C(!0)},children:[Y&&s.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center shadow-lg",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300 ${Y?"bg-green-500":P?"bg-gray-400":"bg-emerald-500"}`,children:P?s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-white border-t-transparent"}):s.jsx("span",{className:"text-xl font-bold text-white",children:H})}),s.jsxs("h4",{className:`text-base font-bold mb-1 ${Y?"text-green-700":"text-gray-900"}`,children:[" #",H]}),Y&&Q!==null&&s.jsx("div",{className:"mb-2",children:s.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold ${Q>=4?"bg-green-100 text-green-700":Q>=3?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),Q,"/5"]})}),s.jsx("p",{className:`text-xs ${Y?"text-green-600":P?"text-gray-500":"text-gray-600"}`,children:Y?" ":P?" ...":"  "})]})]},H)})}),s.jsx("div",{className:"flex justify-center pt-4",children:s.jsxs("button",{onClick:()=>y(!1),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx(io,{className:"w-4 h-4 rotate-180"}),"   "]})})]}):s.jsx("div",{className:"grid grid-cols-1 gap-3 relative",children:V.map(H=>{const Y=H.icon,Q=H.id==="case-solving";return s.jsx("div",{ref:Q?p:void 0,className:`
                      group cursor-pointer rounded-xl p-3 border transition-all duration-300
                      bg-gradient-to-br ${H.bgGradient} ${H.borderColor}
                      hover:scale-[1.02] hover:shadow-lg
                      ${Q&&R?"case-solving-highlight":""}
                    `,onClick:()=>q(H.id),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 ${H.iconBg} rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300`,children:s.jsx(Y,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-base font-bold text-gray-900 mb-1",style:{fontFamily:"SNS, sans-serif"},children:H.title}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:H.description})]}),s.jsx("div",{className:"w-6 h-6 rounded-full bg-white/50 flex items-center justify-center group-hover:bg-white group-hover:shadow-md transition-all duration-300",children:s.jsx("svg",{className:"w-3 h-3 text-gray-600 group-hover:translate-x-0.5 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},H.id)})})}),s.jsx("div",{className:"border-t border-gray-100 p-2 bg-gray-50 rounded-b-2xl"})]}),s.jsx(kne,{isOpen:_,onClose:()=>{console.log("  CaseEvaluationModal"),C(!1),y(!1),setTimeout(()=>{console.log("   onClose"),t()},100)},participantId:l,participantName:a,caseNumber:j,examId:i,onEvaluationComplete:async()=>{await(o==null?void 0:o(j)),C(!1),y(!1)},onRemoveEvaluation:c,existingEvaluation:(()=>{const H=O.find(Y=>Y.reservist_id===l&&Y.case_number===j);return console.log("  existingEvaluation :",{participantId:l,selectedCaseNumber:j,currentEvaluationsLength:O.length,found:H}),H})(),onModalStateChange:H=>{x==null||x(H)}}),s.jsx(Sne,{isVisible:f,targetRef:p,onClose:k})]})]})},Fne=e=>s.jsx(Bne,{...e}),Tne=({isOpen:e,onClose:t,participantId:r,participantName:a,examId:n,onEvaluationComplete:i,onRemoveEvaluation:l,existingEvaluation:o,onModalStateChange:c})=>{const{user:d}=st(),[x,u]=E.useState({exam_event_id:n,reservist_id:r,evaluator_id:(d==null?void 0:d.id)||"",presentation_number:1,criteria_scores:{goal_achievement:0,topic_development:0,document_quality:0}}),[f,h]=E.useState(!1),[p,g]=E.useState(!1),[y,v]=E.useState(!1),[w,m]=E.useState(!1),[b,_]=E.useState(!1),[C,j]=E.useState(!1),[D,R]=E.useState(null);E.useEffect(()=>{e&&r&&n&&(d!=null&&d.id)&&(async()=>(await M(),await O()))()},[e,r,n,d==null?void 0:d.id]),E.useEffect(()=>{const I=e||w;c&&c(I);const V=new CustomEvent("modalStateChange",{detail:{isOpen:I}});window.dispatchEvent(V)},[e,w,c]);const M=async()=>{try{console.log("    :",{examId:n,participantId:r});const{data:I,error:V}=await Z.from("presentation_assignments").select("presentation_number").eq("exam_event_id",n).eq("participant_id",r).single();if(console.log("    :",{data:I,error:V}),V&&V.code!=="PGRST116"){console.error("    :",V);return}I?(console.log("   :",I.presentation_number),R(I.presentation_number)):(console.log("      "),R(null))}catch(I){console.error("    :",I)}},O=async()=>{if(d!=null&&d.id){h(!0);try{const{data:I,error:V}=await Z.from("project_defense_evaluations").select("*").eq("exam_event_id",n).eq("reservist_id",r).eq("evaluator_id",d.id).single();if(V&&V.code!=="PGRST116"){console.error("   :",V);return}if(I)u({id:I.id,exam_event_id:I.exam_event_id,reservist_id:I.reservist_id,evaluator_id:I.evaluator_id,presentation_number:I.presentation_number,criteria_scores:I.criteria_scores}),v(!0),j(!0);else{const H=D??1;u({exam_event_id:n,reservist_id:r,evaluator_id:d.id,presentation_number:H,criteria_scores:{goal_achievement:0,topic_development:0,document_quality:0}}),v(!1),j(!1)}}catch(I){console.error("   :",I)}finally{h(!1)}}},B=(I,V)=>{console.log("ProjectDefenseModal handleScoreChange:",{criterion:I,score:V}),u(H=>({...H,criteria_scores:{...H.criteria_scores,[I]:V}})),v(!1)},L=()=>{if(console.log(" ProjectDefenseModal handleSaveClick :",{hasExistingEvaluation:C,saved:y,saving:p,criteriaScores:x.criteria_scores}),!Object.values(x.criteria_scores).every(V=>V>0)){console.log("   -    :",x.criteria_scores),alert(",      .");return}C&&!y?(console.log("       totalScore:",S()),setTimeout(()=>{_(!0)},0)):(console.log("   "),U())},U=async()=>{g(!0);try{const I={...x.id&&{id:x.id},exam_event_id:n,reservist_id:r,evaluator_id:d==null?void 0:d.id,presentation_number:D||x.presentation_number,criteria_scores:x.criteria_scores},{error:V}=await Z.from("project_defense_evaluations").upsert(I,{onConflict:"exam_event_id,reservist_id,evaluator_id"});V&&(console.error("    :",V),alert(" project_defense_evaluations  .      .")),v(!0),console.log("      totalScore:",S()),setTimeout(()=>{m(!0)},0)}catch(I){console.error("    :",I),v(!0),m(!0)}finally{g(!1)}},P=async()=>{m(!1),await(i==null?void 0:i()),t()},F=Array.from({length:9},(I,V)=>1+V*.5),N=[{key:"goal_achievement",title:"    ",icon:ys},{key:"topic_development",title:"   ",icon:at},{key:"document_quality",title:"   ",icon:Et}],T=I=>I>=4?"#059669":I>=3?"#d97706":"#dc2626",S=()=>{const V=Object.values(x.criteria_scores).filter(Q=>Q>0);if(V.length===0)return 0;const H=V.reduce((Q,te)=>Q+te,0)/V.length,Y=Math.round(H*10)/10;return console.log(" ProjectDefenseModal getTotalScore calculated:",{criteria_scores:x.criteria_scores,validScores:V,average:H,result:Y}),Y},z=E.useMemo(()=>S(),[x.criteria_scores]),k=E.useMemo(()=>Object.values(x.criteria_scores).every(I=>I>0),[x.criteria_scores])&&!p;console.log("ProjectDefenseModal Debug:",{totalScore:z,criteria_scores:x.criteria_scores,canSave:k,saving:p,saved:y,showSuccessModal:w,isOpen:e});const q=`
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      cursor: pointer;
      width: 100%;
    }

    input[type="range"]::-webkit-slider-track {
      background: transparent;
      height: 20px;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      background: #10b981;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      margin-top: -10px; /*      */
    }

    input[type="range"]::-moz-range-track {
      background: transparent;
      height: 20px;
    }

    input[type="range"]::-moz-range-thumb {
      background: #10b981;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      margin-top: -10px; /*      */
    }
    
    /*        */
    .case-evaluation-modal {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      z-index: 10002 !important;
      background: white !important;
    }
    
    /*    body     */
    body.modal-open {
      margin: 0 !important;
      padding: 0 !important;
      overflow: hidden !important;
    }
  `,A=({value:I,onChange:V})=>{const H=Y=>{const Q=parseInt(Y.target.value);V(F[Q])};return s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"mb-2 grid grid-cols-9 gap-1",children:[1,1.5,2,2.5,3,3.5,4,4.5,5].map(Y=>{const Q=I===Y;return s.jsx("button",{className:"h-7 w-full rounded-full text-[10px] font-semibold border transition "+(Q?"bg-emerald-500 border-emerald-500 text-white":"bg-white border-gray-200 text-gray-700 hover:border-emerald-300 hover:bg-emerald-50"),onClick:()=>V(Y),"aria-label":` ${Y}`,children:Y},Y)})}),s.jsxs("div",{className:"relative pt-3",children:[s.jsx("div",{className:"absolute left-1 right-1 top-[9px] h-[2px] bg-gray-200 rounded-full"}),s.jsx("div",{className:"absolute left-1 top-[9px] h-[2px] bg-emerald-500 rounded-full",style:{width:`${F.indexOf(I)/(F.length-1)*100}%`}}),s.jsx("div",{className:"absolute left-1 right-1 top-[6px] h-5 pointer-events-none",children:F.map((Y,Q)=>{const te=`${Q/(F.length-1)*100}%`,re=Number.isInteger(Y);return s.jsxs("div",{className:"absolute",style:{left:te,transform:"translateX(-50%)"},children:[s.jsx("div",{className:re?"w-[2px] h-5 bg-gray-300":"w-[1px] h-3 bg-gray-300"}),re&&s.jsx("div",{className:"text-[10px] text-gray-500 text-center mt-1 translate-x-[-50%]",children:Y})]},Y)})}),s.jsx("input",{type:"range",min:0,max:F.length-1,value:Math.max(0,F.indexOf(I)),onChange:H,className:"w-full h-5 relative z-10"})]})]})};return e?s.jsxs(s.Fragment,{children:[s.jsx("style",{children:q}),s.jsxs("div",{className:"case-evaluation-modal fixed inset-0 z-[10002] overflow-y-auto bg-white",style:{pointerEvents:"auto"},children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-gray-100 bg-white/80 backdrop-blur-sm",style:{paddingTop:"0px"},children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:s.jsx(Kw,{className:"w-5 h-5 text-emerald-700"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"text-xs text-gray-500",children:" "}),s.jsx("div",{className:"text-base font-semibold truncate",children:a})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold",style:{color:T(S())},children:S().toFixed(1)}),s.jsx("div",{className:"text-[11px] text-gray-400",children:" "})]}),s.jsx("button",{onPointerUp:t,className:"p-2 rounded-lg hover:bg-gray-50 active:bg-gray-100","aria-label":"",style:{minWidth:"44px",minHeight:"44px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation",userSelect:"none"},children:s.jsx(Qe,{className:"w-6 h-6 text-gray-700 pointer-events-none"})})]})]})}),s.jsx("main",{className:"px-4 pt-3",children:s.jsx("div",{className:"space-y-3",children:f?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"rounded-xl border border-gray-100 bg-white p-3 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center",children:s.jsx(Kw,{className:"w-4 h-4 text-emerald-700"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:" "}),s.jsx("div",{className:"text-xs text-gray-500",children:D?" ":"   ( : 1)"})]})]}),s.jsx("div",{className:"h-10 w-10 rounded-lg border-2 border-emerald-500 bg-emerald-500 text-white shadow-lg flex items-center justify-center font-semibold text-lg",children:(()=>{const I=D||x.presentation_number;return console.log("   :",{assignedPresentationNumber:D,evaluationPresentationNumber:x.presentation_number,displayNumber:I}),I})()})]})}),N.map(I=>{const V=I.icon,H=x.criteria_scores[I.key],Y=T(H);return s.jsxs("div",{className:"rounded-xl border border-gray-100 bg-white p-3 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center",children:s.jsx(V,{className:"w-4 h-4 text-emerald-700"})}),s.jsx("div",{className:"min-w-0",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.title})})]}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:"text-lg font-bold",style:{color:Y},children:H?H.toFixed(1):""})})]}),s.jsx(A,{value:H,onChange:Q=>B(I.key,Q)})]},I.key)}),s.jsx("div",{className:"mt-6 px-4 pb-6",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onPointerUp:t,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:" "}),s.jsx("button",{onPointerUp:()=>{console.log(" ProjectDefenseModal Submit button clicked:",{canSave:k,hasAnyScore:Object.values(x.criteria_scores).some(I=>I>0),saving:p}),k?(console.log("  handleSaveClick"),L()):console.log("  ")},disabled:!k,className:`flex-1 px-4 py-2.5 rounded-lg font-semibold text-sm ${k?"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:p?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"..."]}):y?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(at,{className:"w-4 h-4"}),""]}):s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(Ps,{className:"w-4 h-4"}),""]})})]})})]})})})]}),s.jsx(Qy,{isOpen:w,onClose:P,participantName:a,caseNumber:null,totalScore:S(),evaluationType:" ",detailedScores:x.criteria_scores,onRemoveEvaluation:async()=>{await(l==null?void 0:l(r))}}),s.jsx(Jy,{isOpen:b,onClose:()=>_(!1),onConfirm:()=>{_(!1),U()},participantName:a,evaluationType:" ",totalScore:S()})]}):null},Mne=({isOpen:e,onClose:t,participantId:r,participantName:a,examId:n,onEvaluationComplete:i,onRemoveEvaluation:l,existingEvaluation:o,onModalStateChange:c})=>{const{user:d}=st(),[x,u]=E.useState({exam_event_id:n,reservist_id:r,evaluator_id:(d==null?void 0:d.id)||"",competency_scores:{results_orientation:0,effective_communication:0,teamwork_skills:0,systemic_thinking:0}}),[f,h]=E.useState(!1),[p,g]=E.useState(!1),[y,v]=E.useState(!1),[w,m]=E.useState(!1),[b,_]=E.useState(!1),[C,j]=E.useState(!1),[D,R]=E.useState(!1),[M,O]=E.useState(null),[B,L]=E.useState(!1);E.useEffect(()=>{e&&r&&n&&(d!=null&&d.id)?B||U():e||L(!1)},[e,r,n,d==null?void 0:d.id,B]),E.useEffect(()=>{const Y=e||w||D;c&&c(Y);const Q=new CustomEvent("modalStateChange",{detail:{isOpen:Y}});window.dispatchEvent(Q)},[e,w,D,c]);const U=async()=>{if(d!=null&&d.id){h(!0);try{const{data:Y,error:Q}=await Z.from("diagnostic_game_evaluations").select("*").eq("exam_event_id",n).eq("reservist_id",r).eq("evaluator_id",d.id).single();if(Q&&Q.code!=="PGRST116"){console.error("   :",Q),u({exam_event_id:n,reservist_id:r,evaluator_id:d.id,competency_scores:{results_orientation:0,effective_communication:0,teamwork_skills:0,systemic_thinking:0}}),v(!1),j(!1),L(!0);return}Y?(u({id:Y.id,exam_event_id:Y.exam_event_id,reservist_id:Y.reservist_id,evaluator_id:Y.evaluator_id,competency_scores:Y.competency_scores}),v(!0),j(!0)):(u({exam_event_id:n,reservist_id:r,evaluator_id:d.id,competency_scores:{results_orientation:0,effective_communication:0,teamwork_skills:0,systemic_thinking:0}}),v(!1)),L(!0)}catch(Y){console.error("    :",Y),u({exam_event_id:n,reservist_id:r,evaluator_id:d.id,competency_scores:{results_orientation:0,effective_communication:0,teamwork_skills:0,systemic_thinking:0}}),v(!1),j(!1),L(!0)}finally{h(!1)}}},P=(Y,Q)=>{console.log("DiagnosticGameModal handleScoreChange:",{competency:Y,score:Q}),u(te=>({...te,competency_scores:{...te.competency_scores,[Y]:Q}})),v(!1)},F=()=>{if(console.log(" DiagnosticGameModal handleSaveClick :",{hasExistingEvaluation:C,saved:y,saving:p,competencyScores:x.competency_scores}),!Object.values(x.competency_scores).every(Q=>Q>0)){console.log("   -    :",x.competency_scores),alert(",      .");return}C&&!y?(console.log("       totalScore:",T()),setTimeout(()=>{_(!0)},0)):(console.log("   "),N())},N=async()=>{g(!0);try{const Y={...x.id&&{id:x.id},exam_event_id:n,reservist_id:r,evaluator_id:d==null?void 0:d.id,competency_scores:x.competency_scores},{error:Q}=await Z.from("diagnostic_game_evaluations").upsert(Y,{onConflict:"exam_event_id,reservist_id,evaluator_id"});Q&&(console.error("    :",Q),alert(" diagnostic_game_evaluations  .      .")),v(!0),console.log("      totalScore:",T()),setTimeout(()=>{m(!0)},0)}catch(Y){console.error("    :",Y),v(!0),m(!0)}finally{g(!1)}},T=()=>{const{results_orientation:Y,effective_communication:Q,teamwork_skills:te,systemic_thinking:re}=x.competency_scores,X=[Y,Q,te,re].filter(ue=>ue>0);if(X.length===0)return 0;const je=X.reduce((ue,de)=>ue+de,0)/X.length,J=Math.round(je*10)/10;return console.log(" DiagnosticGameModal getTotalScore calculated:",{competency_scores:x.competency_scores,validScores:X,average:je,result:J}),J},S=async()=>{m(!1),await(i==null?void 0:i()),t()},z=[{key:"results_orientation",title:"   ",description:"     ;   ;      ",details:["     ","  ,       ","          "],icon:null},{key:"effective_communication",title:"  ",description:"  ;    ;    ;  ;   ",details:["      ","   ","     ","  ","   ","     "],icon:null},{key:"teamwork_skills",title:"    ",description:"    ;   ;   ;    ;  ",details:["    ","       ","      ","        "," ()    ,      "],icon:null},{key:"systemic_thinking",title:"  ",description:"   ;    ;   ;   ;  ",details:[",    ,    ,    ","   ,  - "," ,  ","       ","   "],icon:null}],W=Array.from({length:9},(Y,Q)=>1+Q*.5),k=Y=>Y>=4?"#059669":Y>=3?"#d97706":"#dc2626",q=E.useMemo(()=>{const Q=Object.values(x.competency_scores).filter(re=>re>0);if(Q.length===0)return 0;const te=Q.reduce((re,X)=>re+X,0)/Q.length;return Math.round(te*10)/10},[x.competency_scores]),I=E.useMemo(()=>Object.values(x.competency_scores).every(Y=>Y>0),[x.competency_scores])&&!p;console.log("DiagnosticGameModal Debug:",{totalScore:q,competency_scores:x.competency_scores,canSave:I,saving:p,saved:y,showSuccessModal:w,isOpen:e,showCriteriaModal:D,selectedCompetency:M==null?void 0:M.title});const V=`
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      cursor: pointer;
      width: 100%;
    }

    input[type="range"]::-webkit-slider-track {
      background: transparent;
      height: 20px;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      background: #10b981;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      margin-top: -10px; /*      */
    }

    input[type="range"]::-moz-range-track {
      background: transparent;
      height: 20px;
    }

    input[type="range"]::-moz-range-thumb {
      background: #10b981;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      margin-top: -10px; /*      */
    }
    
    /*        */
    .case-evaluation-modal {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      z-index: 10002 !important;
      background: white !important;
    }
    
    /*    body     */
    body.modal-open {
      margin: 0 !important;
      padding: 0 !important;
      overflow: hidden !important;
    }
    
    /*    iPhone */
    @media screen and (max-width: 768px) {
      .case-evaluation-modal {
        -webkit-overflow-scrolling: touch !important;
        -webkit-transform: translate3d(0, 0, 0) !important;
        transform: translate3d(0, 0, 0) !important;
      }
      
      .case-evaluation-modal header {
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        will-change: transform !important;
      }
      
      .case-evaluation-modal button {
        -webkit-tap-highlight-color: transparent !important;
        -webkit-touch-callout: none !important;
        -webkit-user-select: none !important;
        user-select: none !important;
        touch-action: manipulation !important;
      }
      
      /*  safe area    */
      .case-evaluation-modal {
        padding-top: 0px !important;
        padding-left: 0px !important;
        padding-right: 0px !important;
        padding-bottom: 0px !important;
      }
    }
  `,H=({value:Y,onChange:Q})=>{const te=re=>{const X=parseInt(re.target.value);Q(W[X])};return s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"mb-2 grid grid-cols-9 gap-1",children:[1,1.5,2,2.5,3,3.5,4,4.5,5].map(re=>{const X=Y===re;return s.jsx("button",{className:"h-7 w-full rounded-full text-[10px] font-semibold border transition "+(X?"bg-emerald-500 border-emerald-500 text-white":"bg-white border-gray-200 text-gray-700 hover:border-emerald-300 hover:bg-emerald-50"),onClick:()=>Q(re),"aria-label":` ${re}`,children:re},re)})}),s.jsxs("div",{className:"relative pt-3",children:[s.jsx("div",{className:"absolute left-1 right-1 top-[9px] h-[2px] bg-gray-200 rounded-full"}),s.jsx("div",{className:"absolute left-1 top-[9px] h-[2px] bg-emerald-500 rounded-full",style:{width:`${W.indexOf(Y)/(W.length-1)*100}%`}}),s.jsx("div",{className:"absolute left-1 right-1 top-[6px] h-5 pointer-events-none",children:W.map((re,X)=>{const je=`${X/(W.length-1)*100}%`,J=Number.isInteger(re);return s.jsxs("div",{className:"absolute",style:{left:je,transform:"translateX(-50%)"},children:[s.jsx("div",{className:J?"w-[2px] h-5 bg-gray-300":"w-[1px] h-3 bg-gray-300"}),J&&s.jsx("div",{className:"text-[10px] text-gray-500 text-center mt-1 translate-x-[-50%]",children:re})]},re)})}),s.jsx("input",{type:"range",min:0,max:W.length-1,value:Math.max(0,W.indexOf(Y)),onChange:te,className:"w-full h-5 relative z-10"})]})]})};return e?s.jsxs(s.Fragment,{children:[s.jsx("style",{children:V}),s.jsxs("div",{className:"case-evaluation-modal fixed inset-0 z-[10002] overflow-y-auto bg-white",style:{pointerEvents:"auto"},children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-gray-100 bg-white/80 backdrop-blur-sm",style:{paddingTop:"0px"},children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:s.jsx(rM,{className:"w-5 h-5 text-emerald-700"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"text-xs text-gray-500",children:" "}),s.jsx("div",{className:"text-base font-semibold truncate",children:a})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold",style:{color:k(q)},children:q.toFixed(1)}),s.jsx("div",{className:"text-[11px] text-gray-400",children:" "})]}),s.jsx("button",{onPointerUp:t,className:"p-2 rounded-lg hover:bg-gray-50 active:bg-gray-100","aria-label":"",style:{minWidth:"44px",minHeight:"44px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation",userSelect:"none"},children:s.jsx(Qe,{className:"w-6 h-6 text-gray-700 pointer-events-none"})})]})]})}),s.jsx("main",{className:"px-4 pt-3",children:s.jsx("div",{className:"space-y-3",children:f||!B?s.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"}),s.jsx("p",{className:"text-sm text-gray-600",children:"   ..."})]}):s.jsxs(s.Fragment,{children:[z.map(Y=>{const Q=x.competency_scores[Y.key],te=k(Q);return s.jsxs("div",{className:"rounded-xl border border-gray-100 bg-white p-3 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:Y.title}),s.jsx("button",{onClick:re=>{re.preventDefault(),re.stopPropagation(),console.log(" Info button clicked for:",Y.title),O(Y),R(!0),console.log(" showCriteriaModal set to true")},className:"flex items-center justify-center hover:opacity-70 active:opacity-50 transition-opacity touch-manipulation","aria-label":"  ",style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:s.jsx(Vs,{className:"w-4 h-4 text-gray-400"})})]}),s.jsx("div",{className:"text-xs text-gray-500",children:Y.description})]}),s.jsx("div",{className:"text-right ml-3",children:s.jsx("div",{className:"text-lg font-bold",style:{color:te},children:Q?Q.toFixed(1):""})})]}),s.jsx(H,{value:Q,onChange:re=>P(Y.key,re)})]},Y.key)}),s.jsx("div",{className:"mt-6 px-4 pb-6",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onPointerUp:t,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:" "}),s.jsx("button",{onPointerUp:()=>{console.log(" DiagnosticGameModal Submit button clicked:",{canSave:I,hasAnyScore:Object.values(x.competency_scores).some(Y=>Y>0),saving:p}),I?(console.log("  handleSaveClick"),F()):console.log("  ")},disabled:!I,className:`flex-1 px-4 py-2.5 rounded-lg font-semibold text-sm ${I?"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:p?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"..."]}):y?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(at,{className:"w-4 h-4"}),""]}):s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(Ps,{className:"w-4 h-4"}),""]})})]})})]})})})]}),s.jsx(Qy,{isOpen:w,onClose:S,participantName:a,caseNumber:null,totalScore:T(),evaluationType:" ",detailedScores:x.competency_scores,onRemoveEvaluation:async()=>{await(l==null?void 0:l(r))}}),D&&M&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10004] p-4",onClick:Y=>{Y.target===Y.currentTarget&&(console.log(" Overlay clicked - closing modal"),R(!1),O(null))},children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"p-6 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[" : ",M.title]}),s.jsx("p",{className:"text-gray-600 text-sm mt-2 leading-relaxed",children:M.description})]}),s.jsx("button",{onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),console.log(" X button clicked - closing modal"),R(!1),O(null)},className:"ml-4 p-2 hover:bg-gray-100 rounded-lg transition-colors touch-manipulation",style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},"aria-label":"",children:s.jsx(Qe,{className:"w-5 h-5 text-gray-500"})})]})}),s.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:s.jsx("div",{className:"space-y-3",children:M.details.map((Y,Q)=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-6 h-6 bg-emerald-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:s.jsx("span",{className:"text-emerald-600 text-sm font-semibold",children:Q+1})}),s.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[s.jsx("p",{className:"text-gray-700 text-sm leading-relaxed flex-1",children:Y}),s.jsx("div",{className:"w-6 h-6 bg-emerald-100 rounded-full flex items-center justify-center shadow-sm flex-shrink-0 mt-0.5",children:s.jsx(Vs,{className:"w-3 h-3 text-emerald-600"})})]})]},Q))})}),s.jsx("div",{className:"p-4 sm:p-6 border-t border-gray-100",children:s.jsx("button",{onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),console.log("  button clicked"),R(!1),O(null),console.log(" showCriteriaModal set to false")},className:"w-full px-6 py-4 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 active:bg-emerald-700 transition-colors font-medium text-base touch-manipulation",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:""})})]})}),s.jsx(Jy,{isOpen:b,onClose:()=>_(!1),onConfirm:()=>{_(!1),N()},participantName:a,evaluationType:" ",totalScore:q})]}):null},Rne=({examEventId:e})=>{const{userProfile:t}=st();console.log("ExpertEvaluationResults - userProfile:",t),console.log("ExpertEvaluationResults - userProfile.role:",t==null?void 0:t.role);const[r,a]=E.useState([]),[n,i]=E.useState([]),[l,o]=E.useState([]),[c,d]=E.useState([]),[x,u]=E.useState([]),[f,h]=E.useState(!0),[p,g]=E.useState(null),[y,v]=E.useState(null),[w,m]=E.useState({}),[b,_]=E.useState("");E.useEffect(()=>{C()},[e]);const C=async()=>{try{console.log("   ..."),console.log("examEventId:",e),h(!0),g(null);const{data:N,error:T}=await Z.from("event_participants").select(`
          user_id,
          user:users(
            id,
            full_name,
            email,
            sap_number,
            position:positions(name),
            territory:territories(name)
          )
        `).eq("event_id",e);if(T)throw T;const S=(N==null?void 0:N.map(Y=>({id:Y.user.id,full_name:Y.user.full_name,email:Y.user.email,sap_number:Y.user.sap_number,position:Y.user.position,territory:Y.user.territory})))||[];a(S);const{data:z,error:W}=await Z.from("users").select("id, full_name, email").in("role",["expert","administrator"]);W?(console.warn("  :",W),u([])):u(z||[]),console.log("    examEventId:",e);const{data:k,error:q}=await Z.from("case_evaluations").select("*").eq("exam_event_id",e);q?(console.warn("   :",q),i([])):(i(k||[]),console.log("  :",(k==null?void 0:k.length)||0)),console.log("     examEventId:",e);const{data:A,error:I}=await Z.from("diagnostic_game_evaluations").select("*").eq("exam_event_id",e);I?(console.warn("    :",I),o([])):(o(A||[]),console.log("   :",(A==null?void 0:A.length)||0)),console.log("     examEventId:",e);const{data:V,error:H}=await Z.from("project_defense_evaluations").select("*").eq("exam_event_id",e);H?(console.warn("    :",H),d([])):(d(V||[]),console.log("   :",(V==null?void 0:V.length)||0),V&&V.length>0&&(console.log("   :",JSON.stringify(V[0],null,2)),console.log(" ID   :",V.map(Y=>Y.id)),console.log("   ID 9e171321-002a-4626-8b46-a2482a94f6c5:",V.find(Y=>Y.id==="9e171321-002a-4626-8b46-a2482a94f6c5"))))}catch(N){console.error("   :",N),g("   ")}finally{console.log("   "),h(!1)}},j=(N,T=5)=>{const S=N/T*100;return S>=80?"text-green-600 bg-green-50":S>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},D=(N,T)=>{console.log("  :",{evaluationId:N.id,type:T,evaluation:N}),v({type:T,id:N.id,participantId:N.reservist_id,evaluatorId:N.evaluator_id,caseNumber:N.case_number}),T==="case"?m({correctness:N.criteria_scores.correctness,clarity:N.criteria_scores.clarity,independence:N.criteria_scores.independence}):T==="project"?m({goal_achievement:N.criteria_scores.goal_achievement,topic_development:N.criteria_scores.topic_development,document_quality:N.criteria_scores.document_quality}):T==="diagnostic"&&m({results_orientation:N.competency_scores.results_orientation,effective_communication:N.competency_scores.effective_communication,teamwork_skills:N.competency_scores.teamwork_skills,systemic_thinking:N.competency_scores.systemic_thinking}),_(N.comments||"")},R=()=>{v(null),m({}),_("")},M=async()=>{if(y)try{const N=y.type==="case"?"case_evaluations":y.type==="project"?"project_defense_evaluations":"diagnostic_game_evaluations",T={comments:b};y.type==="case"?T.criteria_scores={correctness:w.correctness,clarity:w.clarity,independence:w.independence}:y.type==="project"?T.criteria_scores={goal_achievement:w.goal_achievement,topic_development:w.topic_development,document_quality:w.document_quality}:y.type==="diagnostic"&&(T.competency_scores={results_orientation:w.results_orientation,effective_communication:w.effective_communication,teamwork_skills:w.teamwork_skills,systemic_thinking:w.systemic_thinking}),console.log(" :",{tableName:N,evaluationId:y.id,updateData:T}),console.log(" updateData:",JSON.stringify(T,null,2)),console.log(" :",y.type),console.log(" editScores:",w);const{error:S}=await Z.from(N).update(T).eq("id",y.id);if(console.log(" :",{error:S}),S)throw console.error(" Supabase:",S),S;console.log("     ");const{data:z}=await Z.from(N).select("*").eq("id",y.id);console.log("  :",z),console.log("ID  :",y.id),console.log("  :",JSON.stringify(z,null,2)),console.log("  ,  ..."),await new Promise(W=>setTimeout(W,500)),await C(),R(),console.log(" ,   ")}catch(N){console.error("  :",N),g(`   : ${N instanceof Error?N.message:" "}`)}},O=async(N,T)=>{if(confirm(" ,     ?"))try{const S=T==="case"?"case_evaluations":T==="project"?"project_defense_evaluations":"diagnostic_game_evaluations";console.log(" :",{evaluationId:N,type:T,tableName:S});const{error:z}=await Z.from(S).delete().eq("id",N);if(console.log(" :",{error:z}),z)throw console.error(" Supabase  :",z),z;console.log("  ,  ..."),await C()}catch(S){console.error("  :",S),g(`   : ${S instanceof Error?S.message:" "}`)}};if(f)return s.jsxs("div",{className:"flex items-center justify-center p-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-2 text-gray-600",children:"  ..."})]});if(p)return s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"text-red-400 mr-2",children:""}),s.jsx("span",{className:"text-red-800",children:p})]})});const B=(N,T,S)=>N.filter(z=>z.reservist_id===T&&z.evaluator_id===S),L=()=>{if(!y)return null;const N=()=>y.type==="case"?s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.correctness||"",onChange:T=>m({...w,correctness:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.clarity||"",onChange:T=>m({...w,clarity:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.independence||"",onChange:T=>m({...w,independence:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}):y.type==="project"?s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.goal_achievement||"",onChange:T=>m({...w,goal_achievement:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.topic_development||"",onChange:T=>m({...w,topic_development:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.document_quality||"",onChange:T=>m({...w,document_quality:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}):y.type==="diagnostic"?s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"   "}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.results_orientation||"",onChange:T=>m({...w,results_orientation:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.effective_communication||"",onChange:T=>m({...w,effective_communication:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"    "}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.teamwork_skills||"",onChange:T=>m({...w,teamwork_skills:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsx("input",{type:"number",min:"1",max:"5",value:w.systemic_thinking||"",onChange:T=>m({...w,systemic_thinking:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}):null;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "}),s.jsx("button",{onClick:R,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"space-y-4",children:[N(),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("textarea",{value:b,onChange:T=>_(T.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"   ..."})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{onClick:R,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:""}),s.jsxs("button",{onClick:M,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center",children:[s.jsx(Ps,{className:"h-4 w-4 mr-2"}),""]})]})]})})},U=()=>x.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(La,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),s.jsx("p",{children:"  "})]}):s.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:s.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",style:{minWidth:`${x.length*120+180}px`},children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-b border-gray-200 w-36 sticky left-0 bg-gray-50 z-20 shadow-sm",children:""}),x.map(N=>s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-900 border-b border-gray-200 min-w-24",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"font-medium text-xs truncate",title:N.full_name,children:N.full_name})})},N.id))]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(N=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-2 whitespace-nowrap sticky left-0 bg-white z-10 shadow-sm",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",title:N.full_name,children:N.full_name}),s.jsx("div",{className:"text-xs text-gray-500",children:N.sap_number})]})}),x.map(T=>{const S=B(n,N.id,T.id);return s.jsx("td",{className:"px-1 py-2 text-center",children:S.length>0?s.jsx("div",{className:"space-y-1",children:S.map((z,W)=>s.jsxs("div",{className:"text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"text-gray-500 text-xs",children:[" ",z.case_number]}),(t==null?void 0:t.role)==="administrator"&&s.jsxs("div",{className:"flex space-x-1",children:[s.jsx("button",{onClick:()=>D(z,"case"),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:" ",children:s.jsx(gg,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>O(z.id,"case"),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:" ",children:s.jsx(Zr,{className:"h-3 w-3"})})]})]}),s.jsxs("div",{className:"flex justify-center space-x-0.5",children:[s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.criteria_scores.correctness)}`,children:z.criteria_scores.correctness}),s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.criteria_scores.clarity)}`,children:z.criteria_scores.clarity}),s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.criteria_scores.independence)}`,children:z.criteria_scores.independence})]})]},z.id))}):s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"text-xs",children:[s.jsx("div",{className:"text-gray-400 mb-1 text-xs",children:" 1"}),s.jsxs("div",{className:"flex justify-center space-x-0.5",children:[s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"})]})]}),s.jsxs("div",{className:"text-xs",children:[s.jsx("div",{className:"text-gray-400 mb-1 text-xs",children:" 2"}),s.jsxs("div",{className:"flex justify-center space-x-0.5",children:[s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"})]})]})]})},T.id)})]},N.id))})]})}),P=()=>x.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(er,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),s.jsx("p",{children:"  "})]}):s.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:s.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",style:{minWidth:`${x.length*120+180}px`},children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-b border-gray-200 w-36 sticky left-0 bg-gray-50 z-20 shadow-sm",children:""}),x.map(N=>s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-900 border-b border-gray-200 min-w-24",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"font-medium text-xs truncate",title:N.full_name,children:N.full_name})})},N.id))]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(N=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-2 whitespace-nowrap sticky left-0 bg-white z-10 shadow-sm",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",title:N.full_name,children:N.full_name}),s.jsx("div",{className:"text-xs text-gray-500",children:N.sap_number})]})}),x.map(T=>{const S=B(c,N.id,T.id);return s.jsx("td",{className:"px-1 py-2 text-center",children:S.length>0?s.jsx("div",{className:"space-y-1",children:S.map((z,W)=>s.jsxs("div",{className:"text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"text-gray-500 text-xs",children:" "}),(console.log("     project evaluation:",{userProfileRole:t==null?void 0:t.role,isAdministrator:(t==null?void 0:t.role)==="administrator",evaluationId:z.id}),(t==null?void 0:t.role)==="administrator")&&s.jsxs("div",{className:"flex space-x-1",children:[s.jsx("button",{onClick:()=>D(z,"project"),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:" ",children:s.jsx(gg,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>{console.log("    project evaluation:",z.id),O(z.id,"project")},className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:" ",children:s.jsx(Zr,{className:"h-3 w-3"})})]})]}),s.jsxs("div",{className:"flex justify-center space-x-0.5",children:[s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.criteria_scores.goal_achievement)}`,children:z.criteria_scores.goal_achievement}),s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.criteria_scores.topic_development)}`,children:z.criteria_scores.topic_development}),s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.criteria_scores.document_quality)}`,children:z.criteria_scores.document_quality})]})]},z.id))}):s.jsxs("div",{className:"flex justify-center space-x-0.5",children:[s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"})]})},T.id)})]},N.id))})]})}),F=()=>x.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(sx,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),s.jsx("p",{children:"  "})]}):s.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:s.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",style:{minWidth:`${x.length*120+180}px`},children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-b border-gray-200 w-36 sticky left-0 bg-gray-50 z-20 shadow-sm",children:""}),x.map(N=>s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-900 border-b border-gray-200 min-w-24",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"font-medium text-xs truncate",title:N.full_name,children:N.full_name})})},N.id))]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(N=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-2 whitespace-nowrap sticky left-0 bg-white z-10 shadow-sm",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",title:N.full_name,children:N.full_name}),s.jsx("div",{className:"text-xs text-gray-500",children:N.sap_number})]})}),x.map(T=>{const S=B(l,N.id,T.id);return s.jsx("td",{className:"px-1 py-2 text-center",children:S.length>0?s.jsx("div",{className:"space-y-1",children:S.map((z,W)=>s.jsxs("div",{className:"text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"text-gray-500 text-xs",children:" "}),(console.log("     diagnostic evaluation:",{userProfileRole:t==null?void 0:t.role,isAdministrator:(t==null?void 0:t.role)==="administrator",evaluationId:z.id}),(t==null?void 0:t.role)==="administrator")&&s.jsxs("div",{className:"flex space-x-1",children:[s.jsx("button",{onClick:()=>D(z,"diagnostic"),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:" ",children:s.jsx(gg,{className:"h-3 w-3"})}),s.jsx("button",{onClick:()=>{console.log("    diagnostic evaluation:",z.id),O(z.id,"diagnostic")},className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:" ",children:s.jsx(Zr,{className:"h-3 w-3"})})]})]}),s.jsxs("div",{className:"flex justify-center space-x-0.5",children:[s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.competency_scores.results_orientation)}`,children:z.competency_scores.results_orientation}),s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.competency_scores.effective_communication)}`,children:z.competency_scores.effective_communication}),s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.competency_scores.teamwork_skills)}`,children:z.competency_scores.teamwork_skills}),s.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${j(z.competency_scores.systemic_thinking)}`,children:z.competency_scores.systemic_thinking})]})]},z.id))}):s.jsxs("div",{className:"flex justify-center space-x-0.5",children:[s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"}),s.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-400",children:"0"})]})},T.id)})]},N.id))})]})});return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center",children:[s.jsx(er,{className:"mr-3 text-[#06A478]"}),"  "]}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(La,{className:"mr-3 text-[#06A478]"})," 1:  "]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"     : , , "}),U()]}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(er,{className:"mr-3 text-[#06A478]"})," 2:  "]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"      :  ,  ,  "}),P()]}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(sx,{className:"mr-3 text-[#06A478]"})," 3:  "]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"  :   ,  ,   ,  "}),F()]}),r.length===0&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(nt,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s.jsx("p",{className:"text-gray-500",children:"   "})]})]}),L()]})},One=({onClick:e,icon:t=s.jsx(zt,{className:"w-5 h-5"}),label:r,position:a="bottom-right",size:n="md",color:i="primary",className:l=""})=>{const o=()=>{switch(a){case"bottom-right":return"bottom-6 right-6";case"bottom-left":return"bottom-6 left-6";case"top-right":return"top-6 right-6";case"top-left":return"top-6 left-6";default:return"bottom-6 right-6"}},c=()=>{switch(n){case"sm":return"w-12 h-12";case"md":return"w-14 h-14";case"lg":return"w-16 h-16";default:return"w-14 h-14"}},d=()=>{switch(i){case"primary":return"bg-[#06A478] hover:bg-[#059669] text-white shadow-lg hover:shadow-xl";case"secondary":return"bg-gray-600 hover:bg-gray-700 text-white shadow-lg hover:shadow-xl";case"success":return"bg-green-500 hover:bg-green-600 text-white shadow-lg hover:shadow-xl";case"warning":return"bg-yellow-500 hover:bg-yellow-600 text-white shadow-lg hover:shadow-xl";case"danger":return"bg-red-500 hover:bg-red-600 text-white shadow-lg hover:shadow-xl";default:return"bg-[#06A478] hover:bg-[#059669] text-white shadow-lg hover:shadow-xl"}};return s.jsxs("button",{onClick:e,className:`
        fixed z-50 rounded-full flex items-center justify-center
        transition-all duration-300 ease-in-out
        hover:scale-110 active:scale-95
        focus:outline-none focus:ring-4 focus:ring-opacity-50
        ${o()}
        ${c()}
        ${d()}
        ${l}
      `,style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},"aria-label":r||"Floating Action Button",children:[t,r&&s.jsx("span",{className:"ml-2 text-sm font-medium hidden sm:block",children:r})]})},Pne=({isOpen:e,onClose:t,schedule:r,examTitle:a=" "})=>e?s.jsx(s.Fragment,{children:s.jsxs("div",{className:"schedule-modal fixed inset-0 z-[10005] overflow-y-auto bg-white",style:{pointerEvents:"auto"},children:[s.jsx("header",{className:"sticky top-0 z-10 border-b border-gray-100 bg-white/80 backdrop-blur-sm",style:{paddingTop:"0px"},children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:s.jsx(zt,{className:"w-5 h-5 text-emerald-700"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"text-xs text-gray-500",children:" "}),s.jsx("div",{className:"text-base font-semibold truncate",children:a})]})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsx("button",{onClick:t,onPointerUp:t,className:"p-2 rounded-lg hover:bg-gray-50 active:bg-gray-100","aria-label":"",style:{minWidth:"44px",minHeight:"44px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation",userSelect:"none"},children:s.jsx(Qe,{className:"w-6 h-6 text-gray-700 pointer-events-none"})})})]})}),s.jsx("main",{className:"px-4 pt-3",children:s.jsxs("div",{className:"space-y-3",children:[!r||r.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(zt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg",children:"  "})]}):s.jsx("div",{className:"space-y-3",children:r.map((n,i)=>s.jsxs("div",{className:"rounded-xl border border-gray-100 bg-white p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-lg text-sm font-bold",children:n.time||n.startTime||"  "}),n.endTime&&s.jsxs("div",{className:"text-gray-500 text-sm",children:[" ",n.endTime]}),n.duration&&s.jsx("div",{className:"bg-gray-100 text-gray-700 px-3 py-1.5 rounded-lg text-sm font-medium",children:n.duration})]}),n.type&&s.jsx("div",{className:"bg-emerald-50 text-emerald-700 px-3 py-1.5 rounded-lg text-sm font-medium",children:n.type})]}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:n.title}),n.description&&s.jsx("p",{className:"text-gray-600 text-sm leading-relaxed mb-3",children:n.description}),s.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[n.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(nr,{className:"h-4 w-4"}),s.jsx("span",{children:n.location})]}),n.speaker&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qt,{className:"h-4 w-4"}),s.jsx("span",{children:n.speaker})]})]})]},n.id||i))}),s.jsx("div",{className:"mt-6 px-4 pb-6",children:s.jsx("div",{className:"flex gap-2",children:s.jsx("button",{onClick:t,onPointerUp:t,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm font-medium",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:""})})})]})})]})}):null,lp=()=>{var Ne;const{id:e}=gi(),t=Qt(),r=ul(),{user:a,userProfile:n}=st(),{setIsNavHidden:i}=$S(),[l,o]=E.useState(null),[c,d]=E.useState([]),[x,u]=E.useState([]),[f,h]=E.useState(!1),[p,g]=E.useState(!1),[y,v]=E.useState(null),w=()=>r.pathname.includes("/schedule")?"schedule":r.pathname.includes("/evaluations")?"evaluations":"participants",[m,b]=E.useState(w),[_,C]=E.useState(!1);E.useEffect(()=>{const ne=w();console.log("   :",ne,"URL:",r.pathname),b(ne)},[r.pathname]),E.useEffect(()=>{const ne={participants:"",evaluations:"",schedule:"",results:" "};window.currentExamTab=ne[m],window.dispatchEvent(new CustomEvent("examTabChanged",{detail:{tab:m,title:ne[m]}}))},[m]);const[j,D]=E.useState(null),[R,M]=E.useState(!1),[O,B]=E.useState(null),[L,U]=E.useState(!1),[P,F]=E.useState(!1),[N,T]=E.useState(!1),[S,z]=E.useState(!1),[W,k]=E.useState(!1),q=R||L||P||N||S||!!j;E.useEffect(()=>{k(q),i(q),window.dispatchEvent(new CustomEvent("modalStateChanged",{detail:{isOpen:q}}))},[q,i]),E.useEffect(()=>{const ne=()=>{(n==null?void 0:n.role)==="administrator"&&T(!0)};return window.addEventListener("openEvaluationResults",ne),()=>{window.removeEventListener("openEvaluationResults",ne)}},[n==null?void 0:n.role]),E.useEffect(()=>()=>i(!1),[i]),E.useEffect(()=>{const ne=()=>h(window.matchMedia("(prefers-color-scheme: dark)").matches);ne();const _e=()=>ne();return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",_e),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",_e)}},[]);const[A,I]=E.useState({position:"center bottom",showAdminControls:!1,showVisualEditor:!1,previewPosition:{x:50,y:100},isDragging:!1}),V=async()=>{if(e)try{console.log("     ID:",e),g(!0);const{data:ne,error:_e}=await Z.from("events").select(`
          id,
          title,
          description,
          location,
          start_date,
          end_date,
          status,
          created_at,
          detailed_schedule,
          event_types (*),
          talent_category: talent_categories (*)
        `).eq("id",e).single();if(_e)throw _e;o(ne),console.log("  ..."),await H(),console.log("  ..."),await Y()}catch(ne){console.error("   :",ne),v("   ")}finally{g(!1)}},H=async()=>{if(e)try{console.log("    :",e);const{data:ne,error:_e}=await Z.from("event_participants").select(`
          *,
          user: users (
            id,
            full_name,
            email,
            sap_number,
            work_experience_days,
            position: positions (name),
            territory: territories (name)
          )
        `).eq("event_id",e);if(_e)throw console.error("   :",_e),_e;console.log("  :",(ne==null?void 0:ne.length)||0);const Te=await Promise.all((ne||[]).map(async Me=>{try{const{data:ye,error:Re}=await Z.from("participant_dossiers").select("*").eq("user_id",Me.user_id).eq("event_id",e).single();return Re&&Re.code!=="PGRST116"?console.warn(`    ${Me.user.full_name}:`,Re):Re&&Re.code==="PGRST116"&&console.log(`  ${Me.user.full_name}   -  ,     `),{...Me,dossier:ye||null}}catch(ye){return console.warn(`    ${Me.user.full_name}:`,ye),{...Me,dossier:null}}}));console.log("    :",Te.length),console.log("   participants:",Te.map(Me=>Me.user.full_name)),d(Te)}catch(ne){console.error("  :",ne)}},Y=async()=>{if(!(!e||!(a!=null&&a.id)))try{console.log("    :",e,":",a.id);let ne=Z.from("case_evaluations").select("*").eq("exam_event_id",e);(n==null?void 0:n.role)!=="administrator"&&(ne=ne.eq("evaluator_id",a.id));const{data:_e,error:Te}=await ne;if(Te)throw console.error("   :",Te),Te;console.log("  :",(_e==null?void 0:_e.length)||0),u(_e||[])}catch(ne){console.error("   :",ne)}},Q=()=>{I(ne=>({...ne,showAdminControls:!ne.showAdminControls}))},te=()=>{I(ne=>({...ne,showVisualEditor:!ne.showVisualEditor}))},re=ne=>{I(_e=>({..._e,position:ne,previewPosition:je(ne)})),J(ne)},X=(ne,_e)=>{I(Te=>({...Te,previewPosition:{x:ne,y:_e}}))},je=ne=>{if(ne.includes("%")){const[Te,Me]=ne.split(" ").map(ye=>parseFloat(ye.replace("%","")));return{x:Te||50,y:Me||50}}return{"center top":{x:50,y:0},"center center":{x:50,y:50},"center bottom":{x:50,y:100},"left top":{x:0,y:0},"left center":{x:0,y:50},"left bottom":{x:0,y:100},"right top":{x:100,y:0},"right center":{x:100,y:50},"right bottom":{x:100,y:100}}[ne]||{x:50,y:100}},J=async ne=>{if(e)try{if(!e.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i))return;const{error:_e}=await Z.from("events").update({banner_position:ne}).eq("id",e);if(_e){const{error:Te}=await Z.from("events").update({metadata:{banner_position:ne}}).eq("id",e);return}}catch(_e){console.error("   :",_e)}},ue=async ne=>{if(!(!e||!ne)&&confirm(" ,       ?"))try{console.log("    :",ne);const{error:_e,count:Te}=await Z.from("event_participants").delete({count:"exact"}).eq("event_id",e).eq("user_id",ne);if(_e){console.error("   :",_e),alert("  : "+_e.message);return}if(console.log("   ,  :",Te),Te===0){console.warn("       "),alert("      ");return}console.log("   ..."),await H(),d(Me=>Me.filter(ye=>ye.user.id!==ne)),console.log("   ")}catch(_e){console.error("   :",_e),alert("  ")}},de=ne=>{A.showVisualEditor&&(I(_e=>({..._e,isDragging:!0})),ce(ne))},ce=ne=>{if(!A.showVisualEditor||!A.isDragging)return;const _e=ne.currentTarget.getBoundingClientRect(),Te=(ne.clientX-_e.left)/_e.width*100,Me=(ne.clientY-_e.top)/_e.height*100,ye=Math.max(0,Math.min(100,Te)),Re=Math.max(0,Math.min(100,Me));X(ye,Re);const De=`${ye}% ${Re}%`;re(De)},fe=()=>{A.showVisualEditor&&(I(ne=>({...ne,isDragging:!1})),J(A.position))};if(E.useEffect(()=>{e&&(console.log("   ID:",e,"URL:",r.pathname),V())},[e,r.pathname]),E.useEffect(()=>{const ne=()=>{A.isDragging&&I(_e=>({..._e,isDragging:!1}))};return A.showVisualEditor&&(document.addEventListener("mouseup",ne),document.addEventListener("mouseleave",ne)),()=>{document.removeEventListener("mouseup",ne),document.removeEventListener("mouseleave",ne)}},[A.showVisualEditor,A.isDragging]),!l||p)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-[#06A478]/20 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("div",{className:"w-8 h-8 border-4 border-[#06A478] border-t-transparent rounded-full animate-spin"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:"   ..."})]})})});if(y)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(ar,{className:"w-8 h-8 text-red-600"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600 mb-4",children:y}),s.jsxs("button",{onClick:()=>{v(null),V()},className:"inline-flex items-center gap-2 px-4 py-2 bg-[#06A478] text-white rounded-lg hover:bg-[#059669] transition-colors",children:[s.jsx(en,{className:"w-4 h-4"})," "]})]})})});const pe=ne=>{switch(ne){case"published":return"";case"draft":return"";case"completed":return"";case"cancelled":return"";default:return""}};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100",children:[s.jsxs("div",{className:"container mx-auto px-0 md:px-4 pt-4 pb-8 md:pb-8",children:[s.jsx("div",{className:`w-full rounded-2xl shadow-lg overflow-hidden relative mb-4 sm:mb-6 font-mabry hidden md:block transition-all duration-300 ${W?"opacity-0 pointer-events-none transform scale-95":"opacity-100"}`,children:s.jsxs("div",{className:`relative min-h-[200px] sm:min-h-[240px] md:min-h-[280px] flex items-end ${A.showVisualEditor?"cursor-crosshair":""} ${A.isDragging?"cursor-grabbing":""}`,style:{background:`url('https://static.tildacdn.com/tild3833-3934-4965-b661-623437346431/Frame_37704_1.png') ${A.position}/cover no-repeat`},onMouseDown:de,onMouseMove:ce,onMouseUp:fe,onMouseLeave:fe,children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),A.showVisualEditor&&s.jsx("div",{className:"absolute w-4 h-4 border-2 border-white rounded-full bg-red-500 shadow-lg z-30 pointer-events-none transform -translate-x-2 -translate-y-2",style:{left:`${A.previewPosition.x}%`,top:`${A.previewPosition.y}%`}}),(n==null?void 0:n.role)==="administrator"&&s.jsxs("div",{className:"absolute top-4 sm:top-6 right-4 sm:right-6 z-20 flex items-center gap-2",children:[s.jsxs("button",{onClick:Q,className:"flex items-center gap-1 px-2.5 sm:px-3 py-1 sm:py-1 rounded-full bg-black/30 hover:bg-black/50 backdrop-blur-sm border border-white/20 hover:border-white/30 text-white font-medium text-xs sm:text-sm shadow-lg transition-all duration-200",title:" ",children:[s.jsx("svg",{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})}),s.jsx("span",{className:"hidden sm:inline",children:""})]}),s.jsxs("div",{className:"flex items-center gap-1 px-2.5 sm:px-3 py-1 sm:py-1 rounded-full bg-gradient-to-r from-purple-400 to-purple-500 text-white font-semibold text-xs sm:text-sm shadow-lg",children:[s.jsx(ys,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),s.jsx("span",{className:"hidden sm:inline",children:" "}),s.jsx("span",{className:"inline sm:hidden",children:""})]})]}),s.jsx("div",{className:"relative z-10 w-full p-4 sm:p-6 md:p-8",children:s.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2 sm:mb-3 leading-tight drop-shadow-lg uppercase font-sns whitespace-pre-line",children:l.title}),l.description&&s.jsx("p",{className:"text-white/90 text-xs sm:text-sm md:text-base leading-relaxed max-w-2xl drop-shadow mb-2 sm:mb-3 line-clamp-2 sm:line-clamp-none",children:l.description})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-start sm:items-center gap-2 sm:gap-4 md:gap-6 text-xs sm:text-sm text-white/90 drop-shadow",children:[l.start_date&&s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[s.jsx(zt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-white/80 flex-shrink-0"}),s.jsxs("span",{className:"font-medium truncate",children:[new Date(l.start_date).toLocaleString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),l.end_date&&l.end_date!==l.start_date&&` - ${new Date(l.end_date).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}`]})]}),l.location&&s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[s.jsx(nr,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-white/80 flex-shrink-0"}),s.jsx("span",{className:"font-medium truncate",children:l.location})]}),s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[s.jsx(nt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-white/80 flex-shrink-0"}),s.jsxs("span",{className:"font-medium",children:[c.length," "]})]})]}),s.jsxs("div",{className:"flex flex-col items-start gap-2 sm:gap-3 mt-3 sm:mt-0",children:[s.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 list-none",style:{listStyle:"none"},children:s.jsx("span",{className:`px-3 sm:px-4 py-2 sm:py-2.5 rounded-xl text-white font-medium text-xs sm:text-sm shadow-lg border border-white/20 ${l.status==="published"?"bg-green-500":l.status==="draft"?"bg-yellow-500":l.status==="completed"?"bg-blue-500":"bg-gray-500"}`,children:pe(l.status)})}),s.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:(n==null?void 0:n.role)==="administrator"&&s.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors shadow-lg hover:shadow-xl",children:[s.jsx(rx,{className:"w-4 h-4"}),"  "]})})]})]})})]})}),(n==null?void 0:n.role)==="administrator"&&A.showAdminControls&&s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6 mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 mr-2 text-[#06A478]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})," "]}),s.jsx("button",{onClick:te,className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${A.showVisualEditor?"bg-[#06A478] text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:A.showVisualEditor?" ":" "})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"center top",label:"-"},{value:"center center",label:"-"},{value:"center bottom",label:"-"},{value:"left top",label:"-"},{value:"left center",label:"-"},{value:"left bottom",label:"-"},{value:"right top",label:"-"},{value:"right center",label:"-"},{value:"right bottom",label:"-"}].map(ne=>s.jsx("button",{onClick:()=>re(ne.value),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${A.position===ne.value?"bg-[#06A478] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:ne.label},ne.value))})]}),s.jsxs("div",{className:"pt-4 border-t border-gray-200 space-y-3",children:[s.jsxs("div",{className:"text-sm text-gray-500",children:[" : ",s.jsx("span",{className:"font-medium",children:A.position})]}),A.showVisualEditor&&s.jsxs("div",{className:"text-sm text-gray-500",children:[": ",s.jsxs("span",{className:"font-medium",children:["X: ",Math.round(A.previewPosition.x),"%, Y: ",Math.round(A.previewPosition.y),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[A.showVisualEditor&&s.jsx("div",{className:"text-xs text-gray-400",children:"        "}),s.jsx("button",{onClick:Q,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:""})]})]})]})]}),s.jsxs("div",{className:`hidden md:block ${f?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border mb-8 transition-all duration-300 ${W?"opacity-0 pointer-events-none transform scale-95":"opacity-100"}`,children:[s.jsx("div",{className:`border-b ${f?"border-gray-700":"border-gray-200"}`,children:s.jsxs("nav",{className:"flex space-x-8 px-6",children:[s.jsxs("button",{onClick:()=>t(`/expert-exam/${e}`),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${m==="participants"?"border-[#06A478] text-[#06A478]":f?"border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-500":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(nt,{className:"w-4 h-4 inline mr-2"})," (",c.length,")"]}),s.jsxs("button",{onClick:()=>t(`/expert-exam/${e}/schedule`),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${m==="schedule"?"border-[#06A478] text-[#06A478]":f?"border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-500":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(zt,{className:"w-4 h-4 inline mr-2"}),""]}),(n==null?void 0:n.role)==="administrator"&&s.jsxs("button",{onClick:()=>T(!0),className:`py-4 px-1 border-b-2 border-transparent font-medium text-sm transition-colors ${f?"text-gray-400 hover:text-gray-200 hover:border-gray-500":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(ys,{className:"w-4 h-4 inline mr-2"})," "]})]})}),s.jsxs("div",{className:"p-3 md:pb-6",children:[m==="participants"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "}),c.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"  "})]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-3 sm:gap-4",children:c.map((ne,_e)=>s.jsx("div",{className:`card-enter ${_e<6?`card-stagger-${_e%6+1}`:""}`,style:{opacity:0},children:s.jsx(t6,{participant:ne,dossier:ne.dossier?{...ne.dossier,user_id:ne.user.id}:void 0,onRate:()=>{B(ne),M(!0)},onViewDossier:Te=>{D(Te)},onRemove:ue,showRemoveButton:(n==null?void 0:n.role)==="administrator"})},ne.id))})]}),m==="evaluations"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:(n==null?void 0:n.role)==="administrator"?"  ":" "}),x.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ms,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"  "})]}):s.jsx("div",{className:"space-y-4",children:x.map(ne=>{var Me;const _e=c.find(ye=>ye.user_id===ne.reservist_id);let Te=null;return(n==null?void 0:n.role)==="administrator"&&ne.evaluator_id&&(Te={email:""}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:(_e==null?void 0:_e.user.full_name)||" "}),s.jsx("p",{className:"text-sm text-gray-500",children:ne.stage}),(n==null?void 0:n.role)==="administrator"&&Te&&s.jsxs("p",{className:"text-xs text-gray-400",children:[": ",Te.email]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-[#06A478]",children:((Me=ne.scores)==null?void 0:Me.total_score)||0}),s.jsx("p",{className:"text-sm text-gray-500",children:""})]})]}),ne.comments&&s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:ne.comments})]},ne.id)})})]}),m==="schedule"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "}),!(l!=null&&l.detailed_schedule)||l.detailed_schedule.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(zt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"  "})]}):s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"hidden sm:block absolute left-8 top-0 bottom-0 w-1 bg-gradient-to-b from-[#06A478]/30 via-[#06A478]/60 to-[#06A478]/30 z-0"}),s.jsx("div",{className:"space-y-4 sm:space-y-6",children:l.detailed_schedule.map((ne,_e)=>{var Te;return s.jsxs("div",{className:"group relative",children:[s.jsx("div",{className:"hidden sm:block absolute left-[30px] top-[18px] w-4 h-4 bg-white border-4 border-[#06A478] rounded-full shadow-lg z-20 group-hover:scale-125 transition-transform duration-200"}),s.jsx("div",{className:"sm:ml-12 relative",children:s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm hover:shadow-xl transition-all duration-300 group-hover:border-[#06A478]/30 group-hover:-translate-y-1 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-[#06A478]/5 via-[#06A478]/10 to-[#06A478]/5 px-4 py-3 sm:px-6 sm:py-4 border-b border-[#06A478]/20",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"bg-[#06A478] text-white px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-bold shadow-sm",children:ne.time||ne.startTime||"  "}),ne.endTime&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center text-[#06A478]/60",children:[s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"}),s.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-[#06A478]/50 rounded-full mx-1"}),s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"})]}),s.jsx("div",{className:"bg-gray-100 text-gray-700 px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium border border-gray-200",children:ne.endTime})]}),!ne.endTime&&s.jsxs("div",{className:"flex items-center text-[#06A478]/60",children:[s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"}),s.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-[#06A478]/50 rounded-full mx-1"}),s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"})]}),ne.duration&&s.jsx("div",{className:"bg-gray-100 text-gray-700 px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium border border-gray-200",children:ne.duration})]})}),s.jsx("div",{className:"flex items-center justify-between sm:justify-end space-x-2",children:ne.type&&s.jsx("div",{className:"bg-gradient-to-r from-[#06A478]/10 to-[#06A478]/20 text-[#06A478] px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium border border-[#06A478]/30",children:ne.type})})]})}),s.jsxs("div",{className:"p-4 sm:p-6",children:[s.jsx("h4",{className:"text-base sm:text-lg font-bold text-gray-900 mb-2 group-hover:text-[#06A478] transition-colors",children:ne.title}),ne.description&&s.jsx("div",{className:"mt-3",children:s.jsx("p",{className:"text-gray-600 leading-relaxed text-sm",children:ne.description})}),s.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm text-gray-600",children:[ne.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(nr,{className:"h-4 w-4"}),s.jsx("span",{children:ne.location})]}),ne.speaker&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qt,{className:"h-4 w-4"}),s.jsx("span",{children:ne.speaker})]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-[#06A478] to-[#059669] rounded-full transition-all duration-1000",style:{width:`${(_e+1)/(((Te=l.detailed_schedule)==null?void 0:Te.length)||1)*100}%`}})})})]})]})})]},ne.id||_e)})})]})]})]})]}),s.jsx("div",{className:"md:hidden bg-white rounded-2xl shadow-lg border border-gray-200 mb-8",children:s.jsxs("div",{className:"p-3",children:[m==="participants"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "}),c.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"  "})]}):s.jsx("div",{className:"space-y-3",children:c.map(ne=>s.jsx(t6,{participant:ne,dossier:ne.dossier?{...ne.dossier,user_id:ne.user.id}:void 0,onRate:()=>{B(ne),M(!0)},onViewDossier:_e=>{D(_e)},onRemove:ue,showRemoveButton:(n==null?void 0:n.role)==="administrator"},ne.id))})]}),m==="evaluations"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "}),x.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ms,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"  "})]}):s.jsx("div",{className:"space-y-4",children:x.map(ne=>{var Me;const _e=c.find(ye=>ye.user_id===ne.reservist_id),Te=ne.evaluator_id?{email:"expert@example.com"}:null;return s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:(_e==null?void 0:_e.user.full_name)||" "}),s.jsx("p",{className:"text-sm text-gray-500",children:ne.stage}),(n==null?void 0:n.role)==="administrator"&&Te&&s.jsxs("p",{className:"text-xs text-gray-400",children:[": ",Te.email]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-[#06A478]",children:((Me=ne.scores)==null?void 0:Me.total_score)||0}),s.jsx("p",{className:"text-sm text-gray-500",children:""})]})]}),ne.comments&&s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:ne.comments})]},ne.id)})})]}),m==="schedule"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "}),!(l!=null&&l.detailed_schedule)||l.detailed_schedule.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(zt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"  "})]}):s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"hidden sm:block absolute left-8 top-0 bottom-0 w-1 bg-gradient-to-b from-[#06A478]/30 via-[#06A478]/60 to-[#06A478]/30 z-0"}),s.jsx("div",{className:"space-y-4 sm:space-y-6",children:l.detailed_schedule.map((ne,_e)=>{var Te;return s.jsxs("div",{className:"group relative",children:[s.jsx("div",{className:"hidden sm:block absolute left-[30px] top-[18px] w-4 h-4 bg-white border-4 border-[#06A478] rounded-full shadow-lg z-20 group-hover:scale-125 transition-transform duration-200"}),s.jsx("div",{className:"sm:ml-12 relative",children:s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm hover:shadow-xl transition-all duration-300 group-hover:border-[#06A478]/30 group-hover:-translate-y-1 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-[#06A478]/5 via-[#06A478]/10 to-[#06A478]/5 px-4 py-3 sm:px-6 sm:py-4 border-b border-[#06A478]/20",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"bg-[#06A478] text-white px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-bold shadow-sm",children:ne.time||ne.startTime||"  "}),ne.endTime&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center text-[#06A478]/60",children:[s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"}),s.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-[#06A478]/50 rounded-full mx-1"}),s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"})]}),s.jsx("div",{className:"bg-gray-100 text-gray-700 px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium border border-gray-200",children:ne.endTime})]}),!ne.endTime&&s.jsxs("div",{className:"flex items-center text-[#06A478]/60",children:[s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"}),s.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-[#06A478]/50 rounded-full mx-1"}),s.jsx("div",{className:"w-4 h-0.5 sm:w-6 bg-[#06A478]/30"})]}),ne.duration&&s.jsx("div",{className:"bg-gray-100 text-gray-700 px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium border border-gray-200",children:ne.duration})]})}),s.jsx("div",{className:"flex items-center justify-between sm:justify-end space-x-2",children:ne.type&&s.jsx("div",{className:"bg-gradient-to-r from-[#06A478]/10 to-[#06A478]/20 text-[#06A478] px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium border border-[#06A478]/30",children:ne.type})})]})}),s.jsxs("div",{className:"p-4 sm:p-6",children:[s.jsx("h4",{className:"text-base sm:text-lg font-bold text-gray-900 mb-2 group-hover:text-[#06A478] transition-colors",children:ne.title}),ne.description&&s.jsx("div",{className:"mt-3",children:s.jsx("p",{className:"text-gray-600 leading-relaxed text-sm",children:ne.description})}),s.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm text-gray-600",children:[ne.location&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(nr,{className:"h-4 w-4"}),s.jsx("span",{children:ne.location})]}),ne.speaker&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qt,{className:"h-4 w-4"}),s.jsx("span",{children:ne.speaker})]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-[#06A478] to-[#059669] rounded-full transition-all duration-1000",style:{width:`${(_e+1)/(((Te=l.detailed_schedule)==null?void 0:Te.length)||1)*100}%`}})})})]})]})})]},ne.id||_e)})})]})]})]})})]}),j&&(()=>{const ne=c.find(_e=>_e.user.id===j);return ne?s.jsx(Nne,{isOpen:!!j,onClose:()=>D(null),onBack:()=>{D(null),b("participants")},user:ne.user,dossier:ne.dossier?{...ne.dossier,user_id:ne.user.id}:void 0}):null})(),s.jsx(Fne,{isOpen:R,onClose:()=>{console.log("  EvaluationStageModal"),M(!1),B(null),setTimeout(()=>{document.body.style.overflow="",document.body.style.position="",document.body.style.width="",console.log("   ")},50),console.log(" EvaluationStageModal ")},onStageSelect:ne=>{ne!=="case-solving"&&(M(!1),ne==="project-defense"?U(!0):ne==="diagnostic-game"&&F(!0))},onCaseEvaluationComplete:async()=>{await Y()},participantName:(O==null?void 0:O.user.full_name)||"",participantPhoto:(Ne=O==null?void 0:O.dossier)==null?void 0:Ne.photo_url,examId:e||"",participantId:(O==null?void 0:O.user.id)||"",evaluations:x,onModalStateChange:ne=>{k(ne)}}),O&&s.jsx(Tne,{isOpen:L,onClose:()=>{U(!1),B(null)},participantId:O.user.id,participantName:O.user.full_name,examId:e||"",onEvaluationComplete:async()=>{await V()},onRemoveEvaluation:async()=>{await V()},onModalStateChange:ne=>{k(ne)}}),O&&s.jsx(Mne,{isOpen:P,onClose:()=>{F(!1),B(null)},participantId:O.user.id,participantName:O.user.full_name,examId:e||"",onEvaluationComplete:async()=>{await V()},onRemoveEvaluation:async()=>{await V()},onModalStateChange:ne=>{k(ne)}}),N&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"  "}),s.jsx("button",{onClick:()=>T(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-80px)]",children:e&&s.jsx(Rne,{examEventId:e})})]})}),s.jsx(One,{onClick:()=>C(!0),icon:s.jsx(zt,{className:"w-5 h-5"}),label:"",position:"bottom-right",size:"md",color:"primary"}),s.jsx(Pne,{isOpen:_,onClose:()=>C(!1),schedule:(l==null?void 0:l.detailed_schedule)||[],examTitle:(l==null?void 0:l.title)||" "}),s.jsx(l7,{isOpen:S,onClose:()=>z(!1),examId:e||"",participants:c,onAssignmentSaved:async()=>{z(!1),await H()}})]})},Lne=()=>{var O,B;const{examId:e}=gi(),[t]=x_(),r=Qt(),{user:a}=st(),n=t.get("participantId"),i=parseInt(t.get("caseNumber")||"1"),[l,o]=E.useState(null),[c,d]=E.useState({exam_event_id:e||"",reservist_id:n||"",evaluator_id:(a==null?void 0:a.id)||"",case_number:i,criteria_scores:{correctness:0,clarity:0,independence:0},comments:""}),[x,u]=E.useState(!0),[f,h]=E.useState(!1),[p,g]=E.useState(!1),[y,v]=E.useState(!0);E.useEffect(()=>{e&&n&&(w(),m(),b())},[e,n,i]);const w=async()=>{if(n)try{const{data:L,error:U}=await Z.from("event_participants").select(`
          id,
          user:users (
            id,
            full_name,
            email,
            position:positions (name),
            territory:territories (name)
          )
        `).eq("user_id",n).eq("event_id",e).single();if(U)throw U;o(L)}catch(L){console.error("   :",L)}},m=async()=>{if(!(!e||!n||!(a!=null&&a.id)))try{const{data:L,error:U}=await Z.from("case_evaluations").select("*").eq("exam_event_id",e).eq("reservist_id",n).eq("evaluator_id",a.id).eq("case_number",i).single();L&&!U&&(d(P=>({...P,...L,criteria_scores:L.criteria_scores||P.criteria_scores})),g(!0))}catch{console.log("  ,  ")}finally{u(!1)}},b=async()=>{if(!(!e||!n))try{const{data:L,error:U}=await Z.from("case_assignments").select("case_numbers").eq("exam_event_id",e).eq("participant_id",n).single();if(U&&U.code!=="PGRST116"){console.error("   :",U),v(!0);return}if(L){const P=L.case_numbers||[];v(P.includes(i))}else v(!0)}catch(L){console.error("   :",L),v(!0)}},_=(L,U)=>{d(P=>({...P,criteria_scores:{...P.criteria_scores,[L]:U}})),g(!1)},C=L=>{d(U=>({...U,comments:L})),g(!1)},j=async()=>{if(!(!e||!n||!(a!=null&&a.id))){h(!0);try{const L={exam_event_id:e,reservist_id:n,evaluator_id:a.id,case_number:i,criteria_scores:c.criteria_scores,comments:c.comments||null,updated_at:new Date().toISOString()};if(c.id){const{error:U}=await Z.from("case_evaluations").update(L).eq("id",c.id);if(U)throw U}else{const{data:U,error:P}=await Z.from("case_evaluations").insert([{...L,created_at:new Date().toISOString()}]).select().single();if(P)throw P;d(F=>({...F,id:U.id}))}g(!0),setTimeout(()=>g(!1),3e3)}catch(L){console.error("  :",L),alert("  ")}finally{h(!1)}}},D=()=>{const{correctness:L,clarity:U,independence:P}=c.criteria_scores,F=[L,U,P].filter(T=>T>0);if(F.length===0)return 0;const N=F.reduce((T,S)=>T+S,0)/F.length;return Math.round(N*10)/10},R=L=>L>=4?"text-green-600":L>=3?"text-yellow-600":"text-red-600",M=[{key:"correctness",title:"  ",description:"   ",icon:at},{key:"clarity",title:" ",description:"    ",icon:La},{key:"independence",title:" ",description:"    - ",icon:qt}];return x?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"..."})]})}):y?s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>r(-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(kn,{className:"w-5 h-5 text-gray-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-xl flex items-center justify-center",children:s.jsx(Et,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",style:{fontFamily:"SNS, sans-serif"},children:["   #",i]}),s.jsx("p",{className:"text-gray-600",children:(l==null?void 0:l.user.full_name)||""})]})]}),((O=l==null?void 0:l.user.position)==null?void 0:O.name)&&s.jsxs("div",{className:"text-sm text-gray-500",children:[l.user.position.name,((B=l.user.territory)==null?void 0:B.name)&&`  ${l.user.territory.name}`]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-emerald-600",children:[D(),s.jsx("span",{className:"text-gray-400",children:"/5"})]}),s.jsx("div",{className:"text-sm text-gray-500",children:" "})]})]})})}),s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",style:{fontFamily:"SNS, sans-serif"},children:" "}),M.map(L=>{const U=L.icon,P=c.criteria_scores[L.key];return s.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-emerald-50 rounded-xl flex items-center justify-center",children:s.jsx(U,{className:"w-6 h-6 text-emerald-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:L.title}),s.jsx("p",{className:"text-gray-600 text-sm",children:L.description})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:`text-2xl font-bold ${R(P)}`,children:[P,s.jsx("span",{className:"text-gray-400",children:"/5"})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(F=>s.jsx("button",{onClick:()=>_(L.key,F),className:`flex-1 h-12 rounded-xl border-2 transition-all duration-200 font-semibold ${P===F?"border-emerald-500 bg-emerald-500 text-white shadow-lg":"border-gray-200 bg-white text-gray-600 hover:border-emerald-300 hover:bg-emerald-50"}`,children:F},F))}),s.jsxs("div",{className:"flex gap-2",children:[[1.5,2.5,3.5,4.5].map(F=>s.jsx("button",{onClick:()=>_(L.key,F),className:`flex-1 h-12 rounded-xl border-2 transition-all duration-200 font-semibold ${P===F?"border-emerald-300 bg-emerald-100 text-emerald-700 shadow-sm":"border-gray-200 bg-gray-25 text-gray-400 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-500"}`,children:F},F)),s.jsx("div",{className:"flex-1"})]})]})]},L.key)})]}),s.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:[" ",s.jsx("span",{className:"text-gray-400 font-normal",children:"( )"})]}),s.jsx("textarea",{value:c.comments||"",onChange:L=>C(L.target.value),placeholder:"     ...",className:"w-full h-32 px-4 py-3 border border-gray-200 rounded-xl resize-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors"})]}),s.jsxs("div",{className:"flex gap-4 justify-end",children:[s.jsx("button",{onClick:()=>r(-1),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:""}),s.jsx("button",{onClick:j,disabled:f||D()===0,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all ${f||D()===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg hover:shadow-xl"}`,children:f?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"..."]}):p?s.jsxs(s.Fragment,{children:[s.jsx(at,{className:"w-4 h-4"}),""]}):s.jsxs(s.Fragment,{children:[s.jsx(Ps,{className:"w-4 h-4"})," "]})})]})]})})]}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(AlertCircle,{className:"w-8 h-8 text-red-600"})}),s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"  "}),s.jsxs("p",{className:"text-gray-600 mb-6",children:[" #",i,"    ",(l==null?void 0:l.user.full_name)||" ",".      ."]}),s.jsx("button",{onClick:()=>r(-1),className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:" "})]})})},Ine=({isOpen:e,onClose:t,examId:r,examTitle:a,scheduleItems:n,onSuccess:i})=>{const[l,o]=E.useState([]),[c,d]=E.useState(""),[x,u]=E.useState(""),[f,h]=E.useState(1),[p,g]=E.useState(!1),[y,v]=E.useState(null);E.useEffect(()=>{e&&w()},[e]);const w=async()=>{try{g(!0),v(null);const{data:_,error:C}=await Z.from("users").select(`
          id,
          full_name,
          email,
          dossier:user_doirp(age)
        `).eq("role","reservist").order("full_name");if(C){console.error("  :",C),v("   ");return}o(_||[])}catch(_){console.error(" fetchReservists:",_),v("  ")}finally{g(!1)}},m=async _=>{if(_.preventDefault(),!c||!x){v(",     ");return}try{g(!0),v(null);const{error:C}=await Z.from("event_participants").insert({event_id:r,user_id:c,status:"confirmed"});if(C){console.error("  :",C),v("     ");return}const{error:j}=await Z.from("presentation_assignments").insert({event_id:r,user_id:c,presentation_number:f,stage:x});if(j){console.error("  :",j),v("   ");return}i(),t()}catch(C){console.error("  :",C),v("  ")}finally{g(!1)}},b=_=>{if(!_)return"";const C=_%10,j=_%100;return j>=11&&j<=19?`${_} `:C===1?`${_} `:C>=2&&C<=4?`${_} `:`${_} `};return e?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#06A478]/5 via-[#06A478]/10 to-[#06A478]/5",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-[#06A478] rounded-lg",children:s.jsx(ax,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"   "}),s.jsx("p",{className:"text-sm text-gray-600",children:a})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Qe,{className:"w-5 h-5 text-gray-500"})})]})}),s.jsx("div",{className:"p-6 max-h-[calc(90vh-120px)] overflow-y-auto",children:s.jsxs("form",{onSubmit:m,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsxs("select",{value:c,onChange:_=>d(_.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#06A478]/20 focus:border-[#06A478] transition-colors",required:!0,children:[s.jsx("option",{value:"",children:" "}),l.map(_=>{var C;return s.jsxs("option",{value:_.id,children:[_.full_name," ",((C=_.dossier)==null?void 0:C.age)&&`(${b(_.dossier.age)})`]},_.id)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"  "}),s.jsxs("select",{value:x,onChange:_=>u(_.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#06A478]/20 focus:border-[#06A478] transition-colors",required:!0,children:[s.jsx("option",{value:"",children:" "}),n.map((_,C)=>s.jsxs("option",{value:_.title,children:[_.title," ",_.time&&`(${_.time})`]},_.id||C))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsx("input",{type:"number",value:f,onChange:_=>h(parseInt(_.target.value)||1),min:"1",max:"999",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#06A478]/20 focus:border-[#06A478] transition-colors",required:!0})]}),y&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx(ar,{className:"w-5 h-5 text-red-500"}),s.jsx("span",{className:"text-red-700 text-sm",children:y})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-semibold",children:""}),s.jsx("button",{type:"submit",disabled:p||!c||!x,className:"flex-1 px-6 py-3 text-white rounded-lg transition-all duration-200 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",style:{background:"linear-gradient(to right, #06A478, #059669)"},children:p?"...":" "})]})]})})]})}):null},Une=()=>{const{userProfile:e}=st(),t=Qt(),[r,a]=E.useState([]),[n,i]=E.useState(!0),[l,o]=E.useState(null),[c,d]=E.useState(!1),[x,u]=E.useState(null);E.useEffect(()=>{console.log(" useEffect triggered:",{userProfileEmail:e==null?void 0:e.email,userProfileRole:e==null?void 0:e.role}),e!=null&&e.email?(console.log(" Starting fetchExpertExams..."),f()):console.log(" Skipping fetchExpertExams - no email")},[e==null?void 0:e.email]);const f=async()=>{if(!(e!=null&&e.email)){console.log("  email ");return}try{i(!0),o(null);let v=Z.from("events").select(`
          id,
          title,
          description,
          location,
          start_date,
          end_date,
          detailed_schedule,
          expert_emails,
          event_types(name, name_ru),
          talent_categories(name, name_ru),
          participants:event_participants(
            id,
            user:users(id, full_name)
          )
        `).eq("event_types.name","exam_talent_reserve").order("start_date",{ascending:!0});e.role==="expert"&&(v=v.contains("expert_emails",[e.email]));const{data:w,error:m}=await v;if(m){console.error("   :",m),console.error("  :",{code:m.code,message:m.message,details:m.details,hint:m.hint}),o(`  : ${m.message}`);return}if(console.log("  :",w),console.log("  :",(w==null?void 0:w.length)||0),!w||w.length===0){console.log("    "),o("  ");return}a(w)}catch(v){console.error("  fetchExpertExams:",v),o("  ")}finally{i(!1)}},h=v=>{try{const w=new Date(v);return isNaN(w.getTime())?(console.error("Invalid date:",v),"  "):w.toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric",weekday:"long"})}catch(w){return console.error("Error formatting date:",w),"  "}},p=(v,w)=>{try{const b=new Date().toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",timeZone:"Europe/Moscow"}),[_,C]=b.split(":").map(Number),[j,D]=v.split(":").map(Number),[R,M]=w.split(":").map(Number),O=_*60+C,B=j*60+D,L=R*60+M;return O>=B&&O<=L}catch(m){return console.error("Error checking current time:",m),!1}},g=v=>{u(v),d(!0)},y=()=>{f()};return console.log(" ExpertSchedulePage render:",{loading:n,userProfile:e==null?void 0:e.email,examsCount:r.length,error:l}),n||!e?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Er,{className:"w-10 h-10 text-blue-500 animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:e?" ...":"  ..."})]})}):l?(console.log("  :",l),s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-red-500 text-xl mb-4",children:""}),s.jsx("p",{className:"text-gray-600 mb-4",children:l}),s.jsx("button",{onClick:f,className:"px-4 py-2 text-white rounded-lg transition-all duration-200 font-semibold",style:{backgroundColor:"#06A478",":hover":{backgroundColor:"#059669"}},onMouseEnter:v=>v.target.style.backgroundColor="#059669",onMouseLeave:v=>v.target.style.backgroundColor="#06A478",children:" "})]})})):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100",children:[s.jsx("div",{className:"bg-white border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:()=>t(-1),className:"mr-4 p-2 rounded-lg hover:bg-gray-100",children:s.jsx(kn,{className:"w-5 h-5 text-gray-600"})}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(zt,{className:"w-6 h-6 mr-3",style:{color:"#06A478"}}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold text-gray-900",style:{lineHeight:"1.1"},children:" "}),s.jsx("p",{className:"text-sm text-gray-500",children:(e==null?void 0:e.role)==="administrator"?"   ":"  "})]})]})]}),(e==null?void 0:e.role)==="administrator"&&r.length>0&&s.jsxs("button",{onClick:()=>g(r[0]),className:"px-4 py-2 text-white rounded-lg transition-all duration-200 font-semibold text-sm flex items-center gap-2 shadow-lg hover:shadow-xl active:scale-[0.98]",style:{background:"linear-gradient(to right, #06A478, #059669)"},children:[s.jsx(ax,{className:"w-4 h-4"})," "]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto py-8",children:r.length===0?s.jsxs("div",{className:"text-center py-12 px-4",children:[s.jsx(zt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:(e==null?void 0:e.role)==="administrator"?"   ":"  "}),s.jsx("p",{className:"text-gray-500",children:(e==null?void 0:e.role)==="administrator"?"      ":"       "})]}):s.jsx("div",{className:"space-y-4 sm:space-y-6",children:r.map(v=>s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200",children:[s.jsx("div",{className:"p-4 border-b border-gray-100",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",style:{lineHeight:"1.1"},children:v.title}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(zt,{className:"w-4 h-4 mr-2 text-gray-400"}),s.jsx("span",{children:h(v.start_date)})]})]})}),s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"grid grid-cols-1 gap-y-2",children:(v.detailed_schedule&&v.detailed_schedule.length>0?v.detailed_schedule:[{startTime:"09:00",endTime:"09:30",title:" -",duration:"30 ",description:""},{startTime:"09:30",endTime:"09:35",title:" ",duration:"5 ",description:"    . ."},{startTime:"09:35",endTime:"12:30",title:"    ",duration:"2 55 ",description:"5   , 20     2-   , 30    2-   "},{startTime:"12:30",endTime:"13:30",title:"",duration:"1",description:""},{startTime:"13:30",endTime:"15:15",title:"   ",duration:"1 45 ",description:"5  -    , 20      "},{startTime:"15:15",endTime:"15:30",title:"-",duration:"15 ",description:""},{startTime:"15:30",endTime:"17:20",title:'  " "',duration:"1 50 ",description:"5   , 40 .    -  , 40 .     "},{startTime:"17:20",endTime:"17:35",title:"  ",duration:"15 ",description:"  "},{startTime:"17:35",endTime:"18:00",title:"   ",duration:"25 ",description:"  ,     , "}]).map((m,b)=>{const _=p(m.startTime||"",m.endTime||"");return s.jsx("div",{className:"group relative",children:s.jsx("div",{className:"relative",children:s.jsxs("div",{className:`bg-white rounded-2xl border shadow-sm hover:shadow-xl transition-all duration-300 group-hover:-translate-y-1 overflow-hidden ${_?"border-[#06A478] shadow-lg ring-2 ring-[#06A478]/20":"border-gray-100 group-hover:border-[#06A478]/30"}`,children:[s.jsx("div",{className:`px-4 py-2.5 border-b ${_?"bg-gradient-to-r from-[#06A478]/10 via-[#06A478]/15 to-[#06A478]/10 border-[#06A478]/30":"bg-gradient-to-r from-[#06A478]/5 via-[#06A478]/10 to-[#06A478]/5 border-[#06A478]/20"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"px-2.5 py-1 rounded-md text-xs font-bold bg-[#06A478] text-white",children:m.time||m.startTime||"  "}),m.endTime&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-[#06A478]/60 text-xs",children:""}),s.jsx("div",{className:"bg-gray-100 text-gray-700 px-2.5 py-1 rounded-md text-xs font-medium",children:m.endTime})]}),_&&s.jsx("div",{className:"bg-[#06A478] text-white px-2.5 py-1 rounded-md text-xs font-bold animate-pulse",children:" "})]}),m.duration&&s.jsx("div",{className:"bg-gray-100 text-gray-700 px-2.5 py-1 rounded-md text-xs font-medium",children:m.duration})]})}),s.jsxs("div",{className:"px-4 py-3",children:[s.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-1.5",style:{lineHeight:"1.1"},children:m.title}),m.description&&s.jsx("p",{className:"text-gray-600 text-sm mb-2",style:{lineHeight:"1.1"},children:m.description})]})]})})},m.id||b)})})}),s.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100",children:s.jsxs("button",{onClick:()=>t(`/expert-exam/${v.id}`),className:"w-full px-6 py-3 text-white rounded-lg transition-all duration-200 font-semibold text-sm shadow-lg hover:shadow-xl active:scale-[0.98] flex items-center justify-center gap-2",style:{minHeight:"48px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation",background:"linear-gradient(to right, #06A478, #059669)",":hover":{background:"linear-gradient(to right, #059669, #048A5A)"}},onMouseEnter:w=>w.target.style.background="linear-gradient(to right, #059669, #048A5A)",onMouseLeave:w=>w.target.style.background="linear-gradient(to right, #06A478, #059669)",children:[s.jsx(zt,{className:"w-4 h-4"}),"  "]})})]},v.id))})}),x&&s.jsx(Ine,{isOpen:c,onClose:()=>d(!1),examId:x.id,examTitle:x.title,scheduleItems:x.detailed_schedule||[],onSuccess:y})]})},Ju=({children:e,fallback:t})=>s.jsx(s.Fragment,{children:e}),$ne=e=>e.includes("/schedule")?"schedule":e.includes("/evaluations")?"evaluations":e.includes("/results")?"results":"participants",zne=()=>{const[e,t]=E.useState(!1),[r,a]=E.useState(!1),[n,i]=E.useState(!1),[l,o]=E.useState(!1),c=ul();Qt();const{userProfile:d}=st();$ne(c.pathname);const x=c.pathname.includes("/case-evaluation/")||c.pathname.includes("/evaluations")||c.pathname.includes("/expert-exam/")&&(c.pathname.includes("/evaluations")||c.pathname.includes("/dossiers"));return E.useEffect(()=>{const u=f=>{i(f.detail.isOpen)};return window.addEventListener("modalStateChange",u),()=>{window.removeEventListener("modalStateChange",u)}},[]),E.useEffect(()=>{const u=f=>{o(f.detail.isOpen)};return window.addEventListener("mobileMenuStateChange",u),()=>{window.removeEventListener("mobileMenuStateChange",u)}},[]),E.useEffect(()=>{const u=()=>a(window.matchMedia("(max-width: 767.98px)").matches);u();const f=()=>setTimeout(u,200);return window.addEventListener("resize",u),window.addEventListener("orientationchange",f),()=>{window.removeEventListener("resize",u),window.removeEventListener("orientationchange",f)}},[]),E.useEffect(()=>{if(r)return document.body.style.overflow="hidden",document.body.style.overscrollBehaviorY="none",document.body.style.WebkitOverflowScrolling="touch",()=>{document.body.style.overflow="",document.body.style.overscrollBehaviorY="",document.body.style.WebkitOverflowScrolling=""}},[r]),s.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100svh",width:"100vw",background:"#f8fafc",paddingTop:"0px",paddingLeft:"0px",paddingRight:"0px"},children:s.jsx("main",{style:{flex:"1 1 0%",minHeight:0,overflowY:"auto",WebkitOverflowScrolling:"touch",paddingBottom:x?"16px":"80px"},children:s.jsx(sB,{context:{setIsNavHidden:t}})})})},qne=(e,t,r)=>{const[a,n]=E.useState(null),[i,l]=E.useState([]),[o,c]=E.useState([]),[d,x]=E.useState(null),[u,f]=E.useState(!0),[h,p]=E.useState(null),[g,y]=E.useState(!1),[v,w]=E.useState(null),[m,b]=E.useState(0),_=E.useRef(null),C=E.useCallback(async()=>{try{f(!0),p(null);const{data:P,error:F}=await Z.from("tests").select("*").eq("id",e).single();if(F)throw F;n(P);const{data:N,error:T}=await Z.from("test_questions").select(`
          *,
          test_answers (*)
        `).eq("test_id",e).order("order");if(T)throw T;const S=(N||[]).map(I=>{var V;return{...I,answers:((V=I.test_answers)==null?void 0:V.sort((H,Y)=>H.order-Y.order))||[],correct_order:I.correct_order}});for(const I of S)if(I.question_type==="sequence"){const{data:V,error:H}=await Z.from("test_sequence_answers").select("*").eq("question_id",I.id).order("answer_order");!H&&V&&(I.answers=V.map(Y=>({...Y,text:Y.answer_text,order:Y.answer_order})))}const z=S;l(z);const{data:W,error:k}=await Z.from("user_test_attempts").select("*").eq("id",r).single();if(k)throw console.error("Error loading attempt:",k),k;console.log("Loaded attempt data:",W),console.log("Current question index from DB:",W==null?void 0:W.current_question_index),w(W);const{data:q,error:A}=await Z.from("user_test_answers").select("*").eq("attempt_id",r);if(A)throw A;if(q&&q.length>0){const I=q.map(V=>({questionId:V.question_id,answerId:V.answer_id,textAnswer:V.text_answer,marked:V.marked||!1,userOrder:V.user_order||void 0}));c(I),y(!0)}else{const I=z.map(V=>{if(V.question_type==="sequence"){const H=(V.answers||[]).map(Y=>String(Y.id)).sort(()=>Math.random()-.5);return{questionId:V.id,marked:!1,userOrder:H,textAnswer:"",answerId:""}}return{questionId:V.id,marked:!1,textAnswer:"",answerId:""}});c(I)}if(console.log("Setting initial question index:",W==null?void 0:W.current_question_index),(W==null?void 0:W.current_question_index)!==void 0&&(W==null?void 0:W.current_question_index)!==null?b(W.current_question_index):b(0),P.time_limit>0&&!W.completed_at&&W.started_at){const I=new Date(W.started_at).getTime();if(isNaN(I))x(P.time_limit*60);else{const V=Math.floor((Date.now()-I)/1e3),H=Math.max(0,P.time_limit*60-V);x(H)}}else P.time_limit>0&&x(P.time_limit*60)}catch(P){console.error("Error loading test data:",P),p("  ")}finally{f(!1)}},[e,r]);E.useEffect(()=>{if(!(d===null||d<=0))return _.current=setInterval(()=>{x(P=>P===null||P<=1?0:P-1)},1e3),()=>{_.current&&clearInterval(_.current)}},[d]);const j=E.useCallback(async P=>{try{const{error:F}=await Z.from("user_test_answers").upsert({attempt_id:r,question_id:P.questionId,answer_id:P.answerId,text_answer:P.textAnswer,marked:P.marked,user_order:P.userOrder||null});if(F)throw F}catch(F){console.error("Error saving answer:",F)}},[r]),D=E.useCallback((P,F,N,T)=>{const S={questionId:P,answerId:F,textAnswer:N,userOrder:T,marked:!0};c(z=>{const k=z.find(q=>q.questionId===P)?z.map(q=>q.questionId===P?{...q,...S}:q):[...z,S];return j(S),k})},[j]),R=E.useCallback(P=>{c(F=>{const N=F.find(S=>S.questionId===P),T=N?F.map(S=>S.questionId===P?{...S,marked:!S.marked}:S):[...F,{questionId:P,marked:!0}];return j(N?{...N,marked:!N.marked}:{questionId:P,marked:!0}),T})},[j]),M=E.useCallback(async P=>{try{console.log("Saving position:",P,"for attempt:",r);const{error:F}=await Z.from("user_test_attempts").update({current_question_index:P}).eq("id",r);if(F)throw console.error("Error saving position:",F),F;console.log("Position saved successfully")}catch(F){console.error("Error saving current position:",F)}},[r]),O=E.useCallback(async()=>{var P,F,N,T;try{const S=i.some(A=>A.question_type==="text");let z=0,W=0;for(const A of i){W+=A.points;const I=o.find(V=>V.questionId===A.id);if(I){if(A.question_type==="single_choice"){const V=(P=A.answers)==null?void 0:P.find(H=>H.is_correct);I.answerId===(V==null?void 0:V.id)&&(z+=A.points)}else if(A.question_type==="multiple_choice"){const V=((F=A.answers)==null?void 0:F.filter(Y=>Y.is_correct))||[];(((N=A.answers)==null?void 0:N.filter(Y=>V.some(Q=>Q.id===Y.id)&&Y.id===I.answerId))||[]).length===V.length&&(z+=A.points)}else if(A.question_type==="sequence"){const V=((T=A.answers)==null?void 0:T.sort((Y,Q)=>Y.order-Q.order).map(Y=>Y.id))||[],H=I.userOrder||[];V.length===H.length&&V.every((Y,Q)=>Y===H[Q])&&(z+=A.points)}}}const k=S?"pending_review":"completed";console.log("Updating attempt status:",{attemptId:r,status:k,totalScore:z,maxScore:W,hasOpenEndedQuestions:S});const{error:q}=await Z.from("user_test_attempts").update({status:k,completed_at:new Date().toISOString(),score:S?0:z,max_score:W,passed:S?!1:z>=((a==null?void 0:a.passing_score)||0)}).eq("id",r);if(q)throw console.error("Error updating attempt:",q),q;return console.log("Attempt updated successfully"),{score:z,maxScore:W,passed:z>=((a==null?void 0:a.passing_score)||0)}}catch(S){throw console.error("Error submitting test:",S),new Error("  ")}},[i,o,a,r]),B=E.useCallback(()=>i.map((P,F)=>{const N=o.find(T=>T.questionId===P.id);return{index:F,questionId:P.id,answered:!!(N!=null&&N.answerId||N!=null&&N.textAnswer||N!=null&&N.userOrder),marked:(N==null?void 0:N.marked)||!1}}),[i,o]),L=E.useCallback(P=>{if(!P){console.log("No questionId provided to getCurrentAnswer");return}const F=o.find(N=>N.questionId===P);return F||console.log("No answer found for question:",P,"Total answers:",o.length),F},[o]),U=E.useCallback(P=>{const F=Math.floor(P/3600),N=Math.floor(P%3600/60),T=P%60;return F>0?`${F}:${N.toString().padStart(2,"0")}:${T.toString().padStart(2,"0")}`:`${N}:${T.toString().padStart(2,"0")}`},[]);return E.useEffect(()=>{C()},[C]),{test:a,questions:i,userAnswers:o,timeRemaining:d,loading:u,error:h,hasExistingProgress:g,attempt:v,currentQuestionIndex:m,setCurrentQuestionIndex:b,updateAnswer:D,markQuestion:R,submitTest:O,getQuestionProgress:B,getCurrentAnswer:L,formatTime:U,loadTestData:C,saveCurrentPosition:M}},Vne=({questions:e,currentIndex:t,onQuestionSelect:r})=>{const a=e.filter(i=>i.answered).length,n=a/e.length*100;return s.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 rounded-b-3xl",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[": ",a,"  ",e.length]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(n),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-[#06A478] h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})})]}),s.jsx("div",{className:"grid grid-cols-10 gap-1 sm:gap-2",children:e.map((i,l)=>{const o=l===t,c=i.answered,d=i.marked;let x="bg-gray-100 text-gray-600",u="border-gray-200";return o?(x="bg-[#06A478] text-white",u="border-[#06A478]"):c?(x="bg-green-100 text-green-700",u="border-green-300"):d&&(x="bg-yellow-100 text-yellow-700",u="border-yellow-300"),s.jsxs("button",{onClick:()=>r(l),className:`
                w-7 h-7 sm:w-8 sm:h-8 rounded-xl font-semibold text-xs transition-all duration-200
                border-2 ${u} ${x}
                hover:scale-105 active:scale-95 hover:shadow-lg
                flex items-center justify-center relative touch-manipulation
              `,children:[l+1,d&&!o&&s.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-yellow-500 rounded-full"})]},i.questionId)})})]})},Hne=({currentIndex:e,totalQuestions:t,isLastQuestion:r,isFirstQuestion:a,isMarked:n,isSubmitting:i,onPrevious:l,onNext:o,onSubmit:c,onMarkQuestion:d})=>s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 safe-area-pb",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("button",{onClick:l,disabled:a,className:"flex items-center space-x-2 px-4 sm:px-6 py-2.5 sm:py-3 text-gray-600 disabled:text-gray-400 disabled:cursor-not-allowed hover:text-gray-900 text-sm sm:text-base font-semibold transition-all duration-200 touch-manipulation min-h-[44px]",children:[s.jsx(Sn,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:""})]}),s.jsxs("button",{onClick:d,className:`flex items-center space-x-2 px-4 sm:px-6 py-2.5 sm:py-3 rounded-xl text-sm sm:text-base font-semibold transition-all duration-200 touch-manipulation min-h-[44px] ${n?"bg-yellow-100 text-yellow-700 shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:shadow-lg"}`,children:[s.jsx(HM,{className:"w-4 h-4"}),s.jsx("span",{children:n?"":""})]}),r?s.jsxs("button",{onClick:c,disabled:i,className:"flex items-center space-x-2 bg-[#06A478] text-white px-4 sm:px-6 py-2.5 sm:py-3 rounded-xl text-sm sm:text-base font-semibold shadow-md hover:shadow-lg hover:bg-[#059669] disabled:opacity-50 transition-all duration-200 touch-manipulation min-h-[44px]",children:[i?s.jsx(Er,{className:"w-4 h-4 animate-spin"}):s.jsx(rl,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:""})]}):s.jsxs("button",{onClick:o,className:"flex items-center space-x-2 px-4 sm:px-6 py-2.5 sm:py-3 text-gray-600 hover:text-gray-900 text-sm sm:text-base font-semibold transition-all duration-200 touch-manipulation min-h-[44px]",children:[s.jsx("span",{className:"text-sm font-medium",children:""}),s.jsx(Fa,{className:"w-5 h-5"})]})]})}),Wne=({questionId:e,answers:t,userOrder:r=[],onOrderChange:a})=>{const[n,i]=E.useState(()=>r.length>0?r:t.map(d=>d.id).sort(()=>Math.random()-.5));E.useEffect(()=>{if(console.log("MobileSequenceQuestion useEffect:",{questionId:e,userOrder:r,answersLength:t.length,currentOrderLength:n.length}),r.length>0)JSON.stringify(r)!==JSON.stringify(n)&&i(r);else if(t.length>0&&n.length!==t.length){const d=t.map(x=>x.id).sort(()=>Math.random()-.5);console.log("Creating shuffled order for question:",e,d),i(d)}},[e,r,t,n]);const l=(d,x)=>{const u=[...n],f=x==="up"?d-1:d+1;f>=0&&f<u.length&&([u[d],u[f]]=[u[f],u[d]],i(u),a(e,u))},o=()=>{const d=t.map(x=>x.id).sort(()=>Math.random()-.5);i(d),a(e,d)},c=d=>t.find(x=>x.id===d);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"    :"}),s.jsxs("button",{onClick:o,className:"flex items-center space-x-1 text-xs text-[#06A478] hover:text-[#047857]",children:[s.jsx(X_,{className:"w-3 h-3"}),s.jsx("span",{children:""})]})]}),s.jsx("div",{className:"space-y-2",children:n.map((d,x)=>{const u=c(d);return u?s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white border-2 border-gray-200 rounded-xl shadow-sm",children:[s.jsx("div",{className:"w-8 h-8 bg-[#f0fdf4] text-[#06A478] rounded-lg flex items-center justify-center text-sm font-semibold",children:x+1}),s.jsx("span",{className:"text-gray-900 text-sm flex-1 leading-[1.2]",children:u.text}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("button",{onClick:()=>l(x,"up"),disabled:x===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:text-gray-200 disabled:cursor-not-allowed",children:s.jsx(Vc,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>l(x,"down"),disabled:x===n.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:text-gray-200 disabled:cursor-not-allowed",children:s.jsx(xi,{className:"w-4 h-4"})})]})]},d):null})}),s.jsx("div",{className:"text-xs text-gray-500 text-center",children:"      "})]})},Gne=e=>({single_choice:" ",multiple_choice:" ",sequence:"",text:" "})[e]||e,Yne=({testId:e,eventId:t,attemptId:r,onComplete:a,onCancel:n,onTestLoaded:i})=>{var I,V;const{userProfile:l}=st(),[o,c]=E.useState(!1),[d,x]=E.useState(!1),[u,f]=E.useState(!1),[h,p]=E.useState(!1),g=E.useRef(null),{test:y,questions:v,timeRemaining:w,loading:m,error:b,hasExistingProgress:_,attempt:C,currentQuestionIndex:j,setCurrentQuestionIndex:D,updateAnswer:R,markQuestion:M,submitTest:O,getQuestionProgress:B,getCurrentAnswer:L,loadTestData:U,saveCurrentPosition:P}=qne(e,t,r);E.useEffect(()=>{_&&f(!0)},[_]),E.useEffect(()=>{y!=null&&y.title&&(i==null||i(y.title))},[y==null?void 0:y.title,i]),E.useEffect(()=>{w===0&&S()},[w]);const F=v[j],N=L(F==null?void 0:F.id),T=B(),S=async()=>{if(!o)try{c(!0),console.log("Submitting test...");const H=await O();console.log("Test submitted successfully:",H),x(!0),g.current=setTimeout(()=>{console.log("Calling onComplete with score:",H.score),a(H.score)},3e3)}catch(H){console.error("Error submitting test:",H)}finally{c(!1)}},z=()=>{if(j<v.length-1){const H=j+1;D(H),P(H)}},W=()=>{if(j>0){const H=j-1;D(H),P(H)}},k=H=>{D(H),p(!1),P(H)},q=()=>{f(!1);const H=(C==null?void 0:C.current_question_index)??0,Y=T.reduce((te,re,X)=>re.answered?X:te,-1);let Q=H;H!=null&&H>=0?Q=H:Y>=0?Q=Y+1:Q=0,D(Math.min(Q,v.length-1))},A=()=>{D(0),f(!1),U()};return m?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Er,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),s.jsx("p",{className:"text-gray-600",children:" ..."})]})}):b?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx(an,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:""}),s.jsx("p",{className:"text-gray-600 mb-4",children:b}),s.jsx("button",{onClick:U,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:" "})]})}):u?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-md w-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx(X_,{className:"w-12 h-12 text-[#06A478] mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:" ?"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"    .     ?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("button",{onClick:q,className:"w-full bg-[#06A478] text-white py-3 rounded-lg font-medium hover:bg-[#047857]",children:""}),s.jsx("button",{onClick:A,className:"w-full bg-gray-200 text-gray-800 py-3 rounded-lg font-medium hover:bg-gray-300",children:" "})]})]})})}):d?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx(er,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:" !"}),s.jsx("p",{className:"text-gray-600",children:" ..."})]})}):!y||!F?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(lo,{className:"w-8 h-8 mx-auto mb-4 text-gray-400"}),s.jsx("p",{className:"text-gray-600",children:"  "})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsxs("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40 rounded-b-3xl",children:[s.jsx("div",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:n,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg",children:s.jsx(Qe,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"font-semibold text-gray-900 text-sm truncate max-w-[200px]",children:y.title}),s.jsxs("p",{className:"text-xs text-gray-500",children:[T.filter(H=>H.answered).length,"  ",v.length]})]})]}),s.jsx("button",{onClick:()=>p(!0),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg",children:s.jsx(xb,{className:"w-5 h-5"})})]})}),s.jsx(Vne,{questions:T,currentIndex:j,onQuestionSelect:k})]}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end",children:s.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-h-[70vh] overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"  "}),s.jsx("button",{onClick:()=>p(!1),className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(Qe,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"p-4 overflow-y-auto max-h-[50vh]",children:s.jsx("div",{className:"grid grid-cols-10 gap-1 sm:gap-2",children:v.map((H,Y)=>{const Q=T[Y],te=Q==null?void 0:Q.answered,re=Y===j;return s.jsx("button",{onClick:()=>k(Y),className:`
                        w-7 h-7 sm:w-8 sm:h-8 rounded-lg font-medium text-xs transition-all duration-300
                        ${re?"bg-[#06A478] text-white shadow-md":te?"bg-green-100 text-green-700 border-2 border-green-300 hover:shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:shadow-md"}
                        hover:scale-105 active:scale-95 touch-manipulation
                        flex items-center justify-center relative
                      `,children:Y+1},H.id)})})})]})}),s.jsx("main",{className:"pb-24",children:s.jsx("div",{className:"px-0",children:s.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-gray-200 overflow-hidden mx-0",children:[s.jsxs("div",{className:"py-6 px-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx("div",{className:"w-6 h-6 bg-[#06A478] rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-xs",children:j+1})}),s.jsx("span",{className:"text-xs font-medium text-gray-500",children:Gne(F.question_type)}),s.jsx("span",{className:"text-xs text-gray-400",children:""}),s.jsxs("span",{className:"text-xs text-gray-500",children:[F.points," ",F.points!==1?"":""]})]}),s.jsx("h2",{className:"font-semibold text-gray-900 text-lg leading-[1.2]",children:F.question})]}),s.jsxs("div",{className:"py-6 px-4",children:[F.question_type==="single_choice"&&s.jsx("div",{className:"space-y-3",children:(I=F.answers)==null?void 0:I.map(H=>s.jsxs("label",{className:`flex items-start space-x-3 p-4 rounded-xl border-2 cursor-pointer transition-all duration-200 hover:shadow-lg ${(N==null?void 0:N.answerId)===H.id?"border-[#06A478] bg-[#06A478]/15 shadow-md":"border-gray-200 hover:border-[#06A478]/50 hover:bg-gray-50/80 bg-white"}`,children:[s.jsx("input",{type:"radio",name:`question-${F.id}`,checked:(N==null?void 0:N.answerId)===H.id,onChange:()=>R(F.id,H.id),className:"mt-1 w-4 h-4 text-[#06A478] border-gray-300 focus:ring-[#06A478]"}),s.jsx("span",{className:"text-gray-900 text-sm leading-[1.2] flex-1",children:H.text})]},H.id))}),F.question_type==="multiple_choice"&&s.jsx("div",{className:"space-y-3",children:(V=F.answers)==null?void 0:V.map(H=>s.jsxs("label",{className:`flex items-start space-x-3 p-4 rounded-xl border-2 cursor-pointer transition-all duration-200 hover:shadow-lg ${(N==null?void 0:N.answerId)===H.id?"border-[#06A478] bg-[#06A478]/15 shadow-md":"border-gray-200 hover:border-[#06A478]/50 hover:bg-gray-50/80 bg-white"}`,children:[s.jsx("input",{type:"checkbox",checked:(N==null?void 0:N.answerId)===H.id,onChange:()=>R(F.id,H.id),className:"mt-1 w-4 h-4 text-[#06A478] border-gray-300 rounded focus:ring-[#06A478]"}),s.jsx("span",{className:"text-gray-900 text-sm leading-[1.2] flex-1",children:H.text})]},H.id))}),F.question_type==="text"&&s.jsx("div",{children:s.jsx("textarea",{value:(N==null?void 0:N.textAnswer)||"",onChange:H=>R(F.id,void 0,H.target.value),placeholder:"  ...",className:"w-full p-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-[#06A478] focus:border-transparent resize-none",rows:4})}),F.question_type==="sequence"&&s.jsx(Wne,{questionId:F.id,answers:F.answers||[],userOrder:N==null?void 0:N.userOrder,onOrderChange:(H,Y)=>{console.log("Sequence order change:",{questionId:H,newOrder:Y,currentAnswer:N}),R(H,void 0,void 0,Y)}})]})]})})}),s.jsx(Hne,{currentIndex:j,totalQuestions:v.length,isLastQuestion:j===v.length-1,isFirstQuestion:j===0,isMarked:(N==null?void 0:N.marked)||!1,isSubmitting:o,onPrevious:W,onNext:z,onSubmit:S,onMarkQuestion:()=>M(F.id)})]})};function Xne(e=768){const[t,r]=E.useState(!1);return E.useEffect(()=>{const a=()=>{const n=window.innerWidth,i=window.innerHeight,l=n<e,o=n<i&&n<=430||i<n&&i<=430,c=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);r(l||o||c)};return a(),window.addEventListener("resize",a),window.addEventListener("orientationchange",()=>{setTimeout(a,100)}),()=>{window.removeEventListener("resize",a),window.removeEventListener("orientationchange",a)}},[e]),t}function Kne(){return s.jsx("div",{style:{textAlign:"center",marginTop:40},children:"..."})}async function Qne({eventId:e,testId:t,userId:r}){console.log(" createAttempt   :",{eventId:e,testId:t,userId:r});const{data:a,error:n}=await Z.from("user_test_attempts").select("id, status").eq("event_id",e).eq("test_id",t).eq("user_id",r).maybeSingle();if(n)throw console.error("     :",n),n;if(a)return console.log("   :",a.id,":",a.status),a.id;console.log("     createAttempt");const{data:i,error:l}=await Z.from("user_test_attempts").insert({event_id:e,test_id:t,user_id:r,status:"in_progress"}).select().single();if(l)throw console.error("    :",l),l;return console.log("     createAttempt:",i.id),i.id}function Jne(){const[e,t]=x_(),r=Qt(),{userProfile:a}=st(),n=Xne(),[i,l]=E.useState(null),[o,c]=E.useState(!0),d=e.get("eventId"),x=e.get("testId"),u=e.get("attemptId");if(E.useEffect(()=>{if(console.log(" TakeTestPage useEffect   :",{eventId:d,testId:x,urlAttemptId:u,userId:a==null?void 0:a.id}),!d||!x||!(a!=null&&a.id)){console.log("   "),c(!1);return}if(u){console.log("   attemptId:",u),l(u),c(!1);return}console.log("     TakeTestPage"),c(!0),Qne({eventId:d,testId:x,userId:a.id}).then(h=>{console.log("   :",h),t({eventId:d,testId:x,attemptId:h}),l(h)}).catch(h=>{console.error("     TakeTestPage:",h),c(!1)})},[d,x,u,a==null?void 0:a.id,t]),o||!d||!x||!i)return s.jsx(Kne,{});const f=n?Yne:t7;return s.jsx(f,{eventId:d,testId:x,attemptId:i,onComplete:()=>{r(`/event/${d}`),setTimeout(()=>{window.location.reload()},100)},onCancel:()=>r(`/event/${d}`)})}function Zne(){var b,_,C;const{attemptId:e}=gi(),t=Qt(),{userProfile:r}=st(),[a,n]=E.useState(null),[i,l]=E.useState(!0),[o,c]=E.useState(null),[d,x]=E.useState(!1);console.log("TestResultsPage mounted with attemptId:",e),console.log("User profile:",r),E.useEffect(()=>{console.log("useEffect triggered with attemptId:",e,"userProfile?.id:",r==null?void 0:r.id),e&&u()},[e]);const u=async()=>{console.log("fetchTestResult called with attemptId:",e),l(!0),c(null);try{console.log("User profile:",r),console.log("User role:",r==null?void 0:r.role);const j=(r==null?void 0:r.role)==="administrator"||(r==null?void 0:r.role)==="moderator";console.log("Is admin check:",j);const{data:D,error:R}=await Z.from("user_test_attempts").select(`
          id,
          test_id,
          event_id,
          status,
          score,
          start_time,
          completed_at,
          test:tests(
            id,
            title,
            description,
            type,
            passing_score,
            time_limit
          ),
          event:events(
            id,
            title,
            start_date,
            end_date
          )
        `).eq("id",e).single();if(R)throw R;if(!D)throw new Error("   ");if(!j&&D.user_id!==(r==null?void 0:r.id))throw new Error("       ");const{data:M,error:O}=await Z.from("user_test_answers").select(`
          id,
          question_id,
          answer_id,
          text_answer,
          is_correct,
          user_order,
          question:test_questions(
            id,
            question,
            question_type,
            points,
            correct_order,
            answers:test_answers(
              id,
              text,
              is_correct,
              "order"
            )
          )
        `).eq("attempt_id",e).order("created_at",{ascending:!0});if(O)throw O;console.log("Loaded test result:",D),console.log("Loaded answers:",M),console.log("Is admin:",j),console.log("Result user_id:",D.user_id),console.log("Current user_id:",r==null?void 0:r.id),n({...D,answers:M||[]}),console.log("Final result set:",{...D,answers:M||[]})}catch(j){console.error("   :",j),c(j.message)}finally{l(!1)}},f=j=>{switch(j){case"entry":return" ";case"final":return" ";case"annual":return" ";default:return""}},h=j=>{switch(j){case"entry":return"bg-blue-100 text-blue-800";case"final":return"bg-purple-100 text-purple-800";case"annual":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},p=j=>new Date(j).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),g=(j,D)=>{const R=new Date(j),M=new Date(D);return`${Math.round((M.getTime()-R.getTime())/1e3/60)} `},y=()=>{t("/testing")};if(i)return s.jsx("div",{className:"flex items-center justify-center min-h-64",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Er,{className:"w-6 h-6 animate-spin text-sns-green"}),s.jsx("span",{className:"text-gray-600",children:" ..."})]})});if(o)return s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[s.jsx(ar,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-red-800 mb-2",children:" "}),s.jsx("p",{className:"text-red-700",children:o}),s.jsx("button",{onClick:y,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:""})]});if(!a)return s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 text-center",children:[s.jsx(ar,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"  "}),s.jsx("p",{className:"text-yellow-700",children:"    "}),s.jsx("button",{onClick:y,className:"mt-4 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:""})]});const v=a.score>=a.test.passing_score,w=((b=a.answers)==null?void 0:b.filter(j=>j.is_correct).length)||0,m=((_=a.answers)==null?void 0:_.length)||0;return console.log("Render state:",{loading:i,error:o,result:a?{id:a.id,score:a.score,answersCount:((C=a.answers)==null?void 0:C.length)||0,hasAnswers:!!a.answers&&a.answers.length>0}:null,showAnswers:d,isPassed:v,correctAnswers:w,totalQuestions:m}),s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("button",{onClick:y,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx(kn,{size:20}),s.jsx("span",{children:"  "})]})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100 p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-6",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("span",{className:Ve("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",h(a.test.type)),children:f(a.test.type)}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a.test.title})]}),s.jsxs("p",{className:"text-gray-600 mb-2",children:[": ",a.event.title]}),a.test.description&&s.jsx("p",{className:"text-sm text-gray-500",children:a.test.description})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:Ve("text-3xl font-bold",v?"text-green-600":"text-red-600"),children:[a.score,"%"]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[" : ",a.test.passing_score,"%"]}),s.jsx("div",{className:Ve("mt-2 px-3 py-1 rounded-full text-sm font-medium",v?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:v?" ":"  "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(at,{className:"h-5 w-5 text-green-600"}),s.jsx("span",{className:"text-sm text-gray-600",children:" "})]}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:[w," / ",m]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(er,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{className:"text-sm text-gray-600",children:""})]}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:[m>0?Math.round(w/m*100):0,"%"]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(wr,{className:"h-5 w-5 text-purple-600"}),s.jsx("span",{className:"text-sm text-gray-600",children:" "})]}),s.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:g(a.start_time,a.completed_at)})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Et,{className:"h-5 w-5 text-orange-600"}),s.jsx("span",{className:"text-sm text-gray-600",children:" "})]}),s.jsx("div",{className:"text-sm font-medium text-gray-900 mt-1",children:p(a.completed_at)})]})]}),s.jsxs("button",{onClick:()=>{console.log("Toggle answers button clicked"),console.log("Current showAnswers state:",d),console.log("Result answers:",a.answers);const j=!d;console.log("Setting showAnswers to:",j),x(j)},className:"w-full bg-blue-50 text-blue-700 px-4 py-3 rounded-lg hover:bg-blue-100 transition-colors flex items-center justify-center space-x-2",children:[s.jsx(Et,{size:16}),s.jsx("span",{children:d?" ":"  "})]})]}),console.log("Rendering details section, showAnswers:",d),d&&s.jsxs("div",{className:"bg-white rounded-xl shadow-soft border border-gray-100 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" "}),a.answers&&a.answers.length>0?s.jsx("div",{className:"space-y-4",children:a.answers.map((j,D)=>{var R,M,O,B;return s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:Ve("w-8 h-8 rounded-full flex items-center justify-center text-white font-semibold",j.is_correct?"bg-green-500":"bg-red-500"),children:j.is_correct?s.jsx(at,{size:16}):s.jsx(ds,{size:16})}),s.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[" ",D+1]})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[j.question.points," ()"]})]}),s.jsx("div",{className:"mb-3",children:s.jsx("p",{className:"text-gray-900 font-medium",children:j.question.question})}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:" :"}),s.jsx("div",{className:"text-gray-900",children:j.question.question_type==="text"?s.jsx("p",{children:j.text_answer||"  "}):j.question.question_type==="sequence"?s.jsx("div",{children:j.user_order&&j.user_order.length>0?s.jsx("ol",{className:"list-decimal list-inside space-y-1",children:j.user_order.map((L,U)=>{var F;const P=(F=j.question.answers)==null?void 0:F.find(N=>N.order===L);return s.jsx("li",{className:"text-gray-900",children:(P==null?void 0:P.text)||` ${L}`},U)})}):s.jsx("p",{children:"  "})}):s.jsx("p",{children:((M=(R=j.question.answers)==null?void 0:R.find(L=>L.id===j.answer_id))==null?void 0:M.text)||"  "})})]}),!j.is_correct&&j.question.question_type!=="text"&&s.jsxs("div",{className:"mt-3 bg-green-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm text-green-600 mb-1",children:" :"}),s.jsx("div",{className:"text-green-800",children:j.question.question_type==="sequence"?s.jsx("div",{children:j.question.correct_order&&j.question.correct_order.length>0?s.jsx("ol",{className:"list-decimal list-inside space-y-1",children:j.question.correct_order.map((L,U)=>{var F;const P=(F=j.question.answers)==null?void 0:F.find(N=>N.order===L);return s.jsx("li",{className:"text-green-800",children:(P==null?void 0:P.text)||` ${L}`},U)})}):s.jsx("p",{children:"   "})}):s.jsx("p",{children:((B=(O=j.question.answers)==null?void 0:O.find(L=>L.is_correct))==null?void 0:B.text)||" "})})]})]},j.id)})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Et,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),s.jsx("p",{className:"text-gray-600",children:"    "})]})]})]})}function eie(){const{eventId:e}=gi(),t=Qt(),r=()=>{t("/testing")};return e?s.jsxs("div",{className:"space-y-6 pb-safe-bottom",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("button",{onClick:r,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx(kn,{size:20}),s.jsx("span",{children:"  "})]})}),s.jsx(r7,{eventId:e})]}):s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[s.jsx("h3",{className:"text-lg font-medium text-red-800 mb-2",children:""}),s.jsx("p",{className:"text-red-700",children:"ID   "}),s.jsx("button",{onClick:r,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:""})]})}function tie(){const{eventId:e}=gi(),t=Qt(),[r,a]=E.useState(!1),[n,i]=E.useState(null);return e?s.jsxs("div",{className:"min-h-screen bg-gray-50 relative",children:[s.jsx("div",{className:"bg-white border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex items-center justify-between h-16",children:s.jsxs("div",{className:"flex items-center",children:[s.jsxs("button",{onClick:()=>t(-1),className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[s.jsx(kn,{className:"h-5 w-5 mr-2"}),""]}),s.jsxs("div",{className:"ml-4",children:[s.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:" "}),s.jsxs("p",{className:"text-sm text-gray-500",children:[" ID: ",e]})]})]})})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsx(nA,{eventId:e,onReviewComplete:()=>{t(-1)},onEditReview:l=>{i(l),a(!0)}})}),r&&n&&s.jsx(aA,{isOpen:r,onClose:()=>{a(!1),i(null)},attemptId:n,eventId:e||""})]}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:""}),s.jsx("p",{className:"text-gray-600",children:"ID   "})]})})}function s6({value:e,onChange:t,labels:r={high:"",medium:"",low:""}}){var i;const a=[{v:"high",text:r.high,bg:"bg-emerald-600",ring:"ring-emerald-600"},{v:"medium",text:r.medium,bg:"bg-amber-500",ring:"ring-amber-500"},{v:"low",text:r.low,bg:"bg-rose-500",ring:"ring-rose-500"}],n=Math.max(0,a.findIndex(l=>l.v===e));return s.jsx("div",{className:"relative w-full select-none",children:s.jsxs("div",{className:"grid grid-cols-3 rounded-xl border border-slate-200 bg-white p-1 gap-0",role:"radiogroup","aria-label":" ",onKeyDown:l=>{const o=["low","medium","high"],c=o.indexOf(e);l.key==="ArrowLeft"||l.key==="ArrowDown"?t(o[Math.max(0,c-1)]):(l.key==="ArrowRight"||l.key==="ArrowUp")&&t(o[Math.min(o.length-1,c+1)])},tabIndex:0,children:[s.jsx("div",{className:`absolute top-1 h-[calc(100%-0.5rem)] rounded-lg ${(i=a[n])==null?void 0:i.bg} transition-all`,style:{left:`calc(${n} * 33.333% + 0.25rem)`,width:"calc(33.333% - 0.5rem)"},"aria-hidden":!0}),a.map(l=>s.jsx("button",{type:"button",role:"radio","aria-checked":e===l.v,onClick:()=>t(l.v),className:`z-10 h-8 text-xs font-medium rounded-lg transition-colors whitespace-nowrap
              focus:outline-none
              ${e===l.v?"text-white":"text-slate-600 hover:text-slate-900"}
              flex items-center justify-center min-w-0`,children:s.jsx("span",{className:"truncate",children:l.text})},l.v))]})})}function a6({value:e,onChange:t,max:r=5}){const a=E.useMemo(()=>Array.from({length:r},(n,i)=>i+1),[r]);return s.jsx("div",{role:"radiogroup","aria-label":"  ",className:"flex gap-1.5 items-center justify-start",children:a.map(n=>{const i=n===e;return s.jsx("button",{role:"radio","aria-checked":i,tabIndex:i?0:-1,onKeyDown:l=>{(l.key==="ArrowLeft"||l.key==="ArrowDown")&&t(Math.max(1,e-1)),(l.key==="ArrowRight"||l.key==="ArrowUp")&&t(Math.min(r,e+1))},onClick:()=>t(n),type:"button","aria-label":` ${n}`,className:`h-10 w-10 rounded-full border text-sm font-medium transition-all
              ${i?n===5?"bg-green-500 border-green-500 text-white shadow-sm":n===4?"bg-green-400 border-green-400 text-white shadow-sm":n===3?"bg-yellow-500 border-yellow-500 text-white shadow-sm":n===2?"bg-orange-500 border-orange-500 text-white shadow-sm":"bg-red-500 border-red-500 text-white shadow-sm":"bg-white border-slate-200 text-slate-700 hover:bg-slate-50 focus:outline-none"}`,children:n},n)})})}function rie({saving:e}){return s.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/70 backdrop-blur px-3 py-1 text-xs font-medium border border-slate-200",children:[e?s.jsx(Er,{className:"h-4 w-4 animate-spin text-emerald-600"}):s.jsx(Pa,{className:"h-4 w-4 text-emerald-600"}),e?"":""]})}const Od={leadership_potential:{title:" ",description:"   :  ,  ,   .",levels:{high:"     ,    ",medium:"      ,   ",low:"         "}},business_communication:{title:" ",description:"   ,  ,   -  .",levels:{high:"    ,   ",medium:"   ,    ",low:"   ,   "}},learning_ability:{title:"",description:"   ,  ,     .",levels:{high:"      ",medium:"   ,   ",low:"     "}},motivation_level:{title:"",description:"   ,   ,    .",levels:{high:"  ,  ",medium:"   ",low:"   "}}},Nl={5:"  :     ",4:" : ,   ",3:" :   ,   ",2:" :   ,  ",1:"  : /  "},nv={bonus_management:{categoryTitle:"  ",skills:{bonus_calculation:{title:" ",description:"       .",levels:Nl},tools_usage:{title:" ",description:"        .",levels:Nl}}},task_planning:{categoryTitle:"   ",skills:{task_execution:{title:"  ",description:"      .",levels:Nl},weekly_planning:{title:" ",description:"       100%     .",levels:Nl}}},client_development:{categoryTitle:"  ",skills:{new_client_connection:{title:"  ",description:"      .",levels:Nl},client_connection_skill:{title:" ",description:"     .",levels:Nl}}},average_skills_score:{title:"          ",description:"     ",levels:Nl}},sie=["bonus_calculation","tools_usage","task_execution","weekly_planning","new_client_connection","client_connection_skill"];function n6(e){return{participant_id:e,leadership_potential:"high",business_communication:"high",learning_ability:"high",motivation_level:"high",goal_setting:1,client_contact:1,needs_identification:1,presentation_demo:1,objection_handling:1,bonus_calculation:1,tools_usage:1,task_execution:1,weekly_planning:1,new_client_connection:1,client_connection_skill:1,average_skills_score:1}}function aie(e,t=500){const r=E.useRef(null);return E.useCallback((...a)=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>e(...a),t)},[e,t])}function nie(){const{eventId:e}=gi(),t=Qt(),{userProfile:r}=st(),[a,n]=E.useState([]),[i,l]=E.useState(new Map),[o,c]=E.useState(!0),[d,x]=E.useState(null),[u,f]=E.useState(!1),[h,p]=E.useState(null),g=20,[y,v]=E.useState(1),w=Math.max(1,Math.ceil(a.length/g)),m=E.useMemo(()=>{const M=(y-1)*g;return a.slice(M,M+g)},[a,y]);E.useEffect(()=>{e&&b()},[e]),E.useEffect(()=>{a.length!==0&&l(M=>{let O=!1;const B=new Map(M);for(const L of a)B.has(L.id)||(B.set(L.id,n6(L.id)),O=!0);return O?B:M})},[a]),E.useEffect(()=>{v(M=>{const O=Math.max(1,Math.ceil(a.length/g));return Math.min(M,O)})},[a.length,g]);const b=async()=>{try{c(!0),x(null);const{data:M,error:O}=await Z.from("event_participants").select("id, user_id").eq("event_id",e).eq("attended",!0);if(O)throw O;const B=(M==null?void 0:M.map(N=>N.user_id))||[];let L=[];if(B.length>0){const{data:N,error:T}=await Z.from("users").select("id, full_name, territory_id").in("id",B);if(T)throw T;const S=(N==null?void 0:N.map(W=>W.territory_id).filter(Boolean))||[];let z=[];if(S.length>0){const{data:W,error:k}=await Z.from("territories").select("id, name, region").in("id",S);k?console.warn("  :",k):z=W||[]}L=(M==null?void 0:M.map(W=>{const k=N==null?void 0:N.find(A=>A.id===W.user_id),q=k!=null&&k.territory_id?z.find(A=>A.id===k.territory_id):null;return{id:W.user_id,full_name:(k==null?void 0:k.full_name)||"",territory_name:q==null?void 0:q.name,territory_region:q==null?void 0:q.region}}))||[]}n(L);const{data:U,error:P}=await Z.from("tp_evaluations").select("*").eq("event_id",e).eq("evaluator_id",r==null?void 0:r.id);P&&console.warn("   :",P);const F=new Map;U==null||U.forEach(N=>{F.set(N.participant_id,{participant_id:N.participant_id,leadership_potential:N.leadership_potential||"high",business_communication:N.business_communication||"high",learning_ability:N.learning_ability||"high",motivation_level:N.motivation_level||"high",goal_setting:N.goal_setting||1,client_contact:N.client_contact||1,needs_identification:N.needs_identification||1,presentation_demo:N.presentation_demo||1,objection_handling:N.objection_handling||1,bonus_calculation:N.bonus_calculation||1,tools_usage:N.tools_usage||1,task_execution:N.task_execution||1,weekly_planning:N.weekly_planning||1,new_client_connection:N.new_client_connection||1,client_connection_skill:N.client_connection_skill||1,average_skills_score:N.average_skills_score||1})}),l(F)}catch(M){console.error(M),x("   ")}finally{c(!1)}},_=E.useCallback(M=>i.get(M)??n6(M),[i]),C=E.useCallback(async M=>{if(!(r!=null&&r.id))return;const O={event_id:e,evaluator_id:r.id,...M,updated_at:new Date().toISOString()},{error:B}=await Z.from("tp_evaluations").upsert(O,{onConflict:"event_id,participant_id,evaluator_id"});if(B)throw B},[e,r==null?void 0:r.id]),j=aie(C,500),D=(M,O,B)=>R(M,{[O]:B}),R=async(M,O)=>{f(!0);const L={..._(M),...O},U=sie.map(F=>Number(L[F])),P=U.length>0?U.reduce((F,N)=>F+(Number.isFinite(N)?N:0),0)/U.length:0;L.average_skills_score=P,l(F=>new Map(F).set(M,L));try{await j(L)}catch(F){console.error(" :",F)}finally{f(!1)}};return o?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Er,{className:"animate-spin h-12 w-12 text-emerald-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:" "})]})}):d?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx("div",{className:"text-rose-500 text-6xl mb-4",children:""}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600 mb-4",children:d}),s.jsx("button",{onClick:()=>t(-1),className:"px-4 py-2 bg-slate-700 text-white rounded-xl hover:bg-slate-800 focus:outline-none",children:""})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-30",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center justify-between py-3 gap-3",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0 focus:outline-none","aria-label":"",children:s.jsx(kn,{className:"h-5 w-5 text-gray-700"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 leading-tight truncate",children:"      "}),s.jsx("p",{className:"text-sm text-gray-600 truncate",children:"           "})]})]}),s.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[s.jsxs("span",{className:"hidden sm:inline text-sm text-gray-500",children:[a.length," ()"]}),s.jsx(rie,{saving:u})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-6 space-y-8",children:a.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(sO,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:"   "})]}):s.jsxs(s.Fragment,{children:[s.jsxs("section",{"aria-labelledby":"personal-title",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{id:"personal-title",className:"text-lg font-semibold text-emerald-700 leading-tight",children:"   "}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:", , , "})]}),s.jsx("div",{className:"grid gap-4 md:hidden",children:m.map(M=>{const O=_(M.id);return s.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm transition-shadow",children:[s.jsxs("div",{className:"bg-slate-50 rounded-xl px-4 py-3 mb-4 border border-slate-200",children:[s.jsx("div",{className:"font-semibold text-slate-800",children:M.full_name}),s.jsxs("div",{className:"text-xs text-slate-500",children:[M.territory_name||""," ",M.territory_region?` ${M.territory_region}`:""]})]}),s.jsx("div",{className:"space-y-3",children:Object.entries(Od).map(([B,L])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-700 mb-1",children:[s.jsx("span",{className:"font-medium",children:L.title}),s.jsx("button",{onClick:()=>p(B),"aria-label":`  ${L.title}`,className:"p-1 rounded hover:bg-slate-100 focus:outline-none",children:s.jsx(Vs,{className:"w-4 h-4 text-slate-500"})})]}),s.jsx(s6,{value:O[B],onChange:U=>D(M.id,B,U)})]},B))})]},M.id)})}),s.jsx("div",{className:"hidden md:block overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-sm",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-slate-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"sticky left-0 z-10 text-left py-3 px-4 font-semibold bg-slate-50 w-60 border-r border-slate-200",children:""}),Object.entries(Od).map(([M,O])=>s.jsx("th",{className:"text-center py-3 px-3 font-semibold text-slate-800",children:s.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[s.jsx("span",{children:O.title}),s.jsx("button",{onClick:()=>p(M),className:"p-1 rounded-full hover:bg-slate-200","aria-label":`: ${O.title}`,children:s.jsx(Vs,{className:"w-4 h-4 text-slate-500"})})]})},M))]})}),s.jsx("tbody",{children:m.map((M,O)=>{const B=_(M.id);return s.jsxs("tr",{className:`transition-colors ${O%2===0?"bg-white":"bg-slate-50/70"}`,children:[s.jsxs("td",{className:"sticky left-0 z-10 bg-inherit border-r border-slate-200 py-2.5 px-4 w-60",children:[s.jsx("div",{className:"font-medium text-slate-900 truncate",children:M.full_name}),s.jsxs("div",{className:"text-xs text-slate-500 truncate",children:[M.territory_name||"",M.territory_region&&`  ${M.territory_region}`]})]}),Object.keys(Od).map(L=>s.jsx("td",{className:"py-2.5 px-3 text-center align-middle",children:s.jsx(s6,{value:B[L],onChange:U=>D(M.id,L,U)})},L))]},M.id)})})]})})]}),w>1&&s.jsxs("div",{className:"flex items-center justify-center gap-2 pt-2",children:[s.jsx("button",{className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm hover:bg-slate-50 disabled:opacity-50 focus:outline-none",onClick:()=>v(M=>Math.max(1,M-1)),disabled:y===1,children:""}),s.jsxs("div",{className:"text-sm text-slate-600",children:[" ",s.jsx("span",{className:"font-semibold text-slate-800",children:y}),"  ",w]}),s.jsx("button",{className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm hover:bg-slate-50 disabled:opacity-50 focus:outline-none",onClick:()=>v(M=>Math.min(w,M+1)),disabled:y===w,children:""})]}),s.jsxs("section",{"aria-labelledby":"sales-title",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{id:"sales-title",className:"text-lg font-semibold text-emerald-700 leading-tight",children:"        "}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:" ,  ,   , ,  "})]}),s.jsx("div",{className:"grid gap-4 grid-cols-1",children:m.map(M=>{const O=_(M.id),B=O.average_skills_score,L=["bonus_calculation","tools_usage","task_execution"],U=["weekly_planning","new_client_connection","client_connection_skill"],P=B>4?{box:"border-green-200 bg-green-50",text:"text-green-800"}:B>=3?{box:"border-yellow-200 bg-yellow-50",text:"text-yellow-800"}:{box:"border-red-200 bg-red-50",text:"text-red-800"};return s.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm transition-shadow",children:[s.jsx("div",{className:"bg-slate-50 rounded-xl px-4 py-3 mb-4 border border-slate-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-slate-800",children:M.full_name}),s.jsxs("div",{className:"text-xs text-slate-500",children:[M.territory_name||""," ",M.territory_region?` ${M.territory_region}`:""]})]}),s.jsxs("div",{className:"md:hidden flex items-center gap-2",children:[s.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded-lg text-sm font-semibold ${B>4?"bg-green-100 text-green-800":B>=3?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[s.jsx(Dn,{className:"w-4 h-4"}),B.toFixed(1)]}),s.jsx("button",{onClick:()=>p("average_skills_score"),className:"p-1 rounded hover:bg-slate-200","aria-label":"   ",children:s.jsx(Vs,{className:"w-4 h-4 text-slate-500"})})]})]})}),s.jsxs("div",{className:`\r
                          grid gap-4\r
                          grid-cols-1\r
                          lg:[grid-template-columns:repeat(3,minmax(0,1fr))_260px]\r
                        `,children:[L.map(F=>s.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white px-4 py-3 min-h-[96px] flex flex-col justify-between",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("span",{className:"text-sm font-medium text-slate-700 pr-2",children:[F==="bonus_calculation"&&"      ",F==="tools_usage"&&"       ",F==="task_execution"&&"      "]}),s.jsx("button",{onClick:()=>p(F),className:"p-1 rounded hover:bg-slate-100 flex-shrink-0 focus:outline-none","aria-label":"",children:s.jsx(Vs,{className:"w-4 h-4 text-slate-500"})})]}),s.jsx("div",{className:"mt-2",children:s.jsx(a6,{value:O[F],onChange:N=>D(M.id,F,N)})})]},F)),s.jsxs("div",{className:`rounded-xl border px-4 py-3 row-span-2 ${P.box}`,children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("span",{className:"text-sm font-semibold text-slate-800 pr-2",children:nv.average_skills_score.title}),s.jsx("button",{onClick:()=>p("average_skills_score"),className:"p-1 rounded hover:bg-slate-100 flex-shrink-0 focus:outline-none","aria-label":"   ",children:s.jsx(Vs,{className:"w-4 h-4 text-slate-600"})})]}),s.jsx("div",{className:"mt-12 flex justify-center","aria-live":"polite",children:s.jsx("div",{className:`inline-flex items-baseline gap-2 px-3 py-2 rounded-xl ${P.text}`,children:s.jsx("span",{className:"text-5xl font-black leading-none tracking-tight",children:Number.isFinite(B)?B.toFixed(1):""})})})]}),U.map(F=>s.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white px-4 py-3 min-h-[96px] flex flex-col justify-between",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("span",{className:"text-sm font-medium text-slate-700 pr-2",children:[F==="weekly_planning"&&"       100%     ",F==="new_client_connection"&&"   ",F==="client_connection_skill"&&"   "]}),s.jsx("button",{onClick:()=>p(F),className:"p-1 rounded hover:bg-slate-100 flex-shrink-0 focus:outline-none","aria-label":"",children:s.jsx(Vs,{className:"w-4 h-4 text-slate-500"})})]}),s.jsx("div",{className:"mt-2",children:s.jsx(a6,{value:O[F],onChange:N=>D(M.id,F,N)})})]},F))]})]},M.id)})})]}),w>1&&s.jsxs("div",{className:"flex items-center justify-center gap-2 pt-2",children:[s.jsx("button",{className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm hover:bg-slate-50 disabled:opacity-50 focus:outline-none",onClick:()=>v(M=>Math.max(1,M-1)),disabled:y===1,children:""}),s.jsxs("div",{className:"text-sm text-slate-600",children:[" ",s.jsx("span",{className:"font-semibold text-slate-800",children:y}),"  ",w]}),s.jsx("button",{className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm hover:bg-slate-50 disabled:opacity-50 focus:outline-none",onClick:()=>v(M=>Math.min(w,M+1)),disabled:y===w,children:""})]})]})}),h&&s.jsx(iie,{criterionId:h,onClose:()=>p(null)})]})}function iie({criterionId:e,onClose:t}){E.useEffect(()=>{const n=i=>{i.key==="Escape"&&t()};return document.addEventListener("keydown",n),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",n),document.body.style.overflow=""}},[t]);let r=null,a=!1;if(Object.prototype.hasOwnProperty.call(Od,e))r=Od[e],a=!0;else if(e==="average_skills_score")r=nv.average_skills_score;else for(const n of Object.values(nv))if("skills"in n&&Object.prototype.hasOwnProperty.call(n.skills,e)){r=n.skills[e];break}return s.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:t,role:"dialog","aria-modal":"true",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6 border border-slate-200",onClick:n=>n.stopPropagation(),children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:(r==null?void 0:r.title)||""}),s.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600 focus:outline-none rounded-lg","aria-label":"",children:s.jsx(ds,{className:"w-6 h-6"})})]}),r?s.jsxs("div",{className:"space-y-4 text-sm text-slate-700",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-slate-800 mb-1",children:""}),s.jsx("p",{className:"text-slate-600",children:r.description})]}),a?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-slate-800 mb-2",children:""}),s.jsxs("ul",{className:"space-y-2 text-slate-600",children:[s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-emerald-500 mt-1 flex-shrink-0 border-2 border-white ring-1 ring-emerald-500"}),s.jsxs("span",{children:[s.jsx("b",{className:"text-slate-800",children:":"}),r.levels.high]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-amber-500 mt-1 flex-shrink-0 border-2 border-white ring-1 ring-amber-500"}),s.jsxs("span",{children:[s.jsx("b",{className:"text-slate-800",children:":"}),r.levels.medium]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-rose-500 mt-1 flex-shrink-0 border-2 border-white ring-1 ring-rose-500"}),s.jsxs("span",{children:[s.jsx("b",{className:"text-slate-800",children:":"}),r.levels.low]})]})]})]}):s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-slate-800 mb-2",children:"  (15)"}),s.jsx("div",{className:"space-y-1.5 text-xs text-slate-600",children:Object.entries(r.levels).sort(([n],[i])=>Number(i)-Number(n)).map(([n,i])=>s.jsxs("p",{children:[s.jsxs("b",{children:[n,":"]})," ",String(i)]},n))}),e==="average_skills_score"&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[s.jsx("p",{className:"font-semibold text-slate-800 mb-2",children:"  "}),s.jsxs("div",{className:"space-y-1.5 text-xs text-slate-600",children:[s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500 flex-shrink-0"}),s.jsx("b",{className:"text-green-700",children:""}),"   > 4.0.    ."]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-yellow-500 flex-shrink-0"}),s.jsx("b",{className:"text-yellow-700",children:""}),"   3.04.0.    ."]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500 flex-shrink-0"}),s.jsx("b",{className:"text-red-700",children:""}),"   < 3.0.    ."]})]})]})]})]}):s.jsx("p",{className:"text-slate-600 text-sm",children:"      ."}),s.jsx("div",{className:"mt-6 flex justify-end",children:s.jsx("button",{onClick:t,className:"px-5 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 focus:outline-none transition-colors text-sm font-medium",children:""})})]})})}function lie(){const e=E.useRef(!1);return E.useEffect(()=>{if(e.current)return;e.current=!0,window.authCallbackProcessing=!0,(async()=>{var n;try{console.log(" AuthCallback: start"),console.log(" AuthCallback: window.authCallbackProcessing =",window.authCallbackProcessing);const{data:{session:i},error:l}=await Z.auth.getSession();if(i!=null&&i.user&&!l){console.log(" AuthCallback: User already authenticated:",i.user.email),console.log(" AuthCallback: Redirecting to home without processing tokens"),window.authCallbackProcessing=!1,window.location.href="/";return}const c=new URL(window.location.href).searchParams,d=new URLSearchParams(window.location.hash.replace(/^#/,""));console.log(" AuthCallback: URL parsed, search params:",Object.fromEntries(c.entries())),console.log(" AuthCallback: hash params:",Object.fromEntries(d.entries()));const x=c.get("code");if(x){console.log(" PKCE code detected, exchanging for session..."),console.log(" AuthCallback: About to call exchangeCodeForSession");const{data:p,error:g}=await Z.auth.exchangeCodeForSession(x);return console.log(" AuthCallback: exchangeCodeForSession completed"),g?(console.error(" exchangeCodeForSession error:",g),a()):(console.log(" PKCE session established for:",(n=p.user)==null?void 0:n.email),console.log(" AuthCallback: About to cleanup URL"),t(),console.log(" AuthCallback: About to navigate home"),r())}const u=c.get("access_token")||d.get("access_token"),f=c.get("refresh_token")||d.get("refresh_token");if(u&&f){console.log(" Tokens detected in URL, setSession..."),console.log(" AuthCallback: About to call setSession");const{error:p}=await Z.auth.setSession({access_token:u,refresh_token:f});return console.log(" AuthCallback: setSession completed"),p?(console.error(" setSession error:",p),a()):(console.log(" Session set via tokens"),console.log(" AuthCallback: About to cleanup URL"),t(),console.log(" AuthCallback: About to navigate home"),r())}const h=c.get("token")||d.get("token");if(h){if(h.startsWith("iphone_")){console.log(" iPhone mock token detected, creating session...");const g={id:"f10774ae-754d-4b44-92a4-a57a2ece733c",email:"doirp.sns777@gmail.com",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),app_metadata:{},user_metadata:{},aud:"authenticated",confirmation_sent_at:new Date().toISOString(),recovery_sent_at:null,email_change_sent_at:null,new_email:null,new_phone:null,invited_at:null,action_link:null,email_confirmed_at:new Date().toISOString(),phone_confirmed_at:null,confirmed_at:new Date().toISOString(),email_change_confirm_status:0,banned_until:null,reauthentication_sent_at:null,is_sso_user:!1,deleted_at:null,is_anonymous:!1,phone:null,factors:null,identities:[],last_sign_in_at:new Date().toISOString()},y={access_token:`iphone_${h}`,refresh_token:`iphone_refresh_${h}`,expires_in:3600,expires_at:Math.floor(Date.now()/1e3)+3600,token_type:"bearer",user:g},{error:v}=await Z.auth.setSession({access_token:y.access_token,refresh_token:y.refresh_token});return v?(console.error(" iPhone: Failed to create mock session:",v),a()):(console.log(" iPhone: Mock session created successfully"),t(),r())}console.log(" token_hash detected, verifyOtp..."),console.log(" AuthCallback: About to call verifyOtp");const{error:p}=await Z.auth.verifyOtp({token_hash:h,type:"magiclink"});return console.log(" AuthCallback: verifyOtp completed"),p?(console.error(" verifyOtp error:",p),a()):(console.log(" OTP verified"),console.log(" AuthCallback: About to cleanup URL"),t(),console.log(" AuthCallback: About to navigate home"),r())}console.log(" No auth params found, go home"),a()}catch(i){console.error(" AuthCallback fatal:",i),a()}})();function t(){console.log(" AuthCallback: Cleaning up URL"),window.history.replaceState({},"","/"),console.log(" AuthCallback: URL cleaned up")}function r(){console.log(" AuthCallback: softHome() called"),window.authCallbackProcessing=!1,console.log(" AuthCallback: Flag cleared, about to reload"),window.location.href="/",console.log(" AuthCallback: location.href set")}function a(){console.log(" AuthCallback: hardHome() called"),window.authCallbackProcessing=!1,console.log(" AuthCallback: Flag cleared, about to replace location"),window.location.replace("/"),console.log(" AuthCallback: location.replace() called")}},[]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 px-4",children:s.jsxs("div",{className:"text-center bg-white/95 backdrop-blur-xl px-8 py-6 rounded-3xl shadow-lg border border-white/60",children:[s.jsx(Yl,{size:32,className:"mx-auto mb-4",label:" ",labelClassName:"text-slate-600",iconClassName:"text-blue-600"}),s.jsx("p",{className:"text-gray-600 text-sm",children:" ..."})]})})}function i6(){const{token:e}=gi(),[t,r]=E.useState("loading"),[a,n]=E.useState(" QR-"),[i,l]=E.useState(0),o=E.useRef(!0);E.useEffect(()=>()=>{o.current=!1},[]),E.useEffect(()=>{(async()=>{if(!e){r("error"),n("QR-  ");return}try{r("loading"),n("");const x="https://oaockmesooydvausfoca.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hb2NrbWVzb295ZHZhdXNmb2NhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzNzI4NDEsImV4cCI6MjA2Njk0ODg0MX0.gwWS35APlyST7_IUvQvJtGO4QmGsvbE95lnQf0H1PUE",f=await fetch(`${x}/functions/v1/qr-auth-simple`,{method:"POST",headers:{"Content-Type":"application/json",apikey:u,Authorization:`Bearer ${u}`},body:JSON.stringify({token:e})});if(!f.ok)throw new Error(`HTTP ${f.status}`);const h=await f.json();if(!(h!=null&&h.success))throw new Error((h==null?void 0:h.error)||" ");n("  ");const{error:p}=await Z.auth.signInWithPassword({email:h.email,password:h.password});if(p)throw new Error(p.message);r("success"),n("! "),setTimeout(()=>{o.current&&(window.location.href="/")},500)}catch(x){if(console.error("QR auth error:",x),!o.current)return;r("error"),n((x==null?void 0:x.message)||" ")}})()},[e,i]);const c=()=>{l(d=>d+1)};return s.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-[#F5F7F9] flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(14,159,110,0.08),transparent_70%)]","aria-hidden":!0}),s.jsx("div",{className:"relative z-10 w-full max-w-md",children:s.jsxs("div",{className:"rounded-3xl border border-white/50 bg-white/90 p-8 shadow-2xl backdrop-blur-xl",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"inline-flex h-16 w-16 items-center justify-center rounded-2xl bg-emerald-500/10 mb-4",children:s.jsx(K_,{className:"h-8 w-8 text-emerald-500"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"QR-"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[t==="loading"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-emerald-500 border-t-transparent"}),s.jsx("p",{className:"text-sm text-gray-600",children:a})]}),t==="success"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:s.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsx("p",{className:"text-sm font-medium text-green-600",children:a})]}),t==="error"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-full bg-red-100",children:s.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("p",{className:"text-sm font-medium text-red-600",children:a}),s.jsxs("button",{onClick:c,className:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[s.jsx(en,{className:"h-4 w-4"}),""]})]})]}),s.jsx("div",{className:"rounded-2xl border border-gray-200 bg-gray-50 p-4 text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-600",children:[s.jsx(Zh,{className:"h-4 w-4"}),s.jsx("span",{children:"   "})]})})]})]})})]})}function oie({title:e=" ",subtitle:t=",   ",visible:r}){return r?s.jsx("div",{className:"fixed inset-0 z-[4999] flex items-center justify-center bg-slate-900/70 backdrop-blur-xl px-4",children:s.jsxs("div",{className:"w-full max-w-sm rounded-3xl bg-white/95 backdrop-blur-xl p-8 shadow-2xl border border-white/40",children:[s.jsx(Yl,{size:48,label:"",className:"mx-auto mb-6"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:e}),s.jsx("p",{className:"text-sm text-gray-600 text-center leading-relaxed",children:t})]})}):null}function cie({onStartTest:e}){const{eventId:t}=gi(),r=Qt();if(!t)return s.jsx("div",{children:" ID "});const a=()=>{r("/events")};return s.jsx(Yae,{eventId:t,onStartTest:e,onBack:a})}function die(){const{user:e,userProfile:t,loading:r,resetAuth:a,authError:n,loadingPhase:i,retryFetchProfile:l}=st(),[o,c]=E.useState(!1),[d,x]=E.useState(!1),u=Qt(),f=typeof window<"u"&&window.location.pathname.startsWith("/auth/"),h=typeof window<"u"&&window.location.pathname.startsWith("/auth/qr"),p=f||i==="initializing"||i==="session-fetch"||i==="auth-change";E.useEffect(()=>{if(!e&&!r&&BT()&&!f){const B=setTimeout(()=>{x(!0)},1e3);return()=>clearTimeout(B)}else x(!1)},[e,r,f]),E.useEffect(()=>{console.log(" App: Checking auth params");const{hash:B,search:L,pathname:U}=window.location;console.log(" App: Current URL:",window.location.href),console.log(" App: Pathname:",U),console.log(" App: Search:",L),console.log(" App: Hash:",B);const P=L.includes("code="),F=B.includes("access_token")||B.includes("refresh_token")||B.includes("token="),N=L.includes("token=")&&L.includes("type=magiclink"),T=L.includes("auth=success")&&L.includes("user=")&&L.includes("token=");if(console.log(" App: hasPKCE:",P),console.log(" App: hasHashTokens:",F),console.log(" App: hasSearchMagic:",N),console.log(" App: hasIPhoneAuth:",T),U==="/auth/callback"){console.log(" Already on /auth/callback, skipping redirect");return}if(e&&(P||F||N||T)){console.log(" App: User already authenticated, cleaning URL without redirect");const z=window.location.origin+window.location.pathname;window.history.replaceState({},"",z);return}if(T){console.log(" iPhone auth detected, redirecting to callback...");const z=new URLSearchParams(L),W=z.get("user"),k=z.get("token");if(W&&k){console.log(" iPhone: Redirecting to callback with mock tokens");const q=`/auth/callback?token=iphone_${k}&type=magiclink&redirect_to=http://51.250.94.103/`;window.location.replace(q);return}console.log(" iPhone: Clearing URL and showing login form"),window.history.replaceState({},"","/");return}if((P||F||N)&&U!=="/auth/callback"){const z=P?L:B||L;console.log(" Auth params detected, redirecting to /auth/callback..."),console.log(" App: Redirecting to:","/auth/callback"+z),window.location.replace("/auth/callback"+z)}else console.log(" No magic link tokens found");(async()=>{try{const{data:{session:z},error:W}=await Z.auth.getSession();z&&!W?console.log(" Found stored session:",z.user.email):console.log(" No stored session found")}catch(z){console.error(" Error checking stored session:",z)}})()},[e]);const[g,y]=E.useState(null),[v,w]=E.useState(0),m=ul();if(m.pathname==="/auth/callback")return s.jsx(lie,{});if(m.pathname.startsWith("/auth/qr/"))return s.jsx(lg,{children:s.jsx(kt,{path:"/auth/qr/:token",element:s.jsx(i6,{})})});if(m.pathname==="/test-users")return s.jsx(lg,{children:s.jsx(kt,{path:"/test-users",element:s.jsx(e6,{})})});const D=m.pathname.startsWith("/take-test")||m.pathname.startsWith("/test-results/")?"take-test":m.pathname.startsWith("/events")?"events":m.pathname.startsWith("/event/")?"event-detail":m.pathname.startsWith("/calendar")?"calendar":m.pathname.startsWith("/representatives")?"representatives":m.pathname.startsWith("/supervisors")?"supervisors":m.pathname.startsWith("/expert-events")?"expert-events":m.pathname.startsWith("/tasks")?"tasks":m.pathname.startsWith("/testing")?"tests":m.pathname.startsWith("/admin")?"admin":m.pathname.startsWith("/employees")?"employees":m.pathname.startsWith("/test-users")?"test-users":m.pathname.startsWith("/exam-management")||m.pathname.startsWith("/exam-reserve")?"exam-reserve":m.pathname.startsWith("/expert-schedule")?"schedule":"dashboard",R=(B,L,U)=>{console.log(" App handleStartTest   :",{testId:B,eventId:L,attemptId:U});const P=new URLSearchParams({eventId:L,testId:B});U&&P.append("attemptId",U);const F=`/take-test?${P.toString()}`;console.log("  :",F),u(F)},M=async B=>{console.log("handleEditEvent   eventId:",B);try{const{data:L,error:U}=await Z.from("events").select(`
          *,
          event_types (*),
          creator:creator_id(
            id,
            full_name,
            email,
            avatar_url
          ),
          event_participants (
            user_id,
            users (
              id,
              full_name,
              email,
              sap_number
            )
          )
        `).eq("id",B).single();if(U){console.error("  :",U);return}console.log("  :",L),y(L),c(!0)}catch(L){console.error("   :",L)}},O=()=>{y(null),c(!0)};return E.useEffect(()=>{let B;return r?B=setInterval(()=>{w(L=>L+1)},1e3):w(0),()=>{B&&clearInterval(B)}},[r]),r?s.jsxs("div",{className:"min-h-screen relative overflow-hidden flex items-center justify-center p-4",children:[s.jsxs("div",{className:"absolute inset-0",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-50 via-white to-blue-50"}),s.jsxs("div",{className:"absolute top-0 left-0 w-full h-full",children:[s.jsx("div",{className:"absolute top-[-20%] right-[-10%] w-[600px] h-[600px] rounded-full bg-gradient-to-br from-blue-400/20 via-cyan-300/20 to-teal-400/20 blur-3xl animate-pulse",style:{animationDuration:"8s"}}),s.jsx("div",{className:"absolute bottom-[-20%] left-[-10%] w-[700px] h-[700px] rounded-full bg-gradient-to-tr from-emerald-300/20 via-green-400/20 to-lime-300/20 blur-3xl animate-pulse",style:{animationDuration:"10s",animationDelay:"2s"}})]}),s.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.8),transparent_50%)]"})]}),s.jsx("div",{className:"relative z-10 bg-white/80 backdrop-blur-2xl rounded-3xl p-8 shadow-2xl border border-white/50 max-w-md mx-auto",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Yl,{size:48,className:"mx-auto mb-6",label:""}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:" "}),s.jsxs("p",{className:"text-gray-600 mb-4",children:[i==="initializing"&&"...",i==="session-fetch"&&" ...",i==="profile-fetch"&&" ...",i==="auth-change"&&" ...",!["initializing","session-fetch","profile-fetch","auth-change"].includes(i)&&" ..."]}),v>3&&s.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[" : ",v," ."]}),n&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-4 text-left",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(gR,{className:"h-5 w-5 text-red-500 mr-2 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-red-800 font-medium text-sm",children:" "}),s.jsx("p",{className:"text-red-700 text-sm mt-1",children:n})]})]})}),v>5&&s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[n&&l&&s.jsxs("button",{onClick:l,className:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-medium rounded-xl shadow-lg hover:shadow-xl transition-all duration-200",children:[s.jsx(en,{className:"h-4 w-4 mr-2"})," "]}),s.jsx("button",{onClick:a,className:"inline-flex items-center justify-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-xl shadow-lg hover:shadow-xl transition-all duration-200",children:"    "})]})]})})]}):e?s.jsxs(s.Fragment,{children:[s.jsx(oie,{visible:p,title:h?" ":" ",subtitle:h?" QR-   ":"     "}),s.jsxs(gO,{currentView:D,children:[s.jsxs(lg,{children:[s.jsx(kt,{path:"/",element:s.jsx(Zee,{})}),s.jsx(kt,{path:"/events",element:s.jsx(Ite,{onNavigateToEvent:B=>{(t==null?void 0:t.role)==="expert"?u("/expert-exam/36520f72-c191-4e32-ba02-aa17c482c50b"):u(`/event/${B}`)},onEditEvent:B=>M(B),onCreateEvent:O})}),s.jsx(kt,{path:"/event/:eventId",element:s.jsx(cie,{onStartTest:R})}),s.jsx(kt,{path:"/calendar",element:s.jsx(Xae,{})}),s.jsx(kt,{path:"/representatives",element:s.jsx(Kae,{})}),s.jsx(kt,{path:"/supervisors",element:s.jsx(Qae,{})}),s.jsx(kt,{path:"/expert-events",element:s.jsx(Jae,{})}),s.jsx(kt,{path:"/tasks",element:s.jsx(Zae,{})}),s.jsx(kt,{path:"/testing",element:s.jsx(xne,{})}),s.jsx(kt,{path:"/trainer-territories",element:s.jsx(une,{})}),s.jsx(kt,{path:"/admin",element:s.jsx(gte,{})}),s.jsx(kt,{path:"/employees",element:s.jsx(Bre,{})}),s.jsx(kt,{path:"/test-users",element:s.jsx(e6,{})}),s.jsx(kt,{path:"/exam-reserve",element:s.jsx(pne,{})}),s.jsx(kt,{path:"/exam-details/:id",element:s.jsx(wne,{})}),s.jsx(kt,{path:"/expert-schedule",element:s.jsx(Une,{})}),s.jsxs(kt,{element:s.jsx(zne,{}),children:[s.jsx(kt,{path:"/expert-exam/:id",element:s.jsx(Ju,{children:s.jsx(lp,{})})}),s.jsx(kt,{path:"/expert-exam/:id/schedule",element:s.jsx(Ju,{children:s.jsx(lp,{})})}),s.jsx(kt,{path:"/expert-exam/:id/evaluations",element:s.jsx(Ju,{children:s.jsx(lp,{})})}),s.jsx(kt,{path:"/case-evaluation/:examId",element:s.jsx(Ju,{children:s.jsx(Lne,{})})})]}),s.jsx(kt,{path:"/take-test",element:s.jsx(Jne,{})}),s.jsx(kt,{path:"/test-results/:attemptId",element:s.jsx(Zne,{})}),s.jsx(kt,{path:"/event-test-results/:eventId",element:s.jsx(eie,{})}),s.jsx(kt,{path:"/event-test-review/:eventId",element:s.jsx(tie,{})}),s.jsx(kt,{path:"/event-tp-evaluation/:eventId",element:s.jsx(nie,{})}),s.jsx(kt,{path:"/auth/qr/:token",element:s.jsx(i6,{})})]}),s.jsx(JC,{isOpen:o,onClose:()=>{c(!1),y(null)},onSuccess:()=>{c(!1),y(null),u("/events")},editingEvent:g}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-blue-600 text-sm font-bold",children:""})}),s.jsx("h3",{className:"text-lg font-semibold",children:" "})]}),s.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600 text-xl font-bold",children:""})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:"   .   ?"}),s.jsx("p",{className:"text-sm text-gray-500",children:"       "})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>{x(!1);const B=document.querySelector("[data-quick-login]");B&&B.click()},className:"w-full flex items-center justify-center px-4 py-3 bg-[#06A478] text-white rounded-lg hover:bg-[#059669] transition-colors shadow-sm hover:shadow-md",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsx("button",{onClick:()=>x(!1),className:"w-full px-4 py-3 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:" "})]})]})})})]})]}):f||i==="initializing"||i==="session-fetch"||i==="auth-change"?null:s.jsx(EO,{})}function xie(){return s.jsx(MT,{children:s.jsx(oB,{children:s.jsx(die,{})})})}dS.createRoot(document.getElementById("root")).render(s.jsx(E.StrictMode,{children:s.jsx(xie,{})}));
