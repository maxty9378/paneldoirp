# Инструкция по очистке кэша и Service Worker

## Проблема
При разработке может возникнуть конфликт со старым Service Worker, который кэширует запросы и мешает работе Vite HMR.

## Решение

### 1. Очистка через DevTools (Рекомендуется)

#### Chrome/Edge:
1. Откройте DevTools (F12)
2. Перейдите на вкладку **Application**
3. В левом меню найдите **Service Workers**
4. Нажмите **Unregister** напротив всех Service Worker
5. В левом меню найдите **Storage**
6. Нажмите **Clear site data**
7. Закройте и откройте браузер

#### Быстрая очистка:
1. Нажмите `Ctrl + Shift + Delete`
2. Выберите "Все время" (All time)
3. Отметьте:
   - ✅ Кэшированные изображения и файлы
   - ✅ Файлы cookie и другие данные сайтов
4. Нажмите **Очистить данные**

### 2. Принудительная перезагрузка

После очистки:
- Нажмите `Ctrl + Shift + R` (жесткая перезагрузка)
- или `Ctrl + F5`

### 3. Режим инкогнито для тестирования

Для быстрого тестирования без кэша:
- Откройте окно инкогнито: `Ctrl + Shift + N`
- Перейдите на http://localhost:5173

## Предотвращение проблемы

### Отключить кэш в DevTools во время разработки:

1. Откройте DevTools (F12)
2. Перейдите на вкладку **Network**
3. Поставьте галочку **Disable cache**
4. Держите DevTools открытыми во время разработки

### Использовать скрипт с увеличенной памятью:

```bash
npm run dev:memory
```

Этот скрипт запускает Vite с увеличенным лимитом памяти (8GB), что предотвращает ошибки "heap out of memory".

## Автоматическая очистка при запуске

Вы также можете создать HTML файл для автоматической очистки:

```html
<!DOCTYPE html>
<html>
<head>
    <title>Очистка Service Worker</title>
</head>
<body>
    <h1>Очистка Service Worker...</h1>
    <p id="status">Проверка...</p>
    <script>
        async function unregisterServiceWorkers() {
            if ('serviceWorker' in navigator) {
                const registrations = await navigator.serviceWorker.getRegistrations();
                for (let registration of registrations) {
                    await registration.unregister();
                    console.log('Service Worker отключен:', registration);
                }
                document.getElementById('status').textContent = 
                    registrations.length > 0 
                    ? `Отключено ${registrations.length} Service Worker(s)` 
                    : 'Service Worker не найдены';
            } else {
                document.getElementById('status').textContent = 'Service Worker не поддерживается';
            }
        }
        unregisterServiceWorkers();
    </script>
</body>
</html>
```

Сохраните этот файл как `clear-sw.html` и откройте его в браузере перед началом разработки.

